{"version":3,"sources":["pages/ConfigurationPage/DevicesPage/ComponentConfigPage.js","pages/ConfigurationPage/LayoutsPage/WidgetPage.js","../node_modules/@material-ui/icons/Devices.js","../node_modules/@material-ui/icons/FormatListBulleted.js","../node_modules/@material-ui/icons/Remove.js"],"names":["ComponentConfig","React","memo","props","Log","_","_onClose","_onChange","id","config","attributes","useState","open","setOpen","useEffect","undefined","componentConfiguration","Object","keys","map","configKey","configOption","val","_translate","info","otherConfigOption","label","i18n","t","selection","Tag","Inputs","type","key","divider","disableTypography","container","spacing","item","width","inputProps","style","textAlign","onChange","header","actions","Button","variant","onClick","color","dense","maxWidth","fullWidth","disablePadding","useStyles","makeStyles","theme","iconContainer","display","alignItems","iconCentered","verticalAlign","marginRight","noPadding","padding","alignRight","justifyContent","marginLeft","height","lineHeight","title","Badge","right","transform","sticky","position","backgroundColor","palette","background","default","top","zIndex","_merge","require","_copy","WidgetPage","classes","errors","setErrors","EDITOR","useRef","widget","decryptAllPasswords","current","then","decrypted","onClose","_onSave","useCallback","action","err","ModuleConfigurations","module","forEach","field","required","parameter","moduleConfig","values","indexOf","prevErrors","encryptAllPasswords","onSave","deviceIndex","nextErrors","error","devices","split","replace","_validate","xs","index","onDelete","startIcon","className","disabled","length","SectionWidget","editor","SectionModule","configItems","WidgetsConfig","params","hideOn","FieldsetItem","columns","Fieldset","get","setModule","Text","autoComplete","autoHighlight","options","ModuleList","ModuleConfig","moduleSettings","ModuleSettings","moduleConfigurations","ModuleDevices","push","hide","Input","description","ModuleConfiguration","marginBottom","createElement","FieldsetLegend","setDevices","setError","_addItem","device","deviceId","name","nextDevices","_editItem","_deleteItem","splice","deviceOptions","sortArray","deviceIdList","withinGroup","renderedDevices","i","deviceStates","states","bodyStateKey","primaryStateKey","Device","errorMessage","disableCloseOnSelect","clearOnSelect","clearOnBlur","getOptionLabel","option","function","manufacturer","renderOption","state","added","filter","badgeContent","badge","fontSize","paddingLeft","devicesStates","requiredStates","Array","isArray","some","join","groupBy","closeIcon","popupIcon","centered","onEnter","clearOnEnter","onDragEnd","res","source","destination","droppableId","provided","snapshot","ref","innerRef","minHeight","droppableProps","root","placeholder","componentConfig","setComponentConfig","stateKey","DeviceIcon","Actions","DeviceActionsConfiguration","selectable","Select","_key","secondaryStateKey","lastUpdateOption","Switch","lastUpdate","element","componentsOptions","userConfig","c","uuid","JSON","stringify","draggableId","clsx","drag","isDragging","draggableProps","dragHandleProps","substr","lastIndexOf","icon","DeviceBodyConfiguration","_interopRequireDefault","_interopRequireWildcard","defineProperty","exports","value","_default","d"],"mappings":"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","file":"static/js/27.a22fcfa6.chunk.js","sourcesContent":["import React, { useState, useEffect } from 'react'\r\n//import clsx from 'clsx'\r\n\r\nimport i18n from '../../../controller/i18n'\r\nimport Log from '../../../controller/Log'\r\n\r\nimport Grid from '@material-ui/core/Grid'\r\nimport List from '@material-ui/core/List'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport Dialog from '../../../components/Dialog'\r\nimport Info from '../../../components/Info'\r\nimport Inputs from '../../../components/Inputs'\r\n\r\n\r\n/*\r\n * STYLES\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nconst useStyles = makeStyles(theme => ({\r\n}));\r\n */\r\n\r\n\r\n/*\r\n *\r\n */\r\nconst ComponentConfig = React.memo(props => {\r\n\tLog._('WidgetPage', 'RENDER ComponentConfig', 'development');\r\n\t//const classes = useStyles();\r\n\tconst { _onClose, _onChange, id, config, attributes } = props;\r\n\t\r\n\tconst [open,setOpen] = useState(false);\r\n\tconst onClose = () => {\r\n\t\tsetOpen(false)\r\n\t\t_onClose();\r\n\t}\r\n\t\r\n\tuseEffect(() => {\r\n\t\tsetOpen(config !== null);\r\n\t}, [config]);\r\n\t\r\n\tif (id === null || config === null || config === undefined) {\r\n\t\treturn null;\r\n\t}\r\n\t\r\n\t// component configuration\r\n\tconst componentConfiguration = Object.keys(config).map(configKey => {\r\n\t\tlet configOption = config[configKey];\r\n\t\tconfigOption = typeof configOption === 'object' ? configOption : { 'label': configKey, 'val': configOption.val !== undefined ? configOption.val : configOption }\r\n\t\tlet { _translate, info, ...otherConfigOption } = configOption;\r\n\t\t\r\n\t\totherConfigOption.label = configOption.label || configKey;\r\n\t\totherConfigOption.label = _translate ? i18n.t(configOption.label) : configOption.label;\r\n\t\totherConfigOption.val = _translate ? i18n.t(configOption.val) : configOption.val;\r\n\t\totherConfigOption.selection = typeof otherConfigOption.selection === 'function' ? otherConfigOption.selection(props) : otherConfigOption.selection;\r\n\t\t\r\n\t\tconst Tag = Inputs[configOption.type || 'Text'];\r\n\t\treturn (\r\n\t\t\t<ListItem key={'Config-' + configKey} divider>\r\n\t\t\t\t<ListItemText disableTypography>\r\n\t\t\t\t\t<Grid container spacing={1}>\r\n\t\t\t\t\t\t<Grid item><Info info={info} /></Grid>\r\n\t\t\t\t\t\t<Grid item><Typography>{i18n.t(otherConfigOption.label)}</Typography></Grid>\r\n\t\t\t\t\t</Grid>\r\n\t\t\t\t</ListItemText>\r\n\t\t\t\t\r\n\t\t\t\t<ListItemSecondaryAction>\r\n\t\t\t\t\t<Tag\r\n\t\t\t\t\t\tkey={'componentConfig.' + id + '.' + configKey}\r\n\t\t\t\t\t\tid={'componentConfig.' + id + '.' + configKey}\r\n\t\t\t\t\t\t{...otherConfigOption}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlabel=''\r\n\t\t\t\t\t\twidth={180}\r\n\t\t\t\t\t\tinputProps={{\r\n\t\t\t\t\t\t\tstyle: { textAlign: 'right' }\r\n\t\t\t\t\t\t}} \r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tonChange={(props, val) => _onChange(props, val, attributes)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t\t</ListItemSecondaryAction>\r\n\t\t\t</ListItem>\r\n\t\t);\r\n\t});\r\n\t\r\n\treturn (\r\n\t\t<Dialog\r\n\t\t\theader={i18n.t('Component configuration')}\r\n\t\t\tactions={\r\n\t\t\t\t<Inputs.Button key=\"action-save\" variant=\"text\" onClick={onClose} color=\"primary\" label=\"Apply\" />\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tdense\r\n\t\t\tmaxWidth='xs'\r\n\t\t\tfullWidth={true}\r\n\t\t\topen={open}\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t<List dense disablePadding>\r\n\t\t\t\t{componentConfiguration}\r\n\t\t\t</List>\r\n\t\t</Dialog>\r\n\t);\r\n});\r\n\r\nexport default ComponentConfig;\r\n","import React, { useState, useEffect, useRef, useCallback } from 'react'\r\nimport clsx from 'clsx'\r\nimport { DragDropContext, Droppable, Draggable } from 'react-beautiful-dnd'\r\nimport { v5 as uuid } from 'uuid'\r\n\r\nimport config from '../../../config/config'\r\nimport WidgetsConfig from './Widgets.config'\r\nimport { encryptAllPasswords, decryptAllPasswords } from '../../../helpers/encryption'\r\nimport { sortArray } from '../../../helpers/utils'\r\n\r\nimport i18n from '../../../controller/i18n'\r\nimport Log from '../../../controller/Log'\r\n//import Devices from '../../../controller/Devices'\r\nimport { ModuleList, ModuleConfigurations, ModuleSettings } from '../../../modules/'\r\nimport { componentsOptions } from '../../../functions'\r\n\r\nimport Badge from '@material-ui/core/Badge'\r\nimport Divider from '@material-ui/core/Divider'\r\nimport Grid from '@material-ui/core/Grid'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport List from '@material-ui/core/List'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport DeleteIcon from '@material-ui/icons/Delete'\r\nimport DevicesIcon from '@material-ui/icons/Devices'\r\nimport DividerIcon from '@material-ui/icons/Remove'\r\nimport GroupIcon from '@material-ui/icons/FormatListBulleted'\r\n\r\nimport ComponentConfig from '../DevicesPage/ComponentConfigPage'\r\nimport Dialog from '../../../components/Dialog'\r\nimport Icon from '../../../components/Icon'\r\nimport Inputs from '../../../components/Inputs'\r\nimport Placeholder from '../../../components/Placeholder'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nconst useStyles = makeStyles(theme => ({\r\n\ticonContainer: {\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center'\r\n\t},\r\n\ticonCentered: {\r\n\t\tverticalAlign: 'middle',\r\n\t\tmarginRight: theme.spacing(2)\r\n\t},\r\n\tnoPadding: {\r\n\t\tpadding: 0,\r\n\t},\r\n\talignRight: {\r\n\t\tdisplay: 'flex',\r\n\t\tjustifyContent: 'flex-end',\r\n\t\t\r\n\t\t'& > :not(:first-child)': {\r\n\t\t\tmarginLeft: 8,\r\n\t\t}\r\n\t},\r\n\theight: {\r\n\t\tlineHeight: '45px'\r\n\t},\r\n\ttitle: {\r\n\t\tlineHeight: '25px'\r\n\t},\r\n\tBadge: {\r\n\t\tright: 'unset',\r\n\t\ttransform: 'none',\r\n\t},\r\n\tsticky: {\r\n\t\tposition: 'sticky',\r\n\t\tbackgroundColor: theme.palette.background.default,\r\n\t\ttop: -16,\r\n\t\tzIndex: 1\r\n\t}\r\n}));\r\n\r\n\r\nconst _merge = require('deepmerge');\r\nconst _copy = require('rfdc')();\r\nconst WidgetPage = props => {\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst [errors,setErrors] = useState({});\r\n\tconst EDITOR = useRef(_copy({ 'moduleConfig': {}, 'devices': [], ...props.widget }));\r\n\t\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tuseEffect(() => {\r\n\t\tdecryptAllPasswords(EDITOR.current).then(decrypted => EDITOR.current = decrypted);\r\n\t\t\r\n\t}, []);\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _onClose = () => {\r\n\t\tEDITOR.current = null;\r\n\t\tprops.onClose();\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _onSave = useCallback(action => {\r\n\t\t\r\n\t\t// errors\r\n\t\tconst requiredFields = [{ 'parameter': 'title', 'required': true }, { 'parameter': 'module', 'required': true }];\r\n\t\tlet err = {};\r\n\t\t\r\n\t\t[ ...requiredFields, ...(ModuleConfigurations[EDITOR.current.module] || []) ].forEach(field => {\r\n\t\t\tif (field.required === true && !EDITOR.current[field.parameter] && !EDITOR.current.moduleConfig[field.parameter]) {\r\n\t\t\t\terr[field.parameter] = true;\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\tif (Object.values(err).indexOf(true) > -1) {\r\n\t\t\tsetErrors(prevErrors => ({ ...prevErrors, ...err }));\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t\t// encrypt passwords and save\r\n\t\tencryptAllPasswords(EDITOR.current).then(props.onSave);\r\n\t\t\r\n\t}, [props.onSave]);\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _onChange = useCallback((props, val, deviceIndex) => {\r\n\t\t\r\n\t\t// error handler\r\n\t\tsetErrors(prevErrors => {\r\n\t\t\tlet nextErrors = { ...prevErrors }\r\n\t\t\t\r\n\t\t\t// error occured\r\n\t\t\tif (props.error && props.error !== prevErrors[props.id]) {\r\n\t\t\t\tnextErrors[props.id] = props.error;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// no error -> remove old error\r\n\t\t\telse if (!props.error && prevErrors[props.id]) {\r\n\t\t\t\tdelete nextErrors[props.id];\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn nextErrors;\r\n\t\t});\r\n\t\t\r\n\t\t// device\r\n\t\tif (deviceIndex !== undefined) {\r\n\t\t\tEDITOR.current.devices = EDITOR.current.devices || [];\r\n\t\t\tEDITOR.current.devices[deviceIndex] = EDITOR.current.devices[deviceIndex] || {}\r\n\t\t\t\r\n\t\t\tif (props.id.indexOf('componentConfig.') > -1) {\r\n\t\t\t\tconst [,key,id] = props.id.split('.');\r\n\t\t\t\t\r\n\t\t\t\tEDITOR.current.devices[deviceIndex][key] = EDITOR.current.devices[deviceIndex][key] || {}\r\n\t\t\t\tEDITOR.current.devices[deviceIndex][key][id] = val;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tEDITOR.current.devices[deviceIndex][props.id] = val;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// converted nested IDs to object\r\n\t\telse if (props.id.indexOf('moduleConfig.') > -1) {\r\n\t\t\tEDITOR.current.moduleConfig[props.id.replace('moduleConfig.', '')] = val;\r\n\t\t}\r\n\t\t\r\n\t\t// set value\r\n\t\telse {\r\n\t\t\tEDITOR.current[props.id] = val;\r\n\t\t}\r\n\t\t\r\n\t}, []);\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _validate = useCallback((key, val) => {\r\n\t\t_onChange({ error: !val, id: key }, val || '');\r\n\t}, [_onChange]);\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\tconst mount = () => _validate('title', props.widget.title); // trigger initial validation\r\n\tuseEffect(mount, []);\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\tif (props.widget === null) {\r\n\t\treturn null;\r\n\t}\r\n\t\r\n\treturn (\r\n\t\t<Dialog\r\n\t\t\theader={i18n.t('Widget configuration')}\r\n\t\t\tactions={\r\n\t\t\t\t<Grid container>\r\n\t\t\t\t\t<Grid item xs={6}>\r\n\t\t\t\t\t\t{props.widget.index !== undefined && <Inputs.Button key='action-delete' variant=\"text\" onClick={() => props.onDelete(props.widget.index)} color=\"secondary\" startIcon={<DeleteIcon />} label=\"Delete Widget\" />}\r\n\t\t\t\t\t\t&nbsp;\r\n\t\t\t\t\t</Grid>\r\n\t\t\t\t\t<Grid item xs={6} className={classes.alignRight}>\r\n\t\t\t\t\t\t<Inputs.Button key=\"action-cancel\" variant=\"text\" onClick={_onClose} color=\"secondary\" label=\"Cancel\" />\r\n\t\t\t\t\t\t<Inputs.Button key=\"action-save\" variant=\"text\" onClick={_onSave} color=\"primary\" disabled={Object.keys(errors).length > 0} label=\"Apply\" />\r\n\t\t\t\t\t</Grid>\r\n\t\t\t\t</Grid>\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tdense\r\n\t\t\tmaxWidth={false}\r\n\t\t\tfullWidth={true}\r\n\t\t\topen={true}\r\n\t\t\tonClose={_onClose}\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t<SectionWidget\r\n\t\t\t\t{...props}\r\n\t\t\t\t_onChange={_onChange}\r\n\t\t\t\t_validate={_validate}\r\n\t\t\t\teditor={EDITOR.current}\r\n\t\t\t\t/>\r\n\t\t\t\r\n\t\t\t<SectionModule\r\n\t\t\t\t{...props}\r\n\t\t\t\t_onChange={_onChange}\r\n\t\t\t\teditor={EDITOR.current}\r\n\t\t\t\t/>\r\n\t\t\t\r\n\t\t</Dialog>\r\n\t)\r\n}\r\n\r\nexport default WidgetPage;\r\n\r\n\r\n/*\r\n *\r\n */\r\nconst SectionWidget = React.memo(props => {\r\n\tLog._('WidgetPage', 'RENDER SectionWidget', 'development');\r\n\t//const classes = useStyles();\r\n\tconst { _onChange, editor } = props;\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\tconst configItems = Object.values(WidgetsConfig).map(params => {\r\n\t\tconst Tag = Inputs[params.type || 'Text'];\r\n\t\t\r\n\t\tdelete params.hideOn;\r\n\t\treturn (\r\n\t\t\t<Inputs.FieldsetItem key={'key-' + params.parameter} columns={params.columns || 2}>\r\n\t\t\t\t<Tag\r\n\t\t\t\t\t{...params}\r\n\t\t\t\t\tid={params.parameter}\r\n\t\t\t\t\t\r\n\t\t\t\t\tonChange={_onChange}\r\n\t\t\t\t\tval={editor[params.parameter] !== undefined ? editor[params.parameter] : (params.val || '')}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\r\n\t\t\t</Inputs.FieldsetItem>\r\n\t\t);\r\n\t});\r\n\t\r\n\treturn (\r\n\t\t<Inputs.Fieldset label='Widget-Box'>\r\n\t\t\t{configItems}\r\n\t\t</Inputs.Fieldset>\r\n\t);\r\n});\r\n\r\n/*\r\n *\r\n */\r\nconst SectionModule = React.memo(props => {\r\n\tLog._('WidgetPage', 'RENDER SectionModule', 'development');\r\n\t//const classes = useStyles();\r\n\tconst { _onChange, editor } = props;\r\n\t\r\n\tconst [module,setModule] = useState(editor.module || config.get('DEFAULT_MODULE'));\r\n\t\r\n\treturn (\r\n\t\t<Inputs.Fieldset label='Module'>\r\n\t\t\t<Inputs.FieldsetItem>\r\n\t\t\t\t<Inputs.Text\r\n\t\t\t\t\tkey='module'\r\n\t\t\t\t\tid='module'\r\n\t\t\t\t\t\r\n\t\t\t\t\trequired\r\n\t\t\t\t\tlabel=\"config#Layout#widgetModule#label\"\r\n\t\t\t\t\t\r\n\t\t\t\t\tautoComplete\r\n\t\t\t\t\tautoHighlight\r\n\t\t\t\t\t\r\n\t\t\t\t\tval={module}\r\n\t\t\t\t\toptions={ModuleList}\r\n\t\t\t\t\t\r\n\t\t\t\t\tonChange={(props, val) => {\r\n\t\t\t\t\t\t_onChange(props, val);\r\n\t\t\t\t\t\tsetModule(val);\r\n\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\t\t\t\r\n\t\t\t</Inputs.FieldsetItem>\r\n\t\t\t\r\n\t\t\t<ModuleConfig\r\n\t\t\t\t{...props}\r\n\t\t\t\tmoduleSettings={(module && ModuleSettings[module]) || {}}\r\n\t\t\t\tmoduleConfigurations={(module && ModuleConfigurations[module]) || []}\r\n\t\t\t\t/>\r\n\t\t\t\r\n\t\t\t<ModuleDevices\r\n\t\t\t\t{...props}\r\n\t\t\t\tmoduleSettings={(module && ModuleSettings[module]) || {}}\r\n\t\t\t\t/>\r\n\t\t\t\r\n\t\t</Inputs.Fieldset>\r\n\t);\r\n});\r\n\r\n/*\r\n *\r\n */\r\nconst ModuleConfig = props => {\r\n\tLog._('WidgetPage', 'RENDER ModuleConfig', 'development');\r\n\t//const classes = useStyles();\r\n\tconst { _onChange, moduleSettings, moduleConfigurations, editor } = props;\r\n\t\r\n\t//\r\n\tconst [errors,setErrors] = useState({});\r\n\tuseEffect(() => {\r\n\t\tconst keys = Object.keys(errors);\r\n\t\tif (keys.length > 0) {\r\n\t\t\tkeys.forEach(key => _onChange({ error: true, id: key }, ''));\r\n\t\t}\r\n\t\t\r\n\t}, [errors, _onChange]);\r\n\t\r\n\t// get module configuration options\r\n\tlet moduleConfig = [];\r\n\t\r\n\tif (moduleConfigurations.length > 0) {\r\n\t\tmoduleConfig.push(moduleConfigurations.map(config => {\r\n\t\t\t\r\n\t\t\tif (config.hide) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// get selection options\r\n\t\t\tif (typeof config.selection === 'function') {\r\n\t\t\t\tconfig.selection = config.selection();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// consider required fields\r\n\t\t\tif (!errors['moduleConfig.' + config.parameter] && config.required === true && !(editor.moduleConfig[config.parameter] || config.val)) {\r\n\t\t\t\tsetErrors(prevErrors => ({\r\n\t\t\t\t\t...prevErrors,\r\n\t\t\t\t\t['moduleConfig.' + config.parameter]: true\r\n\t\t\t\t}));\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// render config option\r\n\t\t\tconst Input = Inputs[config.type || 'Text'];\r\n\t\t\treturn (\r\n\t\t\t\t<Inputs.FieldsetItem columns={config.columns || 3} key={'ModuleConfiguration-' + config.parameter}>\r\n\t\t\t\t\t<Input\r\n\t\t\t\t\t\t{...config}\r\n\t\t\t\t\t\tkey={'moduleConfig-' + config.parameter}\r\n\t\t\t\t\t\tid={'moduleConfig.' + config.parameter}\r\n\t\t\t\t\t\tlabel={config.label || config.parameter}\r\n\t\t\t\t\t\tinfo={config.description}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tonChange={_onChange}\r\n\t\t\t\t\t\tval={editor.moduleConfig[config.parameter] !== undefined ? editor.moduleConfig[config.parameter] : config.val}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t\t</Inputs.FieldsetItem>\r\n\t\t\t);\r\n\t\t}));\r\n\t}\r\n\t\r\n\tif (moduleSettings.ModuleConfiguration !== undefined) {\r\n\t\tmoduleConfig.push(\r\n\t\t\t<Grid key=\"CustomModuleConfiguration\" item xs={12}>\r\n\t\t\t\t<Divider style={{ marginBottom: 8 }} />\r\n\t\t\t\t{React.createElement(moduleSettings.ModuleConfiguration, { 'options': editor.moduleConfig, '_onChange': _onChange })}\r\n\t\t\t</Grid>\r\n\t\t);\r\n\t}\r\n\t\r\n\tif (moduleConfig.length === 0) {\r\n\t\tmoduleConfig = (\r\n\t\t\t<Inputs.FieldsetItem key=\"noModuleConfiguration\" noPadding>\r\n\t\t\t\t<Typography>{i18n.t('No configuration available for this module')}.</Typography>\r\n\t\t\t</Inputs.FieldsetItem>\r\n\t\t);\r\n\t}\r\n\t\r\n\treturn [\r\n\t\t<Inputs.FieldsetItem key=\"ModuleConfiguration\" noPadding>\r\n\t\t\t<Inputs.FieldsetLegend label='Module Configuration' variant=\"h4\" divider={false} />\r\n\t\t</Inputs.FieldsetItem>,\r\n\t\tmoduleConfig\r\n\t];\r\n}\r\n\r\n/*\r\n *\r\n */\r\nconst ModuleDevices = React.memo(props => {\r\n\tLog._('WidgetPage', 'RENDER SectionDevices', 'development');\r\n\tconst classes = useStyles();\r\n\tconst { _onChange, moduleSettings, editor } = props;\r\n\t\r\n\tconst [devices,setDevices] = useState(editor.devices || []);\r\n\tconst [error,setError] = useState('');\r\n\t\r\n\tif (!moduleSettings.devices) {\r\n\t\treturn null;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _addItem = (type, val) => {\r\n\t\tlet device = { type: type }\r\n\t\t\r\n\t\t// add device\r\n\t\tif (type === 'device') {\r\n\t\t\tdevice.deviceId = val.id;\r\n\t\t}\r\n\t\t\r\n\t\t// add group\r\n\t\telse if (type === 'group') {\r\n\t\t\tdevice.name = val;\r\n\t\t}\r\n\t\t\r\n\t\t// next devices\r\n\t\tlet nextDevices = [\r\n\t\t\t...devices,\r\n\t\t\tdevice\r\n\t\t];\r\n\t\t\r\n\t\tsetError('');\r\n\t\tsetDevices(nextDevices);\r\n\t\t_onChange({ id: 'devices' }, nextDevices);\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _editItem = (index, props, val) => _onChange(props, val, index);\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _deleteItem = index => {\r\n\t\t\r\n\t\t// next devices\r\n\t\tlet nextDevices = [ ...devices ];\r\n\t\tnextDevices.splice(index, 1);\r\n\t\t\r\n\t\tsetDevices(nextDevices);\r\n\t\t_onChange({ id: 'devices' }, nextDevices);\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _onDragEnd = res => {\r\n\t\t\r\n\t\tif (res.source && res.destination && res.source.index !== res.destination.index) {\r\n\t\t\t\r\n\t\t\t// next devices\r\n\t\t\tlet nextDevices = [ ...devices ];\r\n\t\t\tnextDevices.splice(res.destination.index, 0, nextDevices.splice(res.source.index, 1)[0]);\r\n\t\t\t\r\n\t\t\tsetDevices(nextDevices);\r\n\t\t\t_onChange({ id: 'devices' }, nextDevices);\r\n\t\t}\r\n\t}\r\n\t\r\n\t//\r\n\tconst deviceOptions = sortArray(sortArray(Object.values(props.devices), 'name'), 'function');\r\n\tconst deviceIdList = devices.map(device => device.deviceId);\r\n\t\r\n\tlet withinGroup = false;\r\n\tconst renderedDevices = devices.map((device, i) => {\r\n\t\tconst deviceStates = Object.keys(device.states || {});\r\n\t\tconst bodyStateKey = device.bodyStateKey !== undefined ? device.bodyStateKey : (device.primaryStateKey || (deviceStates && deviceStates[0]) || null);\r\n\t\t\r\n\t\tif (device.type === 'group') {\r\n\t\t\twithinGroup = true;\r\n\t\t}\r\n\t\telse if (device.type === 'divider') {\r\n\t\t\twithinGroup = false;\r\n\t\t}\r\n\t\t\r\n\t\treturn (\r\n\t\t\t<Device\r\n\t\t\t\t{...props}\r\n\t\t\t\tkey={device.type + '- ' + (device.deviceId || device.name) + '-' + i}\r\n\t\t\t\t_addItem={_addItem}\r\n\t\t\t\t_editItem={_editItem}\r\n\t\t\t\t_deleteItem={_deleteItem}\r\n\t\t\t\tdevice={props.devices[device.deviceId] || null}\r\n\t\t\t\toptions={{\r\n\t\t\t\t\t'label': (bodyStateKey && device.states && device.states[bodyStateKey] && device.states[bodyStateKey].label) || '',\r\n\t\t\t\t\t...device,\r\n\t\t\t\t\t'index': i\r\n\t\t\t\t}}\r\n\t\t\t\t\r\n\t\t\t\twithinGroup={withinGroup}\r\n\t\t\t\tdevices={devices}\r\n\t\t\t\t/>\r\n\t\t);\r\n\t});\r\n\t\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<Inputs.FieldsetItem noPadding>\r\n\t\t\t\t<Inputs.FieldsetLegend label='Assigned Devices' variant=\"h4\" divider={false} />\r\n\t\t\t</Inputs.FieldsetItem>\r\n\t\t\t\r\n\t\t\t<Inputs.Fieldset noPadding>\t\r\n\t\t\t\t<Inputs.Fieldset noPadding className={classes.sticky}>\t\r\n\t\t\t\t\t<Inputs.FieldsetItem columns={3}>\r\n\t\t\t\t\t\t<Inputs.Text\r\n\t\t\t\t\t\t\twidth=\"90%\"\r\n\t\t\t\t\t\t\tkey='addDevice'\r\n\t\t\t\t\t\t\tid='addDevice'\r\n\t\t\t\t\t\t\tlabel='Add device'\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\terror={error !== ''}\r\n\t\t\t\t\t\t\terrorMessage={error}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tautoComplete\r\n\t\t\t\t\t\t\tautoHighlight\r\n\t\t\t\t\t\t\tdisableCloseOnSelect\r\n\t\t\t\t\t\t\tclearOnSelect\r\n\t\t\t\t\t\t\tclearOnBlur\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\toptions={deviceOptions}\r\n\t\t\t\t\t\t\tgetOptionLabel={option => i18n.t(option.function) + ' ' + option.name + (!option.attributes || !option.attributes.manufacturer ? '' : ' (' + option.attributes.manufacturer.name + ')')}\r\n\t\t\t\t\t\t\trenderOption={(option, state) => {\r\n\t\t\t\t\t\t\t\tconst added = deviceIdList.indexOf(option.id) > -1 ? deviceIdList.filter(device => device === option.id).length : 0;\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<Badge badgeContent={added} classes={{ badge: classes.Badge }} color=\"primary\">\r\n\t\t\t\t\t\t\t\t\t\t<span style={{ fontSize: '0.8rem', paddingLeft: '24px' }}>{added > 0 ? <strong>{option.name}</strong> : option.name}</span>\r\n\t\t\t\t\t\t\t\t\t</Badge>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tonChange={(props, device) => {\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t// check if an item has been selected\r\n\t\t\t\t\t\t\t\tif (device) {\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t// verify if device has certain state, if required by the module\r\n\t\t\t\t\t\t\t\t\tconst states = Object.keys(device.states || {});\r\n\t\t\t\t\t\t\t\t\tif (moduleSettings.devicesStates && moduleSettings.devicesStates.requiredStates && Array.isArray(moduleSettings.devicesStates.requiredStates) && moduleSettings.devicesStates.requiredStates.some(state => states.indexOf(state) === -1)) {\r\n\t\t\t\t\t\t\t\t\t\tsetError(i18n.t('Device needs one of the following states') + ': ' + moduleSettings.devicesStates.requiredStates.join(', '));\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\t\t_addItem('device', device);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tgroupBy={option => i18n.t(option.function)}\r\n\t\t\t\t\t\t\tcloseIcon={null}\r\n\t\t\t\t\t\t\tpopupIcon={null}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t</Inputs.FieldsetItem>\r\n\t\t\t\t\t{Array.isArray(moduleSettings['devices']) && moduleSettings['devices'].indexOf('group') > -1 && [\r\n\t\t\t\t\t<Inputs.FieldsetItem key=\"orGroup\" columns={1} centered>\r\n\t\t\t\t\t\t<em>{i18n.t('or')}</em>\r\n\t\t\t\t\t</Inputs.FieldsetItem>,\r\n\t\t\t\t\t<Inputs.FieldsetItem key=\"addGroup\" columns={3}>\r\n\t\t\t\t\t\t<Inputs.Text\r\n\t\t\t\t\t\t\twidth=\"90%\"\r\n\t\t\t\t\t\t\tkey='addGroup'\r\n\t\t\t\t\t\t\tid='addGroup'\r\n\t\t\t\t\t\t\tlabel='Add group'\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tonEnter={(props, val) => val && _addItem('group', val)}\r\n\t\t\t\t\t\t\tclearOnEnter\r\n\t\t\t\t\t\t\tclearOnBlur\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t</Inputs.FieldsetItem>]}\r\n\t\t\t\t\t\r\n\t\t\t\t\t{Array.isArray(moduleSettings['devices']) && moduleSettings['devices'].indexOf('divider') > -1 && [\r\n\t\t\t\t\t<Inputs.FieldsetItem key=\"orDivider\" columns={1} centered>\r\n\t\t\t\t\t\t<em>{i18n.t('or')}</em>\r\n\t\t\t\t\t</Inputs.FieldsetItem>,\r\n\t\t\t\t\t<Inputs.FieldsetItem key=\"addDivider\" columns={3}>\r\n\t\t\t\t\t\t<Inputs.Button\r\n\t\t\t\t\t\t\tkey='addDivider'\r\n\t\t\t\t\t\t\tid='addDivider'\r\n\t\t\t\t\t\t\tlabel='Add divider'\r\n\t\t\t\t\t\t\tonClick={() => _addItem('divider')}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t</Inputs.FieldsetItem>]}\r\n\t\t\t\t</Inputs.Fieldset>\r\n\t\t\t\t<Inputs.FieldsetItem>\r\n\t\t\t\t\t<DragDropContext onDragEnd={_onDragEnd}>\r\n\t\t\t\t\t\t<Droppable\r\n\t\t\t\t\t\t\tkey=\"dropList\"\r\n\t\t\t\t\t\t\tdroppableId=\"dropList\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t{(provided, snapshot) => (\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tref={provided.innerRef}\r\n\t\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\t\tminHeight: 50\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t{...provided.droppableProps}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<List classes={{ root: classes.fullWidth }} dense disablePadding>\r\n\t\t\t\t\t\t\t\t\t{renderedDevices}\r\n\t\t\t\t\t\t\t\t\t{provided.placeholder}\r\n\t\t\t\t\t\t\t\t</List>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</Droppable>\r\n\t\t\t\t\t</DragDropContext>\r\n\t\t\t\t</Inputs.FieldsetItem>\r\n\t\t\t\t\r\n\t\t\t</Inputs.Fieldset>\r\n\t\t</>\r\n\t);\r\n});\r\n\r\n/*\r\n *\r\n */\r\nconst Device = React.memo(props => {\r\n\tLog._('WidgetPage', 'RENDER Device', 'development');\r\n\tconst classes = useStyles();\r\n\tconst { _editItem, _deleteItem, devices, device, options, moduleSettings } = props;\r\n\t\r\n\t//\r\n\tconst [componentConfig,setComponentConfig] = useState(null);\r\n\tconst deviceStates = device && device.states && Object.keys(device.states || {}).map(stateKey => ({ '_key': stateKey, '_translated': true, [stateKey]: device.states[stateKey].label || stateKey }));\r\n\t\r\n\t//\r\n\tlet Device = options.deviceId;\r\n\tlet DeviceIcon = <DevicesIcon classes={{ root: classes.iconCentered }} />\r\n\tlet Actions = null;\r\n\t\r\n\t//\r\n\tif (options.type === 'device' && device !== null) {\r\n\t\tDevice = <span className={classes.title}>{device.name + ' (' + i18n.t(device.function) + ', #' + device.id + ')'}</span>\r\n\t\t\r\n\t\tif (!moduleSettings.DeviceActionsConfiguration) {\r\n\t\t\tActions = (!moduleSettings.devicesStates || (moduleSettings.devicesStates && moduleSettings.devicesStates.selectable !== false)) && <Grid container spacing={1}>\r\n\t\t\t\t\t<Grid item xs={6}>\r\n\t\t\t\t\t{(!moduleSettings.devicesStates || !moduleSettings.devicesStates.selectable || (moduleSettings.devicesStates.selectable && moduleSettings.devicesStates.selectable.indexOf('primaryStateKey') > -1)) &&\r\n\t\t\t\t\t\t<Inputs.Select\r\n\t\t\t\t\t\t\tid=\"primaryStateKey\"\r\n\t\t\t\t\t\t\twidth={150}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tlabel='Primary State Key'\r\n\t\t\t\t\t\t\tselection={deviceStates}\r\n\t\t\t\t\t\t\tval={options.primaryStateKey !== undefined ? options.primaryStateKey : device.primaryStateKey}\r\n\t\t\t\t\t\t\tonChange={(props, val) => {\r\n\t\t\t\t\t\t\t\tval = typeof val === 'object' ? val[val._key] : val;\r\n\t\t\t\t\t\t\t\t_editItem(options.index, props, val);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\tdisabled={moduleSettings.devicesStates && moduleSettings.devicesStates.disabled && moduleSettings.devicesStates.disabled.indexOf('primaryStateKey') > -1}\r\n\t\t\t\t\t\t\t/>}\r\n\t\t\t\t\t\r\n\t\t\t\t\t</Grid>\r\n\t\t\t\t\t<Grid item xs={6}>\r\n\t\t\t\t\t{(!moduleSettings.devicesStates || !moduleSettings.devicesStates.selectable || (moduleSettings.devicesStates.selectable && moduleSettings.devicesStates.selectable.indexOf('secondaryStateKey') > -1)) ?\r\n\t\t\t\t\t\t<Inputs.Select\r\n\t\t\t\t\t\t\tid=\"secondaryStateKey\"\r\n\t\t\t\t\t\t\twidth={150}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tlabel='Secondary State Key'\r\n\t\t\t\t\t\t\tselection={[ { '': i18n.t('none') }, ...deviceStates ]}\r\n\t\t\t\t\t\t\tval={options.secondaryStateKey !== undefined ? options.secondaryStateKey : device.secondaryStateKey}\r\n\t\t\t\t\t\t\tonChange={(props, val) => {\r\n\t\t\t\t\t\t\t\tval = typeof val === 'object' ? val[val._key] : val;\r\n\t\t\t\t\t\t\t\t_editItem(options.index, props, val);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\tdisabled={moduleSettings.devicesStates && moduleSettings.devicesStates.disabled && moduleSettings.devicesStates.disabled.indexOf('secondaryStateKey') > -1}\r\n\t\t\t\t\t\t\t/> :\r\n\t\t\t\t\t\t<Placeholder width={150} />}\r\n\t\t\t\t\t</Grid>\r\n\t\t\t\t\t{moduleSettings.devicesStates && moduleSettings.devicesStates.lastUpdateOption === true &&\r\n\t\t\t\t\t<Grid item xs={12}>\r\n\t\t\t\t\t\t<Inputs.Switch\r\n\t\t\t\t\t\t\tid=\"lastUpdate\"\r\n\t\t\t\t\t\t\tlabel='Display Last Update'\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tval={options.lastUpdate !== undefined ? options.lastUpdate : true}\r\n\t\t\t\t\t\t\tonChange={(props, val) => _editItem(options.index, props, val)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t</Grid>}\r\n\t\t\t\t</Grid>\r\n\t\t}\r\n\t}\r\n\telse if (options.type === 'group') {\r\n\t\tDeviceIcon = <GroupIcon classes={{ root: classes.iconCentered }} />\r\n\t\tDevice = <span className={classes.title}>{options.name}</span>\r\n\t}\r\n\telse if (options.type === 'divider') {\r\n\t\tDeviceIcon = <DividerIcon classes={{ root: classes.iconCentered }} />\r\n\t\tDevice = <em className={classes.title}>{'(' + i18n.t('divider') + ')'}</em>\r\n\t}\r\n\t\r\n\t//\r\n\tconst deviceOptions = {\r\n\t\t'device': device || {},\r\n\t\t'deviceStates': deviceStates,\r\n\t\t'options': { ...devices[options.index] || options, 'withinGroup': props.withinGroup },\r\n\t\t'elements': { DeviceIcon, Device, Actions },\r\n\t\t\r\n\t\t'onChange': (props, val) => _editItem(options.index, props, val),\r\n\t\t'onConfig': (id, stateKey, element) => {\r\n\t\t\tlet config = _merge(\r\n\t\t\t\tcomponentsOptions['_defaults'][element] || {},\r\n\t\t\t\t(componentsOptions[device.function] && componentsOptions[device.function][element]) || {}\r\n\t\t\t);\r\n\t\t\t\r\n\t\t\t// apply user specific values\r\n\t\t\tconst userConfig = _merge(\r\n\t\t\t\t(device && device.states && device.states[stateKey] && device.states[stateKey][element + 'Config']) || {},\r\n\t\t\t\toptions[element + 'Config'] || {}\r\n\t\t\t);\r\n\t\t\t\r\n\t\t\tObject.keys(userConfig).forEach(key => {\r\n\t\t\t\tlet [,c] = key.indexOf('-') > -1 ? key.split('-') : ['', key];\r\n\t\t\t\tconfig[c] = typeof config[c] !== 'object' ? { 'val': config[c] } : config[c];\r\n\t\t\t\tconfig[c].val = userConfig[stateKey + '-' + c] || userConfig[c] || config[c].val;\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tsetComponentConfig({ id, device, config, 'attributes': { stateKey, element } });\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn (\r\n\t\t<Draggable\r\n\t\t\tkey={'uuid-' + uuid(JSON.stringify(device) + '_' + JSON.stringify(deviceOptions.options), '4eaf6392-6a70-4802-b343-5ff1a1673f39')}\r\n\t\t\tdraggableId={'device-' + options.deviceId + '-' + options.index}\r\n\t\t\tindex={options.index}\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t{(provided, snapshot) => (\r\n\t\t\t<div\r\n\t\t\t\tclassName={clsx(classes.drag, snapshot.isDragging && classes.isDragging)}\r\n\t\t\t\tref={provided.innerRef}\r\n\t\t\t\t{...provided.draggableProps}\r\n\t\t\t\t{...provided.dragHandleProps}\r\n\t\t\t\t>\r\n\t\t\t\t\r\n\t\t\t\t<ComponentConfig\r\n\t\t\t\t\t_onClose={() => setComponentConfig(null)}\r\n\t\t\t\t\t_onChange={(props, val, attributes) => {\r\n\t\t\t\t\t\tconst key = attributes.stateKey + '-' + props.id.substr(props.id.lastIndexOf('.')+1);\r\n\t\t\t\t\t\tconst id = attributes.element + 'Config';\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\toptions[id] = options[id] || {}\r\n\t\t\t\t\t\toptions[id][key] = val;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t_editItem(options.index, { ...props, 'id': 'componentConfig.' + id + '.' + key }, val);\r\n\t\t\t\t\t}}\r\n\t\t\t\t\t{...componentConfig || {}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\r\n\t\t\t\t<ListItem divider classes={{ container: classes.height }}>\r\n\t\t\t\t\t<Grid container item xs={1}>\r\n\t\t\t\t\t\t<div className={classes.iconContainer}>\r\n\t\t\t\t\t\t\t<Icon style={{ fontSize: '1.5em' }} icon=\"mdi:drag\" />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<IconButton onClick={() => _deleteItem(options.index)}>\r\n\t\t\t\t\t\t\t<DeleteIcon />\r\n\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t</Grid>\r\n\t\t\t\t\t<Grid container item xs={5}>\r\n\t\t\t\t\t\t{moduleSettings.DeviceBodyConfiguration ? React.createElement(moduleSettings.DeviceBodyConfiguration, deviceOptions) : <>{DeviceIcon} {Device}</>}\r\n\t\t\t\t\t</Grid>\r\n\t\t\t\t\t<Grid container item xs={6}>\r\n\t\t\t\t\t\t{moduleSettings.DeviceActionsConfiguration ? React.createElement(moduleSettings.DeviceActionsConfiguration, deviceOptions) : Actions}\r\n\t\t\t\t\t</Grid>\r\n\t\t\t\t</ListItem>\r\n\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</Draggable>\r\n\t);\r\n});\r\n","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M4 6h18V4H4c-1.1 0-2 .9-2 2v11H0v3h14v-3H4V6zm19 2h-6c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h6c.55 0 1-.45 1-1V9c0-.55-.45-1-1-1zm-1 9h-4v-7h4v7z\"\n}), 'Devices');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M4 10.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm0-6c-.83 0-1.5.67-1.5 1.5S3.17 7.5 4 7.5 5.5 6.83 5.5 6 4.83 4.5 4 4.5zm0 12c-.83 0-1.5.68-1.5 1.5s.68 1.5 1.5 1.5 1.5-.68 1.5-1.5-.67-1.5-1.5-1.5zM7 19h14v-2H7v2zm0-6h14v-2H7v2zm0-8v2h14V5H7z\"\n}), 'FormatListBulleted');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M19 13H5v-2h14v2z\"\n}), 'Remove');\n\nexports.default = _default;"],"sourceRoot":""}