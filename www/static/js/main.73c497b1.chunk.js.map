{"version":3,"sources":["modules/StateListItem.js","modules/StateList.js","helpers/timeConverter.js","Log.js","components/EnhancedTableToolbar.js","components/EnhancedTableHead.js","components/EnhancedTableBody.js","components/EnhancedTable.js","modules/AdapterStatus.js","modules/Chart.js","modules/DateTime.js","modules/Map.js","modules/StateListHorizontal.js","modules/Weather.js","functions/door/door.js","functions/heating/heating.js","functions/location/location.js","functions/user/user.js","functions/window/window.js","helpers/colorConverter.js","functions/light/light.js","functions/blind/blind.js","functions/blind/blind-manufacturers.js","modules/MultimediaItem.js","modules/Multimedia.js","Settings.js","functions/blind/index.js","functions/blind/blind.de.js","functions/blind/blind.en.js","functions/door/door.de.js","functions/door/door.en.js","functions/heating/heating.de.js","functions/heating/heating.en.js","config/config.js","functions/light/light.de.js","functions/light/light.en.js","functions/location/location.de.js","functions/location/location.en.js","functions/user/user.de.js","functions/user/user.en.js","functions/window/window.de.js","functions/window/window.en.js","i18n sync /^/.*/.js$","i18n/de.js","i18n/en.js","functions/defaults.js","i18n.js","functions/blind sync /^/blind/..*$","functions/door/index.js","functions/door sync /^/door/..*$","functions/heating/index.js","functions/heating sync /^/heating/..*$","functions/light/index.js","Socket.js","Connection.js","functions/light sync /^/light/..*$","functions/location/index.js","functions/location sync /^/location/..*$","functions/user/index.js","functions/user sync /^/user/..*$","functions/window/index.js","functions/window sync /^/window/..*$","pages/LogsPage.js","components/GridContainer.js","components/StatusSnackbar.js","config/config.dev.js","functions/index.js","Function.js","config/adapters.js","Device.js","pages/index.js","components/TopBar.js","helpers/useWindowDimensions.js","components/TabBar.js","components/Notifications.js","components/Popup.js","components/Widget.js","Jarvis.js","App.js","serviceWorker.js","index.js","components/Inputs.js","pages/DevicesPage.js","pages/LayoutsPage.js","pages/SettingsPage.js","pages/ConfigurationPage.js","modules/index.js","components/Dialog.js"],"names":["styles","theme","defaultListDivider","margin","defaultListIcon","props","components","icon","horizontalListItem","display","textAlign","paddingRight","width","marginTop","horizontalListItemIcon","minWidth","horizontalListItemAction","top","right","position","transform","verticalListItemAction","ListItemIconElement","withStyles","customClassNames","children","classes","classNames","Array","isArray","map","className","clsx","StateListItem","stateChange","stateKey","state","device","primaryStateKey","secondaryStateKey","setState","ListItemTextWidth","getDeviceState","ListItemText","React","createRef","ListItemSecondaryAction","this","Math","floor","current","offsetWidth","resizeComponent","listen","unlisten","ListItemSecondaryActionWidth","openDialog","horizontal","component","action","options","get","getIcon","val","value","primaryComponent","getComponent","primaryAction","getAction","secondaryAction","Fragment","divider","ListItem","finger","button","onClick","bind","ListItemIcon","getStyle","ref","disableTypography","primary","getOption","secondary","subtitle","timeChanged","style","flex","key","id","Component","defaultListSectionDivider","defaultListSectionDividerItem","padding","defaultListSectionText","breakpoints","down","horizontalList","flexDirection","flexWrap","ListDivider","getDevicesBySubgroup","subgroup","title","subgroupActions","handleChange","targetStatus","forEach","status","setDeviceState","ButtonGroup","color","size","Button","i18n","t","StateList","devices","push","settings","List","dense","i","listSection","listItem","ModuleDescription","ModuleScreenshots","ModuleConfig","timeToSeconds","time","toString","indexOf","split","length","hours","minutes","seconds","parseInt","timeToHoursMinutesSeconds","withHours","Number","isNaN","substr","join","secondsToDateTime","dateTimeFormat","format","Date","locale","locales","getLanguage","Log","module","message","criticality","printToConsole","stack","entry","log","console","useToolbarStyles","makeStyles","root","paddingLeft","spacing","highlight","palette","type","main","backgroundColor","lighten","light","text","dark","EnhancedTableToolbar","rowCount","numSelected","rightActionButton","Toolbar","Typography","variant","undefined","Tooltip","IconButton","aria-label","EnhancedTableHead","headCells","onSelectAllClick","selectable","sortable","order","orderBy","onRequestSort","TableHead","TableRow","TableCell","Checkbox","indeterminate","checked","onChange","inputProps","headCell","align","disablePadding","sortDirection","TableSortLabel","active","direction","property","event","label","useStyles","noWrap","whiteSpace","nestedObjects","seen","EnhancedTable","columns","pageRows","emptyRows","rowStyles","selected","row","index","isItemSelected","labelId","columnId","rowStyle","Object","keys","hover","role","aria-checked","tabIndex","column","scope","content","toLowerCase","JSON","stringify","showTableContent","height","colSpan","table","descendingComparator","a","b","getComparator","stableSort","array","comparator","stabilizedThis","el","sort","CustomTableBody","rows","toolbar","pagination","defaultOrder","defaultOrderBy","defaultSelected","defaultPage","defaultRowsPerPage","toolbarRightActionButton","useState","setOrder","setOrderBy","setSelected","page","setPage","rowsPerPage","setRowsPerPage","TableBody","EnhancedTableBody","TableContainer","Table","aria-labelledby","stickyHeader","target","newSelecteds","n","slice","min","selectedIndex","newSelected","concat","TablePagination","rowsPerPageOptions","count","onChangePage","newPage","onChangeRowsPerPage","AdapterStatus","adapterInformation","adapterAliveStatus","newUpdates","updatesJson","lastUpdateCheck","socket","Connection","getConnection","list","blacklist","updateStates","adapterStates","updates","getStates","err","states","subscribeStates","update","lastIndexOf","getAdapterInstances","instances","adapters","instance","common","name","replace","item1","item2","aliveStatus","prevState","unsubscribeStates","updateList","parse","adapterList","loading","adapter","enabled","alive","connected","connection","tooltip","alt","src","extIcon","small","version","availableVersion","UpdateAvailable","runAsCompactMode","compactGroup","StatusIndicator","notAlive","disabled","noUpdates","container","UpdatesListItem","UpdatesIndicator","fontStyle","borderRadius","fontSize","ModuleSettings","noDevicesAllowed","Chart","historyChange","history","addChartGraph","axis","getAxis","start","end","updateChartGraph","chartFilter","chartConfig","yAxes","unshift","ticks","callback","yLeftAxisUnitBefore","parseFloat","toFixed","yLeftAxisUnitAfter","errors","datePicker","selectedTimeRangeValue","selectedTimeRangeUnit","selectedDateTime","dateNow","chartLabels","chartData","labels","datasets","chartPan","chartZoom","timer","timeRangeRef","chartRef","chartUpdates","chartOptions","maintainAspectRatio","spanGaps","legend","legendClickHandler","tooltips","callbacks","item","data","datasetIndex","unit","scales","plugins","colorschemes","scheme","zoom","pan","mode","getTimeRange","requestDeviceStateHistory","step","catch","_","liveUpdates","prevProps","clearTimeout","setTimeout","getTime","timeRange","axisTimeFormat","helpers","prevMarker","markers","marker","ts","reduce","chartIndex","findIndex","groupChartData","chartInstance","values","error","prevStates","dataSet","fill","graphConfig","e","legendItem","ci","meta","getDatasetMeta","hidden","resetZoom","inputRef","input","displayEmpty","disableUnderline","select","utils","DateFnsUtils","open","onOpen","onClose","ampm","InputProps","iconButton","dividerVertical","orientation","placement","buttonDisabled","errorMessage","severity","createElement","toolbarButtons","disableElevation","chartHeight","alignItems","justifyContent","marginBottom","marginRight","marginLeft","DateTime","refTimer","useRef","setDateTime","city","setCity","sunrise","setSunrise","sunset","setSunset","refresh","useEffect","Settings","getSetting","latitude","longitude","getSunrise","getSunset","sun","mapOverview","left","bottom","zIndex","cursor","mapIconContainer","mapIconParent","boxShadow","mapIcon","mapTooltip","Map","defaultZoom","defaultPosition","setMarkers","memoizedMapInitialised","useCallback","memoizedHandleClick","flyTo","prevMarkers","requestDeviceState","mapMarkers","Marker","attributes","avatar","arrow","useFlyTo","center","whenReady","attribution","url","markerIcon","offset","function","L","divIcon","html","iconSize","memoizedHandleMouseEvent","closeTooltip","openTooltip","riseOnHover","onMouseOver","tooltipDirection","permanent","tooltipPermanent","StateListHorizontal","StateListConfig","paper","Weather","setData","getRemoteResource","then","response","statusCode","body","weatherForecast","day","forecast","dailyForecast","date","justify","translations","require","default","setTranslation","description","configurations","true","false","lock","actions","temperature","setTemperature","humidity","boost","Level","defaults","LevelComponent","max","PowerAction","presence","users","location","battery","HsvToRgb","h","r","g","f","p","q","s","v","round","RgbToHex","LightColorAction","stateVal","colorSpace","setColorSpace","colors","Red","Green","Blue","Hue","Saturation","Brightness","Label","br","LightColorComponent","initialColor","onChangeComplete","power","level","colorTemperature","hue","rgb","hsv","hex","setHue","hsl","setChecked","parent","Action","_any","float","lineHeight","borderLeftTransparent","borderLeftColor","alpha","borderRightTransparent","borderRightColor","borderRightColorSecondary","level2","activity","manufacturer","getActivityType","setLevel","sKey","d","setActivity","Multimedia","progress","progressTimeout","isRunning","duration","noHeader","styleImage","styleLengthBar","background","backgroundImage","backgroundUrlPrepend","playIconElements","Divider","image","noImage","information","informationLeft","grandParent","informationRight","lengthBar","controls","controlsBox","controlsBoxLeft","controlsBoxCenter","Fab","controlButton","controlsBoxRight","backgroundPosition","minHeight","paddingTop","controlButtonSmall","MultimediaItem","language","setLanguage","loadTranslation","pageTitle","document","pageFavicon","getElementById","href","setting","DEFAULTS","DEVICES_CONFIG","LAYOUT_CONFIG","tabsHideLabels","info","tabIcon","tabLabel","tabFullscreen","deviceKey","groupName","groupModule","autoCompleteValues","ModuleList","groupTitle","groupIcon","groupIconStyle","webpackContext","req","webpackContextResolve","__webpack_require__","o","Error","code","resolve","exports","sliderMarkLabel","parentOnChange","TriggerAction","startIcon","linebreak","markSteps","markStep","markLabel","onChangeCommitted","valueLabelDisplay","marks","number","door","trigger","wind","de","languages","translation","isoLong","word","placeholders","parts","shift","RegExp","ucFirst","charAt","toUpperCase","navigator","userLanguage","Socket","io","timeout","query","statesSubscribes","on","emit","attempts","reason","pattern","ids","cb","subscribeState","cbs","reg","_getPatternFromId","task","hasOwnProperty","test","getObjectView","Promise","reject","getObject","obj","design","search","params","getState","getStateHistory","unsubscribeState","EventEmitter","listeners","setUrl","setListeners","connect","listener","setListener","window","hostname","LogsPage","logs","getLog","CustomDialog","pinToTop","fullWidth","maxWidth","navigate","header","autoFocus","gridContainer","GridContainer","contents","grid","Grid","xs","sm","md","lg","xl","success","green","warning","amber","iconVariant","opacity","variantIcon","CheckCircleIcon","WarningIcon","ErrorIcon","InfoIcon","StatusSnackbar","autoHideDuration","closeButton","other","Icon","Snackbar","anchorOrigin","vertical","SnackbarContent","blind","heating","jalousie","user","Function","functionType","functionId","functions","defaultStyles","_isFunction","defaultValue","Device","deviceProperties","room","group","_setProperties","stateSubscriptions","stateType","node","config","attribute","stateValKeys","stateValKey","stateValValue","tmp","ignoredStates","ignoredState","hiddenStates","stateOrAttribute","_getStateFromKey","Adapters","formatDistanceToNow","lc","includeSeconds","addSuffix","_getConfigurationSetting","pair","option","_getUserSetting","forceDefault","stateProperty","deviceState","defaultIcon","eventName","subscribe","responses","_updateDeviceState","subscribeDeviceState","historyCache","res","child","off","configuration","appBar","flexGrow","menuButton","transition","flexShrink","userSelect","TopBar","connectionStatus","toggleDrawer","notifications","connectionStatusIcon","connectionStatusTooltip","AppBar","Hidden","smDown","getWindowDimensions","innerWidth","innerHeight","paddingBottom","tabs","borderBottom","fixed","indicator","fullscreen","TabBar","selectedTab","onSelectTab","tabBarProps","tab","setTab","setFixed","handleScroll","threshold","scrollY","prevFixed","offsetTop","offsetHeight","addEventListener","removeEventListener","renderedTabs","Tab","Tabs","TabPanel","renderedTab","windowDimensions","setWindowDimensions","handleResize","useWindowDimensions","mapHeight","setMapHeight","topBarHeight","setHidden","Box","Notifications","Drawer","anchor","drawer","DialogTitle","grey","DialogContent","MuiDialogContent","DialogActions","MuiDialogActions","Popup","forceUpdate","allSettled","nextProps","nextState","closeDialog","Dialog","dividers","card","cardHeaderNoContents","cardAvatar","cardContent","Widget","iconStyle","Card","CardHeader","Avatar","CardContent","getGroup","groupId","Tag","Modules","getGridContents","groups","gridContents","columnContents","moduleSettings","Jarvis","tabTitle","notificationDrawer","notificationsUnread","dialog","dialogContents","layout","tabsEnabled","widgetProps","filter","notification","unread","NODE_NOTIFICATIONS","tabPanels","tabPanel","now","Page","Pages","getTabPanels","topBarTitle","smUp","views","selectedView","onSwipe","App","loaded","errorHandler","reconnect","port","protocol","NODE_SETTINGS","setSettings","applySettings","iobroker","NODE_DEVICES","processDevices","promises","results","result","deviceList","groupedDevices","deviceId","jarvis","processDevice","groupDevice","CircularProgress","topBar","tabBar","gridColumns","SkeletonLoader","Skeleton","animation","gridItem","loaders","random","loader","renderError","ThemeProvider","renderLoadingSkeleton","renderLoadingProgress","Boolean","match","ReactDOM","render","serviceWorker","ready","registration","unregister","FormControl","CustomFormControl","InputLabel","Switch","SwitchSmall","SwitchInline","TextInput","CustomTextInput","InfoIconWrapper","link","rel","required","shrink","autoCompleteParams","placeholder","helperText","setValue","InputType","TextField","userInput","InputLabelProps","startAdornment","InputAdornment","NumberInput","SelectInput","menuOptions","MenuItem","Select","FormHelperText","SwitchInput","SwitchInlineInput","FormControlLabel","control","TextAutoCompleteInput","autoComplete","autoHighlight","Autocomplete","onInputChange","renderInput","SettingsPage","_addDevice","uuid","selectedDevice","_addKey","prevDevice","_cancelDevice","groupEditor","_closePopup","popup","selectedKey","_deleteDevice","prevDevices","_openPopup","_saveDevice","Inputs","hr","attributeKey","renderDeviceAttribute","optionKey","renderDeviceOption","renderDeviceState","renderDeviceStates","renderDeviceOptions","renderDeviceAttributes","deleteButton","renderDevice","renderDevices","verticalAlign","LayoutsPage","_addColumn","tabKey","newColumn","_addTab","newTabIndex","1","_changeTab","tKey","prevTab","columnKey","selectedColumn","groupKey","selectedGroup","parameter","ModuleConfigurations","field","tabLayout","col","tabColumnGroups","componentKey","_deleteColumn","_deleteGroup","_deleteTab","_moveGroup","stopPropagation","sorted","sortedArray","sortedObject","_moveTab","iconContainer","tabColumnComponentsNodes","entries","MODULE","renderTabColumnGroup","groupsInFirstColumn","tabColumnsNodes","renderTabColumns","lastTab","columnContainer","tabsNodes","tabsTotal","renderTab","renderTabs","Input","Paper","CustomDialogActions","alignRight","gutters","ListItemGutters","borderRight","borderLeft","_handleSettingsChange","setSetting","getSettings","_handlePanelChange","panel","isExpanded","inputKey","inputSettings","ExpansionPanel","expanded","ExpansionPanelSummary","expandIcon","heading","secondaryHeading","ExpansionPanelDetails","renderPanel","typography","pxToRem","flexBasis","ConfigurationPage","_onDevicesChange","_onSettingsChange","_onLayoutsChange","_handleTabChange","_cancel","_save","all","reload","Set","expertMode","indicatorColor","textColor","DevicesPage","rawEditor","multiline","fontFamily","CustomDialogContent"],"mappings":"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","file":"static/js/main.73c497b1.chunk.js","sourcesContent":["import React from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\r\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tdefaultListDivider: {\r\n\t\tmargin: '0 0 5px 0'\r\n\t},\r\n\tdefaultListIcon: props => ({\r\n\t\t...theme.components.icon,\r\n\t\t...props.styles\r\n\t}),\r\n\thorizontalListItem: {\r\n\t\tdisplay: 'inline-block',\r\n\t\ttextAlign: 'center',\r\n\t\tpaddingRight: '16px',\r\n\t\twidth: '140px',\r\n\t\tmarginTop: '10px'\r\n\t},\r\n\thorizontalListItemIcon: {\r\n\t\tminWidth: 'auto'\r\n\t},\r\n\thorizontalListItemAction: {\r\n\t\ttextAlign: 'center',\r\n\t\ttop: 0,\r\n\t\tright: 0,\r\n\t\tposition: 'static',\r\n\t\ttransform: 'none',\r\n\t},\r\n\tverticalListItemAction: {\r\n\t\ttextAlign: 'right'\r\n\t},\r\n});\r\n\r\n\r\nconst ListItemIconElement = withStyles(styles)(props => {\r\n\tconst { customClassNames, children, classes } = props;\r\n\t\r\n\tlet classNames = Array.isArray(customClassNames) ? customClassNames : [customClassNames];\r\n\tclassNames = classNames.map(className => (classes[className] ? classes[className] : className));\r\n\t\r\n\treturn <span className={clsx(classNames)}>{children}</span>\r\n});\r\n\r\n\r\nclass StateListItem extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {\r\n\t\t\tListItemTextWidth: '100%'\r\n\t\t}\r\n\t\t\r\n\t\tthis.state[this.props.device.primaryStateKey] = this.props.device.getDeviceState() || {}\r\n\t\t\r\n\t\tif (this.props.device.secondaryStateKey) {\r\n\t\t\tthis.state[this.props.device.secondaryStateKey] = this.props.device.getDeviceState(this.props.device.secondaryStateKey) || {}\r\n\t\t}\r\n\t\t\r\n\t\tthis.ListItemText = React.createRef();\r\n\t\tthis.ListItemSecondaryAction = React.createRef();\r\n\t}\r\n\t\r\n\tcomponentDidMount() {\r\n\t\tthis.ListItemTextWidth = Math.floor(this.ListItemText.current.offsetWidth);\r\n\t\tthis.resizeComponent();\r\n\t\t\r\n\t\t// get state changes\r\n\t\tthis.props.device.listen(this.stateChange);\r\n\t}\r\n\t\r\n\tcomponentWillUnmount() {\r\n\t\tthis.props.device.unlisten(this.stateChange);\r\n\t}\r\n\t\r\n\tcomponentDidUpdate() {\r\n\t\tthis.resizeComponent();\r\n\t}\r\n\t\r\n\tstateChange = (stateKey, state) => {\r\n\t\tif (stateKey === this.props.device.primaryStateKey || stateKey === this.props.device.secondaryStateKey) {\r\n\t\t\tthis.setState({ [stateKey]: state });\r\n\t\t}\r\n\t}\r\n\t\r\n\tresizeComponent() {\r\n\t\tconst ListItemSecondaryActionWidth = Math.floor(this.ListItemSecondaryAction.current.offsetWidth*1.08);\r\n\t\t\r\n\t\tif (this.state.ListItemSecondaryActionWidth !== ListItemSecondaryActionWidth) {\r\n\t\t\tthis.setState({\r\n\t\t\t\tListItemSecondaryActionWidth: ListItemSecondaryActionWidth,\r\n\t\t\t\tListItemTextWidth: this.ListItemTextWidth-ListItemSecondaryActionWidth + 'px'\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t\r\n\topenDialog() {\r\n\t\tthis.props.openDialog(this.props.device);\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { classes, horizontal, device, component, action } = this.props;\r\n\t\t\r\n\t\tconst state = this.state[device.primaryStateKey];\r\n\t\tconst options = device.get('options');\r\n\t\t\r\n\t\tconst icon = device.getIcon(device.primaryStateKey, state.val) || device.getIcon(device.primaryStateKey, state.value);\r\n\t\tconst primaryComponent = component && device.getComponent();\r\n\t\tconst primaryAction = device.getAction(device.primaryStateKey, device.options.primaryAction === false);\r\n\t\tconst secondaryAction = action && this.state[device.secondaryStateKey] ? device.getAction(device.secondaryStateKey) : null;\r\n\t\t\r\n\t\treturn (\r\n\r\n<React.Fragment>\r\n\t\r\n\t{options.divider && options.divider !== 'after' && <ListItem divider className={classes.defaultListDivider} />}\r\n\t\r\n\t<ListItem\r\n\t\tclassName={clsx(this.props.openDialog && classes.finger, horizontal && classes.horizontalListItem)}\r\n\t\tbutton={this.props.openDialog !== null}\r\n\t\tonClick={this.props.openDialog && this.openDialog.bind(this)}\r\n\t\t>\r\n\t\t\r\n\t\t<ListItemIcon className={clsx(horizontal && classes.horizontalListItemIcon)}>\r\n\t\t{icon === null ? <React.Fragment /> :\r\n\t\t\t<ListItemIconElement customClassNames={['defaultListIcon','mdi mdi-' + icon]} styles={device.getStyle('icon', device.primaryStateKey, state.val)} />\r\n\t\t}\r\n\t\t</ListItemIcon>\r\n\t\t\r\n\t\t<ListItemText\r\n\t\t\tref={this.ListItemText}\r\n\t\t\tdisableTypography={primaryComponent !== false}\r\n\t\t\tprimary={primaryComponent || device.getOption('label')}\r\n\t\t\tsecondary={(options.subtitle !== null ? (options.subtitle || (state && state.timeChanged) || null) : null)}\r\n\t\t\tstyle={{ flex: 'initial', width: this.state.ListItemTextWidth }}\r\n\t\t\t/>\r\n\t\t\r\n\t\t<ListItemSecondaryAction\r\n\t\t\tref={this.ListItemSecondaryAction}\r\n\t\t\tclassName={ horizontal ? classes.horizontalListItemAction : classes.verticalListItemAction }\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t{!secondaryAction ? primaryAction : [ primaryAction, <br key={'br_' + device.id} />, secondaryAction ]}\r\n\t\t</ListItemSecondaryAction>\r\n\t</ListItem>\r\n\t\r\n\t{options.divider && options.divider === 'after' && <ListItem divider style={{margin: '5px 0'}} />}\r\n\t\r\n</React.Fragment>\r\n\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(StateListItem);\r\n","import React from 'react'\r\nimport i18n from '../i18n'\r\n\r\nimport List from '@material-ui/core/List'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\nimport StateListItem from './StateListItem'\r\nimport Button from '@material-ui/core/Button'\r\nimport ButtonGroup from '@material-ui/core/ButtonGroup'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tdefaultListSectionDivider: {\r\n\t\tmargin: '5px 0 0 0'\r\n\t},\r\n\tdefaultListSectionDividerItem: {\r\n\t\tmargin: '6px 0 7px 0',\r\n\t\tpadding: '0 16px !important'\r\n\t},\r\n\tdefaultListSectionText: {\r\n\t\tmargin: 0,\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tmargin: '0 0 0 10px',\r\n\t\t}\r\n\t},\r\n\thorizontalList: {\r\n\t\tdisplay: 'flex',\r\n\t\tflexDirection: 'row',\r\n\t\tflexWrap: 'wrap'\r\n\t}\r\n});\r\n\r\n\r\nconst ListDivider = withStyles(styles)(props => {\r\n\tconst { classes, getDevicesBySubgroup, subgroup, title, subgroupActions } = props;\r\n\t\r\n\tconst handleChangeOn = () => handleChange(true);\r\n\tconst handleChangeOff = () => handleChange(false);\r\n\tconst handleChange = targetStatus => {\r\n\t\t\r\n\t\tconst devices = getDevicesBySubgroup(subgroup);\r\n\t\tdevices.forEach(device => {\r\n\t\t\t\r\n\t\t\tlet status = targetStatus;\r\n\t\t\tif (device.primaryStateKey === 'level') {\r\n\t\t\t\tstatus = status ? 100 : 0;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tdevice.setDeviceState(null, status);\r\n\t\t});\r\n\t}\r\n\t\r\n\treturn (\r\n\t\r\n<React.Fragment>\r\n\t<ListItem divider className={classes.defaultListSectionDivider} />\r\n\t<ListItem className={classes.defaultListSectionDividerItem}>\r\n\t\t<ListItemText\r\n\t\t\tclassName={classes.defaultListSectionText}\r\n\t\t\tprimary={title}\r\n\t\t\t/>\r\n\t\t\r\n\t\t<ListItemSecondaryAction>\r\n\t\t{subgroupActions === null || subgroupActions === false ? null :\r\n\t\t\t<ButtonGroup color=\"primary\" size=\"small\">\r\n\t\t\t\t<Button onClick={handleChangeOn}>{i18n.t('on')}</Button>\r\n\t\t\t\t<Button onClick={handleChangeOff}>{i18n.t('off')}</Button>\r\n\t\t\t</ButtonGroup>\r\n\t\t}\r\n\t\t\r\n\t\t</ListItemSecondaryAction>\r\n\t</ListItem>\r\n</React.Fragment>\r\n\t\r\n\t);\r\n});\r\n\r\nclass StateList extends React.Component {\r\n\t\r\n\tgetDevicesBySubgroup(subgroup) {\r\n\t\t\r\n\t\tlet devices = [];\r\n\t\tthis.props.devices.forEach(device => {\r\n\t\t\t\r\n\t\t\tif (subgroup === device.getOption('subgroup')) {\r\n\t\t\t\tdevices.push(device);\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\treturn devices;\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { classes, horizontal, devices, settings, component, action, ...props } = this.props;\r\n\t\tlet subgroup;\r\n\t\t\r\n\t\treturn (\r\n\r\n<List dense={true} className={horizontal && classes.horizontalList}>\r\n\t{devices.map((device, i) => {\r\n\t\t\r\n\t\tconst listSection = subgroup !== null && device.options.subgroup !== null && device.options.subgroup !== subgroup && <ListDivider\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={'ListDivider-' + device.get('id')}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tgetDevicesBySubgroup={this.getDevicesBySubgroup.bind(this)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsubgroup={device.getOption('subgroup')}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle={device.options.subgroup}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsubgroupActions={settings.subgroupActions || device.options.subgroupActions}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\r\n\t\tconst listItem = <StateListItem\r\n\t\t\t\t\t\t\t{...props}\r\n\t\t\t\t\t\t\tkey={'StateListItem-' + device.get('id')}\r\n\t\t\t\t\t\t\thorizontal={horizontal}\r\n\t\t\t\t\t\t\tdevice={device}\r\n\t\t\t\t\t\t\tcomponent={component || false}\r\n\t\t\t\t\t\t\taction={action || true}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\r\n\t\tsubgroup = device.getOption('subgroup');\r\n\t\treturn [ listSection, listItem ];\r\n\t})}\r\n</List>\r\n\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(StateList);\r\n\r\n\r\nexport const ModuleDescription = \"Zeigt eine Liste von States an.\";\r\nexport const ModuleScreenshots = ['StateList1.png', 'StateList2.png', 'StateList3.png', 'StateList4.png'];\r\n\r\nexport const ModuleConfig = [\r\n\t{\r\n\t\t'parameter': 'subgroupActions',\r\n\t\t'label': {\r\n\t\t\t'en': 'Show on/off actions for sugroups',\r\n\t\t\t'de': 'Buttons an/aus fr Untergruppen einblenden'\r\n\t\t},\r\n\t\t'type': 'SwitchInput',\r\n\t\t'val': true\r\n\t}\r\n]\r\n","import { format } from 'date-fns'\r\nimport i18n, { locales } from '../i18n'\r\n\r\n/**\r\n *\r\n *\r\n */\r\nfunction timeToSeconds(time) {\r\n\t\r\n\tif (time.toString().indexOf(':') > -1) {\r\n\t\ttime = time.toString();\r\n\t\tlet format = time.split(':').length-1;\r\n\t\tlet [ hours, minutes, seconds ] = format > 1 ? time.split(':') : ('0:' + time).split(':');\r\n\t\ttime = parseInt(hours) * 3600 + parseInt(minutes) * 60 + parseInt(seconds);\r\n\t}\r\n\t\r\n\treturn parseInt(time);\r\n}\r\n\r\n/**\r\n *\r\n *\r\n */\r\nfunction timeToHoursMinutesSeconds(time, withHours = false) {\r\n\t\r\n\tif (time.toString().indexOf(':') > -1) {\r\n\t\treturn time;\r\n\t}\r\n\t\r\n\ttime = parseInt(time);\r\n\twithHours = withHours || (time > 3600);\r\n\t\r\n\tif (Number.isNaN(time)) {\r\n\t\treturn withHours ? '00:00:00' : '00:00';\r\n\t}\r\n\t\r\n\tlet hours = '0' + Math.floor(time/3600);\r\n\tlet minutes = '0' + Math.floor(time/60);\r\n\tlet seconds = '0' + (time % 60);\r\n\t\r\n\treturn withHours ? [ hours.substr(-2), minutes.substr(-2), seconds.substr(-2) ].join(':') : [ minutes.substr(-2), seconds.substr(-2) ].join(':');\r\n}\r\n\r\n/**\r\n *\r\n *\r\n */\r\nfunction secondsToDateTime(seconds, dateTimeFormat = 'dd. MMM yyyy, HH:mm') {\r\n\treturn format(new Date(seconds*1000), dateTimeFormat, { locale: locales[i18n.getLanguage()] });\r\n}\r\n\r\n\r\nexport default {\r\n\ttimeToSeconds,\r\n\ttimeToHoursMinutesSeconds,\r\n\tsecondsToDateTime\r\n}","/**\r\n * Settings\r\n *\r\n *\r\n */\r\nexport default class Log {\r\n\r\n\t/*\r\n\t * holds the log\r\n\t */\r\n\tstatic log = [];\r\n\r\n\t/**\r\n\t * Add a message to the log\r\n\t *\r\n\t * @param\t{String}\t\tmodule\t\t\t\t\t\tModule (origin) of log message\r\n\t * @param\t{String|Array}\tmessage\t\t\t\t\t\tLog message\r\n\t * @param\t{String}\t\t[criticality=info]\t\t\tCriticality, one of 'debug', 'info', 'warn' or 'error'\r\n\t * @param\t{Boolean}\t\t[printToConsole=false]\t\tPrint log message to console\r\n\t * @param\t{Object}\t\t[stack={}]\t\t\t\t\tStack trace of error message\r\n\t * @return\t{Log}\r\n\t */\r\n\tstatic _(module, message, criticality = 'info', printToConsole = true, stack = {}) {\r\n\t\tmessage = Array.isArray(message) ? message : [message];\r\n\t\t\r\n\t\tmessage.forEach(entry => {\r\n\t\t\tLog.log.push({\r\n\t\t\t\ttime: new Date(),\r\n\t\t\t\tmodule,\r\n\t\t\t\tcriticality,\r\n\t\t\t\tmessage: entry,\r\n\t\t\t\tstack\r\n\t\t\t});\r\n\t\t});\r\n\t\t\r\n\t\tif (printToConsole) {\r\n\t\t\tmessage[0] = module + ' # ' + message[0];\r\n\t\t\tconsole[criticality](...message); // https://nodejs.org/docs/latest/api/console.html\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Gets the log\r\n\t *\r\n\t * @param\tvoid\r\n\t * @return\t{Array}\r\n\t */\r\n\tstatic getLog() {\r\n\t\treturn Log.log;\r\n\t}\r\n}\r\n","/*\r\n * Code by MATERIAL-UI\r\n * @see https://material-ui.com/components/tables/#sorting-amp-selecting\r\n *\r\n */\r\nimport React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport clsx from 'clsx'\r\n\r\nimport { lighten, makeStyles } from '@material-ui/core/styles'\r\nimport Toolbar from '@material-ui/core/Toolbar'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\nimport DeleteIcon from '@material-ui/icons/Delete'\r\n\r\n\r\nconst useToolbarStyles = makeStyles(theme => ({\r\n  root: {\r\n    paddingLeft: theme.spacing(2),\r\n    paddingRight: theme.spacing(1),\r\n  },\r\n  highlight:\r\n    theme.palette.type === 'light'\r\n      ? {\r\n          color: theme.palette.secondary.main,\r\n          backgroundColor: lighten(theme.palette.secondary.light, 0.85),\r\n        }\r\n      : {\r\n          color: theme.palette.text.primary,\r\n          backgroundColor: theme.palette.secondary.dark,\r\n        },\r\n  title: {\r\n    flex: '1 1 100%',\r\n  },\r\n}));\r\n\r\nexport default function EnhancedTableToolbar(props) {\r\n  const classes = useToolbarStyles();\r\n  const { title, rowCount, numSelected, rightActionButton } = props;\r\n\r\n  return (\r\n    <Toolbar\r\n      className={clsx(classes.root, {\r\n        [classes.highlight]: numSelected > 0,\r\n      })}\r\n    >\r\n      {numSelected > 0 ? (\r\n        <Typography className={classes.title} color=\"inherit\" variant=\"subtitle1\">\r\n          {numSelected} selected\r\n        </Typography>\r\n      ) : (\r\n        <Typography className={classes.title} variant=\"h6\" id=\"tableTitle\">\r\n\t\t\t{title !== undefined && (title + ' (' + rowCount + ')')}\r\n        </Typography>\r\n      )}\r\n\r\n      {numSelected > 0 ? (\r\n        <Tooltip title=\"Delete\">\r\n          <IconButton aria-label=\"delete\">\r\n            <DeleteIcon />\r\n          </IconButton>\r\n        </Tooltip>\r\n      )\r\n\t  : rightActionButton}\r\n    </Toolbar>\r\n  );\r\n};\r\n\r\nEnhancedTableToolbar.propTypes = {\r\n  numSelected: PropTypes.number.isRequired,\r\n};","/*\r\n * Code by MATERIAL-UI\r\n * @see https://material-ui.com/components/tables/#sorting-amp-selecting\r\n *\r\n */\r\nimport React from 'react'\r\nimport PropTypes from 'prop-types'\r\n\r\nimport TableHead from '@material-ui/core/TableHead'\r\nimport TableRow from '@material-ui/core/TableRow'\r\nimport TableCell from '@material-ui/core/TableCell'\r\nimport TableSortLabel from '@material-ui/core/TableSortLabel'\r\nimport Checkbox from '@material-ui/core/Checkbox'\r\n\r\n\r\nexport default function EnhancedTableHead(props) {\r\n  const { headCells, onSelectAllClick, selectable, sortable, order, orderBy, numSelected, rowCount, onRequestSort } = props;\r\n  const createSortHandler = property => event => {\r\n    onRequestSort(event, property);\r\n  };\r\n\r\n  return (\r\n    <TableHead>\r\n      <TableRow>\r\n\t\t{selectable !== false &&\r\n\t\t\t<TableCell padding=\"checkbox\">\r\n\t\t\t  <Checkbox\r\n\t\t\t\tindeterminate={numSelected > 0 && numSelected < rowCount}\r\n\t\t\t\tchecked={rowCount > 0 && numSelected === rowCount}\r\n\t\t\t\tonChange={onSelectAllClick}\r\n\t\t\t\tinputProps={{ 'aria-label': 'select all' }}\r\n\t\t\t  />\r\n\t\t\t</TableCell>\r\n\t\t}\r\n\t\t\r\n        {headCells.map(headCell => (\r\n          <TableCell\r\n            key={headCell.id}\r\n            align={headCell.align || 'left'}\r\n            padding={headCell.disablePadding ? 'none' : 'default'}\r\n            sortDirection={sortable && (orderBy === headCell.id ? order : false)}\r\n\t\t\tstyle={{ width: headCell.width || 'auto' }}\r\n          >\r\n\t\t  {sortable ?\r\n            <TableSortLabel\r\n              active={orderBy === headCell.id}\r\n              direction={orderBy === headCell.id ? order : 'asc'}\r\n              onClick={createSortHandler(headCell.id)}\r\n            >\r\n              <strong>{headCell.label}</strong>\r\n            </TableSortLabel>\r\n\t\t\t:\r\n\t\t\t <strong>{headCell.label}</strong>\r\n\t\t\t}\r\n          </TableCell>\r\n        ))}\r\n      </TableRow>\r\n    </TableHead>\r\n  );\r\n}\r\n\r\nEnhancedTableHead.propTypes = {\r\n  classes: PropTypes.object.isRequired,\r\n  numSelected: PropTypes.number.isRequired,\r\n  onRequestSort: PropTypes.func.isRequired,\r\n  onSelectAllClick: PropTypes.func.isRequired,\r\n  order: PropTypes.oneOf(['asc', 'desc']).isRequired,\r\n  orderBy: PropTypes.string.isRequired,\r\n  rowCount: PropTypes.number.isRequired,\r\n};","/*\r\n * Code by MATERIAL-UI\r\n * @see https://material-ui.com/components/tables/#sorting-amp-selecting\r\n *\r\n */\r\nimport React from 'react'\r\nimport clsx from 'clsx'\r\nimport { format } from 'date-fns'\r\n\r\nimport TableBody from '@material-ui/core/TableBody'\r\nimport TableCell from '@material-ui/core/TableCell'\r\nimport TableRow from '@material-ui/core/TableRow'\r\nimport Checkbox from '@material-ui/core/Checkbox'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tnoWrap: {\r\n\t\twhiteSpace: 'nowrap'\r\n\t}\r\n}));\r\n\r\n\r\n// https://stackoverflow.com/questions/9382167/serializing-object-that-contains-cyclic-object-value\r\nfunction nestedObjects(key, val, seen) {\r\n\t\r\n\tif (val !== null && typeof val === 'object') {\r\n\t\tif (seen.indexOf(val) >= 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tseen.push(val);\r\n\t}\r\n\t\r\n\treturn val;\r\n}\r\n\r\nfunction showTableContent(content, type = '') {\r\n\t\r\n\tif (content === undefined || content === null) {\r\n\t\treturn '';\r\n\t}\r\n\t\r\n\tlet seen = [];\r\n\tswitch(type.toLowerCase()) {\r\n\t\tcase 'date':\r\n\t\t\tcontent = format(content, 'yyyy-MM-dd HH:mm:ss');\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tdefault:\r\n\t\t\tcontent = Array.isArray(content) || typeof content === 'object' ? JSON.stringify(content, (key, val) => nestedObjects(key, val, seen)) : content;\r\n\t\t\tcontent = typeof content === 'boolean' ? content.toString() : content;\r\n\t\t\tbreak;\r\n\t}\r\n\t\r\n\treturn content;\r\n}\r\n\r\nexport default function EnhancedTable(props) {\r\n\tconst { columns, pageRows, emptyRows, rowStyles, selectable, selected, onClick } = props;\r\n\tconst classes = useStyles();\r\n\tconst isSelected = id => selected.indexOf(id) !== -1;\r\n\r\n\treturn (\r\n\r\n<TableBody>\r\n\t{pageRows.map((row, index) => {\r\n\t\tconst isItemSelected = isSelected(row.id);\r\n\t\tconst labelId = `enhanced-table-checkbox-${index}`;\r\n\t\t\r\n\t\tlet styles = {};\r\n\t\tfor (let columnId in rowStyles) {\r\n\t\t\tlet rowStyle = rowStyles[columnId];\r\n\t\t\t\r\n\t\t\tif (row[columnId] && Object.keys(rowStyle).indexOf(row[columnId]) > -1) {\r\n\t\t\t\tstyles = { ...styles, ...rowStyle[row[columnId]] };\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn (\r\n\r\n\t<TableRow\r\n\t\tkey={'TableRow-' + index}\r\n\t\thover\r\n\t\tonClick={onClick ? (event => onClick(event, row.id)) : undefined}\r\n\t\trole=\"checkbox\"\r\n\t\taria-checked={isItemSelected}\r\n\t\ttabIndex={-1}\r\n\t\tselected={isItemSelected}\r\n\t\t>\r\n\t\t\r\n\t\t{selectable !== false &&\r\n\t\t<TableCell\r\n\t\t\tkey={'TableCell-' + index + '-Checkbox'}\r\n\t\t\tstyle={styles}\r\n\t\t\tpadding=\"checkbox\"\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t<Checkbox\r\n\t\t\t\tchecked={isItemSelected}\r\n\t\t\t\tinputProps={{ 'aria-labelledby': labelId }}\r\n\t\t\t\t/>\r\n\t\t\t\r\n\t\t</TableCell>\r\n\t\t}\r\n\t\t\r\n\t\t{columns.map(column => (\r\n\t\t<TableCell\r\n\t\t\tkey={'TableCell-' + index + '-' + column.id}\r\n\t\t\tclasses={{ root: clsx(column.noWrap && classes.noWrap) }}\r\n\t\t\tstyle={styles}\r\n\t\t\tscope=\"row\"\r\n\t\t\tpadding={column.disablePadding ? 'none' : 'default'}\r\n\t\t\t>\r\n\r\n\t\t\t{showTableContent(row[column.id], column.type)}\r\n\t\t</TableCell>\r\n\r\n\t\t))}\r\n\r\n\t</TableRow>\r\n\t\t\r\n\t\t);\r\n\t})}\r\n\t\r\n\t{emptyRows > 0 && (\r\n\t<TableRow style={{ height: 53 * emptyRows }}>\r\n\t\t<TableCell colSpan={6} />\r\n\t</TableRow>\r\n\t)}\r\n\t\r\n</TableBody>\r\n\r\n\t);\r\n}","/*\r\n * Code by MATERIAL-UI\r\n * @see https://material-ui.com/components/tables/#sorting-amp-selecting\r\n *\r\n */\r\nimport React from 'react'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport Table from '@material-ui/core/Table'\r\nimport TableContainer from '@material-ui/core/TableContainer'\r\nimport TablePagination from '@material-ui/core/TablePagination'\r\n\r\nimport EnhancedTableToolbar from '../components/EnhancedTableToolbar'\r\nimport EnhancedTableHead from '../components/EnhancedTableHead'\r\nimport EnhancedTableBody from '../components/EnhancedTableBody'\r\n\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  table: {\r\n    minWidth: 750,\r\n  }\r\n}));\r\n\r\n\r\nfunction descendingComparator(a, b, orderBy) {\r\n  if (b[orderBy] < a[orderBy]) {\r\n    return -1;\r\n  }\r\n  if (b[orderBy] > a[orderBy]) {\r\n    return 1;\r\n  }\r\n  return 0;\r\n}\r\n\r\nfunction getComparator(order, orderBy) {\r\n  return order === 'desc'\r\n    ? (a, b) => descendingComparator(a, b, orderBy)\r\n    : (a, b) => -descendingComparator(a, b, orderBy);\r\n}\r\n\r\nfunction stableSort(array, comparator) {\r\n  const stabilizedThis = array.map((el, index) => [el, index]);\r\n  stabilizedThis.sort((a, b) => {\r\n    const order = comparator(a[0], b[0]);\r\n    if (order !== 0) return order;\r\n    return a[1] - b[1];\r\n  });\r\n  return stabilizedThis.map(el => el[0]);\r\n}\r\n\r\nexport default function EnhancedTable(props) {\r\n  const classes = useStyles();\r\n  \r\n  const { title, headCells, size, CustomTableBody, rows, toolbar, selectable, pagination, defaultOrder, defaultOrderBy, defaultSelected, defaultPage, defaultRowsPerPage, toolbarRightActionButton } = props;\r\n  \r\n  const [order, setOrder] = React.useState(defaultOrder || 'asc');\r\n  const [orderBy, setOrderBy] = React.useState(defaultOrderBy || headCells[0].id);\r\n  const [selected, setSelected] = React.useState(defaultSelected || []);\r\n  const [page, setPage] = React.useState(defaultPage || 0);\r\n  const [rowsPerPage, setRowsPerPage] = React.useState(pagination ? (defaultRowsPerPage || 5) : rows.length);\r\n\r\n  const handleRequestSort = (event, property) => {\r\n    const isAsc = orderBy === property && order === 'asc';\r\n    setOrder(isAsc ? 'desc' : 'asc');\r\n    setOrderBy(property);\r\n  };\r\n\r\n  const handleSelectAllClick = event => {\r\n    if (event.target.checked) {\r\n      const newSelecteds = rows.map(n => n.id);\r\n      setSelected(newSelecteds);\r\n      return;\r\n    }\r\n    setSelected([]);\r\n  };\r\n\r\n  const handleChangePage = (event, newPage) => {\r\n    setPage(newPage);\r\n  };\r\n\r\n  const handleChangeRowsPerPage = event => {\r\n    setRowsPerPage(parseInt(event.target.value, 10));\r\n    setPage(0);\r\n  };\r\n\r\n  const selectRow = (event, id) => {\r\n    const selectedIndex = selected.indexOf(id);\r\n    let newSelected = [];\r\n\r\n    if (selectedIndex === -1) {\r\n      newSelected = newSelected.concat(selected, id);\r\n    } else if (selectedIndex === 0) {\r\n      newSelected = newSelected.concat(selected.slice(1));\r\n    } else if (selectedIndex === selected.length - 1) {\r\n      newSelected = newSelected.concat(selected.slice(0, -1));\r\n    } else if (selectedIndex > 0) {\r\n      newSelected = newSelected.concat(\r\n        selected.slice(0, selectedIndex),\r\n        selected.slice(selectedIndex + 1),\r\n      );\r\n    }\r\n\r\n    setSelected(newSelected);\r\n  };\r\n\r\n  const TableBody = CustomTableBody || EnhancedTableBody;\r\n  return (\r\n\t<React.Fragment>\r\n\t\t{toolbar !== false &&\r\n        <EnhancedTableToolbar\r\n\t\t  title={title}\r\n          rowCount={rows.length}\r\n\t\t  numSelected={selected.length || 0}\r\n\t\t  rightActionButton={toolbarRightActionButton}\r\n\t\t  />}\r\n\t\t\r\n        <TableContainer>\r\n          <Table\r\n            className={classes.table}\r\n            aria-labelledby=\"tableTitle\"\r\n            aria-label=\"enhanced table\"\r\n\t\t\tsize={size}\r\n\t\t\tstickyHeader={true}\r\n          >\r\n            <EnhancedTableHead\r\n              classes={classes}\r\n              numSelected={selected.length}\r\n              order={order}\r\n              orderBy={orderBy}\r\n              onSelectAllClick={handleSelectAllClick}\r\n              onRequestSort={handleRequestSort}\r\n              rowCount={rows.length}\r\n\t\t\t  {...props}\r\n            />\r\n\t\t\t\r\n\t\t\t<TableBody\r\n\t\t\t\tcolumns={headCells}\r\n\t\t\t\tpageRows={stableSort(rows, getComparator(order, orderBy)).slice(page * rowsPerPage, page * rowsPerPage + rowsPerPage)}\r\n\t\t\t\temptyRows={rowsPerPage - Math.min(rowsPerPage, rows.length - page * rowsPerPage)}\r\n\t\t\t\tonClick={selectable !== false && selectRow}\r\n\t\t\t\tselected={selected}\r\n\t\t\t\t{...props}\r\n\t\t\t\t/>\r\n\t\t\t\r\n          </Table>\r\n        </TableContainer>\r\n\t\t{pagination && <TablePagination\r\n          rowsPerPageOptions={[5, 10, 25]}\r\n          component=\"div\"\r\n          count={rows.length}\r\n          rowsPerPage={rowsPerPage}\r\n          page={page}\r\n          onChangePage={handleChangePage}\r\n          onChangeRowsPerPage={handleChangeRowsPerPage}\r\n        />}\r\n\t</React.Fragment>\r\n\t\r\n  );\r\n}","import React from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport { format } from 'date-fns'\r\n\r\nimport Connection from '../Connection'\r\nimport i18n, { locales } from '../i18n'\r\n\r\nimport CircularProgress from '@material-ui/core/CircularProgress'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\nimport Avatar from '@material-ui/core/Avatar'\r\nimport List from '@material-ui/core/List'\r\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction'\r\nimport StarIcon from '@material-ui/icons/Star';\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tnoUpdates: {\r\n\t\tfontStyle: 'italic',\r\n\t\ttextAlign: 'right',\r\n\t\tcolor: 'rgba(0, 0, 0, 0.54)'\r\n\t},\r\n\tUpdateAvailable: {\r\n\t\tcolor: '#CCAA00',\r\n\t},\r\n\tUpdatesListItem: {\r\n\t\tbackgroundColor: '#ffd700',\r\n\t\tcolor: '#fff',\r\n\t\tmargin: theme.spacing(0, -2),\r\n\t\tpaddingLeft: theme.spacing(2)\r\n\t},\r\n\tUpdatesIndicator: {\r\n\t\tright: theme.spacing(3.75),\r\n\t\tbackgroundColor: '#CCAA00',\r\n\t\tborderRadius: '50%',\r\n\t\twidth: theme.spacing(3),\r\n\t\theight: theme.spacing(3),\r\n\t\tcolor: '#fff',\r\n\t\ttextAlign: 'center',\r\n\t\tfontSize: '1rem !important'\r\n\t},\r\n\tStatusIndicator: {\r\n\t\tfontSize: '1.4rem'\r\n\t},\r\n\tloading: {\r\n\t\ttextAlign: 'center',\r\n\t\tmarginTop: '5px'\r\n\t},\r\n\tsmall: {\r\n\t\twidth: theme.spacing(3),\r\n\t\theight: theme.spacing(3),\r\n\t},\r\n\talive: {\r\n\t\tcolor: '#86d686'\r\n\t},\r\n\tnotAlive: {\r\n\t\tcolor: '#f7e43b'\r\n\t},\r\n\tdisabled: {\r\n\t\tcolor: '#bababa'\r\n\t}\r\n});\r\n\r\n\r\nclass AdapterStatus extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {\r\n\t\t\tadapterInformation: [],\r\n\t\t\tadapterAliveStatus: {},\r\n\t\t\tnewUpdates: false,\r\n\t\t\tupdatesJson: '',\r\n\t\t\tlastUpdateCheck: ''\r\n\t\t}\r\n\t\t\r\n\t\tthis.socket = Connection.getConnection;\r\n\t\tthis.list = this.props.settings.list ? (Array.isArray(this.props.settings.list) ? this.props.settings.list : this.props.settings.list.split(',')) : null;\r\n\t\tthis.blacklist = this.props.settings.blacklist ? (Array.isArray(this.props.settings.blacklist) ? this.props.settings.blacklist : this.props.settings.blacklist.split(',')) : null;\r\n\t\t\r\n\t\tthis.updateStates = ['admin.0.info.newUpdates', 'admin.0.info.lastUpdateCheck', 'admin.0.info.updatesJson'];\r\n\t\tthis.adapterStates = [];\r\n\t}\r\n\t\r\n\tcomponentDidMount() {\r\n\t\t\r\n\t\t// retrieve updates\r\n\t\tif (this.props.settings.updates !== false) {\r\n\t\t\t\r\n\t\t\tthis.socket.getStates(this.updateStates, (err, states) => {\r\n\t\t\t\t\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tnewUpdates: states['admin.0.info.newUpdates'].val,\r\n\t\t\t\t\tlastUpdateCheck: states['admin.0.info.lastUpdateCheck'].val,\r\n\t\t\t\t\tupdatesJson: states['admin.0.info.updatesJson'].val\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\t// get state updates\r\n\t\t\t\tthis.socket.subscribeStates(this.updateStates, (id, update) => {\r\n\t\t\t\t\t\r\n\t\t\t\t\tid = id.substr(id.lastIndexOf('.')+1);\r\n\t\t\t\t\tif (this.state[id] !== update.val) {\r\n\t\t\t\t\t\tthis.setState({ [id]: update.val });\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\t// get adapter instances\r\n\t\tthis.socket.getAdapterInstances((err, instances) => {\r\n\t\t\t\r\n\t\t\tif (instances && instances.rows) {\r\n\t\t\t\tlet adapters = [];\r\n\t\t\t\t\r\n\t\t\t\t// states per instance to retrieve\r\n\t\t\t\tinstances.rows.forEach((instance, i) => {\r\n\t\t\t\t\t\r\n\t\t\t\t\t// get alive / connected states\r\n\t\t\t\t\tif ((!this.list || (this.list && this.list.indexOf(instance.value.common.name) > -1)) && (!this.blacklist || (this.blacklist && this.blacklist.indexOf(instance.value.common.name) === -1))) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tadapters.push(instance);\r\n\t\t\t\t\t\tthis.adapterStates = this.adapterStates.concat([\r\n\t\t\t\t\t\t\tinstance.id + '.alive',\r\n\t\t\t\t\t\t\tinstance.id + '.connected',\r\n\t\t\t\t\t\t\tinstance.id.replace('system.adapter.', '') + '.info.connection'\r\n\t\t\t\t\t\t]);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\t// sort instances\r\n\t\t\t\tthis.setState({ adapterInformation: adapters.sort((item1, item2) => {\r\n\t\t\t\t\t\tif (item1.id > item2.id) return 1;\r\n\t\t\t\t\t\telse if (item2.id > item1.id) return -1;\r\n\t\t\t\t\t\telse return 0;\r\n\t\t\t\t\t})\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\t// retrieve intial states\r\n\t\t\t\tthis.socket.getStates(this.adapterStates, (err, adapterAliveStatus) => {\r\n\t\t\t\t\tthis.setState({ adapterAliveStatus });\r\n\t\t\t\t\t\r\n\t\t\t\t\t// get state updates\r\n\t\t\t\t\tthis.socket.subscribeStates(this.adapterStates, (id, aliveStatus) => {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (aliveStatus && (!this.state.adapterAliveStatus[id] || (aliveStatus.val !== this.state.adapterAliveStatus[id].val))) {\r\n\t\t\t\t\t\t\tthis.setState(prevState => ({ adapterAliveStatus: { ...prevState.adapterAliveStatus, [id]: aliveStatus } }));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\tcomponentWillUnmount() {\r\n\t\tthis.socket.unsubscribeStates([ ...this.updateStates, ...this.adapterStates ]);\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { classes } = this.props;\r\n\t\t\r\n\t\t// adapter updates\r\n\t\tconst updateList = (this.state.updatesJson && JSON.parse(this.state.updatesJson)) || {};\r\n\t\tconst updates = Object.keys(updateList).length\r\n\t\t\r\n\t\t// adapter instances\r\n\t\tlet adapterList = <ListItem key='loading' className={classes.loading}><CircularProgress size={20} /></ListItem>\r\n\t\t\r\n\t\tif (this.state.adapterInformation.length > 0) {\r\n\t\t\t\r\n\t\t\tadapterList = this.state.adapterInformation.map(adapter => {\r\n\t\t\t\tadapter.update = updateList[adapter.value.common.name] || false;\r\n\t\t\t\t\r\n\t\t\t\tconst enabled = adapter.value.common.enabled;\r\n\t\t\t\tconst alive = (this.state.adapterAliveStatus[adapter.id + '.alive'] && this.state.adapterAliveStatus[adapter.id + '.alive'].val) || false;\r\n\t\t\t\tconst connected = (this.state.adapterAliveStatus[adapter.id + '.connected'] && this.state.adapterAliveStatus[adapter.id + '.connected'].val) || false;\r\n\t\t\t\tconst connection = this.state.adapterAliveStatus[adapter.id.replace('system.adapter.', '') + '.info.connection'] ? this.state.adapterAliveStatus[adapter.id.replace('system.adapter.', '') + '.info.connection'].val : true;\r\n\t\t\t\t\r\n\t\t\t\tconst tooltip = i18n.t('Adapter') + ' ' + (enabled ? (alive && connected && connection ? i18n.t('alive') : i18n.t('not alive')) : i18n.t('disabled'));\r\n\t\t\t\t\r\n\t\t\t\treturn (\r\n\t\t\t\t\r\n\t\t\t\t\t<ListItem key={'adapter-' + adapter.id}>\r\n\t\t\t\t\t\t<ListItemAvatar>\r\n\t\t\t\t\t\t\t<Avatar alt={adapter.value.common.name} src={adapter.value.common.extIcon} className={classes.small} />\r\n\t\t\t\t\t\t</ListItemAvatar>\r\n\t\t\t\t\t\t<ListItemText\r\n\t\t\t\t\t\t\tprimary={adapter.value.common.title}\r\n\t\t\t\t\t\t\tsecondary={[\r\n\t\t\t\t\t\t\t\t'v' + adapter.value.common.version,\r\n\t\t\t\t\t\t\t\t(adapter.update && adapter.value.common.version !== adapter.update.availableVersion && (<span key={'updates-' + adapter.id}>, <span className={classes.UpdateAvailable}>{i18n.t('Update available') + ' v' + adapter.update.availableVersion}</span></span>)),\r\n\t\t\t\t\t\t\t\t(adapter.value.common.runAsCompactMode && ', ' + i18n.t('Compact Mode') + ' ' + i18n.t('on') + ' (' + i18n.t('Group') + ' ' + adapter.value.common.compactGroup + ')')\r\n\t\t\t\t\t\t\t]}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<ListItemSecondaryAction className={clsx(classes.StatusIndicator, enabled ? (alive && connected && connection ? classes.alive : classes.notAlive) : classes.disabled)}>\r\n\t\t\t\t\t\t\t<Tooltip title={tooltip}>\r\n\t\t\t\t\t\t\t\t<span className={enabled ? (alive && connected && connection ? 'mdi mdi-check-circle' : 'mdi mdi-alert') : 'mdi mdi-close'}></span>\r\n\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t</ListItemSecondaryAction>\r\n\t\t\t\t\t</ListItem>\r\n\t\t\t\t\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\treturn (\r\n\r\n<List dense>\r\n\t{this.state.newUpdates === false ? (this.state.lastUpdateCheck && \r\n\t<ListItem key=\"updates\" classes={{ root: classes.noUpdates }}>\r\n\t\t<ListItemText\r\n\t\t\tprimary={i18n.t('last update') + ': ' + format(new Date(this.state.lastUpdateCheck), 'dd.MM.yyyy HH:mm:ss', { locale: locales[i18n.getLanguage()] })}\r\n\t\t\t/>\r\n\t\t\r\n\t</ListItem>)\r\n\t:\r\n\t<ListItem key=\"updates\" classes={{ container: classes.UpdatesListItem }}>\r\n\t\t<ListItemAvatar>\r\n\t\t\t<StarIcon />\r\n\t\t</ListItemAvatar>\r\n\t\t<ListItemText\r\n\t\t\tprimary={i18n.t('Updates available') + '!'}\r\n\t\t\t/>\r\n\t\t\r\n\t\t<ListItemSecondaryAction className={clsx(classes.StatusIndicator, classes.UpdatesIndicator)}>\r\n\t\t\t{updates}\r\n\t\t</ListItemSecondaryAction>\r\n\t</ListItem>\r\n\t}\r\n\t\r\n\t{adapterList}\r\n</List>\r\n\r\n\t\t);\r\n\t}\r\n}\r\n\r\n\r\nexport default withStyles(styles)(AdapterStatus);\r\n\r\nexport const ModuleSettings = {\r\n\tnoDevicesAllowed: true,\r\n\ttitle: i18n.t('Adapter Status'),\r\n\ticon: 'traffic-light'\r\n}\r\n\r\nexport const ModuleDescription = \"Zeigt alle installierten Adapter mit ihren Instanzen und dem jeweiligen Status (active & alive, active & not connected, inactive) an.\";\r\nexport const ModuleScreenshots = ['AdapterStatus1.png'];\r\n\r\nexport const ModuleConfig = [\r\n\t{\r\n\t\t'parameter': 'updates',\r\n\t\t'label': 'Adapter Updates',\r\n\t\t'description': {\r\n\t\t\t'en': 'Enable to show adapters updates',\r\n\t\t\t'de': 'Aktivieren, um Adapter Updates anzuzeigen'\r\n\t\t},\r\n\t\t'type': 'SwitchInput',\r\n\t\t'val': true\r\n\t},\r\n\t{\r\n\t\t'parameter': 'list',\r\n\t\t'label': {\r\n\t\t\t'en': 'List of Adapter\\'s',\r\n\t\t\t'de': 'Liste angezeigter Adapter'\r\n\t\t},\r\n\t\t'description': {\r\n\t\t\t'en': 'List of adapters to show (empty shows all adapters)',\r\n\t\t\t'de': 'Liste der Adapter, die angezeigt werden (leere Liste zeigt alle Adapter)'\r\n\t\t},\r\n\t\t'values': {\r\n\t\t\t'en': 'Adapter names separated by comma',\r\n\t\t\t'de': 'Namen der Adapter mit Komma separiert'\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t'parameter': 'blacklist',\r\n\t\t'label': {\r\n\t\t\t'en': 'List of Adapter\\'s to hide',\r\n\t\t\t'de': 'Liste nicht angezeigter Adapter'\r\n\t\t},\r\n\t\t'description': {\r\n\t\t\t'en': 'Shows all adapters except the ones listed here',\r\n\t\t\t'de': 'Zeigt alle Adapter, auer die hier angegebenen'\r\n\t\t},\r\n\t\t'values': {\r\n\t\t\t'en': 'Adapter names separated by comma',\r\n\t\t\t'de': 'Namen der Adapter mit Komma separiert'\r\n\t\t}\r\n\t}\r\n]\r\n","import React from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport { Line } from 'react-chartjs-2'\r\n// eslint-disable-next-line\r\nimport chartjs_colorschemes from 'chartjs-plugin-colorschemes'\r\n// eslint-disable-next-line\r\nimport chartjs_zoom from 'chartjs-plugin-zoom'\r\n\r\nimport DateFnsUtils from '@date-io/date-fns'\r\n\r\nimport Log from '../Log'\r\nimport i18n, { locales } from '../i18n'\r\nimport helpers from '../helpers/timeConverter'\r\n\r\nimport CircularProgress from '@material-ui/core/CircularProgress'\r\nimport Button from '@material-ui/core/Button'\r\nimport ButtonGroup from '@material-ui/core/ButtonGroup'\r\nimport Alert from '@material-ui/lab/Alert'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport Divider from '@material-ui/core/Divider'\r\nimport { MuiPickersUtilsProvider, DateTimePicker } from '@material-ui/pickers'\r\nimport InputBase from '@material-ui/core/InputBase'\r\nimport Select from '@material-ui/core/Select'\r\nimport MenuItem from '@material-ui/core/MenuItem'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport CalendarIcon from '@material-ui/icons/Event'\r\nimport CalendarTodayIcon from '@material-ui/icons/EventAvailable'\r\nimport HistoryIcon from '@material-ui/icons/History'\r\nimport FastRewindIcon from '@material-ui/icons/FastRewind'\r\n//import DisablePan from '@material-ui/icons/SelectAll'\r\n//import DisableZoom from '@material-ui/icons/LocationDisabled'\r\nimport ResetZoom from '@material-ui/icons/ZoomOutMap'\r\nimport LiveUpdates from '@material-ui/icons/Update'\r\n\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tloading: {\r\n\t\tposition: 'absolute',\r\n\t\tbackgroundColor: 'rgba(0, 0, 0, 0.3)',\r\n\t\twidth: '100%',\r\n\t\theight: '100%',\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center',\r\n\t\tjustifyContent: 'center',\r\n\t},\r\n\terrorMessage: {\r\n\t\tmarginBottom: 5,\r\n\t\tmarginRight: 15,\r\n\t\twidth: '100%'\r\n\t},\r\n\ttoolbar: {\r\n\t\tdisplay: 'flex'\r\n\t},\r\n\ttoolbarButtons: {\r\n\t\tdisplay: 'initial',\r\n\t\twhiteSpace: 'nowrap'\r\n\t},\r\n\toptions: {\r\n\t\tdisplay: 'flex',\r\n\t\tjustifyContent: 'center',\r\n\t},\r\n\tdatePicker: {\r\n\t\tpadding: '2px 4px',\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center',\r\n\t\tmargin: 2\r\n\t},\r\n\tinput: {\r\n\t\tmarginLeft: theme.spacing(1),\r\n\t\tflex: 1,\r\n\t},\r\n\tselect: {\r\n\t\twidth: 100\r\n\t},\r\n\ticon: {\r\n\t\tmargin: 10,\r\n\t},\r\n\ticonButton: {\r\n\t\tpadding: 10,\r\n\t},\r\n\tdivider: {\r\n\t\tmargin: '15px 0',\r\n\t},\r\n\tdividerVertical: {\r\n\t\theight: 28,\r\n\t\tmargin: 4,\r\n\t},\r\n\tbutton: {\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t\tcolor: '#fff !important',\r\n\t\tmargin: '4px'\r\n\t},\r\n\tbuttonDisabled: {\r\n\t\tbackgroundColor: '#eee',\r\n\t\tmargin: '4px'\r\n\t}\r\n});\r\n\r\n\r\nclass Chart extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\t// chart settings\r\n\t\tthis.chartFilter = this.props.settings.chartFilter || {};\r\n\t\tthis.chartConfig = this.props.settings.chartConfig || {};\r\n\t\t\r\n\t\tthis.chartConfig.yAxes = this.chartConfig.yAxes || [];\r\n\t\tthis.chartConfig.yAxes.unshift({\r\n\t\t\tid: 'left',\r\n\t\t\ttype: 'linear',\r\n\t\t\tposition: 'left',\r\n\t\t\tticks: {\r\n\t\t\t\tcallback: value => (this.chartConfig.yLeftAxisUnitBefore || '') + Number.parseFloat(value).toFixed(1) + (this.chartConfig.yLeftAxisUnitAfter || '')\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\t// states\r\n\t\tthis.state = {\r\n\t\t\tloading: true,\r\n\t\t\terrors: [],\r\n\t\t\t\r\n\t\t\tdatePicker: false,\r\n\t\t\tselectedTimeRangeValue: (this.chartFilter && this.chartFilter.selectedTimeRangeValue) || 1,\r\n\t\t\tselectedTimeRangeUnit: (this.chartFilter && this.chartFilter.selectedTimeRangeUnit) || 'days',\r\n\t\t\tselectedDateTime: (this.chartFilter && this.chartFilter.selectedDateTime && new Date(this.chartFilter.selectedDateTime)) || new Date(),\r\n\t\t\tdateNow: this.chartFilter && this.chartFilter.selectedDateTime ? false : true,\r\n\t\t\t\r\n\t\t\tchartLabels: [],\r\n\t\t\tchartData: {\r\n\t\t\t\tlabels: [],\r\n\t\t\t\tdatasets: []\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tchartPan: true,\r\n\t\t\tchartZoom: true\r\n\t\t}\r\n\t\t\r\n\t\t//\r\n\t\tthis.timer = null;\r\n\t\tthis.timeRangeRef = React.createRef();\r\n\t\t\r\n\t\t// chart instance options\r\n\t\tthis.chartRef = React.createRef();\r\n\t\tthis.chartUpdates = {};\r\n\t\tthis.chartOptions = {\r\n\t\t\tmaintainAspectRatio: false,\r\n\t\t\tspanGaps: true,\r\n\t\t\tlegend: {\r\n\t\t\t\tonClick: this.legendClickHandler.bind(this)\r\n\t\t\t},\r\n\t\t\ttooltips: {\r\n\t\t\t\tcallbacks: {\r\n\t\t\t\t\tlabel: (item, data) => data.datasets[item.datasetIndex].label + ': ' + item.value + data.datasets[item.datasetIndex].unit\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tscales: {\r\n\t\t\t\tyAxes: this.chartConfig.yAxes\r\n\t\t\t},\r\n\r\n\t\t\tplugins: {\r\n\t\t\t\tcolorschemes: {\r\n\t\t\t\t\tscheme: 'brewer.SetOne9'\r\n\t\t\t\t},\r\n\t\t\t\tzoom: {\r\n\t\t\t\t\t// Container for pan options\r\n\t\t\t\t\tpan: {\r\n\t\t\t\t\t\t// Boolean to enable panning\r\n\t\t\t\t\t\tenabled: true,\r\n\r\n\t\t\t\t\t\t// Panning directions\r\n\t\t\t\t\t\tmode: 'xy'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t\r\n\t\t\t\t\t// Container for zoom options\r\n\t\t\t\t\tzoom: {\r\n\t\t\t\t\t\t// Boolean to enable zooming\r\n\t\t\t\t\t\tenabled: true,\r\n\r\n\t\t\t\t\t\t// Zooming directions.\r\n\t\t\t\t\t\tmode: 'xy'\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\t\r\n\tcomponentDidMount() {\r\n\t\t\r\n\t\t// request initial history data\r\n\t\tlet options = { ...this.getTimeRange(), axis: this.getAxis() };\r\n\t\t\r\n\t\tthis.props.devices.forEach(device => {\r\n\t\t\tdevice.label = device.name + ' (' + i18n.t(device.primaryStateKey) + ')';\r\n\t\t\tdevice.requestDeviceStateHistory(device.options.history || null, true, { 'start': options.start, 'end': options.end, 'step': options.step, 'aggregate': 'average', 'ignoreNull': true }).catch(err => Log._('Modules (Chart)', err.message, 'error', true, err.stack));\r\n\t\t\t\r\n\t\t\t// add listeners for newly requested data\r\n\t\t\tdevice.listen('historyChange', (options) => this.historyChange);\r\n\t\t\t\r\n\t\t\t// add listeners for data updates\r\n\t\t\tif (this.props.settings.liveUpdates !== null && this.props.settings.liveUpdates !== false && this.state.dateNow) {\r\n\t\t\t\tdevice.listen((options) => this.stateChange);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\tcomponentWillUnmount() {\r\n\t\tthis.props.devices.forEach(device => {\r\n\t\t\tdevice.unlisten(this.stateChange);\r\n\t\t});\r\n\t}\r\n\t\r\n\tcomponentDidUpdate(prevProps, prevState) {\r\n\t\t\r\n\t\tif (this.state.selectedTimeRangeValue &&\r\n\t\t\t\t(prevState.selectedDateTime !== this.state.selectedDateTime || prevState.selectedTimeRangeValue !== this.state.selectedTimeRangeValue || prevState.selectedTimeRangeUnit !== this.state.selectedTimeRangeUnit)\r\n\t\t\t) {\r\n\t\t\t\r\n\t\t\t// request updated history data\r\n\t\t\tthis.setState({ loading: true, errors: [] });\r\n\t\t\t\r\n\t\t\tclearTimeout(this.timer);\r\n\t\t\tthis.timer = setTimeout(() => {\r\n\t\t\t\t\r\n\t\t\t\tconst options = this.getTimeRange();\r\n\t\t\t\tthis.props.devices.forEach(device => {\r\n\t\t\t\t\tdevice.requestDeviceStateHistory(device.options.history || null, true, { 'start': options.start, 'end': options.end, 'step': options.step, 'aggregate': 'average', 'ignoreNull': true }).catch(err => Log._('Modules (Chart)', err.message, 'error', true, err.stack));\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t}, 500);\r\n\t\t}\r\n\t}\r\n\t\r\n\thistoryChange = options => (stateKey, history, state, device) => {\r\n\t\tthis.addChartGraph(device, history, { ...options, axis: this.getAxis(options.start, options.end) } );\r\n\t\tthis.setState({ loading: false });\r\n\t}\r\n\t\r\n\tstateChange = options => (stateKey, val, state, device) => this.updateChartGraph(device, val, { ...options, axis: this.getAxis(options.end, new Date()) } )\r\n\t\r\n\tgetTimeRange() {\r\n\t\t\r\n\t\tconst end = this.state.selectedDateTime.getTime();\r\n\t\tlet timeRange = this.state.selectedTimeRangeValue;\r\n\t\tlet step = 1;\r\n\t\tlet axisTimeFormat = 'dd. MMM yyyy, HH:mm';\r\n\t\t\r\n\t\tswitch(this.state.selectedTimeRangeUnit) {\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t\t\r\n\t\t\tcase 'seconds':\r\n\t\t\t\taxisTimeFormat = 'dd. MMM yyyy, HH:mm:ss';\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tcase 'minutes':\r\n\t\t\t\taxisTimeFormat = 'dd. MMM yyyy, HH:mm:ss';\r\n\t\t\t\ttimeRange = timeRange*60;\r\n\t\t\t\t//step = step;\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tcase 'hours':\r\n\t\t\t\taxisTimeFormat = 'dd. MMM yyyy, HH:mm';\r\n\t\t\t\ttimeRange = timeRange*60*60;\r\n\t\t\t\tstep = step*60;\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tcase 'days':\r\n\t\t\t\taxisTimeFormat = 'dd. MMM yyyy, HH:mm';\r\n\t\t\t\ttimeRange = timeRange*60*60*24;\r\n\t\t\t\tstep = step*60*60;\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tcase 'months':\r\n\t\t\t\taxisTimeFormat = 'dd. MMM yyyy';\r\n\t\t\t\ttimeRange = timeRange*60*60*24*31;\r\n\t\t\t\tstep = step*60*60*24;\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tcase 'years':\r\n\t\t\t\taxisTimeFormat = 'dd. MMM yyyy';\r\n\t\t\t\ttimeRange = timeRange*60*60*24*365;\r\n\t\t\t\tstep = step*60*60*24*31;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\t\r\n\t\treturn {\r\n\t\t\t'axisTimeFormat': axisTimeFormat,\r\n\t\t\t'start': end-timeRange*1000,\r\n\t\t\t'end': end,\r\n\t\t\t'timeRange': timeRange*1000,\r\n\t\t\t'step': step*1000\r\n\t\t};\r\n\t}\r\n\t\r\n\tgetAxis(start, end) {\r\n\t\t\r\n\t\tconst { step, axisTimeFormat } = this.getTimeRange();\r\n\t\tlet axis = {};\r\n\t\t\r\n\t\tfor (let time = start; time <= end; time += step) {\r\n\t\t\taxis[time] = helpers.secondsToDateTime(time/1000, axisTimeFormat);\r\n\t\t}\r\n\t\t\r\n\t\treturn axis;\r\n\t}\r\n\t\r\n\tgroupChartData(chartData, axis) {\r\n\t\t\r\n\t\tlet prevMarker;\r\n\t\tlet data = [];\r\n\t\t\r\n\t\tlet markers = Object.keys(axis);\r\n\t\tmarkers.forEach((marker, i) => {\r\n\t\t\tprevMarker = markers[(i-1 > 0 ? i-1 : 0)];\r\n\t\t\t\r\n\t\t\tfor (let index in chartData) {\r\n\t\t\t\tlet entry = chartData[index];\r\n\t\t\t\tentry.val = parseFloat(entry.val);\r\n\t\t\t\t\r\n\t\t\t\t// \r\n\t\t\t\tif (!entry.ts || entry.val === null) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// before range, continue\r\n\t\t\t\tif (prevMarker > entry.ts) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// in range\r\n\t\t\t\telse if (prevMarker < entry.ts && entry.ts <= marker) {\r\n\t\t\t\t\tdata[i] = !data[i] ? [ entry.val ] : [ ...data[i], entry.val ]; // parseFloat((data[i] ? ((data[i]+entry.val)/2) : entry.val).toFixed(2));\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// beyond range, so next marker\r\n\t\t\t\telse if (entry.ts > marker) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t//\r\n\t\t\tif (!data[i]) {\r\n\t\t\t\t// \r\n\t\t\t}\r\n\t\t\telse if (data[i].length === 1) {\r\n\t\t\t\tdata[i] = data[i][0];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tdata[i] = data[i].reduce((a,b) => a + b, 0) / data[i].length;\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\treturn data;\r\n\t}\r\n\t\r\n\tupdateChartGraph(device, value, options) {\r\n\t\t\r\n\t\tconst chartIndex = this.state.chartLabels.findIndex(entry => entry === device.label);\r\n\t\tif (chartIndex === -1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t\tthis.chartUpdates[chartIndex] = this.chartUpdates[chartIndex] || [];\r\n\t\tthis.chartUpdates[chartIndex].push({\r\n\t\t\t'ts': value.ts,\r\n\t\t\t'val': value.val\r\n\t\t});\r\n\t\t\r\n\t\t// process data\r\n\t\tconst data = this.groupChartData(this.chartUpdates[chartIndex], options.axis);\r\n\t\t\r\n\t\t//console.log(value);\r\n\t\t//console.log(options, options.axis, data);\r\n\t\t\r\n\t\t// update chart\r\n\t\tthis.chartRef.current.chartInstance.data.labels = [ ...this.state.chartData.labels, ...Object.values(options.axis) ];\r\n\t\tthis.chartRef.current.chartInstance.data.datasets[chartIndex].data = [ ...this.state.chartData.datasets[chartIndex].data, ...data ];\r\n\t\tthis.chartRef.current.chartInstance.update();\r\n\t}\r\n\t\r\n\taddChartGraph(device, history, options) {\r\n\t\t\r\n\t\t// only add chart if data is given\r\n\t\tif (!history || !history.length) {\r\n\t\t\tlet error = i18n.t('No history data given for %s').replace('%s', device.label) + '!';\r\n\t\t\tthis.setState(prevStates => ({ errors: [ ...prevStates.errors, error ] }));\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t\t// process data\r\n\t\tconst data = this.groupChartData(history, options.axis);\r\n\t\t\r\n\t\t// update chart\r\n\t\tconst chartIndex = this.state.chartLabels.findIndex(entry => entry === device.label);\r\n\t\tif (chartIndex > -1) {\r\n\t\t\tthis.chartRef.current.chartInstance.data.labels = Object.values(options.axis);\r\n\t\t\tthis.chartRef.current.chartInstance.data.datasets[chartIndex].data = data;\r\n\t\t\tthis.chartRef.current.chartInstance.update();\r\n\t\t}\r\n\t\t\r\n\t\t// index chart\r\n\t\telse {\r\n\t\t\tthis.setState(prevStates => ({ chartLabels: [ ...prevStates.chartLabels, device.label ] }));\r\n\t\t\t\r\n\t\t\t// chart dataset\r\n\t\t\tlet dataSet = {\r\n\t\t\t\tlabel: device.label,\r\n\t\t\t\tunit: device.states[device.primaryStateKey].state.value.unit || '',\r\n\t\t\t\tfill: false,\r\n\t\t\t\t...device.options.graphConfig || {},\r\n\t\t\t\tdata: data\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\t// add data to chart\r\n\t\t\tthis.setState(prevStates => ({\r\n\t\t\t\taxisTimeFormat: options.axisTimeFormat,\r\n\t\t\t\tchartData: {\r\n\t\t\t\t\tlabels: Object.values(options.axis),\r\n\t\t\t\t\tdatasets: [ ...prevStates.chartData.datasets, dataSet ],\r\n\t\t\t\t}\r\n\t\t\t}));\r\n\t\t}\r\n\t}\r\n\t\r\n\tlegendClickHandler(e, legendItem) {\r\n\t\t\r\n\t\tlet index = legendItem.datasetIndex;\r\n\t\tlet ci = this.chartRef.current.chartInstance;\r\n\t\tlet meta = ci.getDatasetMeta(index);\r\n\r\n\t\tmeta.hidden = meta.hidden === null ? !ci.data.datasets[index].hidden : null;\r\n\t\tci.update();\r\n\t\tci.resetZoom();\r\n\t}\r\n\t\r\n\tdisablePan() {\r\n\t\tlet pan = this.chartRef.current.chartInstance.options.plugins.zoom.pan.enabled;\r\n\t\tthis.chartRef.current.chartInstance.options.plugins.zoom.pan.enabled = (pan === false);\r\n\t\tthis.setState({ chartPan: (pan === false) });\r\n\t}\r\n\t\r\n\tdisableZoom() {\r\n\t\tlet zoom = this.chartRef.current.chartInstance.options.plugins.zoom.zoom.enabled;\r\n\t\tthis.chartRef.current.chartInstance.options.plugins.zoom.zoom.enabled = (zoom === false);\r\n\t\tthis.setState({ chartZoom: (zoom === false) });\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { classes, settings } = this.props;\r\n\t\treturn (\r\n\r\n<div>\r\n\t<div className={classes.options}>\r\n\t\r\n\t\t<Paper className={classes.datePicker}>\r\n\t\t\t<Tooltip title={i18n.t('Period shown in Chart')}>\r\n\t\t\t\t<HistoryIcon className={classes.icon} />\r\n\t\t\t</Tooltip>\r\n\t\t\t\r\n\t\t\t<InputBase\r\n\t\t\t\tinputRef={this.timeRangeRef}\r\n\t\t\t\tclassName={classes.input}\r\n\t\t\t\tvalue={this.state.selectedTimeRangeValue}\r\n\t\t\t\tonChange={event => this.setState({ selectedTimeRangeValue: event.target.value })}\r\n\t\t\t\t/>\r\n\t\t\t\r\n\t\t\t<Select\r\n\t\t\t\tvalue={this.state.selectedTimeRangeUnit}\r\n\t\t\t\tonChange={event => this.setState({ selectedTimeRangeUnit: event.target.value })}\r\n\t\t\t\tdisplayEmpty\r\n\t\t\t\tdisableUnderline\r\n\t\t\t\tclassName={classes.select}\r\n\t\t\t\t>\r\n\t\t\t\t\r\n\t\t\t\t<MenuItem value=\"seconds\">{i18n.t('Seconds')}</MenuItem>\r\n\t\t\t\t<MenuItem value=\"minutes\">{i18n.t('Minutes')}</MenuItem>\r\n\t\t\t\t<MenuItem value=\"hours\">{i18n.t('Hours')}</MenuItem>\r\n\t\t\t\t<MenuItem value=\"days\">{i18n.t('Days')}</MenuItem>\r\n\t\t\t\t<MenuItem value=\"months\">{i18n.t('Months')}</MenuItem>\r\n\t\t\t\t<MenuItem value=\"years\">{i18n.t('Years')}</MenuItem>\r\n\t\t\t</Select>\r\n\t\t\t\r\n\t\t\t{/*\r\n\t\t\t<IconButton className={classes.iconButton} onClick={() => this.timeRangeRef.current.focus()}>\r\n\t\t\t\t<CalendarIcon />\r\n\t\t\t</IconButton>\r\n\t\t\t*/}\r\n\t\t</Paper>\r\n\r\n\t\t<Paper className={classes.datePicker}>\r\n\t\t\t<Tooltip title={i18n.t('End date')}>\r\n\t\t\t\t<FastRewindIcon className={classes.icon} />\r\n\t\t\t</Tooltip>\r\n\t\t\t\r\n\t\t\t<MuiPickersUtilsProvider locale={locales[i18n.getLanguage()]} utils={DateFnsUtils}>\r\n\t\t\t\t<DateTimePicker\r\n\t\t\t\t\tclassName={classes.input}\r\n\t\t\t\t\tvalue={this.state.selectedDateTime}\r\n\t\t\t\t\tonChange={selectedDateTime => this.setState({ selectedDateTime: selectedDateTime, dateNow: false })}\r\n\t\t\t\t\t\r\n\t\t\t\t\topen={this.state.datePicker}\r\n\t\t\t\t\tonOpen={() => this.setState({ datePicker: true })}\r\n\t\t\t\t\tonClose={() => this.setState({ datePicker: false })}\r\n\t\t\t\t\t\r\n\t\t\t\t\tvariant=\"inline\"\r\n\t\t\t\t\tampm={false}\r\n\t\t\t\t\tformat='dd.MM.yyyy HH:mm'\r\n\t\t\t\t\tInputProps={{\r\n\t\t\t\t\t\tdisableUnderline: true,\r\n\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t</MuiPickersUtilsProvider>\r\n\t\t\t\r\n\t\t\t<Tooltip title={i18n.t('Select end date')}>\r\n\t\t\t\t<IconButton color=\"primary\" className={classes.iconButton} onClick={() => this.setState({ datePicker: true })}>\r\n\t\t\t\t\t<CalendarIcon />\r\n\t\t\t\t</IconButton>\r\n\t\t\t</Tooltip>\r\n\t\t\t<Divider className={classes.dividerVertical} orientation=\"vertical\" />\r\n\t\t\t<Tooltip title={i18n.t('Select today as end date')}>\r\n\t\t\t\t<IconButton className={classes.iconButton} onClick={() => this.setState({ selectedDateTime: new Date(), dateNow: true })}>\r\n\t\t\t\t\t<CalendarTodayIcon />\r\n\t\t\t\t</IconButton>\r\n\t\t\t</Tooltip>\r\n\t\t</Paper>\r\n\t\t\r\n\t\t<Tooltip title={i18n.t('Live updates are ' + (this.props.settings.liveUpdates !== null && this.props.settings.liveUpdates !== false && this.state.dateNow ? 'on' : 'off'))} placement=\"top\" style={{ display: 'flex' }}>\r\n\t\t\t<span>\r\n\t\t\t\t<Button disabled={true} className={clsx(classes.datePicker, this.props.settings.liveUpdates !== null && this.props.settings.liveUpdates !== false && this.state.dateNow ? classes.button : classes.buttonDisabled)}>\r\n\t\t\t\t\t<LiveUpdates />\r\n\t\t\t\t</Button>\r\n\t\t\t</span>\r\n\t\t</Tooltip>\r\n\t\t\r\n\t</div>\r\n\t<Divider className={classes.divider} />\r\n\t\r\n\t<div className={classes.toolbar}>\r\n\t\t<div className={classes.errorMessage}>\r\n\t\t\t{this.state.errors.length > 0 && <Alert severity=\"error\">{this.state.errors.map((error, i) => [ error, React.createElement('br', { key: 'br-error-' + i }) ])}</Alert>}\r\n\t\t</div>\r\n\t\t\r\n\t\t<ButtonGroup className={classes.toolbarButtons} color=\"primary\">\r\n\t\t{/*\r\n\t\t\t<Button disableElevation={true} variant={this.state.chartPan ? 'contained' : 'outlined'} onClick={this.disablePan.bind(this)}>\r\n\t\t\t\t<Tooltip title={i18n.t(this.state.chartPan ? 'Disable panning' : 'Enable panning')}>\r\n\t\t\t\t\t<DisablePan />\r\n\t\t\t\t</Tooltip>\r\n\t\t\t</Button>\r\n\t\t\t<Button disableElevation={true} variant={this.state.chartZoom ? 'contained' : 'outlined'} onClick={this.disableZoom.bind(this)}>\r\n\t\t\t\t<Tooltip title={i18n.t(this.state.chartZoom ? 'Disable Zoom' : 'Enable Zoom')}>\r\n\t\t\t\t\t<DisableZoom />\r\n\t\t\t\t</Tooltip>\r\n\t\t\t</Button>\r\n\t\t*/}\r\n\t\t\t<Button disableElevation={true} variant=\"contained\" onClick={() => this.chartRef.current.chartInstance.resetZoom()}>\r\n\t\t\t\t<Tooltip title={i18n.t('Reset Zoom')}>\r\n\t\t\t\t\t<ResetZoom />\r\n\t\t\t\t</Tooltip>\r\n\t\t\t</Button>\r\n\t\t</ButtonGroup>\r\n\t</div>\r\n\t\r\n\t<div className={'chart-container'} style={{ position: 'relative', height: settings.chartHeight || '500px' }}>\r\n\t\t{this.state.loading && <div className={classes.loading}>\r\n\t\t\t<CircularProgress />\r\n\t\t</div>}\r\n\t\t\r\n\t\t<Line\r\n\t\t\tref={this.chartRef}\r\n\t\t\tdata={this.state.chartData}\r\n\t\t\toptions={this.chartOptions}\r\n\t\t\t/>\r\n\t\t\t\r\n\t</div>\r\n</div>\r\n\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(Chart);\r\n\r\nexport const ModuleSettings = {\r\n\tnoDevicesAllowed: true,\r\n\ttitle: i18n.t('Adapter Status'),\r\n\ticon: 'traffic-light'\r\n}\r\n\r\nexport const ModuleDescription = \"Stellt historische Werte (z.B. aus ioBroker.history) grafisch als Chart mittels Chart.js dar.\";\r\nexport const ModuleScreenshots = ['Chart1.png'];\r\n\r\nexport const ModuleConfig = [\r\n]\r\n","import React, { useState, useEffect, useRef } from 'react'\r\n\r\nimport { format } from 'date-fns'\r\nimport { getSunrise, getSunset } from 'sunrise-sunset-js'\r\n\r\nimport Settings from '../Settings'\r\nimport i18n, { locales } from '../i18n'\r\nimport CircularProgress from '@material-ui/core/CircularProgress'\r\n\r\n\r\nexport default function DateTime(props) {\r\n\tconst { settings } = props;\r\n\t\r\n\tconst refTimer = useRef();\r\n\tconst [DateTime, setDateTime] = useState(format(new Date(), settings.format, { locale: locales[i18n.getLanguage()] }));\r\n\tconst [city, setCity] = useState('');\r\n\tconst [sunrise, setSunrise] = useState('');\r\n\tconst [sunset, setSunset] = useState('');\r\n\t\r\n\t// https://date-fns.org/v2.9.0/docs/format\r\n\tsettings.style = { fontSize: '1.5rem', textAlign: 'center', ...settings.style };\r\n\tsettings.format = settings.format || 'dd.MM.yyyy HH:mm:ss';\r\n\tsettings.refresh = settings.format.indexOf('s') > -1 ? 1000 : (settings.format.indexOf('i') > -1 ? 60*1000 : 60*60*1000);\r\n\t\r\n\tuseEffect(() => {\r\n\t\tclearTimeout(refTimer.current);\r\n\t\trefTimer.current = setTimeout(() => setDateTime(format(new Date(), settings.format, { locale: locales[i18n.getLanguage()] })), settings.refresh);\r\n\t\t\r\n\t\t//\r\n\t\tif (Settings.getSetting('iobroker').latitude && Settings.getSetting('iobroker').longitude) {\r\n\t\t\tsetSunrise(getSunrise(Settings.getSetting('iobroker').latitude, Settings.getSetting('iobroker').longitude));\r\n\t\t\tsetSunset(getSunset(Settings.getSetting('iobroker').latitude, Settings.getSetting('iobroker').longitude));\r\n\t\t}\r\n\t\t\r\n\t\tif (Settings.getSetting('iobroker').city) {\r\n\t\t\tsetCity(Settings.getSetting('iobroker').city);\r\n\t\t}\r\n\t\t\r\n\t}, [settings]);\r\n\t\r\n\treturn (\r\n\r\n<div style={settings.style}>\r\n\t{i18n.t('%DateTime').replace(/%DateTime/, DateTime)}\r\n\t\r\n\t{settings.sun !== false && <div style={{ margin: '5px 0', fontSize: '1.2rem' }}>\r\n\t\t\r\n\t\t<span className=\"mdi mdi-city-variant-outline\"></span> {city ? city : <CircularProgress size=\"1.2rem\" />}\r\n\t\t<span style={{ margin: '0 10px' }}></span>\r\n\t\t\r\n\t\t<span className=\"mdi mdi-weather-sunset-up\"></span> {sunrise ? format(sunrise, 'HH:mm') : <CircularProgress size=\"1.2rem\" />}\r\n\t\t<span style={{ margin: '0 10px' }}></span>\r\n\t\t\r\n\t\t<span className=\"mdi mdi-weather-sunset-down\"></span> {sunset ? format(sunset, 'HH:mm') : <CircularProgress size=\"1.2rem\" />}\r\n\t</div>\r\n\t}\r\n\t\r\n</div>\r\n\r\n\t);\r\n}\r\n\r\nexport const ModuleSettings = {\r\n\tnoDevicesAllowed: true,\r\n\ttitle: i18n.t('Time'),\r\n\ticon: 'clock-outline'\r\n}\r\n\r\nexport const ModuleDescription = \"Das Modul dient der Anzeige des aktuellen Datums und Zeit.\";\r\nexport const ModuleScreenshots = ['DateTime1.png'];\r\n\r\nexport const ModuleConfig = [\r\n\t{\r\n\t\t'parameter': 'style',\r\n\t\t'label': {\r\n\t\t\t'en': 'Style of the text',\r\n\t\t\t'de': 'Style des Textes'\r\n\t\t},\r\n\t\t'description': {\r\n\t\t\t'en': 'CSS statements in javascript notation',\r\n\t\t\t'de': 'CSS-Anweisungen in Javascript Syntax'\r\n\t\t},\r\n\t\t'val': '{ fontSize: \"1.5rem\", textAlign: \"center\" }'\r\n\t},\r\n\t{\r\n\t\t'parameter': 'format',\r\n\t\t'label': {\r\n\t\t\t'en': 'Date/Time format',\r\n\t\t\t'de': 'Format des Datums / Uhrzeit'\r\n\t\t},\r\n\t\t'description': {\r\n\t\t\t'en': 'For possible format values, see date-fns documentation',\r\n\t\t\t'de': 'Fr mgliche Werte, siehe date-fns Dokumentation'\r\n\t\t},\r\n\t\t'link': 'https://date-fns.org/v2.9.0/docs/format',\r\n\t\t'val': 'dd.MM.yyyy HH:mm:ss'\r\n\t},\r\n\t{\r\n\t\t'parameter': 'sun',\r\n\t\t'label': {\r\n\t\t\t'en': 'Show times of sunrise and -set',\r\n\t\t\t'de': 'Zeigt Zeiten fr Sonnenauf- und -untergang'\r\n\t\t},\r\n\t\t'type': 'SwitchInput',\r\n\t\t'val': true\r\n\t}\r\n]\r\n","import React, { useState, useEffect, useRef, useCallback } from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport L from 'leaflet'\r\nimport { Map as LeafletMap, TileLayer, Marker as LeafletMarker, Tooltip as LeafletTooltip } from 'react-leaflet'\r\n\r\nimport Log from '../Log'\r\nimport Settings from '../Settings'\r\nimport i18n from '../i18n'\r\n\r\nimport Box from '@material-ui/core/Box'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\nimport Avatar from '@material-ui/core/Avatar'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tmap: {\r\n\t\twidth: '100%',\r\n\t\theight: '100%'\r\n\t},\r\n\tmapOverview: {\r\n\t\tcolor: '#666',\r\n\t\tposition: 'absolute',\r\n\t\tleft: 0,\r\n\t\tbottom: 0,\r\n\t\twidth: '100%',\r\n\t\theight: '60px',\r\n\t\tzIndex: 999,\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center',\r\n\t\t\r\n\t\t'& > *': {\r\n\t\t\tmargin: theme.spacing(1),\r\n\t\t\tcursor: 'pointer',\r\n\t\t},\r\n\t},\r\n\tmapIconContainer: {\r\n\t},\r\n\tmapIconParent: {\r\n\t\tbackgroundColor: '#fff',\r\n\t\tboxShadow: '0 0 0 8px rgba(255, 255, 255, 0.3)',\r\n\t\tborderRadius: '50%',\r\n\t\twidth: '100%',\r\n\t\theight: '100%'\r\n\t},\r\n\tmapIcon: {\r\n\t\tfontSize: '2rem',\r\n\t\tcolor: theme.palette.primary.main,\r\n\t\ttransform: 'translate3d(4px, -4px,0)', /* for fontSize: '2.3rem' -> 'translate3d(2px, -8px,0)', */\r\n\t\tdisplay: 'block',\r\n\t\t\r\n\t\t'&:after': {\r\n\t\t\tcontent: '\"\"',\r\n\t\t\tdisplay: 'block',\r\n\t\t\tpadding: '50% 0%'\r\n\t\t}\r\n\t},\r\n\tmapTooltip: {\r\n\t}\r\n}));\r\n\r\n\r\nexport default function Map(props) {\r\n\tconst { settings, devices } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst [zoom,] = useState(settings.defaultZoom);\r\n\tconst [position,] = useState(settings.defaultPosition ? (Array.isArray(settings.defaultPosition) ? settings.defaultPosition : settings.defaultPosition.split(',')) : [ Settings.getSetting('iobroker').latitude, Settings.getSetting('iobroker').longitude ]);\r\n\tconst [markers, setMarkers] = useState({});\r\n\t\r\n\t// map instance\r\n\tconst map = useRef();\r\n\tconst memoizedMapInitialised = useCallback(function() {map.current = this}, [],);\r\n\t\r\n\t// Marker click in overview\r\n\tconst memoizedHandleClick = useCallback(flyTo => map.current.flyTo(flyTo.split(',')), [],);\r\n\t\r\n\t// state change\r\n\tconst stateChange = (stateKey, state, device) => {\r\n\t\t\r\n\t\tif (stateKey === 'position') {\r\n\t\t\t\r\n\t\t\tsetMarkers(prevMarkers => {\r\n\t\t\t\tif (!prevMarkers[device.id] || prevMarkers[device.id].position !== state.val) {\r\n\t\t\t\t\tdevice.options.position = state.val;\r\n\t\t\t\t\treturn { ...prevMarkers, [device.id]: device };\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\treturn prevMarkers;\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t\r\n\t// get gps position coordinates\r\n\tuseEffect(() => {\r\n\t\tdevices.forEach(device => {\r\n\t\t\t\r\n\t\t\t// request device state\r\n\t\t\tdevice.requestDeviceState('position').catch(err => {\r\n\t\t\t\tLog._('Modules (Map)', err.message, 'error', true, err.stack)\r\n\t\t\t\t\r\n\t\t\t\tsetMarkers(prevMarkers => {\r\n\t\t\t\t\tif (!prevMarkers[device.id]) {\r\n\t\t\t\t\t\treturn { ...prevMarkers, [device.id]: null };\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\treturn prevMarkers;\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t// listen for updates\r\n\t\t\tdevice.listen(stateChange);\r\n\t\t});\r\n\t\t\r\n\t\t// componentWillUnmount\r\n\t\treturn () => devices.forEach(device => device.unlisten(stateChange));\r\n\t\t\r\n\t}, [devices]);\r\n\t\r\n\t// add markers\r\n\tlet mapMarkers = [], mapOverview = [];\r\n\tif (devices.length > 0 && devices.length === Object.keys(markers).length) {\r\n\t\t\r\n\t\tfor (let key in markers) {\r\n\t\t\tlet device = markers[key];\r\n\t\t\tif (device !== null) {\r\n\t\t\t\tlet marker = <Marker key={'marker-' + device.id} position={device.options.position || ''} device={device} settings={settings.component} />\r\n\t\t\t\tmapMarkers.push(marker);\r\n\t\t\t\t\r\n\t\t\t\tlet item = null;\r\n\t\t\t\tif (device.attributes.avatar) {\r\n\t\t\t\t\titem = <Avatar key={'overview-' + device.id} alt={device.name} src={device.attributes.avatar} onClick={() => memoizedHandleClick(device.options.position)} />\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tlet state = device.getDeviceState();\r\n\t\t\t\t\tconst icon = device.getIcon(null, state && state.val !== undefined ? state.val : null);\r\n\t\t\t\t\tconst styles = device.getStyle('icon', null, state && state.val !== undefined ? state.val : null);\r\n\t\t\t\t\t\r\n\t\t\t\t\tconsole.log(state && state.val !== undefined ? state.val : null);\r\n\t\t\t\t\tconsole.log(styles);\r\n\t\t\t\t\t\r\n\t\t\t\t\titem = <Avatar style={styles} key={'overview-' + device.id} alt={device.name} onClick={() => memoizedHandleClick(device.options.position)}><span className={clsx('mdi mdi-' + icon)}></span></Avatar>\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tmapOverview.push(<Tooltip key={'tooltip-' + device.id} title={device.name} aria-label={device.name} arrow>{item}</Tooltip>);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn (\r\n\r\n<React.Fragment>\r\n\t<Box className={classes.mapOverview}>\r\n\t\t<Typography>{i18n.t('Jump to')}:</Typography>\r\n\t\t{mapOverview}\r\n\t</Box>\r\n\t<LeafletMap useFlyTo={true} center={position} zoom={zoom} className={classes.map} whenReady={memoizedMapInitialised}>\r\n\t\t<TileLayer\r\n\t\t\tattribution='&amp;copy <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\r\n\t\t\turl='https://{s}.tile.osm.org/{z}/{x}/{y}.png'\r\n\t\t\t/>\r\n\t\t\r\n\t\t{mapMarkers}\r\n\t</LeafletMap>\r\n</React.Fragment>\r\n\r\n\t);\r\n}\r\n\r\n\r\nfunction Marker(props) {\r\n\tconst { position, device, settings } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tlet markerIcon = null, offset = 40;\r\n\tLog._('Modules (Map)', 'Marker for ' + device.function + ' ' + device.name + ' added to map.');\r\n\t\r\n\t// Marker with avatar / picture\r\n\tif (device.attributes && device.attributes.avatar && device.attributes.avatar.substr(0, 11) === 'data:image/') {\r\n\t\tmarkerIcon = L.divIcon({\r\n\t\t\tclassName: classes.mapIconContainer,\r\n\t\t\thtml: '<img src=\"' + device.attributes.avatar + '\" class=\"' + classes.mapIconParent + '\" />',\r\n\t\t\ticonSize: [ 64, 64 ]\r\n\t\t});\r\n\t}\r\n\t\r\n\t// Marker with Icon\r\n\telse {\r\n\t\toffset = 30;\r\n\t\tlet state = device.getDeviceState();\r\n\t\tconst icon = device.getIcon(null, state && state.val !== undefined ? state.val : null);\r\n\t\tconst styles = device.getStyle('icon', null, state && state.val !== undefined ? state.val : null);\r\n\t\t\r\n\t\tconsole.log(styles); \r\n\t\tconst useStyles = makeStyles({root: styles}, {name:'testi'});\r\n\t\tconsole.log(useStyles.root); \r\n\t\t\r\n\t\tmarkerIcon = L.divIcon({\r\n\t\t\tclassName: classes.mapIconContainer,\r\n\t\t\thtml: '<div class=\"' + clsx(classes.mapIconParent) + '\"><span class=\"' + clsx(classes.mapIcon, 'mdi mdi-' + icon) + '\"></span></div>',\r\n\t\t\ticonSize: [ 40, 40 ]\r\n\t\t});\r\n\t}\r\n\t\r\n\t// Marker MouseOver / MouseOut (bring tooltip to front if markers overlay)\r\n\tconst memoizedHandleMouseEvent = useCallback(function() {this.closeTooltip().openTooltip()}, [],);\r\n\r\n\treturn (\r\n\r\n<LeafletMarker riseOnHover={true} position={Array.isArray(position) ? position : position.split(',')} icon={markerIcon} onMouseOver={memoizedHandleMouseEvent}>\r\n\t<LeafletTooltip className={classes.mapTooltip} direction={settings.tooltipDirection || 'bottom'} permanent={settings.tooltipPermanent || true} offset={[0,offset]}>\r\n\t\t{device.name}\r\n\t</LeafletTooltip>\r\n</LeafletMarker>\r\n\r\n\t);\r\n}\r\n\r\n\r\nexport const ModuleDescription = \"Zeigt eine Karte von OpenStreetMap.\";\r\nexport const ModuleScreenshots = [];\r\n\r\nexport const ModuleConfig = [\r\n\t{\r\n\t\t'parameter': 'defaultZoom',\r\n\t\t'label': {\r\n\t\t\t'en': 'initial map zoom',\r\n\t\t\t'de': 'initialer Zoom der Karte'\r\n\t\t},\r\n\t\t'type': 'NumberInput',\r\n\t\t'val': 10\r\n\t},\r\n\t{\r\n\t\t'parameter': 'defaultPosition',\r\n\t\t'label': {\r\n\t\t\t'en': 'initial map position',\r\n\t\t\t'de': 'initiale Position auf der Karte'\r\n\t\t},\r\n\t\t'description': {\r\n\t\t\t'en': 'Separate latitude and longitude via comma (e.g. 53.550383, 9.992376)',\r\n\t\t\t'de': 'Latitude und Longitude mit Komma separiert (z. B. 53.550383, 9.992376)'\r\n\t\t},\r\n\t\t'val': ''\r\n\t},\r\n\t{\r\n\t\t'parameter': 'tooltipDirection',\r\n\t\t'label': {\r\n\t\t\t'en': 'Direction tooltip will open',\r\n\t\t\t'de': 'Richtung in die der Tooltip ffnet'\r\n\t\t},\r\n\t\t'description': {\r\n\t\t\t'en': 'possible directions to open: auto, center, top, left, right or bottom',\r\n\t\t\t'de': 'mgliche Werte: auto, center, top, left, right or bottom'\r\n\t\t},\r\n\t\t'val': ''\r\n\t},\r\n\t{\r\n\t\t'parameter': 'tooltipPermanent',\r\n\t\t'label': {\r\n\t\t\t'en': 'permanent tooltip',\r\n\t\t\t'de': 'Permanenter Tooltip'\r\n\t\t},\r\n\t\t'description': {\r\n\t\t\t'en': 'Option to keep tooltip permanently open (true) or only open on mouse-over (false)',\r\n\t\t\t'de': 'Angabe ob der Tooltip permanent ist (true) oder nur beim rberfahren mit der Maus gezeigt wird (false)'\r\n\t\t},\r\n\t\t'type': 'SwitchInput',\r\n\t\t'val': true\r\n\t}\r\n]\r\n","import React from 'react'\r\n\r\nimport StateList, { ModuleConfig as StateListConfig } from './StateList'\r\n\r\n\r\nexport default function StateListHorizontal(props) {\r\n\treturn (<StateList horizontal={true} {...props} />);\r\n}\r\n\r\n\r\nexport const ModuleDescription = \"Zeigt eine Liste von States horizontal an\";\r\nexport const ModuleScreenshots = ['StateListHorizontal1.png'];\r\n\r\nexport const ModuleConfig = StateListConfig","import React, { useState, useEffect } from 'react'\r\n\r\nimport Log from '../Log'\r\nimport Connection from '../Connection'\r\nimport i18n from '../i18n'\r\n\r\nimport Grid from '@material-ui/core/Grid'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tpaper: {\r\n\t\twidth: 100,\r\n\t\theight: 160,\r\n\t\tpadding: 5,\r\n\t\ttextAlign: 'center',\r\n\t}\r\n}));\r\n\r\n\r\nexport default function Weather(props) {\r\n\tconst { settings } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst [data,setData] = useState(null);\r\n\tuseEffect(() => {\r\n\t\t\r\n\t\tConnection.getConnection.getRemoteResource(settings.url).then(\r\n\t\t\tresponse => {\r\n\t\t\t\t\r\n\t\t\t\tif (response.statusCode === 200) {\r\n\t\t\t\t\tsetData(JSON.parse(response.body));\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terr => Log._('Modules (Weather)', err.message, 'error', true, err.stack)\r\n\t\t);\r\n\t\t\r\n\t}, [settings.url]);\r\n\t\r\n\tlet weatherForecast = [];\r\n\t//console.log(data);\r\n\t\r\n\tif (!data) {\r\n\t\treturn null;\r\n\t}\r\n\telse {\r\n\t\tfor (let day in data.day) {\r\n\t\t\tlet forecast = data.day[day];\r\n\t\t\tforecast.title = day === 1 ? i18n.t('today') : (day === 2 ? i18n.t('tomorrow') : forecast.name);\r\n\t\t\t\r\n\t\t\tconst dailyForecast = (\r\n\r\n<Grid key={'day-' + day} item>\r\n\t<Paper className={classes.paper}>\r\n\t\t<Typography variant=\"body1\">\r\n\t\t\t{forecast.title}\r\n\t\t</Typography>\r\n\t\t<Typography variant=\"caption\">\r\n\t\t\t{forecast.date}\r\n\t\t</Typography>\r\n\r\n\r\n\t</Paper>\r\n</Grid>\r\n\r\n\t\t\t);\r\n\t\t\t\r\n\t\t\tweatherForecast.push(dailyForecast);\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn (\r\n\r\n<Grid container justify=\"space-between\" spacing={1}>\r\n\t{weatherForecast}\r\n\t\r\n</Grid>\r\n\r\n\t);\r\n}\r\n\r\nexport const ModuleSettings = {\r\n\tnoDevicesAllowed: true,\r\n\ttitle: i18n.t('Weather'),\r\n\ticon: 'weather-partly-cloudy'\r\n}\r\n\r\n\r\nexport const ModuleDescription = \"Zeigt die Wetter-Vorschau an.\";\r\nexport const ModuleScreenshots = [];\r\n\r\nexport const ModuleConfig = [\r\n]\r\n","import i18n from '../../i18n'\r\n\r\n/*\r\n * i18n\r\n */\r\nlet translations = require('./door.' + i18n.getLanguage()).default\r\ni18n.setTranslation(i18n.getLanguage(), translations);\r\n\r\n\r\nexport default {\r\n\tdescription: {\r\n\t\t'en': 'Doors',\r\n\t\t'de': 'Tren',\r\n\t},\r\n\tconfigurations: {\r\n\t\topen: {\r\n\t\t\ticon: {\r\n\t\t\t\ttrue: 'door-open',\r\n\t\t\t\tfalse: 'door-closed'\r\n\t\t\t},\r\n\t\t\tstate: {\r\n\t\t\t\ttrue: i18n.t('door#open#true'),\r\n\t\t\t\tfalse: i18n.t('door#open#false')\r\n\t\t\t},\r\n\t\t},\r\n\t\tlock: {\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t},\r\n\tactions: {\r\n\t},\r\n\tstyles: {\r\n\t}\r\n}","import React from 'react'\r\n\r\nimport i18n from '../../i18n'\r\nimport defaults from '../defaults'\r\n\r\n\r\n/*\r\n * i18n\r\n */\r\nlet translations = require('./heating.' + i18n.getLanguage()).default\r\ni18n.setTranslation(i18n.getLanguage(), translations);\r\n\r\n\r\n/*\r\n * COMPONENTS\r\n *\r\n */\r\nfunction HeatingSetTemperatureComponent(props) {\r\n\tconst Level = defaults.components.LevelComponent;\r\n\treturn (\r\n\t\t<Level min={0} max={35} {...props} />\r\n\t);\r\n}\r\n\r\n\r\n\r\nexport default {\r\n\tdescription: {\r\n\t\t'en': 'Heating',\r\n\t\t'de': 'Heizung',\r\n\t},\r\n\tconfigurations: {\r\n\t\ttemperature: {\r\n\t\t\tvalue: val => val.toFixed(1),\r\n\t\t\tunit: ' C'\r\n\t\t},\r\n\t\tsetTemperature: {\r\n\t\t\tunit: ' C',\r\n\t\t\ticon: 'thermometer-chevron-up'\r\n\t\t},\r\n\t\thumidity: {\r\n\t\t\tunit: ' %'\r\n\t\t},\r\n\t\tboost: {\r\n\t\t\ticon: 'radiator'\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t\tsetTemperature: HeatingSetTemperatureComponent\r\n\t},\r\n\tactions: {\r\n\t\tboost: defaults.actions.PowerAction\r\n\t},\r\n\tstyles: {\r\n\t}\r\n}","import i18n from '../../i18n'\r\n\r\n\r\n/*\r\n * i18n\r\n */\r\nlet translations = require('./location.' + i18n.getLanguage()).default\r\ni18n.setTranslation(i18n.getLanguage(), translations);\r\n\r\n\r\nexport default {\r\n\tdescription: {\r\n\t\t'en': 'locations',\r\n\t\t'de': 'Orte',\r\n\t},\r\n\tconfigurations: {\r\n\t\tposition: {\r\n\t\t\ticon: 'map-marker'\r\n\t\t},\r\n\t\tpresence: {\r\n\t\t\ticon: {\r\n\t\t\t\ttrue: 'map-marker-radius',\r\n\t\t\t\tfalse: 'map-marker-remove-outline'\r\n\t\t\t},\r\n\t\t\tstate: {\r\n\t\t\t\ttrue: i18n.t('location#presence#true'),\r\n\t\t\t\tfalse: i18n.t('location#presence#false'),\r\n\t\t\t},\r\n\t\t},\r\n\t\tusers: {\r\n\t\t\ticon: {\r\n\t\t\t\t'': 'account-group-outline',\r\n\t\t\t\t'default': 'account-group'\r\n\t\t\t},\r\n\t\t\tstate: {\r\n\t\t\t\t'': i18n.t('location#users#empty')\r\n\t\t\t},\r\n\t\t},\r\n\t},\r\n\tcomponents: {\r\n\t},\r\n\tactions: {\r\n\t},\r\n\tstyles: {\r\n\t}\r\n}","import i18n from '../../i18n'\r\n\r\n\r\n/*\r\n * i18n\r\n */\r\nlet translations = require('./user.' + i18n.getLanguage()).default\r\ni18n.setTranslation(i18n.getLanguage(), translations);\r\n\r\n\r\nexport default {\r\n\tdescription: {\r\n\t\t'en': 'users',\r\n\t\t'de': 'Benutzer',\r\n\t},\r\n\tconfigurations: {\r\n\t\tposition: {\r\n\t\t\ticon: 'map-marker'\r\n\t\t},\r\n\t\tlocation: {\r\n\t\t\ticon: 'account'\r\n\t\t},\r\n\t\tbattery: {\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t},\r\n\tactions: {\r\n\t},\r\n\tstyles: {\r\n\t}\r\n}","import i18n from '../../i18n'\r\n\r\n\r\n/*\r\n * i18n\r\n */\r\nlet translations = require('./window.' + i18n.getLanguage()).default\r\ni18n.setTranslation(i18n.getLanguage(), translations);\r\n\r\n\r\nexport default {\r\n\tdescription: {\r\n\t\t'en': 'windows',\r\n\t\t'de': 'Fenster',\r\n\t},\r\n\tconfigurations: {\r\n\t\topen: {\r\n\t\t\ticon: {\r\n\t\t\t\ttrue: 'window-open-variant',\r\n\t\t\t\tfalse: 'window-closed-variant'\r\n\t\t\t},\r\n\t\t\tstate: {\r\n\t\t\t\ttrue: i18n.t('window#open#true'),\r\n\t\t\t\tfalse: i18n.t('window#open#false')\r\n\t\t\t},\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t},\r\n\tactions: {\r\n\t},\r\n\tstyles: {\r\n\t}\r\n}","/**\r\n *\r\n *\r\n */\r\nfunction HsvToRgb(h, s = 1, v = 1) {\r\n\tif (Array.isArray(h)) {\r\n\t\tv = h[2];\r\n\t\ts = h[1];\r\n\t\th = h[0];\r\n\t}\r\n\telse if (typeof h === 'string' && h.indexOf(',')) {\r\n\t\t[h, s, v] = h.split(',');\r\n\t}\r\n\t\r\n\tif (h > 1) {\r\n\t\th = h/360;\r\n\t}\r\n\t\r\n\tlet r, g, b, i, f, p, q, t;\r\n\t\r\n\ti = Math.floor(h * 6);\r\n\tf = h * 6 - i;\r\n\tp = v * (1 - s);\r\n\tq = v * (1 - f * s);\r\n\tt = v * (1 - (1 - f) * s);\r\n\t\r\n\tswitch (i % 6) {\r\n\t\tcase 0:\r\n\t\t\tr = v;\r\n\t\t\tg = t;\r\n\t\t\tb = p;\r\n\t\t\tbreak;\r\n\t\t\t\r\n\t\tcase 1:\r\n\t\t\tr = q;\r\n\t\t\tg = v;\r\n\t\t\tb = p;\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tcase 2:\r\n\t\t\tr = p;\r\n\t\t\tg = v;\r\n\t\t\tb = t;\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tcase 3:\r\n\t\t\tr = p;\r\n\t\t\tg = q;\r\n\t\t\tb = v;\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tcase 4:\r\n\t\t\tr = t;\r\n\t\t\tg = p;\r\n\t\t\tb = v;\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tcase 5:\r\n\t\t\tr = v;\r\n\t\t\tg = p;\r\n\t\t\tb = q;\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tdefault: // for webpack\r\n\t\t\tbreak;\r\n\t}\r\n\t\r\n\treturn [\r\n\t\tMath.round(r * 255),\r\n\t\tMath.round(g * 255),\r\n\t\tMath.round(b * 255)\r\n\t];\r\n}\r\n\r\n\r\n/**\r\n *\r\n *\r\n */\r\nfunction RgbToHex(r, g, b) {\r\n\tif (Array.isArray(r)) {\r\n\t\tb = r[2];\r\n\t\tg = r[1];\r\n\t\tr = r[0];\r\n\t}\r\n\telse if (typeof r === 'string' && r.indexOf(',')) {\r\n\t\t[r, g, b] = r.split(',');\r\n\t}\r\n\t\r\n\tr = parseInt(r).toString(16);\r\n\tg = parseInt(g).toString(16);\r\n\tb = parseInt(b).toString(16);\r\n\t\r\n\tif (r.length === 1) r = '0' + r;\r\n\tif (g.length === 1) g = '0' + g;\r\n\tif (b.length === 1) b = '0' + b;\r\n\t\r\n\treturn \"#\" + r + g + b;\r\n}\r\n\r\n\r\nexport default {\r\n\tHsvToRgb,\r\n\tRgbToHex\r\n}","import React, { useState, useEffect } from 'react'\r\nimport { HuePicker, SketchPicker as ColorPicker } from 'react-color'\r\n\r\nimport Log from '../../Log'\r\nimport i18n from '../../i18n'\r\nimport helpers from '../../helpers/colorConverter'\r\nimport defaults from '../defaults'\r\n\r\n\r\n/*\r\n * i18n\r\n */\r\nlet translations = require('./light.' + i18n.getLanguage()).default\r\ni18n.setTranslation(i18n.getLanguage(), translations);\r\n\r\n\r\n/*\r\n * ACTIONS\r\n *\r\n */\r\nfunction LightLevelAction(props) {\r\n\tconst { device, stateKey, stateVal } = props;\r\n\t\r\n\tconst onChange = (e) => {\r\n\t\tsetChecked(e.target.checked);\r\n\t\tdevice.setDeviceState(stateKey, e.target.checked ? ((device.getOption('defaultValue')) || 100) : 0).catch(err => Log._('Function (light)', err.message, 'error', true, err.stack));\r\n\t}\r\n\t\r\n\tconst [checked, setChecked] = useState(stateVal > 0);\r\n\tuseEffect(() => setChecked(stateVal > 0), [stateVal]);\r\n\t\r\n\t// only show percentage if device has a switch itself\r\n\tif (device.parent && device.parent.states.power) {\r\n\t\treturn <defaults.actions.Action {...props} stateVal={checked} onChange={onChange} />;\r\n\t}\r\n\t\r\n\treturn <defaults.actions.PowerAction {...props} stateVal={checked} onChange={onChange} />\r\n}\r\n\r\nfunction LightColorAction(props) {\r\n\tconst { stateKey, stateVal } = props;\r\n\t\r\n\tconst [colorSpace, setColorSpace] = useState(stateVal);\r\n\tuseEffect(() => setColorSpace(stateVal), [stateVal]);\r\n\t\r\n\tlet colors, labels = {};\r\n\tif (stateKey === 'rgb' && colorSpace) {\r\n\t\tcolors = colorSpace.split(',');\r\n\t\tlabels = { Red: colors[0], Green: colors[1], Blue: colors[2] };\r\n\t\t\r\n\t}\r\n\telse if (stateKey === 'hsv' && colorSpace) {\r\n\t\tcolors = colorSpace.split(',');\r\n\t\tlabels = { Hue: colors[0], Saturation: colors[1], Brightness: colors[2] };\r\n\t}\r\n\t\r\n\tconst Label = defaults.components.Label;\r\n\tlet label = [];\r\n\tfor (let key in labels) {\r\n\t\tlabel.push(<Label key={key} label={key + ' ' + labels[key]} br={true} />);\r\n\t}\r\n\t\r\n\treturn label;\r\n}\r\n\r\n\r\n/*\r\n * COMPONENTS\r\n *\r\n */\r\nfunction LightColorTemperatureComponent(props) {\r\n\tconst Level = defaults.components.LevelComponent;\r\n\treturn (\r\n\t\t<Level min={2000} max={6500} step={10} {...props} />\r\n\t);\r\n}\r\n\r\nfunction LightHueComponent(props) {\r\n\tconst { device, stateKey, stateVal, title } = props;\r\n\t\r\n\tconst onChangeComplete = (color, e) => {\r\n\t\tsetHue(Math.round(color.hsl.h));\r\n\t\tdevice.setDeviceState(stateKey, Math.round(color.hsl.h)).catch(err => Log._('Function (light)', err.message, 'error', true, err.stack));\r\n\t}\r\n\t\r\n\tconst [hue, setHue] = useState(stateVal);\r\n\tuseEffect(() => setHue(stateVal), [stateVal]);\r\n\t\r\n\tconst Component = defaults.components.Component;\r\n\tconst color = helpers.RgbToHex(helpers.HsvToRgb(hue));\r\n\treturn (\r\n\r\n<Component title={title || stateKey }>\r\n\t<HuePicker\r\n\t\tcolor={color}\r\n\t\twidth={'100%'}\r\n\t\tonChangeComplete={onChangeComplete}\r\n\t\t/>\r\n\t\t\r\n</Component>\r\n\r\n\t);\r\n}\r\n\r\nfunction LightColorComponent(props) {\r\n\tconst { device, stateKey, stateVal, title } = props;\r\n\t\r\n\tconst onChangeComplete = (color, e) => {\r\n\t\tcolor = color[stateKey];\r\n\t\t\r\n\t\t// RGB\r\n\t\tif (stateKey === 'rgb') {\r\n\t\t\tcolor = [color.r, color.g, color.b].join(',');\r\n\t\t}\r\n\t\t// HSV\r\n\t\telse if (stateKey === 'hsv') {\r\n\t\t\tcolor = [color.h, color.s, color.v].join(',');\r\n\t\t}\r\n\t\t\r\n\t\tdevice.setDeviceState(stateKey, color).catch(err => Log._('Function (light)', err.message, 'error', true, err.stack));\r\n\t};\r\n\t\r\n\tlet initialColor = stateVal || '#ffffff';\r\n\t\r\n\t// RGB\r\n\tif (stateKey === 'rgb') {\r\n\t\tinitialColor = helpers.RgbToHex(initialColor);\r\n\t}\r\n\t// HSV\r\n\telse if (stateKey === 'hsv') {\r\n\t\tinitialColor = helpers.RgbToHex(helpers.HsvToRgb(initialColor));\r\n\t}\r\n\t\r\n\tconst [colorSpace, setColorSpace] = useState(initialColor);\r\n\tuseEffect(() => {\r\n\t\t// RGB\r\n\t\tif (stateKey === 'rgb') {\r\n\t\t\tsetColorSpace(helpers.RgbToHex(stateVal));\r\n\t\t}\r\n\t\t// HSV\r\n\t\telse if (stateKey === 'hsv') {\r\n\t\t\tsetColorSpace(helpers.RgbToHex(helpers.HsvToRgb(stateVal)));\r\n\t\t}\r\n\t\t// HEX\r\n\t\telse if (stateKey === 'hex') {\r\n\t\t\tsetColorSpace(stateVal);\r\n\t\t}\r\n\t}, [stateKey, stateVal]);\r\n\t\r\n\tconst Component = defaults.components.Component;\r\n\treturn (\r\n\r\n<Component title={title || stateKey }>\r\n\t<ColorPicker\r\n\t\tcolor={colorSpace}\r\n\t\twidth={'100%'}\r\n\t\tonChangeComplete={onChangeComplete}\r\n\t\t/>\r\n\t\t\r\n</Component>\r\n\r\n\t);\r\n}\r\n\r\n\r\nconst color = {\r\n\ticon: {\r\n\t\t'default': 'palette',\r\n\t},\r\n\tunit: ' '\r\n}\r\n\r\nexport default {\r\n\tdescription: {\r\n\t\t'en': 'lights',\r\n\t\t'de': 'Lichter',\r\n\t},\r\n\tconfigurations: {\r\n\t\tpower: {\r\n\t\t\ticon: {\r\n\t\t\t\t'true': 'lightbulb-on',\r\n\t\t\t\t'false': 'lightbulb-off-outline'\r\n\t\t\t},\r\n\t\t},\r\n\t\tlevel: {\r\n\t\t\tvalue: val => val > 0 && val <= 1 ? val * 100 : val,\r\n\t\t\tunit: val => val > 0 ? ' %' : null,\r\n\t\t\ticon: {\r\n\t\t\t\t'default': 'lightbulb-on',\r\n\t\t\t\t'0': 'lightbulb-off-outline'\r\n\t\t\t},\r\n\t\t\tstate: {\r\n\t\t\t\t'0': i18n.t('light#level#off')\r\n\t\t\t},\r\n\t\t},\r\n\t\tcolorTemperature: {\r\n\t\t\ticon: {\r\n\t\t\t\t'default': 'thermometer',\r\n\t\t\t},\r\n\t\t\tunit: ' K'\r\n\t\t},\r\n\t\thue: color,\r\n\t\trgb: color,\r\n\t\thsv: color,\r\n\t\thex: color\r\n\t},\r\n\tcomponents: {\r\n\t\tlevel: defaults.components.LevelComponent,\r\n\t\tcolorTemperature: LightColorTemperatureComponent,\r\n\t\trgb: LightColorComponent,\r\n\t\thsv: LightColorComponent,\r\n\t\thex: LightColorComponent,\r\n\t\thue: LightHueComponent\r\n\t},\r\n\tactions: {\r\n\t\tpower: defaults.actions.PowerAction,\r\n\t\tlevel: LightLevelAction,\r\n\t\trgb: LightColorAction,\r\n\t\thsv: LightColorAction,\r\n\t\thex: LightColorAction\r\n\t},\r\n\tstyles: {\r\n\t\t_any: {\r\n\t\t\t//icon: {},\r\n\t\t\tstate: {\r\n\t\t\t\t'0': {\r\n\t\t\t\t\t'color': '#999'\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}","import React, { useState, useEffect } from 'react'\r\nimport clsx from 'clsx'\r\nimport color from 'color'\r\n\r\nimport Button from '@material-ui/core/Button'\r\nimport ButtonGroup from '@material-ui/core/ButtonGroup'\r\nimport ExpandLessIcon from '@material-ui/icons/ExpandLess'\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore'\r\nimport StopIcon from '@material-ui/icons/Stop'\r\n\r\nimport Log from '../../Log'\r\nimport i18n from '../../i18n'\r\nimport defaults from '../defaults'\r\nimport getActivityType from './blind-manufacturers'\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tvalue: props => ({\r\n\t\tfloat: 'left',\r\n\t\tlineHeight: '32px',\r\n\t\tmarginRight: '10px'\r\n\t}),\r\n\tborderLeftTransparent: {\r\n\t\tborderLeftColor: 'transparent !important'\r\n\t},\r\n\tborderLeftColor: {\r\n\t\tborderLeftColor: color(theme.palette.primary.main).alpha(0.5).rgb().toString() +  '!important'\r\n\t},\r\n\tborderRightTransparent: {\r\n\t\tborderRightColor: 'transparent !important'\r\n\t},\r\n\tborderRightColor: {\r\n\t\tborderRightColor: color(theme.palette.primary.main).alpha(0.5).rgb().toString() +  '!important'\r\n\t},\r\n\tborderRightColorSecondary: {\r\n\t\tborderRightColor: color(theme.palette.secondary.main).alpha(0.5).rgb().toString() +  '!important'\r\n\t}\r\n}));\r\n\r\n\r\n/*\r\n * i18n\r\n */\r\nlet translations = require('./blind.' + i18n.getLanguage()).default\r\ni18n.setTranslation(i18n.getLanguage(), translations);\r\n\r\n\r\n/*\r\n * ACTIONS\r\n *\r\n */\r\nfunction BlindLevelAction(props) {\r\n\tconst { device, state, stateKey } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst onGoUp = () => {\r\n\t\tsetLevel(100);\r\n\t\tsetActivity(true);\r\n\t\tdevice.setDeviceState(stateKey, 100).catch(err => Log._('Function (blind)', err.message, 'error', true, err.stack));\r\n\t}\r\n\t\r\n\tconst onGoDown = () => {\r\n\t\tsetLevel(0);\r\n\t\tsetActivity(true);\r\n\t\tdevice.setDeviceState(stateKey, 0).catch(err => Log._('Function (blind)', err.message, 'error', true, err.stack));\r\n\t}\r\n\t\r\n\tconst onStop = () => {\r\n\t\tsetActivity(false);\r\n\t\tdevice.setDeviceState('activity', true).catch(err => Log._('Function (blind)', err.message, 'error', true, err.stack));\r\n\t}\r\n\t\r\n\t// level\r\n\tconst [level, setLevel] = useState(state.value);\r\n\tuseEffect(() => setLevel(state.value), [state]);\r\n\t\r\n\t// state change\r\n\tconst stateChange = (sKey, s, d) => {\r\n\t\t\r\n\t\tif (sKey === 'activity') {\r\n\t\t\tsetActivity(s.val);\r\n\t\t}\r\n\t}\r\n\t\r\n\t// activity\r\n\tconst [activity, setActivity] = useState(false);\r\n\tuseEffect(() => {\r\n\t\t\r\n\t\tif (device.states.activity && device.states.activity.state) {\r\n\t\t\tdevice.states.activity.state = typeof device.states.activity.state === 'string' ? { 'node': device.states.activity.state } : device.states.activity.state;\r\n\t\t\t\r\n\t\t\t// request device state\r\n\t\t\tdevice.requestDeviceState('activity', true).catch(err => Log._('Function (blind)', err.message, 'error', true, err.stack));\r\n\t\t\t\r\n\t\t\t// listen for updates\r\n\t\t\tdevice.listen(stateChange)\r\n\t\t}\r\n\t\t\r\n\t\t// componentWillUnmount\r\n\t\treturn () => device.unlisten(stateChange);\r\n\t\t\r\n\t}, [device, state]);\r\n\t\r\n\treturn (\r\n\r\n<React.Fragment>\r\n\t\r\n\t<div className={classes.value}>\r\n\t\t{level + state.unit}\r\n\t</div>\r\n\t\r\n\t<ButtonGroup size=\"small\">\r\n\t\t<Button color=\"primary\" className={clsx(activity !== null && (!activity ? classes.borderRightColor : classes.borderRightTransparent))} onClick={onGoUp}><ExpandLessIcon /></Button>\r\n\t\t{activity !== null && <Button color=\"secondary\" className={clsx(!activity ? [ classes.borderLeftTransparent, classes.borderRightTransparent ] : classes.borderRightColorSecondary)} onClick={onStop} disabled={!activity}><StopIcon /></Button>}\r\n\t\t<Button color=\"primary\" className={clsx(activity !== null && (!activity ? classes.borderLeftColor : classes.borderLeftTransparent))} onClick={onGoDown}><ExpandMoreIcon /></Button>\r\n\t</ButtonGroup>\r\n</React.Fragment>\r\n\r\n\t);\r\n}\r\n\r\n\r\nexport default {\r\n\tdescription: {\r\n\t\t'en': 'Shutters and Blinds',\r\n\t\t'de': 'Rollos oder Jalousien',\r\n\t},\r\n\tconfigurations: {\r\n\t\tlevel: {\r\n\t\t\tvalue: val => Math.round(val),\r\n\t\t\ticon: {\r\n\t\t\t\t'default': 'window-shutter-open',\r\n\t\t\t\t'>90': 'window-shutter-open',\r\n\t\t\t\t'<=90': 'window-shutter'\r\n\t\t\t}\r\n\t\t},\r\n\t\tlevel2: {\r\n\t\t\tvalue: val => Math.round(val),\r\n\t\t\tunit: ' %',\r\n\t\t\ticon: {\r\n\t\t\t\t'default': 'window-shutter-open',\r\n\t\t\t\t'>90': 'window-shutter-open',\r\n\t\t\t\t'<=90': 'window-shutter'\r\n\t\t\t}\r\n\t\t},\r\n\t\tactivity: {\r\n\t\t\tval: (val, stateKey, device) => getActivityType(device.options.manufacturer, val),\r\n\t\t\ticon: {\r\n\t\t\t\ttrue: 'pan-vertical',\r\n\t\t\t\tfalse: 'dots-vertical',\r\n\t\t\t},\r\n\t\t\tstate: {\r\n\t\t\t\ttrue: i18n.t('blind#activity#true'),\r\n\t\t\t\tfalse: i18n.t('blind#activity#false'),\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t\tlevel2: defaults.components.LevelComponent\r\n\t},\r\n\tactions: {\r\n\t\tlevel: BlindLevelAction\r\n\t},\r\n\tstyles: {\r\n\t}\r\n}","export default function getActivityType(manufacturer, val) {\r\n\t\r\n\t// HomeMatic\r\n\tif (manufacturer === 'HomeMatic') {\r\n\t\t\r\n\t\tswitch(val) {\r\n\t\t\tcase 1: // UP\r\n\t\t\tcase 2: // DOWN\r\n\t\t\t\tval = true;\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tcase 3: // STABLE\r\n\t\t\t\tval = false;\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tdefault: // UNKNOWN\r\n\t\t\t\tval = null;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\t\r\n\t// Shelly\r\n\telse if (manufacturer === 'Shelly') {\r\n\t\t\r\n\t\tswitch(val) {\r\n\t\t\tcase 'open': // MOVING\r\n\t\t\tcase 'close': // MOVING\r\n\t\t\t\tval = true;\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tcase 'stop': // MOVING\r\n\t\t\t\tval = false;\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tdefault: // UNKNOWN\r\n\t\t\t\tval = null;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn val;\r\n}","import React from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport Log from '../Log'\r\n\r\nimport helpers from '../helpers/timeConverter'\r\n\r\nimport Divider from '@material-ui/core/Divider'\r\n//import IconButton from '@material-ui/core/IconButton'\r\nimport Fab from '@material-ui/core/Fab'\r\nimport PlayIcon from '@material-ui/icons/PlayArrow'\r\nimport PauseIcon from '@material-ui/icons/Pause'\r\nimport StopIcon from '@material-ui/icons/Stop'\r\nimport SkipPreviousIcon from '@material-ui/icons/SkipPrevious'\r\nimport SkipNextIcon from '@material-ui/icons/SkipNext'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tdivider: {\r\n\t\tmargin: '15px -16px'\r\n\t},\r\n\tcontainer: {\r\n\t\tmargin: theme.spacing(0, -2),\r\n\t},\r\n\tnoHeader: {\r\n\t\tmarginTop: theme.spacing(-4),\r\n\t},\r\n\timage: {\r\n\t\theight: '200px',\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'flex-end',\r\n\t\tbackgroundPosition: 'center',\r\n\t\tcursor: 'pointer'\r\n\t},\r\n\tnoImage: {\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t\tdisplay: 'flex',\r\n\t\tcursor: 'pointer'\r\n\t},\r\n\tinformation: {\r\n\t\tbackgroundColor: theme.palette.primary.main + '66',\r\n\t\tcolor: '#fff',\r\n\t\tpadding: '10px',\r\n\t\tmargin: 0,\r\n\t\twidth: '100%',\r\n\t\tminHeight: '45px'\r\n\t},\r\n\tinformationLeft: {\r\n\t\twidth: '80%',\r\n\t\tfloat: 'left',\r\n\t\tmargin: 0\r\n\t},\r\n\tinformationRight: {\r\n\t\twidth: '19%',\r\n\t\tfloat: 'right',\r\n\t\tmargin: 0,\r\n\t\ttextAlign: 'right'\r\n\t},\r\n\tlength: {\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t\twidth: '100%',\r\n\t\theight: '7px',\r\n\t},\r\n\tlengthBar: {\r\n\t\tbackgroundColor: theme.palette.secondary.main,\r\n\t\theight: '100%',\r\n\t},\r\n\tcontrols: {\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'stretch'\r\n\t},\r\n\tcontrolsBox: {\r\n\t\tdisplay: 'flex',\r\n\t\tjustifyContent: 'center',\r\n\t\talignItems: 'center',\r\n\t\tpaddingTop: '30px'\r\n\t},\r\n\tcontrolsBoxLeft: {\r\n\t\tflex: 1,\r\n\t\tflexDirection: 'column',\r\n\t\talignItems: 'baseline'\r\n\t},\r\n\tcontrolsBoxCenter: {\r\n\t\tflex: 3\r\n\t},\r\n\tcontrolsBoxRight: {\r\n\t\tflex: 1,\r\n\t\tjustifyContent: 'end'\r\n\t},\r\n\tcontrolButton: {\r\n\t\tmargin: '0 5px'\r\n\t},\r\n\tcontrolButtonSmall: {\r\n\t\tmargin: '0 10px',\r\n\t\tfontSize: '1.2rem',\r\n\t\theight: '32px',\r\n\t\twidth: '32px'\r\n\t}\r\n});\r\n\r\n\r\nclass Multimedia extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {}\r\n\t}\r\n\t\r\n\tcomponentDidMount() {\r\n\t\t\r\n\t\t// get initial states\r\n\t\tfor (let stateKey in this.props.device.states) {\r\n\t\t\tthis.props.device.requestDeviceState(stateKey, true).catch(err => Log._('Modules (MultimediaItem)', err.message, 'error', true, err.stack));\r\n\t\t}\r\n\t\t\r\n\t\t// receive updates\r\n\t\tthis.props.device.listen(this.stateChange);\r\n\t}\r\n\t\r\n\tcomponentWillUnmount() {\r\n\t\tthis.props.device.unlisten(this.stateChange);\r\n\t}\r\n\t\r\n\tstateChange = (stateKey, state) => {\r\n\t\t\r\n\t\t// duration\r\n\t\tif (stateKey === 'duration' && state && state.val.indexOf(':') === -1) {\r\n\t\t\tstate.val = helpers.timeToHoursMinutesSeconds(state.val);\r\n\t\t}\r\n\t\t\r\n\t\t// isRunning\r\n\t\tif (stateKey === 'isRunning' && state && typeof state.val === 'string') {\r\n\t\t\tstate.val = state.val.indexOf('play') > -1;\r\n\t\t}\r\n\t\t\r\n\t\tthis.setState({ [stateKey]: state }, () => {\r\n\t\t\tthis.progress();\r\n\t\t});\r\n\t}\r\n\t\r\n\tprogress() {\r\n\t\tclearTimeout(this.progressTimeout);\r\n\t\t\r\n\t\tif (this.state.isRunning && this.state.isRunning.val === true && this.state.progress && this.state.progress.val && this.state.duration && this.state.duration.val) {\r\n\t\t\tthis.progressTimeout = setTimeout(() => {\r\n\t\t\t\tthis.setState(prevState => ({ progress: { ...prevState.progress, val: helpers.timeToSeconds(prevState.progress.val) + 1 }}), () => this.progress());\r\n\t\t\t}, 1000);\r\n\t\t}\r\n\t}\r\n\t\r\n\topenDialog() {\r\n\t\tthis.props.openDialog(this.props.device);\r\n\t}\r\n\t\r\n\tsetDeviceState(stateKey, value) {\r\n\t\tthis.props.device.setDeviceState(stateKey, value).catch(err => Log._('Modules (MultimediaItem)', err.message, 'error', true, err.stack));\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { classes, noHeader, index, device } = this.props;\r\n\t\tlet styleImage = {}, styleLength = {}, styleLengthBar = {};\r\n\t\t\r\n\t\t// background\r\n\t\tif (this.state.background && this.state.background.val !== '') {\r\n\t\t\tstyleImage.backgroundImage = 'url(' + ((device.options.backgroundUrlPrepend || '') + this.state.background.val) + ')';\r\n\t\t}\r\n\t\t\r\n\t\t// duration\r\n\t\tif (this.state.duration && this.state.duration.val) {\r\n\t\t\tstyleLengthBar.width = ((this.state.progress && this.state.progress.val) || 0) + 'px';\r\n\t\t}\r\n\t\t\r\n\t\tconst playIconElements = this.state.isRunning && this.state.isRunning.val ? [<PauseIcon onClick={this.setDeviceState.bind(this, 'pause', true)} />, <StopIcon />] : [<PlayIcon onClick={this.setDeviceState.bind(this, 'play', true)} />];\r\n\t\t//const repeatIcon = 'repeat'; // repeat, repeat-off, repeat-once\r\n\t\t//const shuffleIcon = 'shuffle-variant'; // shuffle-variant, shuffle-disabled\r\n\t\t//const volumeIcon = 'volume-high'; // volume-variant-off\r\n\t\t\r\n\t\treturn (\r\n\r\n<React.Fragment>\r\n\t\r\n\t{index > 0 && <Divider className={classes.divider} />}\r\n\t<div className={clsx(classes.container, noHeader && classes.noHeader)}>\r\n\t\t\r\n\t\t<div className={clsx(this.state.background && this.state.background.val !== '' ? classes.image : classes.noImage)} style={ styleImage } onClick={this.openDialog.bind(this)}>\r\n\t\t\t\r\n\t\t\t<div className={classes.information}>\r\n\t\t\t\t<p className={classes.informationLeft}>\r\n\t\t\t\t\t{this.state.grandParent && this.state.grandParent.val && [this.state.grandParent.val, <br key={'br-' + device.id} />]}\r\n\t\t\t\t\t{this.state.parent && this.state.parent.val && this.state.parent.val + ' - '}{this.state.title && this.state.title.val}\r\n\t\t\t\t</p>\r\n\t\t\t\t<p className={classes.informationRight}>\r\n\t\t\t\t\t{this.state.progress && helpers.timeToHoursMinutesSeconds(this.state.progress.val)} / {this.state.duration && this.state.duration.val}\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div>\r\n\t\t<div className={classes.length} style={ styleLength }>\r\n\t\t\t<div className={classes.lengthBar} style={ styleLengthBar }></div>\r\n\t\t</div>\r\n\t\t\r\n\t\t<div className={classes.controls}>\r\n\t\t\t<div className={clsx(classes.controlsBox, classes.controlsBoxLeft)}>\r\n\t\t\t\t{/*\r\n\t\t\t\t<IconButton size=\"small\" className={classes.controlButtonSmall}>\r\n\t\t\t\t\t<span className={'mdi mdi-' + repeatIcon}></span>\r\n\t\t\t\t</IconButton>\r\n\t\t\t\t<IconButton size=\"small\" className={classes.controlButtonSmall}>\r\n\t\t\t\t\t<span className={'mdi mdi-' + shuffleIcon}></span>\r\n\t\t\t\t</IconButton>\r\n\t\t\t\t*/}\r\n\t\t\t\t\r\n\t\t\t</div>\r\n\t\t\t<div className={clsx(classes.controlsBox, classes.controlsBoxCenter)}>\r\n\t\t\t\t\r\n\t\t\t\t<Fab className={classes.controlButton} size=\"small\" color=\"secondary\">\r\n\t\t\t\t\t<SkipPreviousIcon onClick={this.setDeviceState.bind(this, 'previous', true)} />\r\n\t\t\t\t</Fab>\r\n\t\t\t\t\r\n\t\t\t\t{playIconElements.map((icon, i) => \r\n\t\t\t\t<Fab key={'icon-' + i} className={classes.controlButton} size=\"large\" color=\"primary\">\r\n\t\t\t\t\t{icon}\r\n\t\t\t\t</Fab>\r\n\t\t\t\t)}\r\n\t\t\t\t\r\n\t\t\t\t<Fab className={classes.controlButton} size=\"small\" color=\"secondary\">\r\n\t\t\t\t\t<SkipNextIcon onClick={this.setDeviceState.bind(this, 'next', true)} />\r\n\t\t\t\t</Fab>\r\n\t\t\t\t\r\n\t\t\t</div>\r\n\t\t\t<div className={clsx(classes.controlsBox, classes.controlsBoxRight)}>\r\n\t\t\t\t{/*\r\n\t\t\t\t<IconButton size=\"small\" className={classes.controlButtonSmall}>\r\n\t\t\t\t\t<span className={'mdi mdi-' + volumeIcon}></span>\r\n\t\t\t\t</IconButton>\r\n\t\t\t\t*/}\r\n\t\t\t\t\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t\r\n\t</div>\r\n\r\n</React.Fragment>\r\n\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(Multimedia);\r\n","import React from 'react'\r\n\r\nimport MultimediaItem from './MultimediaItem'\r\n\r\n\r\nexport default function StateList(props) {\r\n\tconst { devices, settings } = props;\r\n\treturn devices.map((device, i) => <MultimediaItem key={'MultimediaItem-' + device.id} {...props} index={i} noHeader={i === 0 && settings.icon === null && settings.title === null} device={device} />)\r\n}\r\n\r\n\r\nexport const ModuleDescription = \"Zeigt ein Multimedia-Player an (z. B. Spotify)\";\r\nexport const ModuleScreenshots = [];\r\n\r\nexport const ModuleConfig = [\r\n]\r\n","import Log from './Log'\r\nimport i18n from './i18n'\r\n\r\n\r\n/**\r\n * Settings\r\n *\r\n *\r\n */\r\nexport default class Settings {\r\n\r\n\t/*\r\n\t * holds the settings\r\n\t */\r\n\tstatic settings = {};\r\n\t\r\n\t/**\r\n\t * Apply settings.\r\n\t *\r\n\t * @param\tvoid\r\n\t * @return\tvoid\r\n\t */\r\n\tstatic applySettings() {\r\n\t\t\r\n\t\t// language\r\n\t\tif (Settings.settings.language) {\r\n\t\t\ti18n.setLanguage(Settings.settings.language);\r\n\t\t\ti18n.loadTranslation(Settings.settings.language);\r\n\t\t}\r\n\t\telse {\r\n\t\t\ti18n.loadTranslation();\r\n\t\t}\r\n\t\t\r\n\t\t// page title\r\n\t\tif (Settings.settings.pageTitle) {\r\n\t\t\tdocument.title = Settings.settings.pageTitle;\r\n\t\t}\r\n\t\t\r\n\t\t// favicon\r\n\t\tif (Settings.settings.pageFavicon && Settings.settings.pageFavicon.substr(0, 5) === 'data:') {\r\n\t\t\tdocument.getElementById('favicon').href = Settings.settings.pageFavicon;\r\n\t\t}\r\n\t\t\r\n\t\t// translations\r\n\t\tif (Settings.settings.translations) {\r\n\t\t\t\r\n\t\t\tlet translations = Settings.settings.translations;\r\n\t\t\tfor (let language in translations) {\r\n\t\t\t\ti18n.setTranslation(language, translations[language]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets a setting.\r\n\t *\r\n\t * @param\t{String}\tsettings\r\n\t * @return\t{String}\r\n\t */\r\n\tstatic getSetting(setting) {\r\n\t\treturn Settings.settings[setting] || '';\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets all settings.\r\n\t *\r\n\t * @param\tvoid\r\n\t * @return\t{Object}\r\n\t */\r\n\tstatic getSettings() {\r\n\t\treturn Settings.settings || {};\r\n\t}\r\n\t\r\n\t/**\r\n\t * Sets a setting.\r\n\t *\r\n\t * @param\t{String}\tsetting\r\n\t * @param\t{String}\tvalue\r\n\t * @return\t{Boolean}\r\n\t */\r\n\tstatic setSetting(setting, val) {\r\n\t\t\r\n\t\tif (setting && val !== undefined) {\r\n\t\t\tSettings.settings[setting] = val;\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t}\r\n\r\n\t/**\r\n\t * Set settings.\r\n\t *\r\n\t * @param\t{Object}\tsettings\r\n\t * @return\t{Boolean}\r\n\t */\r\n\tstatic setSettings(settings) {\r\n\t\tif (settings) {\r\n\t\t\tSettings.settings = { ...Settings.settings, ...settings || {} };\r\n\t\t\tLog._('Settings', [ 'Set settings', Settings.settings ]);\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t}\r\n}\r\n","export { default } from './blind'\r\n","export default {\r\n\t// States\r\n\t\"blind#activity\": \"Aktivitt\",\r\n\t\"blind#level\": \"Behanghhe\",\r\n\t\"blind#level2\": \"Lamellenposition\",\r\n\t\r\n\t// State values\r\n\t\"blind#activity#true\": \"in Bewegung\",\r\n\t\"blind#activity#false\": \"keine\",\r\n}","export default {\r\n\t// States\r\n\t\"blind#activity\": \"Activity\",\r\n\t\"blind#level\": \"Level\",\r\n\t\"blind#level2\": \"Lamella\",\r\n\t\r\n\t// State values\r\n\t\"blind#activity#true\": \"moving\",\r\n\t\"blind#activity#false\": \"none\",\r\n}","export default {\r\n\t// States\r\n\t\"door#bell\": \"Klingel\",\r\n\t\"door#lock\": \"Schlo\",\r\n\t\"door#open\": \"Tr\",\r\n\t\r\n\t// State values\r\n\t\"door#open#true\": \"offen\",\r\n\t\"door#open#false\": \"geschlossen\",\r\n}","export default {\r\n\t// States\r\n\t\"door#bell\": \"Bell\",\r\n\t\"door#lock\": \"Lock\",\r\n\t\"door#open\": \"Door\",\r\n\t\r\n\t// State values\r\n\t\"door#open#true\": \"open\",\r\n\t\"door#open#false\": \"closed\",\r\n}","export default {\r\n\t\"heating#boost\": \"Boost\",\r\n\t\"heating#humidity\": \"Luftfeuchtigkeit\",\r\n\t\"heating#setTemperature\": \"eingestellte Temperatur\",\r\n\t\"heating#temperature\": \"Temperatur\",\r\n}","export default {\r\n\t\"heating#boost\": \"Boost\",\r\n\t\"heating#humidity\": \"Humidity\",\r\n\t\"heating#setTemperature\": \"Set Temperature\",\r\n\t\"heating#temperature\": \"Temperature\",\r\n}","import ModuleList from '../modules'\r\n\r\n\r\nexport const DEFAULTS = {\r\n\t'MODULE': 'StateList',\r\n\t'NODE_SETTINGS': 'jarvis.0.settings',\r\n\t'NODE_DEVICES': 'jarvis.0.devices',\r\n\t'NODE_NOTIFICATIONS': 'jarvis.0.notifications',\r\n}\r\n\r\nexport const DEVICES_CONFIG = {\r\n\t'divider': {\r\n\t\t'description': {\r\n\t\t\t'en': '',\r\n\t\t\t'de': 'Fgt einen Trennstrich vor (before) oder nach (after) dem Gert ein (abhngig des Moduls).'\r\n\t\t},\r\n\t\t'type': 'SelectInput',\r\n\t\t'options': ['before', 'after']\r\n\t},\r\n\t'group': {\r\n\t\t'description': {\r\n\t\t\t'en': '',\r\n\t\t\t'de': 'Mit der Gruppe knnen mehrere Gerte zusammengefasst / gruppiert angezeigt werden.'\r\n\t\t}\r\n\t},\r\n\t'hiddenStates': {\r\n\t\t'description': {\r\n\t\t\t'en': '',\r\n\t\t\t'de': 'Liste mit States, die von jarvis zwar geladen, aber nicht angezeigt werden.'\r\n\t\t}\r\n\t},\r\n\t'ignoredStates': {\r\n\t\t'description': {\r\n\t\t\t'en': '',\r\n\t\t\t'de': 'Liste mit States, die von jarvis ignoriert (und damit nicht geladen) werden.'\r\n\t\t}\r\n\t},\r\n\t'label': {\r\n\t\t'description': {\r\n\t\t\t'en': '',\r\n\t\t\t'de': 'alternativer Bezeichner des Gerts als Anzeige-Name'\r\n\t\t}\r\n\t},\r\n\t'primaryStateKey': {\r\n\t\t'description': {\r\n\t\t\t'en': '',\r\n\t\t\t'de': 'Dieses Feld dient dem berschreiben des primren States mit einem anderen State.'\r\n\t\t}\r\n\t},\r\n\t'secondaryStateKey': {\r\n\t\t'description': {\r\n\t\t\t'en': '',\r\n\t\t\t'de': 'Dieses Feld dient dem berschreiben des sekundren States mit einem anderen State.'\r\n\t\t}\r\n\t},\r\n\t'sort': {\r\n\t\t'description': {\r\n\t\t\t'en': '',\r\n\t\t\t'de': 'Sortierung des Gerts bezogen auf die Position innerhalb der Gruppe (group).'\r\n\t\t},\r\n\t\t'type': 'NumberInput',\r\n\t},\r\n\t'icon': {\r\n\t\t'description': {\r\n\t\t\t'en': '',\r\n\t\t\t'de': ''\r\n\t\t}\r\n\t},\r\n\t'state': {\r\n\t\t'description': {\r\n\t\t\t'en': '',\r\n\t\t\t'de': ''\r\n\t\t}\r\n\t},\r\n\t'style': {\r\n\t\t'description': {\r\n\t\t\t'en': '',\r\n\t\t\t'de': ''\r\n\t\t}\r\n\t},\r\n\t'unit': {\r\n\t\t'description': {\r\n\t\t\t'en': '',\r\n\t\t\t'de': ''\r\n\t\t}\r\n\t},\r\n\t'value': {\r\n\t\t'description': {\r\n\t\t\t'en': '',\r\n\t\t\t'de': ''\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport const LAYOUT_CONFIG = {\r\n\ttabsHideLabels: {\r\n\t\tlabel: {\r\n\t\t\t'de': 'Tab Labels nicht anzeigen (nur Icons)',\r\n\t\t\t'en': 'Hide tab labels (only show icons)'\r\n\t\t},\r\n\t\tinfo: {\r\n\t\t\t'de': 'Zeigt nur die Icons im Tab und nicht die Labels',\r\n\t\t\t'en': 'Show only icons within a tab, not the label'\r\n\t\t},\r\n\t\ttype: 'SwitchInput',\r\n\t\tval: false\r\n\t},\r\n\ttabIcon: {\r\n\t\tlabel: {\r\n\t\t\t'de': 'Tab Icon',\r\n\t\t\t'en': 'Tab Icon'\r\n\t\t},\r\n\t\ttype: 'TextInput',\r\n\t},\r\n\ttabLabel: {\r\n\t\tlabel: {\r\n\t\t\t'de': 'Tab Label',\r\n\t\t\t'en': 'Tab Label'\r\n\t\t},\r\n\t\ttype: 'TextInput',\r\n\t},\r\n\ttabFullscreen: {\r\n\t\tlabel: {\r\n\t\t\t'de': 'Tab als Vollbild',\r\n\t\t\t'en': 'Tab Fullscreen'\r\n\t\t},\r\n\t\tinfo: {\r\n\t\t\t'de': 'Vollbild kann nur bei einem Tab mit nur einer Spalte und nur einer eingestellten Gruppe aktiviert werden.',\r\n\t\t\t'en': 'Fullscreen can only be enabled on a tab setup with only a single column and only a single group'\r\n\t\t},\r\n\t\ttype: 'SwitchInput',\r\n\t\tval: false\r\n\t},\r\n\tdeviceKey: {\r\n\t\tlabel: {\r\n\t\t\t'de': 'Identifikation',\r\n\t\t\t'en': 'Identifier of key'\r\n\t\t},\r\n\t\ttype: 'TextInput',\r\n\t\tval: ''\r\n\t},\r\n\tgroupName: {\r\n\t\tlabel: {\r\n\t\t\t'de': 'Name der Gruppe',\r\n\t\t\t'en': 'Name of group'\r\n\t\t},\r\n\t\ttype: 'TextInput',\r\n\t\tval: ''\r\n\t},\r\n\tgroupModule: {\r\n\t\tlabel: {\r\n\t\t\t'de': 'Module zur Anzeige der Gruppe',\r\n\t\t\t'en': 'Module to display group'\r\n\t\t},\r\n\t\ttype: 'TextInputAutoComplete',\r\n\t\tval: 'StateList',\r\n\t\tautoCompleteValues: Object.keys(ModuleList)\r\n\t},\r\n\tgroupTitle: {\r\n\t\tlabel: {\r\n\t\t\t'de': 'Titel der Widget-Box',\r\n\t\t\t'en': 'Title of the widget-box'\r\n\t\t},\r\n\t\ttype: 'TextInput',\r\n\t\tval: ''\r\n\t},\r\n\tgroupIcon: {\r\n\t\tlabel: {\r\n\t\t\t'de': 'Icon der Widget-Box',\r\n\t\t\t'en': 'Icon of the widget-box'\r\n\t\t},\r\n\t\ttype: 'TextInput',\r\n\t\tval: 'home'\r\n\t},\r\n\tgroupIconStyle: {\r\n\t\tlabel: {\r\n\t\t\t'de': 'Icon style der Widget-Box',\r\n\t\t\t'en': 'Icon style of the widget-box'\r\n\t\t},\r\n\t\ttype: 'TextInput',\r\n\t\tval: 'backgroundColor: theme.palette.primary.main, color: \"#fff\", fontSize: \"24px\"'\r\n\t}\r\n}\r\n\r\nexport default {\r\n\t'pageSettings': {\r\n\t\t'label': 'Page Settings',\r\n\t\t'settings': {\r\n\t\t\t'language': {\r\n\t\t\t\t'label': {\r\n\t\t\t\t\t'de': 'Spracheinstellung von jarvis',\r\n\t\t\t\t\t'en': 'Language settings for jarvis'\r\n\t\t\t\t},\r\n\t\t\t\t'type': 'SelectInput',\r\n\t\t\t\t'options': {\r\n\t\t\t\t\t'de': 'Deutsch',\r\n\t\t\t\t\t'en': 'English'\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t'pageFavicon': {\r\n\t\t\t\t'label': {\r\n\t\t\t\t\t'de': 'Favicon im Browser',\r\n\t\t\t\t\t'en': 'Browser favicon'\r\n\t\t\t\t},\r\n\t\t\t\t'info': {\r\n\t\t\t\t\t'de': 'base64 Wert der Grafik',\r\n\t\t\t\t\t'en': 'base64 value of the image'\r\n\t\t\t\t},\r\n\t\t\t\t'type': 'TextInput'\r\n\t\t\t},\r\n\t\t\t'pageTitle': {\r\n\t\t\t\t'label': {\r\n\t\t\t\t\t'de': 'Titel im Browser',\r\n\t\t\t\t\t'en': 'Browser title'\r\n\t\t\t\t},\r\n\t\t\t\t'type': 'TextInput',\r\n\t\t\t\t'placeholder': 'jarvis - just another remarkable vis'\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t'themeSettings': {\r\n\t\t'label': 'Theme Settings',\r\n\t\t'settings': {\r\n\t\t\t'themeColorPrimary': {\r\n\t\t\t\t'label': {\r\n\t\t\t\t\t'de': 'Primre Farbe des Themes',\r\n\t\t\t\t\t'en': 'Primary theme color'\r\n\t\t\t\t},\r\n\t\t\t\t'info': {\r\n\t\t\t\t\t'de': 'Der Farbwert kann ein Wert aus der Farbpalette in der Form `HUE|SHADE` (z. B. `blue|700`) sein. Alternativ kann ein Hex oder RGB angegeben werden.'\r\n\t\t\t\t},\r\n\t\t\t\t'link': 'https://material-ui.com/customization/color/#color-palette',\r\n\t\t\t\t'type': 'TextInput',\r\n\t\t\t\t'placeholder': 'blue|700'\r\n\t\t\t},\r\n\t\t\t'themeColorSecondary': {\r\n\t\t\t\t'label': {\r\n\t\t\t\t\t'de': 'Sekundre Farbe des Themes',\r\n\t\t\t\t\t'en': 'Secondary theme color'\r\n\t\t\t\t},\r\n\t\t\t\t'info': {\r\n\t\t\t\t\t'de': 'Der Farbwert kann ein Wert aus der Farbpalette in der Form `HUE|SHADE` (z. B. `pink`) sein. Alternativ kann ein Hex oder RGB angegeben werden.'\r\n\t\t\t\t},\r\n\t\t\t\t'link': 'https://material-ui.com/customization/color/#color-palette',\r\n\t\t\t\t'type': 'TextInput',\r\n\t\t\t\t'placeholder': 'pink'\r\n\t\t\t},\r\n\t\t\t'defaultBoxIcon': {\r\n\t\t\t\t'label': {\r\n\t\t\t\t\t'de': 'Standard Widget-Box Icon',\r\n\t\t\t\t\t'en': 'Default widget-box icon'\r\n\t\t\t\t},\r\n\t\t\t\t'type': 'TextInput',\r\n\t\t\t\t'placeholder': 'home'\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}","export default {\r\n\t// States\r\n\t\"light#colorTemperature\": \"Farbtemperatur\",\r\n\t\"light#hex\": \"Farbe (Hex)\",\r\n\t\"light#hsv\": \"Farbraum Hue-Saturation-Value (HSV)\",\r\n\t\"light#hue\": \"Farbe (Hue)\",\r\n\t\"light#level\": \"Helligkeit\",\r\n\t\"light#power\": \"Licht\",\r\n\t\"light#rgb\": \"Farbraum Rot-Grn-Blau (RGB)\",\r\n\t\r\n\t// State values\r\n\t\"light#level#off\": \"ausgeschaltet\",\r\n}","export default {\r\n\t// States\r\n\t\"light#colorTemperature\": \"Color Temperature\",\r\n\t\"light#hex\": \"Color (Hex)\",\r\n\t\"light#hsv\": \"Colorspace Hue-Saturation-Value (HSV)\",\r\n\t\"light#hue\": \"Color (Hue)\",\r\n\t\"light#level\": \"Brightness\",\r\n\t\"light#power\": \"Power\",\r\n\t\"light#rgb\": \"Colorspace Red-Green-Blue (RGB)\",\r\n\t\r\n\t// State values\r\n\t\"light#level#off\": \"off\",\r\n}","export default {\r\n\t// States\r\n\t\"location#position\": \"Position\",\r\n\t\"location#presence\": \"Anwesenheit\",\r\n\t\"location#users\": \"Benutzer\",\r\n\t\r\n\t// State values\r\n\t\"location#presence#true\": \"anwesend\",\r\n\t\"location#presence#false\": \"abwesend\",\r\n\t\"location#users#empty\": \"niemand anwesend\",\r\n}","export default {\r\n\t// States\r\n\t\"location#position\": \"Position\",\r\n\t\"location#presence\": \"Presence\",\r\n\t\"location#users\": \"Users\",\r\n\t\r\n\t// State values\r\n\t\"location#presence#true\": \"present\",\r\n\t\"location#presence#false\": \"absent\",\r\n\t\"location#users#empty\": \"nobody present\",\r\n}","export default {\r\n\t\"user#location\": \"Standort\",\r\n\t\"user#position\": \"Position\",\r\n}","export default {\r\n\t\"user#location\": \"Location\",\r\n\t\"user#position\": \"Position\",\r\n}","export default {\r\n\t// States\r\n\t\"window#open\": \"Fenster\",\r\n\t\r\n\t// State values\r\n\t\"window#open#true\": \"offen\",\r\n\t\"window#open#false\": \"geschlossen\",\r\n}","export default {\r\n\t// States\r\n\t\"window#open\": \"Window\",\r\n\t\r\n\t// State values\r\n\t\"window#open#true\": \"open\",\r\n\t\"window#open#false\": \"closed\",\r\n}","var map = {\n\t\"./de.js\": 430,\n\t\"./en.js\": 431\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 429;","export default {\r\n\t/*\r\n\t * LOADING SCREEN\r\n\t */\r\n\t\"Retrieving settings\": \"Einstellungen werden geladen\",\r\n\t\r\n\t/*\r\n\t * GENERAL\r\n\t */\r\n\t\"last update\": \"letzte Aktualisierung\",\r\n\t\"Updates available\": \"Aktualisierung verfgbar\",\r\n\t\r\n\t/*\r\n\t * STATES\r\n\t */\r\n\t\"on\": \"an\",\r\n\t\"off\": \"aus\",\r\n\t\r\n\t\"user\": \"User\",\r\n\t\"users\": \"Users\",\r\n\t\r\n\t\"door\": \"Tr\",\r\n\t\"window\": \"Fenster\",\r\n\t\r\n\t\"open\": \"offen\",\r\n\t\"closed\": \"geschlossen\",\r\n\t\r\n\t\"turn on\": \"anschalten\",\r\n\t\"power\": \"Gerte Status\",\r\n\t\"trigger\": \"Gerte Status\",\r\n\t\r\n\t\"brightness\": \"Helligkeit\",\r\n\t\"wind\": \"Wind\",\r\n\t\"battery\": \"Batterie\",\r\n\t\r\n\t\"%DateTime\": \"%DateTime Uhr\",\r\n\t\r\n\t/*\r\n\t * HOUSEHOLD\r\n\t */\r\n\t\"running\": \"Gert luft\",\r\n\t\"consumption\": \"Verbrauch\"\r\n}","export default {\r\n}","import React, { useState, useEffect } from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport Log from '../Log'\r\nimport i18n from '../i18n'\r\n\r\nimport Slider from '@material-ui/core/Slider'\r\nimport Switch from '@material-ui/core/Switch'\r\nimport Button from '@material-ui/core/Button'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles, withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tprimaryAction: props => ({\r\n\t\t...props.styles\r\n\t}),\r\n\tsecondaryAction: props => ({\r\n\t\tcolor: '#999',\r\n\t\tfontSize: '14px',\r\n\t\t...props.styles\r\n\t}),\r\n});\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n\tcomponent: {\r\n\t\tpadding: theme.spacing(2, 0, 2, 0)\r\n\t},\r\n\tsliderMarkLabel: {\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tdisplay: 'none',\r\n\t\t\t'&:nth-child(5)': { display: 'block' },\r\n\t\t\t'&:nth-child(15)': { display: 'block' },\r\n\t\t\t'&:nth-child(25)': { display: 'block' }\r\n\t\t}\r\n\t}\r\n}));\r\n\r\n\r\n/*\r\n * ACTIONS\r\n *\r\n */\r\nconst Action = withStyles(styles)(props => {\r\n\tconst { classes, device, state, stateKey } = props;\r\n\treturn (\r\n\r\n<span className={clsx((stateKey === device.primaryStateKey && classes.primaryAction) || (stateKey === device.secondaryStateKey && classes.secondaryAction))}>\r\n\t{state && state.value} {state && state.unit}\r\n</span>\r\n\r\n\t);\r\n});\r\n\r\nfunction PowerAction(props) {\r\n\tconst { device, stateKey, stateVal, onChange: parentOnChange } = props;\r\n\t\r\n\tconst onChange = (e) => {\r\n\t\tsetChecked(e.target.checked);\r\n\t\tdevice.setDeviceState(stateKey, e.target.checked).catch(err => Log._('Function (defaults)', err.message, 'error', true, err.stack));\r\n\t}\r\n\t\r\n\tconst [checked, setChecked] = useState(stateVal);\r\n\tuseEffect(() => setChecked(stateVal), [stateVal]);\r\n\t\r\n\treturn (\r\n\r\n<Switch\r\n\tchecked={checked}\r\n\tonChange={parentOnChange || onChange}\r\n\tvalue={checked !== true}\r\n\tcolor=\"primary\"\r\n\t/>\r\n\r\n\t);\r\n}\r\n\r\nfunction TriggerAction(props) {\r\n\tconst { device, stateKey, stateVal } = props;\r\n\t\r\n\tconst onClick = () => {\r\n\t\tdevice.setDeviceState(stateKey, true).catch(err => Log._('Function (defaults)', err.message, 'error', true, err.stack));\r\n\t}\r\n\t\r\n\t//\r\n\tif (stateVal === true || stateVal > 0) {\r\n\t\treturn <Action {...props} onChange={null} />;\r\n\t}\r\n\t\r\n\tconst icon = 'power';\r\n\treturn (\r\n\r\n<Button\r\n\tvariant=\"outlined\"\r\n\tcolor=\"primary\"\r\n\tsize=\"small\"\r\n\tstartIcon={<span className={'mdi mdi-' + icon}></span>}\r\n\tonClick={onClick}\r\n\t>\r\n\t\r\n\t{i18n.t('turn on')}\r\n</Button>\r\n\r\n\t);\r\n}\r\n\r\n\r\n/*\r\n * COMPONENTS\r\n *\r\n */\r\nfunction Label(props) {\r\n\tconst { label, br } = props;\r\n\tconst linebreak = br || false;\r\n\t\r\n\treturn (\r\n\t\r\n<React.Fragment>\r\n\t{label}\r\n\t{linebreak && <br />}\r\n</React.Fragment>\r\n\t\r\n\t);\r\n}\r\n\r\nfunction Component(props) {\r\n\tconst { title, children } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\treturn (\r\n\r\n<React.Fragment>\r\n\t<Label label={title} />\r\n\t<div className={classes.component}>\r\n\t\t{children}\r\n\t\r\n\t</div>\r\n</React.Fragment>\r\n\r\n\t);\r\n}\r\n\r\nfunction LevelComponent(props) {\r\n\tlet { device, stateKey, stateVal, title, min, max, step, markSteps } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst onChange = (e, val) => setLevel(val)\r\n\tconst onChangeCommitted = (e, val) => {\r\n\t\tsetLevel(val);\r\n\t\tdevice.setDeviceState(stateKey, val).catch(err => Log._('Function (defaults)', err.message, 'error', true, err.stack));\r\n\t}\r\n\t\r\n\tconst [level, setLevel] = useState(stateVal);\r\n\tuseEffect(() => setLevel(stateVal), [stateVal]);\r\n\t\r\n\t// default settings\r\n\tmin = min || 0;\r\n\tmax = max || 100;\r\n\tstep = step || 1;\r\n\tmarkSteps = markSteps || 11; // 0 to 10\r\n\tlet markStep = ((max-min)/(markSteps-1)) || 10;\r\n\treturn (\r\n\r\n<Component title={title || stateKey }>\r\n\t<Slider\r\n\t\tclasses={{ markLabel: classes.sliderMarkLabel }}\r\n\t\tonChange={onChange}\r\n\t\tonChangeCommitted={onChangeCommitted}\r\n\t\tvalue={level}\r\n\t\tvalueLabelDisplay=\"auto\"\r\n\t\tmarks={[...Array(markSteps).keys()].map(number => ({ 'value': min+number*markStep, 'label': min+number*markStep }))}\r\n\t\tmin={min}\r\n\t\tmax={max}\r\n\t\tstep={step}\r\n\t/>\r\n\r\n</Component>\r\n\r\n\t);\r\n}\r\n\r\n\r\n\r\nexport default {\r\n\tdescription: {\r\n\t\t'en': 'Default settings for all functions',\r\n\t\t'de': 'Standard-Einstellungen fr alle Gewerke',\r\n\t},\r\n\tconfigurations: {\r\n\t\t_any: {\r\n\t\t\tvalue: (val) => val.toString(),\r\n\t\t\t//unit\r\n\t\t\t//icon\r\n\t\t\t//state\r\n\t\t},\r\n\t\tbattery: {\r\n\t\t\tunit: ' %',\r\n\t\t\ticon: 'battery-medium'\r\n\t\t},\r\n\t\tdoor: {\r\n\t\t\ticon: {\r\n\t\t\t\t'true': 'door-open',\r\n\t\t\t\t'false': 'door-closed'\r\n\t\t\t},\r\n\t\t\tstate: {\r\n\t\t\t\t'true': 'open',\r\n\t\t\t\t'false': 'closed'\r\n\t\t\t},\r\n\t\t},\r\n\t\thumidity: {\r\n\t\t\tunit: ' %',\r\n\t\t\ticon: 'water-percent'\r\n\t\t},\r\n\t\tlevel: {\r\n\t\t\tunit: ' %'\r\n\t\t},\r\n\t\tposition: {\r\n\t\t\ticon: 'map-marker'\r\n\t\t},\r\n\t\tpower: {\r\n\t\t\tstate: {\r\n\t\t\t\t'true': 'on',\r\n\t\t\t\t'false': 'off'\r\n\t\t\t},\r\n\t\t\ticon: 'power'\r\n\t\t},\r\n\t\ttemperature: {\r\n\t\t\tunit: ' C',\r\n\t\t\ticon: 'thermometer'\r\n\t\t},\r\n\t\ttrigger: {\r\n\t\t\tstate: {\r\n\t\t\t\t'true': 'on',\r\n\t\t\t\t'false': 'off'\r\n\t\t\t},\r\n\t\t\ticon: 'power'\r\n\t\t},\r\n\t\twind: {\r\n\t\t\tunit: ' km/h',\r\n\t\t\ticon: 'weather-windy'\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t\tLabel,\r\n\t\tComponent,\r\n\t\tLevelComponent,\r\n\t\t\r\n\t\tlevel: LevelComponent\r\n\t},\r\n\tactions: {\r\n\t\tAction,\r\n\t\tPowerAction,\r\n\t\tTriggerAction,\r\n\t\t\r\n\t\tpower: PowerAction,\r\n\t\ttrigger: TriggerAction\r\n\t},\r\n\tstyles: {\r\n\t\t_any: {\r\n\t\t\t//icon: {},\r\n\t\t\tstate: {\r\n\t\t\t\ttrue: {\r\n\t\t\t\t\t'color': '#090',\r\n\t\t\t\t\t'fontWeight': 'bold'\r\n\t\t\t\t},\r\n\t\t\t\tfalse: {\r\n\t\t\t\t\t'color': '#999'\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}","import Log from './Log'\r\nimport { de } from 'date-fns/locale'\r\nexport const locales = { de }\r\n\r\n\r\n/**\r\n * Internationalization\r\n * Based on https://raw.githubusercontent.com/ioBroker/adapter-react/master/src/i18n.js.\r\n * Copyright 2018-2019 bluefox <dogafox@gmaiLog.com>\r\n *\r\n * MIT License\r\n *\r\n *\r\n */\r\nexport default class i18n {\r\n\r\n\t/*\r\n\t * holds the translations\r\n\t */\r\n\tstatic translations = {};\r\n\r\n\t/*\r\n\t * default language\r\n\t */\r\n\tstatic language = (navigator.language || navigator.userLanguage || 'en-EN');\r\n\r\n\t/**\r\n\t * Override default language.\r\n\t *\r\n\t * @param\t{String}\tlanguage\r\n\t * @return\t{Boolean}\r\n\t */\r\n\tstatic setLanguage(language) {\r\n\t\tif (language) {\r\n\t\t\ti18n.language = language;\r\n\t\t\tLog._('i18n', 'Set language to ' + language + '.');\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Loads multiple translations.\r\n\t *\r\n\t * @param\t{String|Array}\tlanguages\r\n\t * @return\t{Boolean}\r\n\t */\r\n\tstatic loadTranslations(languages) {\r\n\t\t\r\n\t\tif (languages) {\r\n\t\t\tlanguages = Array.isArray(languages) ? languages : [languages];\r\n\t\t\tlanguages.forEach(language => i18n.loadTranslation(language));\r\n\t\t\t\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Loads a translation.\r\n\t *\r\n\t * @param\t{String}\tlanguage\r\n\t * @return\t{Boolean}\r\n\t */\r\n\tstatic loadTranslation(language = i18n.getLanguage()) {\r\n\t\t\r\n\t\tif (language) {\r\n\t\t\tlet translation;\r\n\t\t\ttry {\r\n\t\t\t\ttranslation = require('./i18n/' + language + '.js').default;\r\n\t\t\t\ti18n.setTranslation(language, translation);\r\n\t\t\t}\r\n\t\t\tcatch(err) {\r\n\t\t\t\tLog._('i18n', err.message, 'error', false, err.stack);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * Set a translation for language.\r\n\t *\r\n\t * @param\t{String}\tlanguage\r\n\t * @param\t{Object}\ttranslation\r\n\t * @return\t{Boolean}\r\n\t */\r\n\tstatic setTranslation(language, translation) {\r\n\t\tif (language && translation) {\r\n\t\t\ti18n.translations[language] = { ...i18n.translations[language] || {}, ...translation };\r\n\t\t\tLog._('i18n', 'Set translations for language ' + language + '.', 'debug');\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get current set language.\r\n\t *\r\n\t * @param\tvoid\r\n\t * @return\t{String}\r\n\t */\r\n\tstatic getLanguage(isoLong = false) {\r\n\t\treturn i18n.language.substr(0, isoLong ? 5 : 2);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get current set language.\r\n\t *\r\n\t * @param\t{String|Object}\t\tword\r\n\t * @param\t{Object}\t\t\t[options={}]\r\n\t * @param\t{Boolean}\t\t\t[options.ucFirst=false]\r\n\t * @param\t{Object}\t\t\t[placeholders={}]\r\n\t * @param\t{String}\t\t\t[language=i18n.language]\r\n\t * @return\t{String}\r\n\t */\r\n\tstatic t(word = '', options = {}, placeholders = {}, language = i18n.getLanguage()) {\r\n\t\t\r\n\t\t// if object is provided, it might be translated already\r\n\t\tif (typeof word === 'object' && word[language] !== undefined) {\r\n\t\t\tword = word[language];\r\n\t\t}\r\n\t\t\r\n\t\telse {\r\n\t\t\tword = word.toString();\r\n\t\t\tif (i18n.translations[language]) {\r\n\t\t\t\t\r\n\t\t\t\t// check if word is concatenated\r\n\t\t\t\tif (word.indexOf('#') > -1) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet parts = word.split('#');\r\n\t\t\t\t\twhile (parts.length > 0 && !i18n.translations[language][parts.join('#')]) {\r\n\t\t\t\t\t\tparts.shift();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tword = parts.join('#');\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (i18n.translations[language][word]) {\r\n\t\t\t\t\tword = i18n.translations[language][word];\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tLog._('i18n', 'Word \"' + word + '\" not found in language ' + language + '!', 'debug', false);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tLog._('i18n', 'Language ' + language + ' not loaded for word ' + word + '!', 'error');\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// replace placeholders\r\n\t\tfor (let key in placeholders) {\r\n\t\t\tword = word.replace(RegExp('%' + key + '%', 'g'), placeholders[key]);\r\n\t\t}\r\n\t\t\r\n\t\t// options\r\n\t\tif (options.ucFirst) {\r\n\t\t\tword = word.charAt(0).toUpperCase() + word.slice(1);\r\n\t\t}\r\n\t\t\r\n\t\treturn word;\r\n\t}\r\n}\r\n","var map = {\n\t\"./blind.de\": 303,\n\t\"./blind.de.js\": 303,\n\t\"./blind.en\": 304,\n\t\"./blind.en.js\": 304,\n\t\"./blind.js\": 240\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 515;","export { default } from './door'\r\n","var map = {\n\t\"./door.de\": 305,\n\t\"./door.de.js\": 305,\n\t\"./door.en\": 306,\n\t\"./door.en.js\": 306,\n\t\"./door.js\": 230\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 517;","export { default } from './heating'\r\n","var map = {\n\t\"./heating.de\": 307,\n\t\"./heating.de.js\": 307,\n\t\"./heating.en\": 308,\n\t\"./heating.en.js\": 308,\n\t\"./heating.js\": 231\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 519;","export { default } from './light'\r\n","import EventEmitter from 'events'\r\nimport io from 'socket.io-client'\r\n\r\n\r\n/**\r\n * Class for Socket.io conncetion handling.\r\n *\r\n * @description This is based on an implementation @GermanBluefox (https://github.com/GermanBluefox), see https://github.com/ioBroker/adapter-react/blob/master/src/Connection.js\r\n *\t\t\t\tOnly required functions are taken from source class. Major change is that all events are emitted, so proper error handling is possible in the App.\r\n *\r\n *\r\n * @param\t{String}\t\turl\r\n * @param\t{Object}\t\toptions\r\n * @return\t{Socket}\r\n * @see https://github.com/ioBroker/ioBroker.socketio/blob/master/lib/socket.js https://github.com/ioBroker/ioBroker.js-controller/blob/master/lib/adapter.js#L635\r\n *\r\n */\r\nexport default class Socket extends EventEmitter {\r\n\t\r\n\tconstructor(url = null, options = {}) {\r\n\t\tsuper();\r\n\t\t\r\n\t\t// socket connection\r\n\t\tthis.socket = io(url, { timeout: 10000, ...options, query: 'ws=true' });\r\n\t\tthis.statesSubscribes = {}; // subscribed states\r\n\t\t\r\n\t\t/*\r\n\t\t * API events\r\n\t\t * @see https://github.com/socketio/socket.io-client/blob/HEAD/docs/API.md#socket\r\n\t\t *\r\n\t\t */\r\n\t\t// connect\r\n\t\tthis.socket.on('connect', () => this.emit('connect'));\r\n\t\t\r\n\t\t// reconnect: Fired upon a successful reconnection.\r\n\t\tthis.socket.on('reconnect', attempts => this.emit('reconnect', attempts));\r\n\t\t\r\n\t\t// reconnect_error: Fired upon a reconnection attempt error.\r\n\t\tthis.socket.on('reconnect_error', error => this.emit('error', { 'type': 'reconnect', 'event': 'reconnect_error', 'message': error.message }));\r\n\t\t\r\n\t\t// reconnect_failed: Fired upon a reconnection attempt error.\r\n\t\tthis.socket.on('reconnect_failed', () => this.emit('error', { 'type': 'reconnect', 'event': 'reconnect_failed', 'message': 'Reconnection failed!' }));\r\n\t\t\r\n\t\t// discconect\r\n\t\tthis.socket.on('disconnect', reason => this.emit('disconnect', reason));\r\n\t\t\r\n\t\t// connect_error\r\n\t\tthis.socket.on('connect_error', error => this.emit('error', { 'type': 'connect', 'event': 'connect_error', 'message': error.message }));\r\n\t\t\r\n\t\t// connect_timeout\r\n\t\tthis.socket.on('connect_timeout', () => this.emit('error', { 'type': 'connect', 'event': 'connect_timeout', 'message': 'Connect ran into timeout!' }));\r\n\t\t\r\n\t\t// error\r\n\t\tthis.socket.on('error', error => this.emit('error', { 'type': 'error', 'event': 'error', 'message': error.message }));\r\n\t\t\r\n\t\t/*\r\n\t\t * ioBroker events\r\n\t\t *\r\n\t\t */\r\n\t\tthis.socket.on('stateChange', (id, state) => setTimeout(() => this.stateChange(id, state), 0));\r\n\t}\r\n\t\r\n\t/**\r\n\t * Subscribes to multiple states by setting a callback.\r\n\t *\r\n\t */\r\n\t_getPatternFromId(id) {\r\n\t\tlet pattern = id\r\n\t\t\t.replace(/\\./g, '\\\\.')\r\n\t\t\t.replace(/\\*/g, '.*')\r\n\t\t\t.replace(/\\(/g, '\\\\(')\r\n\t\t\t.replace(/\\)/g, '\\\\)')\r\n\t\t\t.replace(/\\+/g, '\\\\+')\r\n\t\t\t.replace(/\\[/g, '\\\\[');\r\n\r\n\t\tif (pattern.indexOf('*') === -1) {\r\n\t\t\tpattern += '$';\r\n\t\t}\r\n\t\t\r\n\t\treturn pattern;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Subscribes to multiple states by setting a callback.\r\n\t *\r\n\t */\r\n\tsubscribeStates(ids, cb) {\r\n\t\tids = Array.isArray(ids) ? ids : [ids];\r\n\t\tids.forEach(id => this.subscribeState(id, cb));\r\n\t}\r\n\t\r\n\t/**\r\n\t * Subscribes to a state by setting a callback.\r\n\t *\r\n\t */\r\n\tsubscribeState(id, cb) {\r\n\t\t\r\n\t\tif (!this.statesSubscribes[id]) {\r\n\t\t\tlet reg = this._getPatternFromId(id);\r\n\t\t\tthis.statesSubscribes[id] = { reg: new RegExp(reg), cbs: [cb] };\r\n\t\t\t\r\n\t\t\tif (this.socket.connected) {\r\n\t\t\t\tthis.socket.emit('subscribe', id);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.statesSubscribes[id].cbs.indexOf(cb) === -1 && this.statesSubscribes[id].cbs.push(cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Fires pre-registered callbacks (via subscribeState) upon state change.\r\n\t *\r\n\t */\r\n\tstateChange(id, state) {\r\n\t\t\r\n\t\tid = id ? id.replace(/[\\s'\"]/g, '_') : '';\r\n\t\tfor (const task in this.statesSubscribes) {\r\n\t\t\tif (this.statesSubscribes.hasOwnProperty(task) && this.statesSubscribes[task].reg.test(id)) {\r\n\t\t\t\tthis.statesSubscribes[task].cbs.forEach(cb => cb(id, state));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets an object view.\r\n\t *\r\n\t */\r\n\tgetAdapterInstances(adapter, cb) {\r\n\t\t\r\n\t\tif (typeof adapter === 'function') {\r\n\t\t\tcb = adapter;\r\n\t\t\tadapter = null;\r\n\t\t}\r\n\t\t\r\n\t\treturn this.getObjectView('system', 'instance', { 'startkey': 'system.adapter.' + (adapter ? adapter + '.' : ''), 'endkey': 'system.adapter.' + (adapter ? adapter + '.999' : 'zzz') }, cb);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets an object.\r\n\t *\r\n\t */\r\n\tgetObject(id, cb) {\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.getObject(id, (err, obj) => err ? reject(err) : resolve(obj)));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('getObject', id, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets an object view.\r\n\t *\r\n\t */\r\n\tgetObjectView(design, search, params, cb) {\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.getObjectView(design, search, params, err => err ? reject(err) : resolve()));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('getObjectView', design, search, params, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets a remote ressource.\r\n\t *\r\n\t */\r\n\tgetRemoteResource(url, cb) {\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.getRemoteResource(url, (err, state) => err ? reject(err) : resolve(state)));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('httpGet', url, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets a state.\r\n\t *\r\n\t */\r\n\tgetState(id, cb) {\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.getState(id, (err, state) => err ? reject(err) : resolve(state)));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('getState', id, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets multiple states at once.\r\n\t *\r\n\t */\r\n\tgetStates(pattern, cb) {\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.getStates(pattern, (err, state) => err ? reject(err) : resolve(state)));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('getStates', pattern, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets the state history.\r\n\t *\r\n\t */\r\n\tgetStateHistory(id, options, cb) {\r\n\t\t\r\n\t\tif (typeof options === 'function') {\r\n\t\t\tcb = options;\r\n\t\t\toptions = {};\r\n\t\t}\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.getStateHistory(id, options, (err, state) => err ? reject(err) : resolve(state)));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('getHistory', id, options, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Sets a state.\r\n\t *\r\n\t */\r\n\tsetState(id, val, cb) {\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.setState(id, val, err => err ? reject(err) : resolve()));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('setState', id, val, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Unsubscribe from multiple states.\r\n\t *\r\n\t */\r\n\tunsubscribeStates(ids) {\r\n\t\tids = Array.isArray(ids) ? ids : [ids];\r\n\t\tids.forEach(id => this.unsubscribeState(id));\r\n\t}\r\n\t\r\n\t/**\r\n\t * Unsubscribe a state.\r\n\t *\r\n\t */\r\n\tunsubscribeState(id) {\r\n\t\t\r\n\t\tif (this.statesSubscribes[id] && this.socket.connected) {\r\n\t\t\tthis.socket.emit('unsubscribe', id);\r\n\t\t\tdelete this.statesSubscribes[id];\r\n\t\t}\r\n\t}\r\n}\r\n","import Socket from './Socket'\r\n\r\n/**\r\n * Connection\r\n +\r\n *\r\n */\r\nexport default class Connection {\r\n\r\n\t/*\r\n\t * URL\r\n\t */\r\n\tstatic url = window.location.hostname;\r\n\t\r\n\t/*\r\n\t * Connection\r\n\t */\r\n\tstatic connection = null;\r\n\t\r\n\t/**\r\n\t * Connects to the Socket.\r\n\t *\r\n\t * @param\t{String}\turl\r\n\t * @param\t{Array}\t\tlisteners\r\n\t * @return\t{Connection}\r\n\t */\r\n\tstatic connect(url = null, listeners = null) {\r\n\t\t\r\n\t\t// set URL\r\n\t\tif (url) {\r\n\t\t\tConnection.setUrl = url;\r\n\t\t}\r\n\t\t\r\n\t\t// connect\r\n\t\tConnection.connection = new Socket(Connection.url);\r\n\t\t\r\n\t\t// set listeners\r\n\t\tif (listeners) {\r\n\t\t\tConnection.setListeners = listeners;\r\n\t\t}\r\n\t\t\r\n\t\t// return connection\r\n\t\treturn Connection.connection;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets the current Connection.\r\n\t *\r\n\t * @param\tvoid\r\n\t * @return\t{Connection}\tCurrent Connection\r\n\t */\r\n\tstatic get getConnection() {\r\n\t\treturn Connection.connection || null;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get the current URL.\r\n\t *\r\n\t * @param\tvoid\r\n\t * @return\t{String}\tURL\r\n\t */\r\n\tstatic get getUrl() {\r\n\t\treturn Connection.url;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Reconnect to the Socket.\r\n\t *\r\n\t * @param\tvoid\r\n\t * @return\t{String}\tURL\r\n\t */\r\n\tstatic get reconnect() {\r\n\t\treturn Connection.connect;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Sets an event listener.\r\n\t *\r\n\t * @param\t{Object}\t\t\tlistener\r\n\t * @param\t{String}\t\t\tlistener.event\r\n\t * @param\t{Function}\t\t\tlistener.callback\r\n\t * @return\tvoid\r\n\t */\r\n\tstatic set setListener(listener) {\r\n\t\tConnection.connection.on(listener.event, listener.callback);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Set event listeners.\r\n\t *\r\n\t * @param\t{Array<Object>}\t\tlisteners\r\n\t * @return \t{Boolean}\r\n\t */\r\n\tstatic set setListeners(listeners = []) {\r\n\t\t\r\n\t\tif (!listeners || !Array.isArray(listeners)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t\tlisteners.forEach(listener => Connection.setListener = listener);\r\n\t\treturn true;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Set a new URL (has to be set before calling connect()).\r\n\t *\r\n\t * @param\t{String}\tURL\r\n\t * @return\tvoid\r\n\t */\r\n\tstatic set setUrl(url) {\r\n\t\tConnection.url = url;\r\n\t}\r\n}\r\n","var map = {\n\t\"./light.de\": 323,\n\t\"./light.de.js\": 323,\n\t\"./light.en\": 324,\n\t\"./light.en.js\": 324,\n\t\"./light.js\": 239\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 615;","export { default } from './location'\r\n","var map = {\n\t\"./location.de\": 325,\n\t\"./location.de.js\": 325,\n\t\"./location.en\": 326,\n\t\"./location.en.js\": 326,\n\t\"./location.js\": 236\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 617;","export { default } from './user'\r\n","var map = {\n\t\"./user.de\": 327,\n\t\"./user.de.js\": 327,\n\t\"./user.en\": 328,\n\t\"./user.en.js\": 328,\n\t\"./user.js\": 237\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 619;","export { default } from './window'\r\n","var map = {\n\t\"./window.de\": 329,\n\t\"./window.de.js\": 329,\n\t\"./window.en\": 330,\n\t\"./window.en.js\": 330,\n\t\"./window.js\": 238\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 621;","import React from 'react'\r\n\r\nimport Log from '../Log'\r\nimport i18n from '../i18n'\r\n\r\nimport Button from '@material-ui/core/Button'\r\nimport Paper from '@material-ui/core/Paper'\r\n\r\nimport Dialog from '../components/Dialog'\r\nimport EnhancedTable from '../components/EnhancedTable'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles'\r\nconst styles = theme => ({\r\n\tpinToTop: {\r\n\t\tposition: 'absolute',\r\n\t\ttop: 0,\r\n\t}\r\n});\r\n\r\n\r\nconst headCells = [\r\n\t{ id: 'time', disablePadding: false, type: 'Date', label: i18n.t('Time'), noWrap: true },\r\n\t{ id: 'module', disablePadding: false, label: i18n.t('Module'), noWrap: true },\r\n\t{ id: 'criticality', disablePadding: false, label: i18n.t('Criticality'), noWrap: true },\r\n\t{ id: 'message', disablePadding: false, label: i18n.t('Message') },\r\n\t{ id: 'stack', disablePadding: false, type: 'Object', label: i18n.t('Stack Trace') },\r\n];\r\n\r\nconst rowStyles = { // https://material-ui.com/components/alert/#simple-alerts\r\n\t'criticality': {\r\n\t\t'debug': {\r\n\t\t\tcolor: 'rgba(0, 0, 0, 0.4)',\r\n\t\t\tbackgroundColor: 'rgba(0, 0, 0, 0.1)'\r\n\t\t},\r\n\t\t'info': {\r\n\t\t\tcolor: 'rgb(13, 60, 97)',\r\n\t\t\tbackgroundColor: 'rgb(232, 244, 253)'\r\n\t\t},\r\n\t\t'warn': {\r\n\t\t\tcolor: 'rgb(102, 60, 0)',\r\n\t\t\tbackgroundColor: 'rgb(255, 244, 229)'\r\n\t\t},\r\n\t\t'error': {\r\n\t\t\tcolor: 'rgb(97, 26, 21)',\r\n\t\t\tbackgroundColor: 'rgb(253, 236, 234)'\r\n\t\t},\r\n\t\t'success': {\r\n\t\t\tcolor: 'rgb(30, 70, 32)',\r\n\t\t\tbackgroundColor: 'rgb(237, 247, 237)'\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n}\r\n\r\nclass LogsPage extends React.Component {\r\n\t\r\n\trender() {\r\n\t\tconst { classes } = this.props;\r\n\t\t\r\n\t\tconst logs = Log.getLog();\r\n\t\treturn (\r\n\r\n<Dialog\r\n\tclasses={{ CustomDialog: classes.pinToTop }}\r\n\tfullWidth={true}\r\n\tmaxWidth={'xl'}\r\n\t\r\n\topen={(this.props.page === 'logs')}\r\n\tonClose={() => this.props.navigate('home')}\r\n\t\r\n\theader=\"Logs\"\r\n\tactions={\r\n\t\t<Button autoFocus onClick={() => this.props.navigate('home')} color=\"primary\">\r\n\t\t\t{i18n.t('Close')}\r\n\t\t</Button>\r\n\t}\r\n\t>\r\n\t\r\n\t<Paper className={classes.paper}>\r\n\t\t<EnhancedTable\r\n\t\t\theadCells={headCells}\r\n\t\t\trows={logs}\r\n\t\t\trowStyles={rowStyles}\r\n\t\t\t\r\n\t\t\tselectable={false}\r\n\t\t\tsortable={true}\r\n\t\t\ttoolbar={false}\r\n\t\t\tstickyHeader\r\n\t\t\t/>\r\n\t\t\r\n\t</Paper>\r\n\t\r\n</Dialog>\r\n\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(LogsPage);\r\n","import React from 'react'\r\n\r\nimport Log from '../Log'\r\nimport Grid from '@material-ui/core/Grid'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tgridContainer: {\r\n\t\tpaddingLeft: theme.spacing(1),\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tpaddingLeft: theme.spacing(0.4)\r\n\t\t}\r\n\t}\r\n}));\r\n\r\n\r\nexport default function GridContainer(props) {\r\n\tconst { contents = {} } = props;\r\n\t\r\n\tconst classes = useStyles();\r\n\tconst columns = Object.keys(contents).length;\r\n\t\r\n\tlet grid = [];\r\n\tfor (let column = 1; column <= columns; column++) {\r\n\t\t\r\n\t\tif (!contents[column]) {\r\n\t\t\tLog._('GridContainer', 'No content for column #' + column + '!', 'warn');\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\t\r\n\t\tgrid.push(\r\n\t\t\t<Grid key={column} item\t\t\t\t// @see https://material-ui.com/customization/breakpoints/\r\n\t\t\t\txs={12}\t\t\t\t\t\t\t//    0 -  600px\r\n\t\t\t\tsm={6}\t\t\t\t\t\t\t//  600 -  960px\r\n\t\t\t\tmd={6}\t\t\t\t\t\t\t//  960 - 1280px\r\n\t\t\t\tlg={Math.round(12/columns)}\t\t// 1280 - 1920px\r\n\t\t\t\txl={Math.round(12/columns)}\t\t// \t\t> 1920px\r\n\t\t\t\t>\r\n\t\t\t\t\r\n\t\t\t\t{contents[column]}\r\n\t\t\t</Grid>\r\n\t\t);\r\n\t}\r\n\t\r\n\treturn (\r\n\r\n<Grid container spacing={0} className={classes.gridContainer}>\r\n\t{grid}\r\n</Grid>\r\n\r\n\t);\r\n}\r\n","import React from 'react';\r\nimport clsx from 'clsx';\r\n\r\nimport Snackbar from '@material-ui/core/Snackbar';\r\nimport SnackbarContent from '@material-ui/core/SnackbarContent';\r\nimport IconButton from '@material-ui/core/IconButton';\r\n\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport CheckCircleIcon from '@material-ui/icons/CheckCircle';\r\nimport WarningIcon from '@material-ui/icons/Warning';\r\nimport ErrorIcon from '@material-ui/icons/Error';\r\nimport InfoIcon from '@material-ui/icons/Info';\r\n\r\n\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { amber, green } from '@material-ui/core/colors';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tsuccess: {\r\n\t\tbackgroundColor: green[600],\r\n\t},\r\n\terror: {\r\n\t\tbackgroundColor: theme.palette.error.dark,\r\n\t},\r\n\tinfo: {\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t},\r\n\twarning: {\r\n\t\tbackgroundColor: amber[700],\r\n\t},\r\n\ticon: {\r\n\t\tfontSize: 20,\r\n\t},\r\n\ticonVariant: {\r\n\t\topacity: 0.9,\r\n\t\tmarginRight: theme.spacing(1),\r\n\t},\r\n\tmessage: {\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center',\r\n\t},\r\n}));\r\n\r\n\r\nconst variantIcon = {\r\n\tsuccess: CheckCircleIcon,\r\n\twarning: WarningIcon,\r\n\terror: ErrorIcon,\r\n\tinfo: InfoIcon,\r\n};\r\n\r\n\r\nexport default function StatusSnackbar(props) {\r\n\tconst classes = useStyles();\r\n\tlet { className, open, autoHideDuration, message, closeButton, onClose, variant, ...other } = props;\r\n\tconst Icon = variantIcon[variant];\r\n\t\r\n\topen = open || true;\r\n\tautoHideDuration = autoHideDuration || null;\r\n\treturn (\r\n\r\n<Snackbar\r\n\tanchorOrigin={{\r\n\t\tvertical: 'bottom',\r\n\t\thorizontal: 'center',\r\n\t}}\r\n\topen={open}\r\n\tautoHideDuration={autoHideDuration}\r\n\tonClose={onClose}\r\n\t>\r\n\t<SnackbarContent\r\n\t\tclassName={clsx(classes[variant], className)}\r\n\t\tmessage={\r\n\t\t\t<span id=\"client-snackbar\" className={classes.message}>\r\n\t\t\t\t<Icon className={clsx(classes.icon, classes.iconVariant)} />\r\n\t\t\t\t{message}\r\n\t\t\t</span>\r\n\t\t}\r\n\t\taction={closeButton && [\r\n\t\t\t<IconButton key=\"close\" aria-label=\"close\" color=\"inherit\" onClick={onClose}>\r\n\t\t\t\t<CloseIcon className={classes.icon} />\r\n\t\t\t</IconButton>,\r\n\t\t]}\r\n\t\t{...other}\r\n\t\t/>\r\n\t\t\r\n</Snackbar>\r\n\r\n\t);\r\n}","export default {\r\n\t\"iobrokerWebAdapterUrl\": \"https://192.168.178.29:8082\"\r\n}","\r\nexport default {\r\n\tdefaults: require('./defaults').default,\r\n\t\r\n\tblind: require('./blind/').default,\r\n\tdoor: require('./door/').default,\r\n\theating: require('./heating/').default,\r\n\tjalousie: require('./blind/').default,\r\n\tlight: require('./light/').default,\r\n\tlocation: require('./location/').default,\r\n\tuser: require('./user/').default,\r\n\twindow: require('./window/').default\r\n}","import EventEmitter from 'events'\r\nimport functions from './functions'\r\n\r\n\r\n/**\r\n * Function\r\n *\r\n * @param\t{String}\t\tfunctionType\r\n * @return\t{Function}\r\n *\r\n */\r\nexport default class Function extends EventEmitter {\r\n\t\r\n\tconstructor(functionType) {\r\n\t\tsuper();\r\n\t\t\r\n\t\tthis.function = functionType;\r\n\t\t\r\n\t\tif (!this.function) {\t\r\n\t\t\tthrow new Error('No function given!');\r\n\t\t}\r\n\t\t\r\n\t\tthis.functionId = this.function.toLowerCase();\r\n\t\t\r\n\t\t// configuration\r\n\t\tthis.defaults = functions['defaults'].configurations;\r\n\t\tthis.configurations = (functions[this.functionId] && functions[this.functionId].configurations) || {};\r\n\t\t\r\n\t\t// styles\r\n\t\tthis.defaultStyles = functions['defaults'].styles;\r\n\t\tthis.styles = (functions[this.functionId] && functions[this.functionId].styles) || {};\r\n\t\t\r\n\t\t// components and actions\r\n\t\tthis.components = { ...functions['defaults'].components, ...(functions[this.functionId] && functions[this.functionId].components) || {} };\r\n\t\tthis.actions = { ...functions['defaults'].actions, ...(functions[this.functionId] && functions[this.functionId].actions) || {} };\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Mixed}\r\n\t * @private\r\n\t */\r\n\t_applyFunction(key, val) {\r\n\t\treturn this._isFunction(key) ? key(val) : val;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{String}\r\n\t * @private\r\n\t */\r\n\t_getValueFromSettings(settings, defaults = '') {\r\n\t\t\r\n\t\tfor (let key in settings) {\r\n\t\t\tif (settings[key] !== undefined) {\r\n\t\t\t\treturn settings[key];\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn defaults;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Boolean}\r\n\t * @private\r\n\t */\r\n\t_isFunction(key) {\r\n\t\treturn key && typeof key === 'function';\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Boolean}\r\n\t * @private\r\n\t */\r\n\t_isValue(val) {\r\n\t\treturn val !== undefined; // || val === null || val === false; // null is considered a value, so it can be used to actually null the output\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Object}\r\n\t * @private\r\n\t */\r\n\t_setObjectStructure(obj, defaultValue = undefined) {\r\n\t\t\r\n\t\tif (!obj || typeof obj != 'object') {\r\n\t\t\tobj = { 'default': obj || defaultValue };\r\n\t\t}\r\n\t\telse if (typeof obj == 'object' && !obj.default) {\r\n\t\t\tobj.default = defaultValue;\r\n\t\t}\r\n\t\t\r\n\t\treturn obj;\r\n\t}\r\n}\r\n","export default {\r\n\t\"hm-rpc\": \"HomeMatic\",\r\n\t\"shelly\": \"Shelly\",\r\n\t\"sonoff\": \"Sonoff\"\r\n}","import React from 'react'\r\n\r\nimport Log from './Log'\r\nimport i18n, { locales } from './i18n'\r\nimport Function from './Function'\r\nimport Adapters from './config/adapters'\r\n\r\nimport { formatDistanceToNow } from 'date-fns'\r\n\r\n\r\n/**\r\n * Device\r\n *\r\n * @param\t{Object}\tdeviceProperties\r\n * @param\t{String}\tdeviceProperties.id\r\n * @param\t{String}\tdeviceProperties.name\r\n * @param\t{String}\t[deviceProperties.room=null]\r\n * @param\t{String}\tdeviceProperties.function\r\n * @param\t{Object}\tdeviceProperties.states\r\n * @param\t{Object}\t[deviceProperties.attributes={}]\r\n * @param\t{Object}\tdeviceProperties.options\r\n * @param\t{Object}\tsocket\r\n * @return\t{Device}\r\n *\r\n */\r\nexport default class Device extends Function {\r\n\t\r\n\tconstructor(deviceProperties, socket) {\r\n\t\ttry {\r\n\t\t\tsuper(deviceProperties.function);\r\n\t\t}\r\n\t\tcatch(err) {\r\n\t\t\tthrow new Error('No function given for device ' + deviceProperties.name + '!');\r\n\t\t}\r\n\t\t\r\n\t\t// initialise class data\r\n\t\tthis.id = deviceProperties.id;\r\n\t\tthis.name = deviceProperties.name;\r\n\t\t\r\n\t\tthis.room = deviceProperties.room || null;\r\n\t\t\r\n\t\tthis.states = deviceProperties.states;\r\n\t\tthis.options = deviceProperties.options;\r\n\t\tthis.attributes = deviceProperties.attributes || {};\r\n\t\t\r\n\t\tthis.socket = socket;\r\n\t\t\r\n\t\t// verify data\r\n\t\tif (!this.options || typeof this.options !== 'object' || Object.keys(this.options).length === 0 || this.options.group === undefined) {\r\n\t\t\tthrow new Error('Device' + (deviceProperties.id || deviceProperties.name ? ' ' + (deviceProperties.name || deviceProperties.id) : '') + ' not defined for jarvis!');\r\n\t\t}\r\n\t\telse if (!this.states || typeof this.states !== 'object' || Object.keys(this.states).length === 0) {\r\n\t\t\tthrow new Error('Insufficent properties provided' + (deviceProperties.id || deviceProperties.name ? ' for device ' + (deviceProperties.name || deviceProperties.id) : '') + ' (no states defined)!');\r\n\t\t}\r\n\t\telse if (!this.id || !this.name || !this.function) {\r\n\t\t\tthrow new Error('Insufficent properties provided' + (deviceProperties.id || deviceProperties.name ? ' for device ' + (deviceProperties.name || deviceProperties.id) : '') + ' (no id, name or function defined)!');\r\n\t\t}\r\n\t\telse if (!this.socket) {\t\r\n\t\t\tthrow new Error('No socket given!');\r\n\t\t}\r\n\t\t\r\n\t\t// hierarchy\r\n\t\tthis.children = deviceProperties.children || [];\r\n\t\tthis.parent = deviceProperties.parent || null;\r\n\t\t\r\n\t\t// do some stuff\r\n\t\tthis._setProperties();\r\n\t\tthis.stateSubscriptions = [];\r\n\t\t\r\n\t\t// listen for errors of the device\r\n\t\tthis.on('error', err => Log._('Device', [ 'Device error occured!', err.message ], 'error', false, err.stack));\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Object|String}\r\n\t * @private\r\n\t */\r\n\t_getStateFromKey(stateKey = null, stateType = 'state') {\r\n\t\t\r\n\t\t// already a state object\r\n\t\tif (stateKey && typeof stateKey === 'object') {\r\n\t\t\treturn stateKey;\r\n\t\t}\r\n\t\t\r\n\t\t// get state object\r\n\t\tlet s = this.states[stateKey || this.primaryStateKey];\r\n\t\t\r\n\t\t// state does not exist\r\n\t\tif (s === undefined) {\r\n\t\t\treturn i18n.t('State does not exist in device %device%').replace(/%device%/g, this.name) + '!';\r\n\t\t}\r\n\t\t\r\n\t\t// state not an object so far\r\n\t\telse if (typeof s === 'string') {\r\n\t\t\tthis.states[stateKey || this.primaryStateKey] = { [stateType]: { 'node': s }};\r\n\t\t\ts = this.states[stateKey || this.primaryStateKey];\r\n\t\t}\r\n\t\telse if (typeof s[stateType] === 'string') {\r\n\t\t\tthis.states[stateKey || this.primaryStateKey][stateType] = { 'node': s[stateType] };\r\n\t\t\ts = this.states[stateKey || this.primaryStateKey];\r\n\t\t}\r\n\t\t\r\n\t\t// state not valid\r\n\t\tif (!s || !s[stateType]) {\r\n\t\t\treturn i18n.t('Incorrect or non-defined state key for device %device%').replace(/%device%/g, this.name).replace(/%stateType%/g, stateType) + '!';\r\n\t\t}\r\n\t\telse if (typeof s[stateType] == 'object' && !s[stateType].node) {\r\n\t\t\treturn i18n.t('No %stateType% specified for device %device%').replace(/%device%/g, this.name).replace(/%stateType%/g, stateType) + '!';\r\n\t\t}\r\n\t\t\r\n\t\treturn s;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @private\r\n\t */\r\n\t_getConfigurationSetting(config, stateKey, attribute, stateVal) {\r\n\t\t\r\n\t\tif (this[config][stateKey]) {\r\n\t\t\t\r\n\t\t\t// 1. if stateKey (e.g. level, power) is available, try to replace an attribute (e.g. icon, unit or for styles state, icon) based on current state (e.g. true, false)\r\n\t\t\tif (typeof this[config][stateKey][attribute] === 'object') {\r\n\t\t\t\t\r\n\t\t\t\tconst stateValKeys = Object.keys(this[config][stateKey][attribute]);\r\n\t\t\t\tif (stateValKeys.toString().indexOf('<') > -1 || stateValKeys.toString().indexOf('>') > -1 || stateValKeys.toString().indexOf('!=') > -1) { // !=, >, >=, <, <=\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet val = this[config][stateKey][attribute]['default'];\r\n\t\t\t\t\tstateValKeys.forEach(stateValKey => {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlet stateValValue = stateValKey.replace('<=', '').replace('<', '').replace('>=', '').replace('>', '').replace('!=', '');\r\n\t\t\t\t\t\tif (stateValKey.indexOf('<=') > -1 && stateVal <= stateValValue) {\r\n\t\t\t\t\t\t\tval = this[config][stateKey][attribute][stateValKey];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (stateValKey.indexOf('<') > -1 && stateVal < stateValValue) {\r\n\t\t\t\t\t\t\tval = this[config][stateKey][attribute][stateValKey];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (stateValKey.indexOf('>=') > -1 && stateVal >= stateValValue) {\r\n\t\t\t\t\t\t\tval = this[config][stateKey][attribute][stateValKey];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (stateValKey.indexOf('>') > -1 && stateVal > stateValValue) {\r\n\t\t\t\t\t\t\tval = this[config][stateKey][attribute][stateValKey];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (stateValKeys.toString().indexOf('!=') > -1 && stateVal != stateValValue) {  // eslint-disable-line eqeqeq\r\n\t\t\t\t\t\t\tval = this[config][stateKey][attribute][stateValKey];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t\treturn val;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\treturn super._isValue(this[config][stateKey][attribute][stateVal]) ? this[config][stateKey][attribute][stateVal] : this[config][stateKey][attribute]['default'];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// 2. if #1 is a function, apply it\r\n\t\t\telse if (super._isFunction(this[config][stateKey][attribute])) {\r\n\t\t\t\treturn this[config][stateKey][attribute](stateVal, stateKey, this);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// 3. fallback to stateKey with attribute, if defined but neither an object (thus stateless) nor a function\r\n\t\t\telse if (typeof this[config][stateKey][attribute] === 'string') {\r\n\t\t\t\treturn this[config][stateKey][attribute];\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (this[config]['_any']) {\r\n\t\t\t\r\n\t\t\t// 4. fallback to _any if no stateKey (e.g. level, power) is given, but consider attribute to be stateful (e.g. true, false)\r\n\t\t\tif (typeof this[config]['_any'][attribute] === 'object') {\r\n\t\t\t\treturn super._isValue(this[config]['_any'][attribute][stateVal]) ? this[config]['_any'][attribute][stateVal] : this[config]['_any'][attribute]['default'];\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// 5. if #4 is a function, apply it\r\n\t\t\telse if (super._isFunction(this[config]['_any'][attribute])) {\r\n\t\t\t\treturn this[config]['_any'][attribute](stateVal, stateKey, this);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// nothing, return undefined (not null, because this would mean take an empty value)\r\n\t\treturn undefined;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @private\r\n\t */\r\n\t_getUserSetting(stateKey, attribute, stateVal, styles = false) {\r\n\t\t\r\n\t\tlet options = this.options;\r\n\t\t\r\n\t\tif (styles) {\r\n\t\t\toptions = this.options['styles'];\r\n\t\t\tlet tmp = attribute;\r\n\t\t\tattribute = stateKey;\r\n\t\t\tstateKey = tmp;\r\n\t\t}\r\n\t\t\r\n\t\tif (options[attribute] && options[attribute][stateKey]) {\r\n\t\t\tif (typeof options[attribute][stateKey] === 'object') {\r\n\t\t\t\treturn super._isValue(options[attribute][stateKey][stateVal]) ? options[attribute][stateKey][stateVal] : options[attribute][stateKey]['default'];\r\n\t\t\t}\r\n\t\t\telse if (super._isFunction(options[attribute][stateKey])) {\r\n\t\t\t\treturn options[attribute][stateKey](stateVal, stateKey, this);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\treturn options[attribute][stateKey];\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn undefined;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t *\r\n\t * @return void\r\n\t * @private\r\n\t *\r\n\t */\r\n\t_setProperties() {\r\n\t\t\r\n\t\tlet states = Object.keys(this.states);\r\n\t\t\r\n\t\t// delete ignored states\r\n\t\tif (this.options.ignoredStates) {\r\n\t\t\tthis.options.ignoredStates = Array.isArray(this.options.ignoredStates) ? this.options.ignoredStates : [this.options.ignoredStates];\r\n\t\t\t\r\n\t\t\tthis.options.ignoredStates.forEach(ignoredState => {\r\n\t\t\t\tif (this.states[ignoredState]) {\r\n\t\t\t\t\tdelete this.states[ignoredState];\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\t// get hidden states\r\n\t\tthis.options.hiddenStates = this.options.hiddenStates ? (Array.isArray(this.options.hiddenStates) ? this.options.hiddenStates : [this.options.hiddenStates]) : [];\r\n\t\t\r\n\t\t// properties\r\n\t\tthis.primaryStateKey = this.options.primary || states[0];\r\n\t\tthis.secondaryStateKey = this.options.secondary || null;\r\n\t\t\r\n\t\t// bring user settings for value, state, unit, icon and styles in structure\r\n\t\t['value', 'state', 'unit', 'icon', 'styles'].forEach(key => {\r\n\t\t\t\r\n\t\t\tlet stateOrAttribute = this.options[key] && Object.keys(this.options[key])[0];\r\n\t\t\tthis.options[key] = !this.options[key] ? {} : super._setObjectStructure(stateOrAttribute && states.indexOf(stateOrAttribute) > -1 ? this.options[key] : { [this.primaryStateKey]: this.options[key] });\r\n\t\t});\r\n\t\t\r\n\t\t// manufacturer\r\n\t\tthis.states[this.primaryStateKey] = this._getStateFromKey(this.primaryStateKey);\r\n\t\tthis.options.manufacturer = (this.primaryStateKey && Adapters[this.states[this.primaryStateKey].state.node.substr(0, this.states[this.primaryStateKey].state.node.indexOf('.'))]) || '';\r\n\t\t\r\n\t\t// all options\r\n\t\tthis.options.group = Array.isArray(this.options.group) ? this.options.group : [this.options.group];\r\n\t\tthis.options.sort = this.options.sort || 999;\r\n\t\t\r\n\t\tthis.options.label = (this.options.label && (typeof this.options.label === 'string' && this.options.label.replace(/%name%/g, this.name))) || this.options.label || this.name;\r\n\t\t//this.options.subtitle = this.options.subtitle;\r\n\t\tthis.options.divider = this.options.divider || '';\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t *\r\n\t * @return\t{Object}\r\n\t * @private\r\n\t */\r\n\t_updateDeviceState(stateKey, state) {\r\n\t\t\r\n\t\t// add time changed\r\n\t\tstate.timeChanged = formatDistanceToNow(new Date(state.lc-5*1000), { locale: locales[i18n.getLanguage()], includeSeconds: true, addSuffix: true })\r\n\t\t\r\n\t\t// add unit\r\n\t\tstate.unit = '';\r\n\t\t\r\n\t\t// change val\r\n\t\tlet val = this._getConfigurationSetting('configurations', stateKey, 'val', state.val);\r\n\t\tstate.val = val !== undefined ? val : state.val;\r\n\t\t\r\n\t\t// assign value\r\n\t\tstate.value = state.val;\r\n\t\t\r\n\t\t// mapping of value to state values\r\n\t\t[{ 'value': 'value' }, { 'state': 'value' }, { 'unit': 'unit' }].forEach(pair => {\r\n\t\t\tlet attribute = Object.keys(pair).toString();\r\n\t\t\tlet option = Object.values(pair).toString();\r\n\t\t\tlet settings = {};\r\n\t\t\t\r\n\t\t\t// get user setting\r\n\t\t\tsettings['options'] = this._getUserSetting(stateKey, attribute, state.val);\r\n\t\t\t\r\n\t\t\t// get function setting or fallback to defaults\r\n\t\t\t['configurations', 'defaults'].forEach(config => {\r\n\t\t\t\tsettings[config] = this._getConfigurationSetting(config, stateKey, attribute, state.val);\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tstate[option] = super._getValueFromSettings(settings, state[option]);\r\n\t\t});\r\n\t\t\r\n\t\tstate.value = i18n.t(state.value);\r\n\t\treturn state;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tget(property) {\r\n\t\treturn this[property] || null;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @return\t{React.Component}\r\n\t */\r\n\tgetAction(stateKey = null, forceDefault = false) {\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\t\r\n\t\tconst state = this.states[stateKey].state.value;\r\n\t\tconst stateVal = state ? state.val : null;\r\n\t\t\r\n\t\tconst Action = (!forceDefault && this.actions[stateKey]) || this.actions.Action;\r\n\t\treturn <Action key={'action-' + this.id + '-' + stateKey} device={this} state={state} stateKey={stateKey} stateVal={stateVal} styles={this.getStyle('state', stateKey, stateVal)} />\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @return\t{React.Component}\r\n\t */\r\n\tgetComponent(stateKey) {\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\t\r\n\t\tconst state = this.states[stateKey].state.value;\r\n\t\tconst stateVal = state ? state.val : null;\r\n\t\t\r\n\t\tconst Component = this.components[stateKey];\r\n\t\treturn (Component && <Component title={this.states[stateKey].label || i18n.t(this.function + '#' + stateKey)} device={this} stateKey={stateKey} stateVal={stateVal} />) || this.states[stateKey].label || i18n.t(this.function + '#' + stateKey);\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @param\t{String}\t[stateProperty=null]\r\n\t * @return\t{String}\r\n\t */\r\n\tgetDeviceState(stateKey = null, stateProperty = null) {\r\n\t\tconst s = this.states[stateKey || this.primaryStateKey];\r\n\t\t\r\n\t\tlet deviceState = null;\r\n\t\t\r\n\t\tif (s && s.state && stateProperty !== null && s.state.value !== undefined && s.state.value[stateProperty] !== undefined) {\r\n\t\t\tdeviceState = s.state.value[stateProperty];\r\n\t\t}\r\n\t\telse if (s && s.state && stateProperty === null && s.state.value !== undefined) {\r\n\t\t\tdeviceState = s.state.value;\r\n\t\t}\r\n\t\t\r\n\t\treturn deviceState;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get an icon based on the current device state (or falls back to a default).\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @param\t{String}\t[stateVal=default]\r\n\t * @param\t{String}\t[defaultIcon=null]\r\n\t * @return\t{String}\r\n\t */\r\n\tgetIcon(stateKey, stateVal = '', defaultIcon = undefined) {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\t\r\n\t\tlet settings = {};\r\n\t\t\r\n\t\t// get user setting\r\n\t\tsettings['options'] = this._getUserSetting(stateKey, 'icon', stateVal);\r\n\t\t\r\n\t\t// get function setting or fallback to defaults\r\n\t\t['configurations', 'defaults'].forEach(config => {\r\n\t\t\tsettings[config] = this._getConfigurationSetting(config, stateKey, 'icon', stateVal);\r\n\t\t});\r\n\t\t\r\n\t\treturn super._getValueFromSettings(settings, defaultIcon);\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tgetOption(option, stateVal = 'default') {\r\n\t\treturn (this.options[option] && (this.options[option][stateVal] || this.options[option]['default'])) || this.options[option] || null;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tgetStyle(attribute, stateKey = null, stateVal = 'default') {\r\n\t\tlet settings = {};\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\t\r\n\t\t// get user setting\r\n\t\tsettings['options'] = this._getUserSetting(stateKey, attribute, stateVal, true);\r\n\t\t\r\n\t\t// get function setting or fallback to defaults\r\n\t\t['styles', 'defaultStyles'].forEach(config => {\r\n\t\t\tsettings[config] = this._getConfigurationSetting(config, stateKey, attribute, stateVal);\r\n\t\t});\r\n\t\t\r\n\t\treturn super._getValueFromSettings(settings, {});\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tlisten(eventName, callback) {\r\n\t\t\r\n\t\tif (typeof eventName === 'function') {\r\n\t\t\tcallback = eventName;\r\n\t\t\teventName = 'stateChange';\r\n\t\t}\r\n\t\t\r\n\t\t// check for duplicates\r\n\t\tlet duplicate = this.listeners(eventName).findIndex(listener => listener.toString() == callback.toString()) > -1; // eslint-disable-line eqeqeq\r\n\t\t\r\n\t\t// attach callback\r\n\t\tif (!duplicate) {\r\n\t\t\tthis.on(eventName, callback);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Requests all state values from the backend.\r\n\t *\r\n\t * @param\t{Boolean}\t[subscribe=false]\r\n\t * @return\t{Array<Promises>}\r\n\t *\r\n\t */\r\n\trequestDeviceStates(subscribe = false) {\r\n\t\t\r\n\t\tlet responses = [];\r\n\t\tfor (let stateKey in this.states) {\r\n\t\t\tresponses.push(this.requestDeviceState(stateKey, subscribe));\r\n\t\t}\r\n\t\t\r\n\t\treturn responses;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Requests a state value from the backend.\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @param\t{Boolean}\t[subscribe=false]\r\n\t * @return\t{Promise}\r\n\t *\r\n\t */\r\n\trequestDeviceState(stateKey = null, subscribe = false) {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\tlet s = this._getStateFromKey(stateKey);\r\n\t\tif (typeof s == 'string') {\r\n\t\t\treturn Promise.reject({ 'success': false, 'stateKey': stateKey, 'error': s });\r\n\t\t}\r\n\t\t\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\r\n\t\t\t// send cached value if present and subscrbe (means always updated)\r\n\t\t\tif (s.state.value !== undefined && this.stateSubscriptions.indexOf(stateKey) > -1) {\r\n\t\t\t\t\r\n\t\t\t\t// publish state\r\n\t\t\t\tthis.emit('stateChange', stateKey, s.state.value, this);\r\n\t\t\t\t\r\n\t\t\t\t// resolve\r\n\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey, 'cached': true });\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// request from backend\r\n\t\t\telse {\r\n\t\t\t\tthis.socket.getState(s.state.node)\r\n\t\t\t\t\t.then(state => {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// state does not exist\r\n\t\t\t\t\t\tif (state === null) {\r\n\t\t\t\t\t\t\treject({ 'success': false, 'stateKey': stateKey, 'error': 'State ' + s.state.node + ' not found!' });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// set result\r\n\t\t\t\t\t\ts.state.value = this._updateDeviceState(stateKey, state);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// publish state change\r\n\t\t\t\t\t\tthis.emit('stateChange', stateKey, s.state.value, this);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// subscribe to state\r\n\t\t\t\t\t\tif (subscribe) {\r\n\t\t\t\t\t\t\tthis.subscribeDeviceState(stateKey).catch(err => reject(err));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// resolve\r\n\t\t\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey, 'cached': false });\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(err => reject({ 'success': false, 'stateKey': stateKey, 'error': err }));\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Requests a state value from the backend.\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @param\t{Boolean}\t[subscribe=false]\r\n\t * @param\t{Object}\t[options={}]\r\n\t * @return\t{Promise}\r\n\t * @see https://github.com/ioBroker/ioBroker.history#access-values-from-javascript-adapter\r\n\t *\r\n\t */\r\n\trequestDeviceStateHistory(stateKey = null, subscribe = false, options = {}) {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\tlet s = this._getStateFromKey(stateKey);\r\n\t\tif (typeof s == 'string') {\r\n\t\t\treturn Promise.reject({ 'success': false, 'stateKey': stateKey, 'error': s });\r\n\t\t}\r\n\t\t\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\ts.state.historyCache = s.state.historyCache || {};\r\n\t\t\t\r\n\t\t\t// send cached value if present and subscrbe (means always updated)\r\n\t\t\tif (options.start && options.end && options.step && s.state.historyCache[options.start + '#' + options.end + '#' + options.step] !== undefined) {\r\n\t\t\t\t\r\n\t\t\t\t// publish state\r\n\t\t\t\tthis.emit('historyChange', stateKey, s.state.historyCache[options.start + '#' + options.end + '#' + options.step], s.state, this);\r\n\t\t\t\t\r\n\t\t\t\t// resolve\r\n\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey, 'cached': true });\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// request from backend\r\n\t\t\telse {\r\n\t\t\t\tthis.socket.getStateHistory(s.state.node, options)\r\n\t\t\t\t\t.then(history => {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// state does not exist\r\n\t\t\t\t\t\tif (history === null) {\r\n\t\t\t\t\t\t\treject({ 'success': false, 'stateKey': stateKey, 'error': 'State ' + s.state.node + ' not found!' });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// cache result\r\n\t\t\t\t\t\tif (options.start && options.end && options.step) {\r\n\t\t\t\t\t\t\ts.state.historyCache[options.start + '#' + options.end + '#' + options.step] = history;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// set result\r\n\t\t\t\t\t\ts.state.history = history;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// publish state change\r\n\t\t\t\t\t\tthis.emit('historyChange', stateKey, s.state.history, s.state, this);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// subscribe to state\r\n\t\t\t\t\t\tif (subscribe) {\r\n\t\t\t\t\t\t\tthis.subscribeDeviceState(stateKey).catch(err => reject(err));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// resolve\r\n\t\t\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey, 'cached': false });\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(err => reject({ 'success': false, 'stateKey': stateKey, 'error': err }));\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tsetAction(action) {\r\n\t\tthis.options.action = action;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tsetComponent(component) {\r\n\t\tthis.options.label = component;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @param\t{String}\tvalue\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @return\tvoid\r\n\t */\r\n\tsetDeviceState(stateKey = null, value) {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\tlet s = this._getStateFromKey(stateKey, 'action');\r\n\t\tif (typeof s == 'string') {\r\n\t\t\treturn Promise.reject({ 'success': false, 'stateKey': stateKey, 'error': s });\r\n\t\t}\r\n\t\t\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tthis.socket.setState(s.action.node, value)\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\r\n\t\t\t\t\t// get state value if not subscribed\r\n\t\t\t\t\tif (this.stateSubscriptions.indexOf(stateKey) === -1) {\r\n\t\t\t\t\t\tthis.requestDeviceState(stateKey);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t// resolve\r\n\t\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey });\r\n\t\t\t\t})\r\n\t\t\t\t.catch(err => reject({ 'success': false, 'stateKey': stateKey, 'error': err }));\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @return\tvoid\r\n\t */\r\n\tsubscribeDeviceState(stateKey = null) {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\tlet s = this._getStateFromKey(stateKey);\r\n\t\tif (typeof s == 'string') {\r\n\t\t\treturn Promise.reject({ 'success': false, 'stateKey': stateKey, 'error': s });\r\n\t\t}\r\n\t\t\r\n\t\t// add subscription\t\r\n\t\tif (this.stateSubscriptions.indexOf(stateKey) === -1) {\r\n\t\t\tthis.stateSubscriptions.push(stateKey);\r\n\t\t\r\n\t\t\t// subscribe\r\n\t\t\treturn new Promise(resolve => {\r\n\t\t\t\tthis.socket.subscribeState(s.state.node, (id, state, params) => {\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (state && state.val !== this.getDeviceState(stateKey, 'val')) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// format value\r\n\t\t\t\t\t\ts.state.value = this._updateDeviceState(stateKey, state);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// publish state change\r\n\t\t\t\t\t\tthis.emit('stateChange', stateKey, s.state.value, this);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// publish to children as well\r\n\t\t\t\t\t\tthis.children.forEach(child => child.emit('stateChange', stateKey, s.state.value, this));\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey });\r\n\t\t\t});\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn Promise.reject({ 'success': false, 'stateKey': stateKey, 'error': 'State already subscribed!' });\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tunlisten(eventName, callback) {\r\n\t\t\r\n\t\tif (typeof eventName === 'function') {\r\n\t\t\tcallback = eventName;\r\n\t\t\teventName = 'stateChange';\r\n\t\t}\r\n\t\t\r\n\t\tthis.off(eventName, callback);\r\n\t}\r\n}\r\n","\r\nexport default {\r\n\tconfiguration: require('./ConfigurationPage').default,\r\n\tlogs: require('./LogsPage').default,\r\n}","import React from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport i18n from '../i18n'\r\n\r\nimport AppBar from '@material-ui/core/AppBar'\r\nimport Toolbar from '@material-ui/core/Toolbar'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport Hidden from '@material-ui/core/Hidden'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport Tooltip from '@material-ui/core/tooltip'\r\nimport Badge from '@material-ui/core/Badge'\r\nimport NotificationsIcon from '@material-ui/icons/Notifications'\r\nimport MenuIcon from '@material-ui/icons/Menu'\r\nimport SettingsIcon from '@material-ui/icons/Settings'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tappBar: {\r\n\t\tflexGrow: 1,\r\n\t\tboxShadow: 'none',\r\n\t\ttransform: 'none',\r\n\t},\r\n\ttoolbar: {\r\n\t\tbackgroundColor: theme.palette.primary.main\r\n\t},\r\n\tmenuButton: {\r\n\t\tmarginRight: theme.spacing(2)\r\n\t},\r\n\ttitle: {\r\n\t\tflexGrow: 1,\r\n\t},\r\n\ticon: {\r\n\t\t...theme.components.icon,\r\n\t\tcolor: '#fff',\r\n\t\tpaddingRight: '6px',\r\n\t\twidth: '1em',\r\n\t\theight: '1em',\r\n\t\tdisplay: 'inline-block',\r\n\t\tfontSize: '1.5rem',\r\n\t\ttransition: 'fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\r\n\t\tflexShrink: 0,\r\n\t\tuserSelect: 'none'\r\n\t}\r\n}));\r\n\r\n\r\nexport default function TopBar(props) {\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst { children, title, connectionStatus, toggleDrawer, navigate, notifications } = props;\r\n\tconst [ icon, label ] = title.indexOf('|') > -1 ? title.split('|') : [ null, title ];\r\n\t\r\n\tconst connectionStatusIcon = connectionStatus ? 'lan-connect' : (connectionStatus === 'pending' ? 'lan-pending' : 'lan-disconnect');\r\n\tconst connectionStatusTooltip = connectionStatus ? i18n.t('Connected to ioBroker') : (connectionStatus === 'pending' ? i18n.t('Not connected to ioBroker! Reconnecting..') : i18n.t('Not connected to ioBroker! Connection failed!'));\r\n\t\r\n\treturn (\r\n\r\n<AppBar id=\"appBar\" position=\"static\" className={classes.appBar}>\r\n\r\n\t<Toolbar className={classes.toolbar}>\r\n\t\t\r\n\t\t<Typography variant=\"h6\" className={classes.title}>\r\n\t\t\t{icon && <span className={clsx(classes.icon, 'mdi mdi-' + icon)}></span>}\r\n\t\t\t{label !== 'null' && label}\r\n\t\t</Typography>\r\n\t\t\r\n\t\t<Hidden smDown>\r\n\t\t\t<IconButton color=\"inherit\" onClick={() => navigate('logs')}>\r\n\t\t\t\t<Tooltip title={i18n.t(connectionStatusTooltip)}>\r\n\t\t\t\t\t<span className={\"mdi mdi-\" + connectionStatusIcon}></span>\r\n\t\t\t\t</Tooltip>\r\n\t\t\t</IconButton>\r\n\t\t\t<IconButton color=\"inherit\" onClick={() => navigate('configuration')}>\r\n\t\t\t\t<SettingsIcon />\r\n\t\t\t</IconButton>\r\n\t\t</Hidden>\r\n\t\t\r\n\t\t{/*\r\n\t\t<IconButton color=\"inherit\" onClick={() => toggleDrawer('notificationDrawer', true)}>\r\n\t\t\t<Badge badgeContent={notifications} color=\"secondary\">\r\n\t\t\t\t<NotificationsIcon />\r\n\t\t\t</Badge>\r\n\t\t</IconButton>\r\n\t\t*/}\r\n\t\t\r\n\t</Toolbar>\r\n\t\r\n\t{children}\r\n</AppBar>\r\n\r\n\t);\r\n}\r\n","/*\r\n * by QoP <https://stackoverflow.com/users/4484822/qop>\r\n * @see https://stackoverflow.com/questions/36862334/get-viewport-window-height-in-reactjs\r\n */\r\nimport { useState, useEffect } from 'react';\r\n\r\nfunction getWindowDimensions() {\r\n  const { innerWidth: width, innerHeight: height } = window;\r\n  return {\r\n    width,\r\n    height\r\n  };\r\n}\r\n\r\nexport default function useWindowDimensions() {\r\n  const [windowDimensions, setWindowDimensions] = useState(getWindowDimensions());\r\n\r\n  useEffect(() => {\r\n    function handleResize() {\r\n      setWindowDimensions(getWindowDimensions());\r\n    }\r\n\r\n    window.addEventListener('resize', handleResize);\r\n    return () => window.removeEventListener('resize', handleResize);\r\n  }, []);\r\n\r\n  return windowDimensions;\r\n}\r\n","import React, { useState, useEffect, useRef, useCallback } from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport Settings from '../Settings'\r\nimport useWindowDimensions from '../helpers/useWindowDimensions'\r\n\r\nimport Tabs from '@material-ui/core/Tabs'\r\nimport Tab from '@material-ui/core/Tab'\r\nimport Box from '@material-ui/core/Box'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\ticon: {\r\n\t\t...theme.components.icon,\r\n\t\tcolor: '#fff',\r\n\t\tpaddingBottom: '6px',\r\n\t\twidth: '1em',\r\n\t\theight: '1em',\r\n\t\tdisplay: 'inline-block',\r\n\t\tfontSize: '1.5rem',\r\n\t\ttransition: 'fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\r\n\t\tflexShrink: 0,\r\n\t\tuserSelect: 'none'\r\n\t},\r\n\ttabs: {\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t\tpaddingLeft: theme.spacing(),\r\n\t\tcolor: '#fff',\r\n\t\twidth: 'calc(100% - ' + theme.spacing() + 'px)',\r\n\t\tzIndex: 101,\r\n\t\tborderBottom: '5px solid #eee'\r\n\t},\r\n\tfixed: {\r\n\t\tposition: 'fixed',\r\n\t\ttop: 0\r\n\t},\r\n\tindicator: {\r\n\t\tbackgroundColor: '#fff',\r\n\t},\r\n\tfullscreen: {\r\n\t\tmarginLeft: -theme.spacing(),\r\n\t\tmarginTop: '-5px',\r\n\t},\r\n\tgrid: {\r\n\t\tpaddingBottom: '30px'\r\n\t}\r\n}));\r\n\r\n\r\nexport default function TabBar(props) {\r\n\tlet { tabs, selectedTab, onSelectTab } = props;\r\n\tconst classes = useStyles();\r\n\tlet tabBarProps = useRef({});\r\n\t\r\n\t// tab\r\n\tconst [tab, setTab] = useState(selectedTab);\r\n\tconst handleChange = (event, tab) => {\r\n\t\tonSelectTab(tab);\r\n\t\tsetTab(tab);\r\n\t}\r\n\t\r\n\t// scroll\r\n\tconst [fixed, setFixed] = useState(false);\r\n\tconst handleScroll = useCallback(() => {\r\n\t\tconst threshold = (tabBarProps.current.top + tabBarProps.current.height - 53);\r\n\t\tconst fixed = window.scrollY >= threshold;\r\n\t\t\r\n\t\tsetFixed(prevFixed => {\r\n\t\t\tif (prevFixed !== fixed) {\r\n\t\t\t\tdocument.getElementById('root').style.paddingTop = fixed ? (threshold-5-8) + 'px' : 0;\r\n\t\t\t\treturn fixed;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn prevFixed;\r\n\t\t});\r\n\t\t\r\n\t}, [tabBarProps]);\r\n\r\n\tuseEffect(() => {\r\n\t\tsetTab(selectedTab);\r\n\t}, [selectedTab]);\r\n\t\r\n\tuseEffect(() => {\r\n\t\ttabBarProps.current = {\r\n\t\t\ttop: document.getElementById('tabBar').offsetTop,\r\n\t\t\theight: document.getElementById('tabBar').offsetHeight\r\n\t\t}\r\n\t\t\r\n\t\twindow.addEventListener('scroll', handleScroll);\r\n\t\treturn () => window.removeEventListener('scroll', handleScroll, 0);\r\n\t\t\r\n\t}, [handleScroll]);\r\n\t\r\n\t// render tabs\r\n\tconst renderedTabs = tabs.map((tab, i) => {\r\n\t\tconst [ icon, label ] = tab.indexOf('|') > -1 ? tab.split('|') : [ null, tab ];\r\n\t\treturn <Tab key={'tab' + i} icon={<span className={clsx(classes.icon, 'mdi mdi-' + icon)}></span>} label={!fixed && Settings.getSetting('tabsHideLabels') !== true && label !== 'null' ? label : null} />\r\n\t});\r\n\t\r\n\treturn (\r\n\r\n<Tabs\r\n\tid=\"tabBar\"\r\n\tvalue={tab}\r\n\tonChange={handleChange}\r\n\tvariant=\"scrollable\"\r\n\tclasses={{\r\n\t\troot: clsx(classes.tabs, fixed && classes.fixed),\r\n\t\tindicator: classes.indicator\r\n\t}}>\r\n\t\r\n\t{renderedTabs}\r\n</Tabs>\r\n\r\n\t);\r\n}\r\n\r\n\r\nexport function TabPanel(props) {\r\n\tconst { children, selectedTab, renderedTab, fullscreen } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\t\r\n\t// get map height based on viewport\r\n\tconst { height } = useWindowDimensions();\r\n\tconst [mapHeight, setMapHeight] = useState(height);\r\n\tlet topBarHeight = useRef({});\r\n\t\r\n\tuseEffect(() => {\r\n\t\ttopBarHeight.current = document.getElementById('appBar').offsetHeight;\r\n\t\tsetMapHeight(height-topBarHeight.current+5);\r\n\t\t\r\n\t}, [height]);\r\n\t\r\n\t/*\r\n\t * Some components need to be visible upon loading, so proper initialise.\r\n\t * Due to the 'hidden' attribute though, they might be hidden.\r\n\t * This is a workaround to initially show everything for a short period of time and then hide according to tab settings.\r\n\t *\r\n\t */\r\n\tconst [hidden, setHidden] = useState(null);\r\n\tuseEffect(() => {\r\n\t\tsetTimeout(() => setHidden(selectedTab !== renderedTab), 10);\r\n\t\t\r\n\t}, [selectedTab, renderedTab]);\r\n\t\r\n\treturn (\r\n\r\n<Box\r\n\trole=\"tabpanel\"\r\n\thidden={hidden}\r\n\tid={'tabpanel-' + renderedTab}\r\n\tclassName={clsx(fullscreen ? classes.fullscreen : classes.grid)}\r\n\tstyle={{ height: mapHeight + 'px' }}\r\n\t>\r\n\t\r\n\t{children}\r\n</Box>\r\n\r\n\t);\r\n}\r\n","import React from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport i18n from '../i18n'\r\n\r\nimport Drawer from '@material-ui/core/Drawer'\r\nimport Divider from '@material-ui/core/Divider'\r\nimport List from '@material-ui/core/List'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tdrawer: {\r\n\t\twidth: 400\r\n\t}\r\n});\r\n\r\n\r\nclass Notifications extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {\r\n\t\t}\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { classes, notifications } = this.props;\r\n\t\t\r\n\t\treturn (\r\n\r\n<Drawer\r\n\tanchor=\"right\"\r\n\topen={this.props.open}\r\n\tonClose={() => this.props.toggleDrawer('notificationDrawer', false)}\r\n\tclasses={{\r\n\t\tpaper: classes.drawer\r\n\t}}\r\n\t>\r\n\t\r\n</Drawer>\r\n\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(Notifications);\r\n","import React from 'react'\r\n\r\nimport Log from '../Log'\r\nimport Connection from '../Connection'\r\nimport Device from '../Device'\r\n\r\nimport Button from '@material-ui/core/Button'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport MuiDialogTitle from '@material-ui/core/DialogTitle'\r\nimport MuiDialogContent from '@material-ui/core/DialogContent'\r\nimport MuiDialogActions from '@material-ui/core/DialogActions'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport CloseIcon from '@material-ui/icons/Close'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport Modules from '../modules'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\troot: {\r\n\t\tmargin: 0,\r\n\t\tpadding: theme.spacing(2),\r\n\t},\r\n\tcloseButton: {\r\n\t\tposition: 'absolute',\r\n\t\tright: theme.spacing(1),\r\n\t\ttop: theme.spacing(1),\r\n\t\tcolor: theme.palette.grey[500],\r\n\t},\r\n});\r\n\r\n\r\nconst DialogTitle = withStyles(styles)(props => {\r\n\tconst { children, classes, onClose, ...other } = props;\r\n\treturn (\r\n\r\n<MuiDialogTitle disableTypography className={classes.root} {...other}>\r\n\t<Typography variant=\"h6\">{children}</Typography>\r\n\t{onClose ? (\r\n\t<IconButton aria-label=\"close\" className={classes.closeButton} onClick={onClose}>\r\n\t\t<CloseIcon />\r\n\t</IconButton>\r\n\t) : null}\r\n</MuiDialogTitle>\r\n\r\n\t);\r\n});\r\n\r\nconst DialogContent = withStyles(theme => ({\r\n\troot: {\r\n\t\tpadding: theme.spacing(2),\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tpaddingLeft: theme.spacing(1)\r\n\t\t}\r\n\t},\r\n}))(MuiDialogContent);\r\n\r\nconst DialogActions = withStyles(theme => ({\r\n\troot: {\r\n\t\tmargin: 0,\r\n\t\tpadding: theme.spacing(1),\r\n\t},\r\n}))(MuiDialogActions);\r\n\r\n\r\nexport default class Popup extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {\r\n\t\t\tchildren: []\r\n\t\t};\r\n\t}\r\n\t\r\n\tcomponentDidUpdate(prevProps, prevState) {\r\n\t\t\r\n\t\tlet device = this.props.contents && this.props.contents.device;\r\n\t\tif (device.id && this.props.contents.ts !== prevProps.contents.ts) {\r\n\t\t\t\r\n\t\t\t// get from cache\r\n\t\t\tif (device.children.length) {\r\n\t\t\t\tLog._('Popup', [ 'Got ' + Object.keys(device.children).length + ' states for device ' + device.name + ' from cache.', device.children ]);\r\n\t\t\t\tthis.setState({ 'children': device.children }, () => this.forceUpdate());\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// retrieve new\r\n\t\t\telse {\r\n\t\t\t\t// loop through states and request status\r\n\t\t\t\tlet responses = [];\r\n\t\t\t\tlet children = [];\r\n\t\t\t\t\r\n\t\t\t\tfor (let stateKey in device.states) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (device.states[stateKey].state === undefined || device.options.hiddenStates.indexOf(stateKey) > -1) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet child = new Device({\r\n\t\t\t\t\t\t\t'parent': device,\r\n\t\t\t\t\t\t\t'id': device.id + '#' + stateKey,\r\n\t\t\t\t\t\t\t'name': device.name,\r\n\t\t\t\t\t\t\t'function': device.function,\r\n\t\t\t\t\t\t\t//'states': { [stateKey]: device.states[stateKey] },\r\n\t\t\t\t\t\t\t'states': device.states,\r\n\t\t\t\t\t\t\t'options': {\r\n\t\t\t\t\t\t\t\t...device.options,\r\n\t\t\t\t\t\t\t\t'primary': stateKey,\r\n\t\t\t\t\t\t\t\t'secondary': null,\r\n\t\t\t\t\t\t\t\t'divider': children.length !== 0,\r\n\t\t\t\t\t\t\t\t'subgroup': null,\r\n\t\t\t\t\t\t\t\t'subtitle': null\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tConnection.getConnection,\r\n\t\t\t\t\t\twindow.language\r\n\t\t\t\t\t);\r\n\t\t\t\t\t\r\n\t\t\t\t\t// add child to parent\r\n\t\t\t\t\tdevice.children.push(child);\r\n\t\t\t\t\t\r\n\t\t\t\t\t// retrieve state\r\n\t\t\t\t\tresponses.push(child.requestDeviceState(null, true));\r\n\t\t\t\t\tchildren.push(child);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tPromise.allSettled(responses).then(() => {\r\n\t\t\t\t\tLog._('Popup', [ 'Retrieved ' + Object.keys(children).length + ' states for device ' + device.name + '.', children ]);\r\n\t\t\t\t\tthis.setState({ 'children': children }, () => this.forceUpdate());\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (!device.id && this.props.contents.ts !== prevProps.contents.ts) {\r\n\t\t\tthis.setState({ 'children': [] }, () => this.forceUpdate());\r\n\t\t}\r\n\t}\r\n\t\r\n\tshouldComponentUpdate(nextProps, nextState) {\r\n\t\treturn !this.props.contents || this.props.contents.ts !== nextProps.contents.ts;\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { open, closeDialog, contents } = this.props;\r\n\t\tconst { device } = contents;\r\n\t\t\r\n\t\treturn (\r\n\r\n<Dialog onClose={closeDialog} open={open || false} maxWidth={'md'} fullWidth={true}>\r\n\t<DialogTitle onClose={closeDialog}>\r\n\t\t{device.name}\r\n\t</DialogTitle>\r\n\t<DialogContent dividers style={{ padding: 0 }}>\r\n\t\t\r\n\t\t<Modules.StateList openDialog={null} devices={this.state.children} component={true} action={true} />\t\r\n\t\t\r\n\t</DialogContent>\r\n\t<DialogActions>\r\n\t\t<Button autoFocus onClick={closeDialog} color=\"primary\">\r\n\t\t\tClose\r\n\t\t</Button>\r\n\t</DialogActions>\r\n</Dialog>\r\n\r\n\t\t);\r\n\t};\r\n}\r\n","import React from 'react'\r\n\r\nimport Settings from '../Settings'\r\n\r\nimport Card from '@material-ui/core/Card'\r\nimport CardHeader from '@material-ui/core/CardHeader'\r\nimport CardContent from '@material-ui/core/CardContent'\r\nimport Avatar from '@material-ui/core/Avatar'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nconst useStyles = makeStyles(theme => ({\r\n\tcard: {\r\n\t\tmargin: theme.spacing(1, 1, 0, 0),\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tmargin: theme.spacing(0.4, 0.4, 0, 0)\r\n\t\t}\r\n\t},\r\n\tcardHeaderNoContents: {\r\n\t\tpadding: theme.spacing(),\r\n\t},\r\n\tcardAvatar: props => ({\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t\tcolor: '#fff',\r\n\t\tfontSize: '24px',\r\n\t\t...props\r\n\t}),\r\n\tcardContent: {\r\n\t\tpadding: theme.spacing(0, 2),\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tpadding: theme.spacing(0)\r\n\t\t}\r\n\t}\r\n}));\r\n\r\n\r\nexport default function Widget(props) {\r\n\tconst { title, icon, iconStyle } = props;\r\n\tconst classes = useStyles(iconStyle);\r\n\t\r\n\treturn (\r\n\r\n<Card className={classes.card}>\r\n\t<CardHeader\r\n\t\tavatar={icon !== null &&\r\n\t\t\t<Avatar variant=\"rounded\" classes={{ root: classes.cardAvatar }}>\r\n\t\t\t\t{React.createElement('span', { 'className': 'mdi mdi-' + (icon || Settings.getSetting('defaultBoxIcon') || 'home') })}\r\n\t\t\t</Avatar>\r\n\t\t}\r\n\t\ttitle={title &&\r\n\t\t\t<Typography variant=\"h5\" component=\"h2\">\r\n\t\t\t\t{title}\r\n\t\t\t</Typography>\r\n\t\t}\r\n\t/>\r\n\t<CardContent className={classes.cardContent}>\r\n\t\t{props.children}\r\n\t</CardContent>\r\n</Card>\r\n\r\n\t);\r\n}\r\n","import React from 'react'\r\n\r\nimport { DEFAULTS } from './config/config'\r\nimport Log from './Log'\r\nimport Connection from './Connection'\r\nimport Settings from './Settings'\r\n\r\nimport Hidden from '@material-ui/core/Hidden'\r\nimport { SwipeableViews } from '@tarragon/swipeable-tabs'\r\n\r\nimport Pages from './pages'\r\nimport TopBar from './components/TopBar'\r\nimport TabBar, { TabPanel } from './components/TabBar'\r\nimport Notifications from './components/Notifications'\r\nimport GridContainer from './components/GridContainer'\r\nimport Popup from './components/Popup'\r\nimport Widget from './components/Widget'\r\nimport Modules, { ModuleSettings } from './modules'\r\n\r\n\r\n/*\r\n *\r\n */\r\nconst getGroup = (groupId, group, props = {}) => {\r\n\t\r\n\t// group empty\r\n\tif (!group && ModuleSettings[group.settings.component].noDevicesAllowed !== true) {\r\n\t\tLog._('Jarvis', 'Group ' + groupId + ' defined in columns but not assigned to any devices!', 'error');\r\n\t\treturn null;\r\n\t}\r\n\t\r\n\t// get module for component\r\n\tconst Tag = Modules[group.settings.component || 'StateList'];\r\n\t\r\n\t// get tag\r\n\tif (Tag === undefined) {\r\n\t\tLog._('Jarvis', 'Undefined component \"' + group.settings.component + '\" used!', 'error');\r\n\t\treturn null;\r\n\t}\r\n\t\r\n\treturn <Tag key={'Tag' + groupId} devices={group.devices} openDialog={props.action ? props.action : null} settings={{ ...group.settings, ...props }} />\r\n}\r\n\r\n\r\n/*\r\n *\r\n */\r\nconst getGridContents = (contents, groups, props = {}) => {\r\n\t\r\n\tlet gridContents = {};\r\n\tconst columns = Object.keys(contents).length;\r\n\t\r\n\tfor (let column = 1; column <= columns; column++) {\r\n\t\t\r\n\t\tlet columnContents = contents[column];\r\n\t\tgridContents[column] = gridContents[column] || [];\r\n\t\t\r\n\t\t// no contents, thus add placeholder\r\n\t\tif (!columnContents || !Object.keys(columnContents).length) {\r\n\t\t\tgridContents[column].push(null);\r\n\t\t}\r\n\t\t\r\n\t\t// add contents\r\n\t\telse {\r\n\t\t\tfor (let groupId in columnContents) {\r\n\t\t\t\t\r\n\t\t\t\tlet group = groups[groupId] || {};\r\n\t\t\t\tgroup.devices = group.devices || [];\r\n\t\t\t\tgroup.settings = columnContents[groupId] || {};\r\n\t\t\t\tlet moduleSettings = ModuleSettings[group.settings.component] || {};\r\n\t\t\t\t\r\n\t\t\t\tlet content = getGroup(groupId, group, props);\r\n\t\t\t\tif ((group.devices.length > 0 || moduleSettings.noDevicesAllowed) && content) {\r\n\t\t\t\t\tgridContents[column].push(\r\n\t\t\t\t\t\t<Widget\r\n\t\t\t\t\t\t\tkey={'Box-' + groupId}\r\n\t\t\t\t\t\t\ttitle={group.settings.title === null ? null : (group.settings.title || group.name || moduleSettings.title)}\r\n\t\t\t\t\t\t\ticon={group.settings.icon === null ? null : (group.settings.icon || moduleSettings.icon)}\r\n\t\t\t\t\t\t\ticonStyle={group.settings.iconStyle}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t{content}\r\n\t\t\t\t\t\t</Widget>\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn gridContents;\r\n}\r\n\r\n\r\nexport default class Jarvis extends React.Component {\r\n\t\r\n    constructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {\r\n\t\t\tconnectionStatus: this.props.connectionStatus || false,\r\n\t\t\t\r\n\t\t\tselectedTab: 0,\r\n\t\t\ttabTitle: '',\r\n\t\t\t\r\n\t\t\tpage: 'home',\r\n\t\t\t\r\n\t\t\tnotificationDrawer: false,\r\n\t\t\tnotifications: [],\r\n\t\t\tnotificationsUnread: 0,\r\n\t\t\t\r\n\t\t\tdevices: this.props.devices,\r\n\t\t\t\r\n\t\t\tdialog: false,\r\n\t\t\tdialogContents: {\r\n\t\t\t\t'ts': 0,\r\n\t\t\t\t'device': {}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// bind methods\r\n\t\tthis.closeDialog = this.closeDialog.bind(this);\r\n\t\tthis.openDialog = this.openDialog.bind(this);\r\n\t\tthis.onSelectTab = this.onSelectTab.bind(this);\r\n\t\tthis.toggleDrawer = this.toggleDrawer.bind(this);\r\n\t\tthis.navigate = this.navigate.bind(this);\r\n\t\t\r\n\t\t// get connection\r\n\t\tthis.socket = Connection.getConnection;\r\n\t\t\r\n\t\t// initialise\r\n\t\tthis.gridContents = {};\r\n\t\tthis.layout = Settings.getSetting('layout');\r\n\t\tthis.tabs = Object.keys(this.layout);\r\n\t\tthis.tabsEnabled = Number.isNaN(parseInt(this.tabs[0]));\r\n\t\tthis.state.tabTitle = this.tabs[this.state.selectedTab];\r\n\t\t\r\n\t\t// no tabs defined, so layout wrap into default tab\r\n\t\tif (!this.tabsEnabled) {\r\n\t\t\tthis.layout = { 'Home': this.layout };\r\n\t\t\tthis.tabs.push('1');\r\n\t\t}\r\n\t\t\r\n\t\t// widget props\r\n\t\tthis.widgetProps = {}\r\n\t}\r\n\t\r\n\tcomponentDidMount() {\r\n\t\t\r\n\t\t// check if devices and settings are defined\r\n\t\tif (Object.keys(this.props.devices).length === 0 || Settings.getSetting('layout') === '') {\r\n\t\t\tthis.navigate('configuration');\r\n\t\t}\r\n\t\t\r\n\t\t// get notifications\r\n\t\tthis.socket.getState('jarvis.0.notifications').then(notifications => {\r\n\t\t\tnotifications = (notifications && notifications.val && JSON.parse(notifications.val)) || [];\r\n\t\t\t\r\n\t\t\tthis.setState({\r\n\t\t\t\tnotificationsUnread: notifications.filter(notification => !notification.unread || notification.unread !== false).length,\r\n\t\t\t\tnotifications: notifications\r\n\t\t\t});\r\n\t\t});\r\n\t\t\r\n\t\tthis.socket.subscribeState(DEFAULTS.NODE_NOTIFICATIONS, notifications => Log._('Jarvis', notifications));\r\n\t}\r\n\t\r\n\tgetTabPanels() {\r\n\t\t\r\n\t\tlet tabIndex = 0;\r\n\t\tlet tabPanels = [];\r\n\t\tfor (let tabLabel in this.layout) {\r\n\t\t\tconst contents = this.layout[tabLabel];\r\n\t\t\t\r\n\t\t\t// fullscreen in component\r\n\t\t\tconst groupId = Object.keys(contents)[0];\r\n\t\t\tconst fullscreen = Number.isNaN(parseInt(groupId));\r\n\t\t\t\r\n\t\t\tif (!this.gridContents[tabLabel] && fullscreen) {\r\n\t\t\t\tthis.gridContents[tabLabel] = getGroup(contents, { ...this.props.groups[groupId], settings: contents[groupId] || {} }, { action: this.openDialog, ...this.widgetProps });\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// grid layout\r\n\t\t\telse if (!this.gridContents[tabLabel]) {\r\n\t\t\t\tthis.gridContents[tabLabel] = <GridContainer contents={getGridContents(contents, this.props.groups, { action: this.openDialog, ...this.widgetProps })} />\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tconst tabPanel = (\r\n\t\t\t\t<TabPanel key={'tabPanel-' + tabIndex} renderedTab={tabIndex} selectedTab={this.state.selectedTab} fullscreen={fullscreen}>\r\n\t\t\t\t\t{this.gridContents[tabLabel]}\r\n\t\t\t\t</TabPanel>\r\n\t\t\t);\r\n\t\t\t\r\n\t\t\ttabPanels.push(tabPanel);\r\n\t\t\ttabIndex++;\r\n\t\t}\r\n\t\t\r\n\t\treturn tabPanels;\r\n\t}\r\n\t\r\n\tcloseDialog() {\r\n\t\tthis.setState({ 'dialog': false, 'dialogContents': { 'ts': Date.now(), 'device': {} } });\r\n\t}\r\n\t\r\n\topenDialog(device) {\r\n\t\tthis.setState({ 'dialog': true, 'dialogContents': { 'ts': Date.now(), 'device': device } });\r\n\t}\r\n\t\r\n\tonSelectTab(tab) {\r\n\t\tthis.setState({ selectedTab: tab, tabTitle: this.tabs[tab] });\r\n\t}\r\n\t\r\n\ttoggleDrawer(drawer, open) {\r\n\t\tthis.setState({ [drawer]: open });\r\n\t}\r\n\t\r\n\tnavigate(page) {\r\n\t\tthis.setState({ page });\r\n\t}\r\n\t\r\n    render() {\r\n\t\tlet Page = Pages[this.state.page] || null;\r\n\t\t\r\n\t\tconst tabPanels = this.getTabPanels();\r\n        return (\r\n\r\n<React.Fragment>\r\n\t<TopBar\r\n\t\ttitle={Settings.topBarTitle || (this.tabsEnabled && this.state.tabTitle) || Settings.getSetting('pageTitle') || 'jarvis - Smart Home Overview'}\r\n\t\tconnectionStatus={this.state.connectionStatus}\r\n\t\ttoggleDrawer={this.toggleDrawer}\r\n\t\tnavigate={this.navigate}\r\n\t\tnotifications={this.state.notificationsUnread}\r\n\t\t>\r\n\t\t\r\n\t\t{this.tabsEnabled && <TabBar tabs={this.tabs} selectedTab={this.state.selectedTab} onSelectTab={this.onSelectTab} />}\r\n\t</TopBar>\r\n\t\r\n\t\r\n\t{/* DRAWER: NOTIFICATIONS */}\r\n\t<Notifications\r\n\t\topen={this.state.notificationDrawer}\r\n\t\ttoggleDrawer={this.toggleDrawer}\r\n\t\tnotifications={this.state.notifications}\r\n\t\t/>\r\n\t\r\n\t\r\n\t{/* PAGE */}\r\n\t{Page && <Page\r\n\t\tpage={this.state.page}\r\n\t\tnavigate={this.navigate}\r\n\t\tdevices={this.state.devices}\r\n\t\t/>}\r\n\t\r\n\t\r\n\t{/* POPUP */}\r\n\t<Popup\r\n\t\topen={this.state.dialog}\r\n\t\tcontents={this.state.dialogContents}\r\n\t\tcloseDialog={this.closeDialog}\r\n\t\t/>\r\n\t\r\n\t\r\n\t{/* TABS */}\r\n\t<Hidden smUp>\r\n\t<SwipeableViews\r\n\t\tviews={tabPanels}\r\n\t\tselectedView={this.state.selectedTab}\r\n\t\tonSwipe={this.onSelectTab}\r\n\t\t/>\r\n\t</Hidden>\r\n\t<Hidden smDown>\r\n\t\t{tabPanels}\r\n\t</Hidden>\r\n\t\r\n</React.Fragment>\r\n\r\n\t\t)\r\n\t}\r\n}\r\n","import React from 'react'\r\n\r\nimport { DEFAULTS } from './config/config'\r\n\r\nimport Grid from '@material-ui/core/Grid'\r\nimport CircularProgress from '@material-ui/core/CircularProgress'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport Skeleton from '@material-ui/lab/Skeleton'\r\n\r\nimport GridContainer from './components/GridContainer'\r\nimport StatusSnackbar from './components/StatusSnackbar'\r\n\r\nimport config from './config/config.dev.js'\r\nimport Log from './Log'\r\nimport i18n from './i18n'\r\nimport Connection from './Connection'\r\nimport Settings from './Settings'\r\nimport Device from './Device'\r\nimport Jarvis from './Jarvis'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { ThemeProvider, withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tloading: {\r\n\t\tmargin: '10px 0 0 0',\r\n\t\tcolor: '#999'\r\n\t},\r\n\tgridItem: {\r\n\t\tmargin: theme.spacing(1, 1, 0, 0),\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tmarginRight: theme.spacing(0.4, 0.4, 0, 0)\r\n\t\t}\r\n\t}\r\n});\r\n\r\n\r\n/*\r\n * CONSTANTS\r\n *\r\n */\r\nclass App extends React.Component {\r\n\t\r\n    constructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {\r\n\t\t\tloaded: [],\r\n\t\t\tconnected: false,\r\n\t\t\terror: false,\r\n\t\t\terrorMessage: '',\r\n\t\t\t\r\n\t\t\ttheme: null\r\n\t\t}\r\n\t}\r\n\t\r\n\tcomponentDidMount() {\r\n\t\t\r\n\t\t// connect and get connection\r\n\t\tconst errorHandler = err => {\r\n\t\t\tLog._('App', i18n.t('Socket disconnected') + '!', 'error', true, err.stack);\r\n\t\t\tthis.setState({ connected: false, error: true, errorMessage: i18n.t(typeof err === 'string' ? err : err.message) + '..' });\r\n\t\t\t\r\n\t\t\tsetTimeout(function reconnect() {\r\n\t\t\t\t\r\n\t\t\t\tLog._('App', i18n.t('Attempting reconnect') + '..');\r\n\t\t\t\tConnection.reconnect();\r\n\t\t\t\tsetTimeout(() => reconnect, 15*1000);\r\n\t\t\t\t\r\n\t\t\t}, 10*1000);\r\n\t\t};\r\n\t\t\r\n\t\tconst url = window.location.port === '3000' ? config.iobrokerWebAdapterUrl :\r\n\t\t\twindow.location.protocol + '//' + window.location.hostname + (window.location.port ? ':' + window.location.port : '');\r\n\t\t\r\n\t\tconst listeners = [\r\n\t\t\t{ 'event': 'connect', 'callback': () => this.setState({ connected: true, error: false, errorMessage: '' }) },\r\n\t\t\t{ 'event': 'reconnect', 'callback': () => this.setState({ connected: 'pending', error: false, errorMessage: '' }) },\r\n\t\t\t{ 'event': 'disconnect', 'callback': errorHandler },\r\n\t\t\t{ 'event': 'error', 'callback': errorHandler }\r\n\t\t];\r\n\t\t\r\n\t\tLog._('App', i18n.t('Connect to') + ' ' + url + '...');\r\n\t\tthis.socket = Connection.connect(url, listeners);\r\n\t\t\r\n\t\t// retrieve settings\r\n\t\tthis.settings = {};\r\n\t\tthis.socket.getState(DEFAULTS.NODE_SETTINGS)\r\n\t\t\t.then(state => {\r\n\t\t\t\t\r\n\t\t\t\ttry {\r\n\t\t\t\t\tif (state) {\r\n\t\t\t\t\t\tthis.settings = { ...this.settings, ...JSON.parse(state.val || {}) };\r\n\t\t\t\t\t\tSettings.setSettings(this.settings);\r\n\t\t\t\t\t\tSettings.applySettings();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst tab = Object.keys(this.settings.layout)[0];\r\n\t\t\t\t\tif (tab === undefined) {\r\n\t\t\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\t\t\tloaded: [ ...prevState.loaded, 'settings' ],\r\n\t\t\t\t\t\t\terror: true,\r\n\t\t\t\t\t\t\terrorMessage: i18n.t('Please create the configuration. See documentation.')\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tthis.setState(prevState => ({ loaded: [ ...prevState.loaded, 'settings' ] }));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tcatch(err) {\r\n\t\t\t\t\tLog._('App', 'GET_SETTINGS: ' + err.message, 'error');\r\n\t\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\t\tloaded: [ ...prevState.loaded, 'settings' ],\r\n\t\t\t\t\t\terror: true,\r\n\t\t\t\t\t\terrorMessage: i18n.t('Error parsing settings') + '!'\r\n\t\t\t\t\t}));\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.catch(err => {\r\n\t\t\t\tLog._('App', 'GET_SETTINGS: ' + err.message, 'error');\r\n\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\tloaded: [ ...prevState.loaded, 'settings' ],\r\n\t\t\t\t\terror: true,\r\n\t\t\t\t\terrorMessage: typeof err === 'string' ? i18n.t(err) : i18n.t(err.message)\r\n\t\t\t\t}));\r\n\t\t\t});\r\n\t\t\r\n\t\t// retrieve ioBroker config\r\n\t\tthis.settings.iobroker = {};\r\n\t\tthis.socket.getObject('system.config', (err, data) => {\r\n\t\t\tif (data && data.common) {\r\n\t\t\t\tthis.settings.iobroker = data.common;\r\n\t\t\t\tSettings.setSettings({ iobroker: this.settings.iobroker });\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\t// get theme\r\n\t\timport('./theme').then(theme => this.setState({ theme: theme.default }));\r\n\t\t\r\n\t\t// retrieve devices\r\n\t\tthis.devices = {};\r\n\t\tthis.groups = {};\r\n\t\t\r\n\t\tthis.socket.getState(DEFAULTS.NODE_DEVICES)\r\n\t\t\t.then(state => {\r\n\t\t\t\t\r\n\t\t\t\ttry {\r\n\t\t\t\t\tthis.devices = JSON.parse(state.val || {});\r\n\t\t\t\t\tthis.processDevices(this.devices).then(groups => {\r\n\t\t\t\t\t\tthis.groups = groups;\r\n\t\t\t\t\t\tthis.setState(prevState => ({ loaded: [ ...prevState.loaded, 'groups' ] }));\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tcatch(err) {\r\n\t\t\t\t\tLog._('App', 'GET_DEVICES: ' + err.message, 'error');\r\n\t\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\t\tloaded: [ ...prevState.loaded, 'groups' ],\r\n\t\t\t\t\t\terror: true,\r\n\t\t\t\t\t\terrorMessage: i18n.t('Error parsing devices') + '!'\r\n\t\t\t\t\t}));\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.catch(err => {\r\n\t\t\t\tLog._('App', 'GET_DEVICES: ' + err.message, 'error');\r\n\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\tloaded: [ ...prevState.loaded, 'groups' ],\r\n\t\t\t\t\terror: true,\r\n\t\t\t\t\terrorMessage: i18n.t('Socket failed while getting devices') + '!'\r\n\t\t\t\t}));\r\n\t\t\t});\r\n\t\t\r\n    }\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tgroupDevice(groups, device) {\r\n\t\t\r\n\t\t// add device to group(s)\r\n\t\tlet options = device.get('options');\r\n\t\toptions.group.forEach(group => {\r\n\t\t\t\r\n\t\t\tlet groupId = group.toLowerCase().replace(/ /g, '');\r\n\t\t\tif (!groups[groupId]) {\r\n\t\t\t\tgroups[groupId] = { 'id': groupId, 'name': group, 'devices': [device] };\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tgroups[groupId].devices.push(device);\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\treturn groups;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tprocessDevice(deviceProperties) {\r\n\t\t\r\n\t\tlet promises = [];\r\n\t\tlet device = null;\r\n\t\ttry {\r\n\t\t\tdevice = new Device(deviceProperties, this.socket);\r\n\t\t\t\r\n\t\t\t// request primary state value\r\n\t\t\tpromises.push(device.requestDeviceState(null, true));\r\n\t\t\t\r\n\t\t\t// request secondary state value\r\n\t\t\tif (device.secondaryStateKey) {\r\n\t\t\t\tpromises.push(device.requestDeviceState(device.secondaryStateKey, true));\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\t\tcatch(err) {\r\n\t\t\tLog._('App', err.message, 'warn');\r\n\t\t}\r\n\t\t\r\n\t\treturn new Promise(resolve => {\r\n\t\t\tPromise.allSettled(promises).then(results => {\r\n\t\t\t\t\r\n\t\t\t\tresults.forEach(result => {\r\n\t\t\t\t\tif (result.status === 'rejected') {\r\n\t\t\t\t\t\tLog._('App', result, 'error');\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tresolve(device);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tprocessDevices(deviceList) {\r\n\t\t\r\n\t\t// loop through all devices of in the device list\r\n\t\tlet promises = [];\r\n\t\tlet groups = {};\r\n\t\t\r\n\t\tlet devices = 0, groupedDevices = 0;\r\n\t\tfor (let deviceId in deviceList) {\r\n\t\t\tdevices++;\r\n\t\t\t\r\n\t\t\tdeviceList[deviceId].options = { ...deviceList[deviceId].options, ...deviceList[deviceId].jarvis }\r\n\t\t\tdelete deviceList[deviceId].jarvis;\r\n\t\t\t\r\n\t\t\tlet deviceProperties = { ...deviceList[deviceId], 'id': deviceId };\r\n\t\t\tpromises.push(new Promise((resolve, reject) => {\r\n\t\t\t\t\r\n\t\t\t\tthis.processDevice(deviceProperties).then(device => {\r\n\t\t\t\r\n\t\t\t\t\tif (device !== null) {\r\n\t\t\t\t\t\tgroupedDevices++;\r\n\t\t\t\t\t\tgroups = this.groupDevice(groups, device);\r\n\t\t\t\t\t\tresolve(deviceId);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\treject(deviceId);\r\n\t\t\t\t});\r\n\t\t\t}));\r\n\t\t\t\r\n\t\t\t// check states for own device settings\r\n\t\t\tfor (let stateKey in deviceProperties.states) {\r\n\t\t\t\t\r\n\t\t\t\tlet state = deviceProperties.states[stateKey];\r\n\t\t\t\tif (state && state.jarvis !== undefined) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tpromises.push(new Promise((resolve, reject) => {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tthis.processDevice({ ...deviceProperties, 'id': deviceId + '#' + stateKey, 'states': { [stateKey]: state }, 'options': state.jarvis }).then(device => {\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (device !== null) {\r\n\t\t\t\t\t\t\t\tgroupedDevices++;\r\n\t\t\t\t\t\t\t\tgroups = this.groupDevice(groups, device);\r\n\t\t\t\t\t\t\t\tresolve(deviceId);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\treject(deviceId);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}));\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn new Promise(resolve => Promise.allSettled(promises).then(res => {\r\n\t\t\t\r\n\t\t\t// sort groups\r\n\t\t\tfor (let groupId in groups) {\r\n\t\t\t\tgroups[groupId].devices.sort((item1, item2) => {\r\n\t\t\t\t\tif (item1.options.sort > item2.options.sort) return 1;\r\n\t\t\t\t\telse if (item2.options.sort > item1.options.sort) return -1;\r\n\t\t\t\t\telse return 0;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\r\n\t\t\t// return\r\n\t\t\tLog._('App', [ 'Processed ' + devices + ' devices. Added ' + groupedDevices + ' devices in ' + Object.keys(groups).length + ' groups.', res, groups ]);\r\n\t\t\tresolve(groups);\r\n\t\t}));\r\n\t}\r\n\t\r\n\trenderError(error) {\r\n\t\terror = error || this.state.errorMessage;\r\n\t\tLog._('App', error, 'error');\r\n\t\treturn (\r\n\r\n<StatusSnackbar\r\n\tkey={'StatusSnackbar'}\r\n\tvariant=\"error\"\r\n\tcloseButton={false}\r\n\tmessage={error.toString()}\r\n\t/>\r\n\r\n\t\t);\r\n\t}\r\n\t\r\n\trenderLoadingProgress() {\r\n\t\tconst { classes } = this.props;\r\n\t\treturn (\r\n\r\n<Grid\r\n\tkey=\"loadingProcess\"\r\n\tcontainer\r\n\tspacing={0}\r\n\tdirection=\"column\"\r\n\tjustify=\"center\"\r\n\talignItems=\"center\"\r\n\tstyle={{ minHeight: \"100vh\" }}\r\n\t>\r\n\r\n\t<CircularProgress />\r\n\t<Typography className={classes.loading}>{i18n.t('Retrieving settings')}...</Typography>\r\n\r\n</Grid>\r\n\r\n\t\t);\r\n\t}\r\n\t\r\n\trenderLoadingSkeleton(props) {\r\n\t\tconst { classes } = this.props;\r\n\t\tconst { topBar, tabBar, gridColumns } = props;\r\n\t\t\r\n\t\tconst SkeletonLoader = (props) => <Skeleton animation=\"wave\" variant=\"rect\" className={classes.gridItem} height={props.height} />;\r\n\t\t\r\n\t\tlet gridContents = {}\r\n\t\tfor (let column = 1; column <= gridColumns; column++) {\r\n\t\t\tgridContents[column] = gridContents[column] || [];\r\n\t\t\t\r\n\t\t\tlet loaders = Math.random() * (5 - 2) + 2;\r\n\t\t\tfor (let loader = 1; loader <= loaders; loader++) {\r\n\t\t\t\tgridContents[column].push(<SkeletonLoader key={column + '#' + loader} height={(Math.random() * (400 - 100) + 100)} />);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn (\r\n\r\n<React.Fragment>\r\n\t{topBar && <Skeleton animation=\"wave\" variant=\"rect\" height={64} />}\r\n\t{tabBar && <Skeleton animation=\"wave\" variant=\"rect\" height={48} />}\r\n\t<GridContainer key=\"loadingSkeleton\" contents={gridContents} />\r\n</React.Fragment>\r\n\r\n\t\t);\r\n\t}\r\n\t\r\n    render() {\r\n\t\t\r\n\t\t// error message\r\n\t\tconst error = this.state.error ? this.renderError() : null;\r\n\t\t\r\n\t\t// loading screens\r\n\t\tif (!error && this.state.loaded.indexOf('settings') === -1) {\r\n\t\t\treturn this.renderLoadingProgress();\r\n\t\t}\r\n\t\telse if (!error && this.state.loaded.indexOf('groups') === -1) {\r\n\t\t\tconst tab = Object.keys(this.settings.layout)[0];\r\n\t\t\treturn tab === undefined ? null : this.renderLoadingSkeleton({ topBar: true, tabBar: tab !== 1, gridColumns: (tab !== 1 ? Object.keys(this.settings.layout[tab]).length : tab.length) });\r\n\t\t}\r\n\t\t\r\n\t\t// App\r\n\t\telse {\r\n\t\t\tLog._('App', [ 'Connected:', this.state.connected ]);\r\n\t\t\treturn (\r\n\r\n<ThemeProvider theme={this.state.theme}>\r\n\t{error}\r\n\t\t{this.state.loaded.length === 2 && <Jarvis key=\"jarvis\" connectionStatus={this.state.connected} devices={this.devices} groups={this.groups} />}\r\n</ThemeProvider>\r\n\r\n\t\t\t)\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(App);\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' }\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import React from 'react'\r\nimport ReactDOM from 'react-dom'\r\n\r\nimport './index.css'\r\nimport App from './App'\r\nimport * as serviceWorker from './serviceWorker'\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n","import React, { useState } from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport i18n from '../i18n'\r\n\r\nimport Grid from '@material-ui/core/Grid'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\nimport Autocomplete from '@material-ui/lab/Autocomplete'\r\nimport InputButton from '@material-ui/core/Button'\r\nimport FormControl from '@material-ui/core/FormControl'\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel'\r\nimport FormHelperText from '@material-ui/core/FormHelperText'\r\nimport InputAdornment from '@material-ui/core/InputAdornment'\r\nimport InputLabel from '@material-ui/core/InputLabel'\r\nimport MenuItem from '@material-ui/core/MenuItem'\r\nimport Select from '@material-ui/core/Select'\r\nimport Switch from '@material-ui/core/Switch'\r\nimport TextField from '@material-ui/core/TextField'\r\n\r\nimport AddIcon from '@material-ui/icons/AddCircle'\r\nimport InfoIcon from '@material-ui/icons/Info'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nconst useStyles = makeStyles(theme => ({\r\n\tfullWidth: {\r\n\t\twidth: '100%',\r\n\t},\r\n\tFormControl: {\r\n\t\tdisplay: 'inline-flex',\r\n\t\twidth: 250,\r\n\t\tmarginLeft: theme.spacing(1),\r\n\t\tmarginRight: theme.spacing(1),\r\n\t\tpadding: '0 !important',\r\n\t},\r\n\tCustomFormControl: {\r\n\t},\r\n\tInputLabel: {\r\n\t\twidth: 330,\r\n\t},\r\n\tSwitch: {\r\n\t\tmarginTop: '10px'\r\n\t},\r\n\tSwitchSmall: {\r\n\t\tmarginTop: '2px'\r\n\t},\r\n\tSwitchInline: {\r\n\t\tmarginLeft: '5px'\r\n\t},\r\n\tTextInput: {\r\n\t},\r\n\tCustomTextInput: {\r\n\t},\r\n}));\r\n\r\n\r\nfunction InfoIconWrapper(props) {\r\n\tconst { children, id, info, link } = props;\r\n\tconst classes = useStyles(props);\r\n\t\r\n\tconst tooltip = link ? <><a target=\"_blank\" rel=\"noopener noreferrer\" href={link}><InfoIcon color=\"primary\" /></a></> : <InfoIcon color=\"primary\" />;\r\n\t\r\n\treturn (\r\n\r\n<Grid\r\n\tkey={'grid-' + id}\r\n\tclassName={clsx(classes.FormControl, classes.CustomFormControl)}\r\n\tcontainer\r\n\titem\r\n\t>\r\n\t\r\n\t{info && <Grid item style={{ width: 30 }}>\r\n\t\t<Tooltip title={i18n.t(info)}>\r\n\t\t\t{tooltip}\r\n\t\t</Tooltip>\r\n\t</Grid>}\r\n\t<Grid item style={{ width: info ? 250-30 : '100%' }}>\r\n\t\t{children}\r\n\t</Grid>\r\n</Grid>\r\n\r\n\t);\r\n}\r\n\r\nfunction Button(props) {\r\n\tconst { id, label, color, variant, disabled, startIcon, onClick } = props;\r\n\tconst classes = useStyles(props);\r\n\t\r\n\treturn (\r\n\r\n<InfoIconWrapper {...props}>\r\n\t<InputButton\r\n\t\tkey={id}\r\n\t\tclasses={{ root: classes.fullWidth }}\r\n\t\tvariant={variant || 'contained'}\r\n\t\tcolor={color || 'primary'}\r\n\t\tdisabled={disabled}\r\n\t\tstartIcon={startIcon || <AddIcon />}\r\n\t\tonClick={onClick}\r\n\t\t>\r\n\t\t\r\n\t\t{i18n.t(label)}\r\n\t</InputButton>\r\n</InfoIconWrapper>\r\n\r\n\t)\r\n}\r\n\r\n\r\nfunction TextAutoCompleteInput(props) {\r\n\tconst { id, val, autoCompleteValues, autoComplete, autoHighlight, onChange } = props;\r\n\t\r\n\t\r\n\tconst [value, setValue] = useState(val || '');\r\n\tconst handleItemChange = (event, val) => onChange(id, val);\r\n\tconst handleTextChange = (event, val) => {\r\n\t\tlet userInput = val || (event && event.target && event.target.value) || '';\r\n\t\tsetValue(userInput);\r\n\t}\r\n\t\r\n\treturn (\r\n\r\n<Autocomplete\r\n\tid={'TextFieldAutoComplete-' + id}\r\n\toptions={autoCompleteValues || []}\r\n\t\r\n\tvalue={value}\r\n\tonChange={handleTextChange}\r\n\tonInputChange={handleItemChange}\r\n\t\r\n\tautoComplete={autoComplete}\r\n\tautoHighlight={autoHighlight}\r\n\t\r\n\trenderInput={(params) => TextInput({ ...props, autoCompleteParams: params })}\r\n\t/>\r\n\r\n\t)\r\n}\r\n\r\n\r\nfunction TextInput(props) {\r\n\tconst { id, icon, label, type, val, required, error, autoFocus, shrink, autoCompleteParams, placeholder, helperText, onChange, disableUnderline, InputProps } = props;\r\n\tconst classes = useStyles(props);\r\n\t\r\n\t\r\n\tconst [value, setValue] = useState(val || '');\r\n\tconst handleTextChange = event => {\r\n\t\tlet userInput = (event && event.target && event.target.value) || '';\r\n\t\t\r\n\t\tsetValue(userInput);\r\n\t\tonChange(id, userInput);\r\n\t}\r\n\t\r\n\tlet InputType = 'text';\r\n\tif (type === 'NumberInput') {\r\n\t\tInputType = 'number';\r\n\t}\r\n\t\r\n\treturn (\r\n\r\n<InfoIconWrapper {...props}>\r\n\t<TextField\r\n\t\tkey={'TextField-' + id}\r\n\t\tclasses={{ root: clsx(classes.fullWidth, classes.TextInput, classes.CustomTextInput) }}\r\n\t\t\r\n\t\tlabel={i18n.t(label)}\r\n\t\ttype={InputType}\r\n\t\tplaceholder={placeholder || ''}\r\n\t\thelperText={helperText || ''}\r\n\t\tautoFocus={autoFocus}\r\n\t\t\r\n\t\tonChange={handleTextChange}\r\n\t\tvalue={value}\r\n\t\trequired={required}\r\n\t\terror={error}\r\n\t\t\r\n\t\tInputLabelProps={{\r\n\t\t\tshrink: shrink\r\n\t\t}}\r\n\t\t\r\n\t\tInputProps={{\r\n\t\t\tdisableUnderline: disableUnderline,\r\n\t\t\tstartAdornment: icon && (\r\n\t\t\t\t<InputAdornment position=\"start\">\r\n\t\t\t\t\t<span className={'mdi mdi-' + icon}></span>\r\n\t\t\t\t</InputAdornment>\r\n\t\t\t),\r\n\t\t\t...InputProps\r\n\t\t}}\r\n\t\t\r\n\t\t{...autoCompleteParams}\r\n\t\t/>\r\n\t\r\n</InfoIconWrapper>\r\n\r\n\t)\r\n}\r\n\r\n\r\nfunction NumberInput(props) {\r\n\treturn TextInput({ ...props, type: 'NumberInput' });\r\n}\r\n\r\n\r\nfunction SelectInput(props) {\r\n\tconst { id, label, options, val, helperText, onChange } = props;\r\n\tconst classes = useStyles(props);\r\n\t\r\n\tconst [value, setValue] = useState(val || '');\r\n\tconst handleSelectChange = event => {\r\n\t\tlet userInput = (event && event.target && event.target.value) || '';\r\n\t\t\r\n\t\tsetValue(userInput);\r\n\t\tonChange(id, userInput);\r\n\t}\r\n\t\r\n\tconst menuOptions = Object.keys(options || {}).map(option => <MenuItem key={'MenuItem-' + id + '-' + option} value={option}>{options[option]}</MenuItem>);\r\n\t\r\n\treturn (\r\n\r\n<InfoIconWrapper {...props}>\r\n\t<FormControl key={'FormControl-' + id}>\r\n\t\t<InputLabel>{i18n.t(label)}</InputLabel>\r\n\t\t<Select\r\n\t\t\tkey={'Select-' + id}\r\n\t\t\tclassName={classes.input}\r\n\t\t\tvalue={value}\r\n\t\t\tonChange={handleSelectChange}\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t{menuOptions}\r\n\t\t</Select>\r\n\t\t<FormHelperText>{helperText || ''}</FormHelperText>\r\n\t</FormControl>\r\n</InfoIconWrapper>\r\n\r\n\t)\r\n}\r\n\r\n\r\nfunction SwitchInlineInput(props) {\r\n\tconst { id, label, val, size, disabled, onChange } = props;\r\n\tconst classes = useStyles(props);\r\n\t\r\n\tconst [checked, setChecked] = useState(val || false);\r\n\tconst handleSwitchChange = event => {\r\n\t\tlet userInput = (event && event.target && event.target.checked) || false;\r\n\t\t\r\n\t\tsetChecked(userInput);\r\n\t\tonChange(id, userInput);\r\n\t}\r\n\t\r\n\treturn (\r\n\r\n<InfoIconWrapper {...props}>\r\n\t<FormControlLabel\r\n\t\tclasses={{ root: classes.SwitchInline }}\r\n\t\tlabel={i18n.t(label)}\r\n\t\tcontrol={<Switch\r\n\t\t\tclasses={{ root: size === 'small' ? classes.SwitchSmall : classes.Switch }}\r\n\t\t\tchecked={checked}\r\n\t\t\tdisabled={disabled}\r\n\t\t\tonChange={handleSwitchChange}\r\n\t\t\tsize={size} />}\r\n\t\t/>\r\n\t\t\r\n</InfoIconWrapper>\r\n\r\n\t)\r\n}\r\n\r\nfunction SwitchInput(props) {\r\n\tconst { id, label, val, size, disabled, onChange } = props;\r\n\tconst classes = useStyles(props);\r\n\t\r\n\tconst [checked, setChecked] = useState(val || false);\r\n\tconst handleSwitchChange = event => {\r\n\t\tlet userInput = (event && event.target && event.target.checked) || false;\r\n\t\t\r\n\t\tsetChecked(userInput);\r\n\t\tonChange(id, userInput);\r\n\t}\r\n\t\r\n\treturn (\r\n\r\n<InfoIconWrapper {...props}>\r\n\t<FormControl key={'FormControl-' + id}>\r\n\t\t<InputLabel classes={{ root: classes.InputLabel }} shrink={true}>{i18n.t(label)}</InputLabel>\r\n\t\t<Switch\r\n\t\t\tclasses={{ root: size === 'small' ? classes.SwitchSmall : classes.Switch }}\r\n\t\t\tchecked={checked}\r\n\t\t\tdisabled={disabled}\r\n\t\t\tonChange={handleSwitchChange}\r\n\t\t\tsize={size}\r\n\t\t\t/>\r\n\t\t\r\n\t</FormControl>\r\n</InfoIconWrapper>\r\n\r\n\t)\r\n}\r\n\r\n\r\nexport default {\r\n\tButton,\r\n\tNumberInput,\r\n\tSelectInput,\r\n\tSwitchInput,\r\n\tSwitchInlineInput,\r\n\tTextInput,\r\n\tTextAutoCompleteInput\r\n}\r\n","import React from 'react'\r\n//import clsx from 'clsx'\r\nimport { v4 as uuid } from 'uuid'\r\n\r\nimport { DEVICES_CONFIG, LAYOUT_CONFIG } from '../config/config'\r\nimport i18n from '../i18n'\r\n\r\nimport Button from '@material-ui/core/Button'\r\n\r\nimport Grid from '@material-ui/core/Grid'\r\nimport List from '@material-ui/core/List'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\n\r\nimport IconButton from '@material-ui/core/IconButton'\r\n\r\nimport TableBody from '@material-ui/core/TableBody'\r\nimport TableRow from '@material-ui/core/TableRow'\r\nimport TableCell from '@material-ui/core/TableCell'\r\n\r\nimport Divider from '@material-ui/core/Divider'\r\n\r\nimport AddIcon from '@material-ui/icons/AddCircle'\r\nimport EditIcon from '@material-ui/icons/Edit'\r\nimport CancelIcon from '@material-ui/icons/Block'\r\nimport SaveIcon from '@material-ui/icons/Check'\r\nimport DeleteIcon from '@material-ui/icons/Delete'\r\n\r\nimport EnhancedTable from '../components/EnhancedTable'\r\nimport Dialog from '../components/Dialog'\r\nimport Inputs from '../components/Inputs'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles'\r\nconst styles = theme => ({\r\n\tdeleteButton: {\r\n\t\tmarginTop: '25px'\r\n\t},\r\n\thr: {\r\n\t\tmargin: '10px 2px'\r\n\t},\r\n\tCustomTextInput: {\r\n\t\twidth: 150\r\n\t},\r\n\tTableCell: {\r\n\t\tverticalAlign: 'top',\r\n\t\tpadding: '5px 0'\r\n\t}\r\n});\r\n\r\n\r\nclass SettingsPage extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {\r\n\t\t\tpopup: false,\r\n\t\t\t\r\n\t\t\tselectedDevice: null,\r\n\t\t\tselectedKey: null,\r\n\t\t\t\r\n\t\t\tdevices: this.props.devices || {},\r\n\t\t\terrors: {}\r\n\t\t}\r\n\t\t\r\n\t\tthis.onChange = this.props.onChange;\r\n\t\tthis.groupEditor = {};\r\n\t}\r\n\t\r\n\t/**\r\n\t * \r\n\t */\r\n\t_addDevice = () => {\r\n\t\tlet deviceId = uuid();\r\n\t\t\r\n\t\tthis.setState(prevState => ({\r\n\t\t\tselectedDevice: deviceId,\r\n\t\t\tdevices: {\r\n\t\t\t\t[deviceId]: {\r\n\t\t\t\t\tname: '',\r\n\t\t\t\t\tfunction: '',\r\n\t\t\t\t\toptions: {},\r\n\t\t\t\t\tattributes: {},\r\n\t\t\t\t\tstates: {}\r\n\t\t\t\t},\r\n\t\t\t\t...prevState.devices\r\n\t\t\t}\r\n\t\t}));\r\n\t}\r\n\t\r\n\t/**\r\n\t * \r\n\t */\r\n\t_addKey = (deviceId, key, name) => {\r\n\t\tlet prevDevice = { ...this.state.devices[deviceId] }\r\n\t\tprevDevice[key] = prevDevice[key] || {};\r\n\t\tprevDevice[key][name.toLowerCase().replace(/ /g, '')] = key === 'states' ? {} : i18n.t('new ' + key.substr(0, key.length-1));\r\n\t\t\r\n\t\tthis.setState(prevState => ({\r\n\t\t\tdevices: {\r\n\t\t\t\t...prevState.devices,\r\n\t\t\t\t[deviceId]: prevDevice\r\n\t\t\t}\r\n\t\t}));\r\n\t}\r\n\t\r\n\t/**\r\n\t * \r\n\t */\r\n\t_cancelDevice = (deviceId, type, stateKey) => {\r\n\t\tthis.groupEditor = {};\r\n\t\tthis.setState({ selectedDevice: null });\r\n\t}\r\n\t\r\n\t/**\r\n\t * \r\n\t */\r\n\t_closePopup = action => {\r\n\t\t\r\n\t\tif (action === 'cancel') {\r\n\t\t\tthis.setState({ popup: false });\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlet errors = {};\r\n\t\t\t['device-key'].forEach(key => errors[key] = !this.groupEditor[key]);\r\n\t\t\t\r\n\t\t\tif (Object.values(errors).indexOf(true) > -1) {\r\n\t\t\t\tthis.setState(prevState => ({ errors: { ...prevState.errors, ...errors }}));\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\t...this._addKey(this.state.selectedDevice, this.state.selectedKey, this.groupEditor['device-key']),\r\n\t\t\t\t\tpopup: false\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * \r\n\t */\r\n\t_deleteDevice = (deviceId, type, stateKey) => {\r\n\t\t\r\n\t\t// delete key from states, options or attributes (type)\r\n\t\tif (type) {\r\n\t\t\tlet prevDevice = { ...this.state.devices[deviceId] }\r\n\t\t\tdelete prevDevice[type][stateKey];\r\n\t\t\t\r\n\t\t\t// delete from editor\r\n\t\t\tif ((';' + Object.keys(this.groupEditor).join(';')).indexOf(';' + type + '-' + stateKey + '-') > -1) {\r\n\t\t\t\t\r\n\t\t\t\tfor (const key in this.groupEditor) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (key.indexOf(type + '-' + stateKey + '-') > -1) {\r\n\t\t\t\t\t\tdelete this.groupEditor[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// delete from device\r\n\t\t\tthis.setState(prevState => ({\r\n\t\t\t\tdevices: {\r\n\t\t\t\t\t...prevState.devices,\r\n\t\t\t\t\t[deviceId]: {\r\n\t\t\t\t\t\toptions: {},\r\n\t\t\t\t\t\tattributes: {},\r\n\t\t\t\t\t\tstates: {},\r\n\t\t\t\t\t\t...prevState.devices[deviceId],\r\n\t\t\t\t\t\t[type]: prevDevice[type]\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}));\r\n\t\t}\r\n\t\t\r\n\t\t// delete device\r\n\t\telse {\r\n\t\t\tthis.groupEditor = {};\r\n\t\t\tlet prevDevices = { ...this.state.devices }\r\n\t\t\tdelete prevDevices[deviceId];\r\n\t\t\t\r\n\t\t\tthis.setState({ devices: prevDevices });\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * \r\n\t */\r\n\t_openPopup = (deviceId, key) => () => {\r\n\t\tthis.groupEditor['device-key'] = '';\r\n\t\tthis._saveDevice(deviceId);\r\n\t\t\r\n\t\tthis.setState({\r\n\t\t\tpopup: true,\r\n\t\t\tselectedDevice: deviceId,\r\n\t\t\tselectedKey: key\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * \r\n\t */\r\n\t_saveDevice = deviceId => {\r\n\t\tlet prevDevice = { ...this.state.devices[deviceId] }\r\n\t\t\r\n\t\tfor (const key in this.groupEditor) {\r\n\t\t\tconst [ type, stateKey, label ] = key.split('-');\r\n\t\t\tconst val = this.groupEditor[key];\r\n\t\t\t\r\n\t\t\tif (label) {\r\n\t\t\t\tprevDevice[type] = prevDevice[type] || {};\r\n\t\t\t\tprevDevice[type][stateKey][label] = val;\r\n\t\t\t}\r\n\t\t\telse if (!label && type === 'device' && stateKey !== 'key') {\r\n\t\t\t\tprevDevice[stateKey] = val;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tthis.setState(prevState => ({\r\n\t\t\tselectedDevice: null,\r\n\t\t\tselectedKey: null,\r\n\t\t\t\r\n\t\t\tdevices: {\r\n\t\t\t\t...prevState.devices,\r\n\t\t\t\t[deviceId]: prevDevice\r\n\t\t\t}\r\n\t\t}), () => this.onChange(this.state.devices));\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\trenderDeviceAttribute(deviceId, attribute) {\r\n\t\tconst { classes } = this.props;\r\n\t\t\r\n\t\treturn (\r\n\r\n<ListItem key={'AttributesListItem-' + attribute.key} dense>\r\n\t<ListItemIcon>\r\n\t\t<IconButton onClick={() => this._deleteDevice(deviceId, 'attributes', attribute.key)}>\r\n\t\t\t<DeleteIcon />\r\n\t\t</IconButton>\r\n\t</ListItemIcon>\r\n\t<ListItemText disableTypography>\r\n\t\t<Inputs.TextInput\r\n\t\t\tkey={'attributes-' + attribute.key}\r\n\t\t\tid={'attributes-' + attribute.key}\r\n\t\t\tonChange={(id, userInput) => this.groupEditor[id] = userInput}\r\n\t\t\tclasses={{ CustomTextInput: classes.hr }}\r\n\t\t\tshrink={true}\r\n\t\t\tlabel={attribute.key}\r\n\t\t\tval={attribute.val || ''}\r\n\t\t\t/>\r\n\t\t\t\r\n\t</ListItemText>\r\n</ListItem>\r\n\r\n\t\t);\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\trenderDeviceAttributes(deviceId, attributes) {\r\n\t\treturn Object.keys(attributes || {}).map(attributeKey => {\r\n\t\t\tlet attribute = attributes[attributeKey];\r\n\t\t\tattribute = typeof attribute === 'string' ? attribute : (Array.isArray(attribute) ? attribute.join(',') : JSON.stringify(attribute, null, 0));\r\n\t\t\treturn this.renderDeviceAttribute(deviceId, { val: attribute, key: attributeKey });\r\n\t\t});\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\trenderDeviceOption(deviceId, option) {\r\n\t\tconst { classes } = this.props;\r\n\t\t\r\n\t\treturn (\r\n\r\n<ListItem key={'JarvisListItem-' + option.key} dense>\r\n\t<ListItemIcon>\r\n\t\t<IconButton onClick={() => this._deleteDevice(deviceId, 'options', option.key)}>\r\n\t\t\t<DeleteIcon />\r\n\t\t</IconButton>\r\n\t</ListItemIcon>\r\n\t<ListItemText disableTypography>\r\n\t\t<Inputs.TextInput\r\n\t\t\tkey={'options-' + option.key}\r\n\t\t\tid={'options-' + option.key}\r\n\t\t\tonChange={(id, userInput) => this.groupEditor[id] = userInput}\r\n\t\t\tclasses={{ TextInput: classes.hr }}\r\n\t\t\tshrink={true}\r\n\t\t\tlabel={option.key}\r\n\t\t\tval={option.val || ''}\r\n\t\t\t/>\r\n\t\t\r\n\t</ListItemText>\r\n</ListItem>\r\n\r\n\t\t);\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\trenderDeviceOptions(deviceId, options) {\r\n\t\treturn Object.keys(options || {}).map(optionKey => {\r\n\t\t\tlet option = options[optionKey];\r\n\t\t\toption = typeof option === 'string' ? option : (Array.isArray(option) ? option.join(',') : JSON.stringify(option, null, 0));\r\n\t\t\t\r\n\t\t\tif (option === '' || option === '{}' || (Array.isArray(option) && option.length === 0)) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn this.renderDeviceOption(deviceId, { val: option, key: optionKey });\r\n\t\t});\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\trenderDeviceState(deviceId, state) {\r\n\t\tconst { classes } = this.props;\r\n\t\t\r\n\t\treturn (\r\n\r\n<React.Fragment key={'StatesListItemLabelFragment-' + state.key}>\r\n\t<ListItem key={'StatesListItemLabel-' + state.key} dense>\r\n\t\t<ListItemIcon>\r\n\t\t\t<IconButton size=\"small\" onClick={() => this._deleteDevice(deviceId, 'states', state.key)}>\r\n\t\t\t\t<DeleteIcon />\r\n\t\t\t</IconButton>\r\n\t\t</ListItemIcon>\r\n\t\t<ListItemText primary=<strong>{state.key}</strong> />\r\n\t\t\r\n\t</ListItem>\r\n\t<ListItem key={'StatesListItemInputs-' + state.key} dense divider>\r\n\t\t<ListItemText disableTypography>\r\n\t\t\t<Inputs.TextInput id={'states-' + state.key + '-label'} onChange={(id, userInput) => this.groupEditor[id] = userInput} classes={{ TextInput: classes.hr }} shrink={true} label=\"Label\" val={state.label || ''} />\r\n\t\t\t<Inputs.TextInput id={'states-' + state.key + '-state'} onChange={(id, userInput) => this.groupEditor[id] = userInput} classes={{ TextInput: classes.hr }} shrink={true} label=\"State\" val={!state.state || typeof state.state === 'string' ? (state.state || '') : state.state.node} />\r\n\t\t\t<Inputs.TextInput id={'states-' + state.key + '-action'} onChange={(id, userInput) => this.groupEditor[id] = userInput} classes={{ TextInput: classes.hr }} shrink={true} label=\"Action\" val={!state.action || typeof state.action === 'string' ? (state.action || '') : state.action.node} />\r\n\t\t</ListItemText>\r\n\t</ListItem>\r\n</React.Fragment>\r\n\r\n\t\t);\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\trenderDeviceStates(deviceId, states) {\r\n\t\treturn Object.keys(states || {}).map(stateKey => {\r\n\t\t\tlet state = states[stateKey];\r\n\t\t\tstate = typeof state === 'string' ? { 'state': state } : state;\r\n\t\t\treturn this.renderDeviceState(deviceId, { ...state, key: stateKey });\r\n\t\t});\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\trenderDevice(device) {\r\n\t\tconst { classes } = this.props;\r\n\t\t\r\n\t\tdevice.id = device.key;\r\n\t\tconst states = this.renderDeviceStates(device.id, device.states || {});\r\n\t\tconst jarvis = this.renderDeviceOptions(device.id, device.options || {});\r\n\t\tconst attributes = this.renderDeviceAttributes(device.id, device.attributes || {});\r\n\t\t\r\n\t\treturn (\r\n\r\n<TableRow\r\n\tkey={device.id + '-' + device.function}\r\n\trole=\"checkbox\"\r\n\ttabIndex={-1}\r\n\t>\r\n\t\r\n\t<TableCell padding=\"checkbox\" scope=\"row\" align=\"center\">\r\n\t\t<IconButton size=\"small\" onClick={() => this._saveDevice(device.id)}>\r\n\t\t\t<SaveIcon />\r\n\t\t</IconButton>\r\n\t\t<IconButton size=\"small\" onClick={() => this._cancelDevice(device.id)}>\r\n\t\t\t<CancelIcon />\r\n\t\t</IconButton>\r\n\t\t\r\n\t\t<IconButton size=\"small\" onClick={() => this._deleteDevice(device.id)} classes={{ root: classes.deleteButton }}>\r\n\t\t\t<DeleteIcon />\r\n\t\t</IconButton>\r\n\t</TableCell>\r\n\t\r\n\t<TableCell classes={{ root: classes.TableCell }}>\r\n\t\t<Inputs.TextInput\r\n\t\t\tclasses={{ CustomFormControl: classes.CustomTextInput, CustomTextInput: classes.CustomTextInput, TextInput: classes.hr }}\r\n\t\t\tkey=\"device-name\"\r\n\t\t\tid=\"device-name\"\r\n\t\t\tonChange={(id, userInput) => this.groupEditor[id] = userInput}\r\n\t\t\tlabel={i18n.t('Device')}\r\n\t\t\tval={device.name}\r\n\t\t\t/>\r\n\t\t\t\r\n\t</TableCell>\r\n\t\r\n\t<TableCell classes={{ root: classes.TableCell }}>\r\n\t\t<Inputs.TextInput\r\n\t\t\tclasses={{ CustomFormControl: classes.CustomTextInput, CustomTextInput: classes.CustomTextInput, TextInput: classes.hr }}\r\n\t\t\tkey=\"device-function\"\r\n\t\t\tid=\"device-function\"\r\n\t\t\tonChange={(id, userInput) => this.groupEditor[id] = userInput}\r\n\t\t\tlabel={i18n.t('Function')}\r\n\t\t\tval={device.function}\r\n\t\t\t/>\r\n\t\t\t\r\n\t</TableCell>\r\n\t\r\n\t{/* STATES */}\r\n\t<TableCell classes={{ root: classes.TableCell }}>\r\n\t\t<Grid container>\r\n\t\t\t<Grid item xs={12}>\r\n\t\t\t\t<Button onClick={this._openPopup(device.id, 'states')} startIcon={<AddIcon />}>{i18n.t('add new state')}</Button>\r\n\t\t\t</Grid>\r\n\t\t\t<List dense>\r\n\t\t\t\t{states}\r\n\t\t\t</List>\r\n\t\t</Grid>\r\n\t</TableCell>\r\n\t\r\n\t{/* JARVIS */}\r\n\t<TableCell classes={{ root: classes.TableCell }}>\r\n\t\t<Grid container>\r\n\t\t\t<Grid item xs={12}>\r\n\t\t\t\t<Button onClick={this._openPopup(device.id, 'options')} startIcon={<AddIcon />}>{i18n.t('add new option')}</Button>\r\n\t\t\t\t<Divider classes={{ root: classes.hr }} />\r\n\t\t\t</Grid>\r\n\t\t\t<Grid item xs={12}>\r\n\t\t\t\t<List dense>\r\n\t\t\t\t\t{jarvis}\r\n\t\t\t\t</List>\r\n\t\t\t</Grid>\r\n\t\t</Grid>\r\n\t</TableCell>\r\n\t\r\n\t{/* ATTRIBUTES */}\r\n\t<TableCell classes={{ root: classes.TableCell }}>\r\n\t\t<Grid container>\r\n\t\t\t<Grid item xs={12}>\r\n\t\t\t\t<Button onClick={this._openPopup(device.id, 'attributes')} startIcon={<AddIcon />}>{i18n.t('add new attribute')}</Button>\r\n\t\t\t\t<Divider classes={{ root: classes.hr }} />\r\n\t\t\t</Grid>\r\n\t\t\t<Grid item xs={12}>\r\n\t\t\t\t<List dense>\r\n\t\t\t\t\t{attributes}\r\n\t\t\t\t</List>\r\n\t\t\t</Grid>\r\n\t\t</Grid>\r\n\t</TableCell>\r\n\t\r\n</TableRow>\r\n\r\n\t\t)\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\trenderDevices(props) {\r\n\t\tconst { rows } = props;\r\n\t\t\r\n\t\treturn (\r\n\t\t\t<TableBody>\r\n\r\n\t\t\t{rows.map((row, index) => {\r\n\t\t\t\tlet options = Object.keys(row.options || {}).filter(optionKey => (row.options[optionKey] === '' || (Array.isArray(row.options[optionKey]) && row.options[optionKey].length === 0) || (typeof row.options[optionKey] === 'object' && Object.keys(row.options[optionKey]).length === 0)) === false).sort().join(', '); \r\n\t\t\t\tlet attributes = Object.keys(row.attributes || {}).sort().join(', ');\r\n\t\t\t\t\r\n\t\t\t\treturn this.state.selectedDevice === row.key ? this.renderDevice(row) :\r\n\t\t\t\t\r\n\t\t\t\t<TableRow key={'TableRow-' + index} hover tabIndex={-1} onClick={() => this.setState({ selectedDevice: row.key })}>\r\n\t\t\t\t\t<TableCell padding=\"checkbox\" scope=\"row\" align=\"center\">\r\n\t\t\t\t\t\t<IconButton size=\"small\" onClick={() => this.setState({ selectedDevice: row.key })}>\r\n\t\t\t\t\t\t\t<EditIcon />\r\n\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t</TableCell>\r\n\t\t\t\t\t<TableCell>{row.name}</TableCell>\r\n\t\t\t\t\t<TableCell>{row.function}</TableCell>\r\n\t\t\t\t\t<TableCell>{Object.keys(row.states || {}).join(', ')}</TableCell>\r\n\t\t\t\t\t<TableCell>{options.length > 30 ? options.substr(0,27) + '...' : options}</TableCell>\r\n\t\t\t\t\t<TableCell>{attributes.length > 15 ? attributes.substr(0,12) + '...' : attributes}</TableCell>\r\n\t\t\t\t</TableRow>\r\n\t\t\t\t\r\n\t\t\t})}\r\n\t\t\r\n\t\t\t</TableBody>\r\n\r\n\t\t);\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\trender() {\r\n\t\tconst devices = Object.keys(this.state.devices).map(deviceId => ({ ...this.state.devices[deviceId], key: deviceId }));\r\n\t\t\r\n\t\treturn (\r\n\r\n<React.Fragment>\r\n\t<EnhancedTable\r\n\t\ttitle=\"Devices\"\r\n\t\theadCells={[\r\n\t\t\t{ id: 'edit', width: '3%', disablePadding: true, label: '' },\r\n\t\t\t{ id: 'name', width: '10%', label: i18n.t('Name') },\r\n\t\t\t{ id: 'function', width: '10%', label: i18n.t('Function') },\r\n\t\t\t{ id: 'states', width: '50%', disablePadding: false, label: i18n.t('States') },\r\n\t\t\t{ id: 'jarvis', width: '14%', disablePadding: false, label: i18n.t('Jarvis') },\r\n\t\t\t{ id: 'attributes', width: '13%', disablePadding: false, label: i18n.t('Attributes') }\r\n\t\t]}\r\n\t\trows={devices}\r\n\t\t\r\n\t\tdefaultOrderBy=\"name\"\r\n\t\tselectable={false}\r\n\t\tsortable={true}\r\n\t\tstickyHeader\r\n\t\t\r\n\t\tCustomTableBody={props => this.renderDevices(props)}\r\n\t\ttoolbarRightActionButton={\r\n\t\t\t<Inputs.Button onClick={() => this._addDevice()} startIcon={<AddIcon />} disabled={this.state.selectedDevice !== null} label={i18n.t('add new device')} />\r\n\t\t}\r\n\t\t/>\r\n\t\t\r\n\t<Dialog\r\n\t\theader={i18n.t('Add new entry')}\r\n\t\tactions={[\r\n\t\t\t<Button key='action-cancel' onClick={() => this._closePopup('cancel')} color=\"secondary\">\r\n\t\t\t\t{i18n.t('Cancel')}\r\n\t\t\t</Button>,\r\n\t\t\t<Button key='action-save' onClick={() => this._closePopup('save')} color=\"primary\">\r\n\t\t\t\t{i18n.t('Ok')}\r\n\t\t\t</Button>\r\n\t\t]}\r\n\t\t\r\n\t\tmaxWidth={'lg'}\r\n\t\topen={this.state.popup}\r\n\t\tonClose={() => this._closePopup('cancel')}\r\n\t\t>\r\n\t\t\r\n\t\t<List>\r\n\t\t\t<ListItem divider>\r\n\t\t\t\t{this.state.selectedKey === 'options' ? <Inputs.TextAutoCompleteInput\r\n\t\t\t\t\tkey='device-key'\r\n\t\t\t\t\tid='device-key'\r\n\t\t\t\t\t{...LAYOUT_CONFIG.deviceKey}\r\n\t\t\t\t\t\r\n\t\t\t\t\tautoComplete\r\n\t\t\t\t\tautoHighlight\r\n\t\t\t\t\t\r\n\t\t\t\t\tonChange={(id, userInput) => this.groupEditor[id] = userInput}\r\n\t\t\t\t\tautoCompleteValues={Object.keys(DEVICES_CONFIG) || []}\r\n\t\t\t\t\t\r\n\t\t\t\t\trequired={true}\r\n\t\t\t\t\terror={this.state.errors['device-key']}\r\n\t\t\t\t\tautoFocus\r\n\t\t\t\t\t/>\r\n\t\t\t\t:\r\n\t\t\t\t\r\n\t\t\t\t<Inputs.TextInput\r\n\t\t\t\t\tkey='device-key'\r\n\t\t\t\t\tid='device-key'\r\n\t\t\t\t\t{...LAYOUT_CONFIG.deviceKey}\r\n\t\t\t\t\tonChange={(id, userInput) => this.groupEditor[id] = userInput}\r\n\t\t\t\t\trequired={true}\r\n\t\t\t\t\terror={this.state.errors['device-key']}\r\n\t\t\t\t\tautoFocus\r\n\t\t\t\t\t/>}\r\n\t\t\t\t\r\n\t\t\t</ListItem>\r\n\t\t</List>\r\n\t\t\r\n\t</Dialog>\r\n\t\r\n</React.Fragment>\r\n\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(SettingsPage);\r\n","import React from 'react'\r\n\r\nimport { DEFAULTS, LAYOUT_CONFIG } from '../config/config'\r\nimport i18n from '../i18n'\r\nimport { ModuleConfigurations } from '../modules/'\r\n\r\nimport Button from '@material-ui/core/Button'\r\nimport Grid from '@material-ui/core/Grid'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport List from '@material-ui/core/List'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport AddIcon from '@material-ui/icons/AddCircle'\r\nimport TabIcon from '@material-ui/icons/Tab'\r\nimport ArrowUpIcon from '@material-ui/icons/KeyboardArrowUp'\r\nimport ArrowDownIcon from '@material-ui/icons/KeyboardArrowDown'\r\nimport FullscreenIcon from '@material-ui/icons/Fullscreen'\r\nimport DeleteIcon from '@material-ui/icons/Delete'\r\n\r\nimport Dialog from '../components/Dialog'\r\nimport Inputs from '../components/Inputs'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles'\r\nconst styles = theme => ({\r\n\tdeleteButton: {\r\n\t\tmarginTop: '20px'\r\n\t},\r\n\ttabs: {\r\n\t\tmarginBottom: '10px'\r\n\t},\r\n\ttab: {\r\n\t\tpadding: theme.spacing(3, 2),\r\n\t},\r\n\ticonContainer: {\r\n\t\tflexDirection: 'column',\r\n\t\talignItems: 'center'\r\n\t},\r\n\tcolumnContainer: {\r\n\t\tmarginTop: theme.spacing(2),\r\n\t},\r\n\tcolumn: {\r\n\t\twidth: 250,\r\n\t\tmargin: theme.spacing(1, 1),\r\n\t\tborderRight: '1px solid rgba(0, 0, 0, 0.12)',\r\n\t\tborderLeft: '1px solid rgba(0, 0, 0, 0.12)',\r\n\t},\r\n\tDialogActions: {\r\n\t\tjustifyContent: 'initial'\r\n\t},\r\n\talignRight: {\r\n\t\tdisplay: 'flex',\r\n\t\tjustifyContent: 'flex-end'\r\n\t},\r\n\tListItemGutters: {\r\n\t\tpadding: '16px'\r\n\t}\r\n});\r\n\r\n\r\nclass LayoutsPage extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {\r\n\t\t\tpopup: false,\r\n\t\t\t\r\n\t\t\tselectedTab: null,\r\n\t\t\tselectedColumn: null,\r\n\t\t\tselectedGroup: {},\r\n\t\t\t\r\n\t\t\tlayout: this.props.layout,\r\n\t\t\tsettings: this.props.settings,\r\n\t\t\terrors: {}\r\n\t\t}\r\n\t\t\r\n\t\tthis.onChange = this.props.onChange;\r\n\t\tthis.groupEditor = {};\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\t_addColumn = (tabKey, newColumn) => {\r\n\t\t\r\n\t\tthis.setState(prevState => ({\r\n\t\t\tlayout: {\r\n\t\t\t\t...prevState.layout,\r\n\t\t\t\t[tabKey]: {\r\n\t\t\t\t\t...prevState.layout[tabKey],\r\n\t\t\t\t\t[newColumn]: {}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}), () => this.onChange(this.state.layout, this.state.settings));\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\t_addTab = () => {\r\n\t\tconst newTabIndex = Object.keys(this.state.layout).length+1;\r\n\t\tthis.setState(prevState => ({\r\n\t\t\tlayout: {\r\n\t\t\t\t...prevState.layout,\r\n\t\t\t\t['home|' + i18n.t('new tab') + ' ' + newTabIndex]: {\r\n\t\t\t\t\t1: {}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}), () => this.onChange(this.state.layout, this.state.settings));\r\n\t\t\r\n\t\tsetTimeout(() => window.location = '#tab-' + newTabIndex, 100);\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\t_changeTab = tabKey => (id, userInput) => {\r\n\t\t\r\n\t\t// edit tab icon / label\r\n\t\tif (id === 'tabIcon' || id === 'tabLabel') {\r\n\t\t\t\r\n\t\t\t// icon or label\r\n\t\t\tlet [ icon, label ] = tabKey.split('|');\r\n\t\t\tif (id === 'tabIcon') {\r\n\t\t\t\ticon = userInput;\r\n\t\t\t}\r\n\t\t\telse if (id === 'tabLabel') {\r\n\t\t\t\tlabel = userInput;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tlet layout = {}\r\n\t\t\tObject.keys(this.state.layout).forEach(tKey => {\r\n\t\t\t\tlayout[tKey === tabKey ? icon + '|' + label : tKey] = this.state.layout[tKey];\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tthis.setState({ layout: layout }, () => this.onChange(this.state.layout, this.state.settings));\r\n\t\t}\r\n\t\t\r\n\t\t// edit tab fullscreen option\r\n\t\telse if (id === 'tabFullscreen') {\r\n\t\t\tlet prevTab = { ...this.state.layout[tabKey] }\r\n\t\t\t\r\n\t\t\tif (userInput === true) {\r\n\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\tlayout: {\r\n\t\t\t\t\t\t...prevState.layout,\r\n\t\t\t\t\t\t[tabKey]: prevTab[1]\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t}), () => this.onChange(this.state.layout, this.state.settings));\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\tlayout: {\r\n\t\t\t\t\t\t...prevState.layout,\r\n\t\t\t\t\t\t[tabKey]: {\r\n\t\t\t\t\t\t\t1: prevTab\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t}), () => this.onChange(this.state.layout, this.state.settings));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\t_closePopup = action => {\r\n\t\t\r\n\t\tif (action === 'cancel') {\r\n\t\t\tthis.setState({ popup: false });\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\telse if (action === 'save') {\r\n\t\t\t\r\n\t\t\tlet tabKey = this.state.selectedTab;\r\n\t\t\tlet columnKey = this.state.selectedColumn;\r\n\t\t\tlet groupKey = this.state.selectedGroup.key;\r\n\t\t\t\r\n\t\t\t// errors\r\n\t\t\tconst requiredFields = [{ parameter: 'key', required: true }, { parameter: 'component', required: true }];\r\n\t\t\tlet errors = {};\r\n\t\t\t\r\n\t\t\t[ ...requiredFields, ...(ModuleConfigurations[this.state.selectedGroup.key] || []) ].forEach(field => {\r\n\t\t\t\terrors['input-group-' + field.parameter] = field.required === true && !this.groupEditor['input-group-' + field.parameter];\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tif (Object.values(errors).indexOf(true) > -1) {\r\n\t\t\t\tthis.setState(prevState => ({ errors: { ...prevState.errors, ...errors }}));\r\n\t\t\t\tconsole.error(errors, this.groupEditor);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tlet group = {};\r\n\t\t\tObject.keys(this.groupEditor).forEach(key => group[key.replace('input-group-', '')] = this.groupEditor[key]);\r\n\t\t\tgroup.key = group.key.toLowerCase().replace(/ /g, '');\r\n\t\t\t\r\n\t\t\t// edit group\r\n\t\t\tif (groupKey) {\r\n\t\t\t\t\r\n\t\t\t\tlet tabLayout = {}\r\n\t\t\t\tfor (let col = 1; col < Object.keys(this.state.layout[tabKey]).length; col++) {\r\n\t\t\t\t\ttabLayout[col] = this.state.layout[tabKey][col >= columnKey ? col+1 : col];\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tlet tabColumnGroups = {};\r\n\t\t\t\tObject.keys(this.state.layout[tabKey][columnKey]).forEach(componentKey => {\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (componentKey === groupKey) {\r\n\t\t\t\t\t\ttabColumnGroups[group.key] = { ...this.state.layout[tabKey][columnKey][componentKey], ...group }\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\ttabColumnGroups[componentKey] = this.state.layout[tabKey][columnKey][componentKey];\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tdelete tabColumnGroups[group.key].key;\r\n\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\tpopup: false,\r\n\t\t\t\t\tlayout: {\r\n\t\t\t\t\t\t...prevState.layout,\r\n\t\t\t\t\t\t[tabKey]: {\r\n\t\t\t\t\t\t\t...prevState.layout[tabKey],\r\n\t\t\t\t\t\t\t[columnKey]: tabColumnGroups\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t}), () => this.onChange(this.state.layout, this.state.settings));\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// new group\r\n\t\t\telse {\r\n\t\t\t\t\r\n\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\tpopup: false,\r\n\t\t\t\t\tlayout: {\r\n\t\t\t\t\t\t...prevState.layout,\r\n\t\t\t\t\t\t[tabKey]: {\r\n\t\t\t\t\t\t\t...prevState.layout[tabKey],\r\n\t\t\t\t\t\t\t[columnKey]: {\r\n\t\t\t\t\t\t\t\t...prevState.layout[tabKey][columnKey],\r\n\t\t\t\t\t\t\t\t[group.key]: group\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}), () => this.onChange(this.state.layout, this.state.settings));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\t_deleteColumn = (tabKey, columnKey) => {\r\n\t\t\r\n\t\tlet tabLayout = {}\r\n\t\tfor (let col = 1; col < Object.keys(this.state.layout[tabKey]).length; col++) {\r\n\t\t\ttabLayout[col] = this.state.layout[tabKey][col >= columnKey ? col+1 : col];\r\n\t\t}\r\n\t\t\r\n\t\tthis.setState(prevState => ({\r\n\t\t\tlayout: {\r\n\t\t\t\t...prevState.layout,\r\n\t\t\t\t[tabKey]: tabLayout\r\n\t\t\t}\r\n\t\t}));\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\t_deleteGroup = (tabKey, columnKey, groupKey) => {\r\n\t\t\r\n\t\tlet layout = { ...this.state.layout[tabKey][columnKey] }\r\n\t\tdelete layout[groupKey];\r\n\t\t\r\n\t\tthis.setState(prevState => ({\r\n\t\t\tpopup: false,\r\n\t\t\tlayout: {\r\n\t\t\t\t...prevState.layout,\r\n\t\t\t\t[tabKey]: {\r\n\t\t\t\t\t...prevState.layout[tabKey],\r\n\t\t\t\t\t[columnKey]: layout\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}), () => this.onChange(this.state.layout, this.state.settings));\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\t_deleteTab = tabKey => {\r\n\t\t\r\n\t\tlet layout = { ...this.state.layout }\r\n\t\tdelete layout[tabKey];\r\n\t\t\r\n\t\tthis.setState({ layout: layout }, () => this.onChange(this.state.layout, this.state.settings));\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\t_moveGroup = (action, tabKey, columnKey, componentKey) => event => {\r\n\t\tevent.stopPropagation();\r\n\t\t\r\n\t\tlet order = { ...this.state.layout[tabKey][columnKey] }\r\n\t\tlet sorted = false;\r\n\t\tlet sortedArray = Object.keys(order).sort((a, b) => {\r\n\t\t\t\r\n\t\t\tif (!sorted && ((action === 'up' && b === componentKey) || (action === 'down' && a === componentKey))) {\r\n\t\t\t\tsorted = true;\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn 0;\r\n\t\t});\r\n\t\t\r\n\t\tlet sortedObject = {}\r\n\t\tsortedArray.map(key => sortedObject[key] = order[key]);\r\n\t\t\r\n\t\tthis.setState(prevState => ({\r\n\t\t\tlayout: {\r\n\t\t\t\t...prevState.layout,\r\n\t\t\t\t[tabKey]: {\r\n\t\t\t\t\t...prevState.layout[tabKey],\r\n\t\t\t\t\t[columnKey]: sortedObject\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}), () => this.onChange(this.state.layout, this.state.settings));\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\t_moveTab = (action, tabKey) => event => {\r\n\t\tevent.stopPropagation();\r\n\t\t\r\n\t\tlet order = { ...this.state.layout }\r\n\t\tlet sorted = false;\r\n\t\tlet sortedArray = Object.keys(order).sort((a, b) => {\r\n\t\t\t\r\n\t\t\tif (!sorted && ((action === 'up' && b === tabKey) || (action === 'down' && a === tabKey))) {\r\n\t\t\t\tsorted = true;\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn 0;\r\n\t\t});\r\n\t\t\r\n\t\tlet sortedObject = {}\r\n\t\tsortedArray.map(key => sortedObject[key] = order[key]);\r\n\t\t\r\n\t\tthis.setState(prevState => ({\r\n\t\t\tsettings: {\r\n\t\t\t\t...prevState.settings,\r\n\t\t\t\t'layout': sortedObject\r\n\t\t\t}\r\n\t\t}), () => this.onChange(this.state.layout, this.state.settings));\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\t_openPopup = (tabKey, columnKey, group) => {\r\n\t\t\r\n\t\tlet states = {};\r\n\t\tObject.keys(group || {}).map(key => states['input-group-' + key] = group[key] || '');\r\n\t\tthis.groupEditor = states;\r\n\t\t\r\n\t\tthis.setState({\r\n\t\t\t...states,\r\n\t\t\tpopup: true,\r\n\t\t\terrors: {},\r\n\t\t\t\r\n\t\t\tselectedTab: tabKey,\r\n\t\t\tselectedColumn: columnKey,\r\n\t\t\tselectedGroup: group || {}\r\n\t\t});\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\trenderTabColumnGroup(tab, column, group) {\r\n\t\tconst { classes } = this.props;\r\n\t\t\r\n\t\treturn (\r\n\r\n<ListItem\r\n\tkey={'Tab-' + tab.key + '_Column-' + column.key + '_Component-' + group.key}\r\n\tonClick={() => this._openPopup(tab.key, column.key, group)}\r\n\tbutton\r\n\tdivider\r\n\t>\r\n\t\r\n\t{tab.fullscreen ?\r\n\t<ListItemIcon classes={{ root: classes.iconContainer }}>\r\n\t\t<FullscreenIcon />\r\n\t</ListItemIcon>\r\n\t\t:\r\n\t<ListItemIcon classes={{ root: classes.iconContainer }}>\r\n\t\t<React.Fragment>\r\n\t\t\t<IconButton size=\"small\" onClick={this._moveGroup('up', tab.key, column.key, group.key)}>\r\n\t\t\t\t<ArrowUpIcon />\r\n\t\t\t</IconButton>\r\n\t\t\t<IconButton size=\"small\" onClick={this._moveGroup('down', tab.key, column.key, group.key)}>\r\n\t\t\t\t<ArrowDownIcon />\r\n\t\t\t</IconButton>\r\n\t\t</React.Fragment>\r\n\t</ListItemIcon>\r\n\t}\r\n\t<ListItemText primary={\r\n\t\t<React.Fragment>\r\n\t\t\t<Typography display=\"block\">{group.key}</Typography>\r\n\t\t\t<Typography variant=\"subtitle2\">({group.name})</Typography>\r\n\t\t</React.Fragment>\r\n\t} />\r\n\t\r\n</ListItem>\r\n\r\n\t\t);\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\trenderTabColumns(tab, column) {\r\n\t\tconst { classes } = this.props;\r\n\t\t\r\n\t\t// components per tab\r\n\t\tlet tabColumnComponentsNodes = [];\r\n\t\t\r\n\t\tfor (let componentKey in column.entries) {\r\n\t\t\tlet component = { ...column.entries[componentKey], key: componentKey, name: (column.entries[componentKey] && column.entries[componentKey].component) || DEFAULTS.MODULE };\r\n\t\t\ttabColumnComponentsNodes.push(this.renderTabColumnGroup(tab, column, component));\r\n\t\t}\r\n\t\t\r\n\t\treturn (\r\n\r\n<Grid className={classes.column} key={'Tab-' + tab.key + '_Column-' + column.key} item>\r\n\t<List>\r\n\t\t<ListItem onClick={() => this._deleteColumn(tab.key, column.key)} button divider dense>\r\n\t\t\t<ListItemIcon classes={{ root: classes.iconContainer }}>\r\n\t\t\t\t<IconButton size=\"small\">\r\n\t\t\t\t\t<DeleteIcon />\r\n\t\t\t\t</IconButton>\r\n\t\t\t</ListItemIcon>\r\n\t\t\t<ListItemText primary={i18n.t('delete column')} />\r\n\t\t</ListItem>\r\n\t\t{(!tab.fullscreen || (tab.fullscreen && column.entries.length < 1))&& <ListItem onClick={() => this._openPopup(tab.key, column.key, null)} button divider dense>\r\n\t\t\t<ListItemIcon classes={{ root: classes.iconContainer }}>\r\n\t\t\t\t<IconButton size=\"small\">\r\n\t\t\t\t\t<AddIcon />\r\n\t\t\t\t</IconButton>\r\n\t\t\t</ListItemIcon>\r\n\t\t\t<ListItemText primary={i18n.t('add new group')} />\r\n\t\t</ListItem>}\r\n\t\t\r\n\t\t{tabColumnComponentsNodes}\r\n\t\t\r\n\t</List>\r\n</Grid>\r\n\r\n\t\t);\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\trenderTab(tab) {\r\n\t\tconst { classes } = this.props;\r\n\t\tconst [ tabIcon, tabLabel ] = tab.key.split('|');\r\n\t\ttab.fullscreen = Number.isNaN(parseInt(Object.keys(tab.entries)[0]));\r\n\t\t\r\n\t\t// columns per tab\r\n\t\tlet columns = Object.keys(tab.entries).length;\r\n\t\tlet groupsInFirstColumn = (tab.entries && tab.entries[1] && Object.keys(tab.entries[1]).length) || 0;\r\n\t\tlet tabColumnsNodes = [];\r\n\t\t\r\n\t\tfor (let columnKey = 1; columnKey < columns+1; columnKey++) {\r\n\t\t\tlet column = { entries: (tab.entries[columnKey] !== undefined ? tab.entries[columnKey] : tab.entries), key: columnKey }\r\n\t\t\ttabColumnsNodes.push(this.renderTabColumns(tab, column));\r\n\t\t}\r\n\t\t\r\n\t\treturn (\r\n\r\n<ListItem\r\n\tid={'tab-' + tab.index}\r\n\tdivider={tab.lastTab !== true} key={'Tab-' + tab.key}\r\n\tclasses={{ root: classes.tab }}\r\n\t>\r\n\t\r\n\t<ListItemIcon key={'Tab-' + tab.key + '-ListItemIcon'} classes={{ root: classes.iconContainer }}>\r\n\t\t<React.Fragment>\r\n\t\t\t<IconButton size=\"small\" onClick={this._moveTab('up', tab.key)}>\r\n\t\t\t\t<ArrowUpIcon />\r\n\t\t\t</IconButton>\r\n\t\t\t<IconButton size=\"small\" onClick={this._moveTab('down', tab.key)}>\r\n\t\t\t\t<ArrowDownIcon />\r\n\t\t\t</IconButton>\r\n\t\t\t<IconButton size=\"small\" onClick={() => this._deleteTab(tab.key)} classes={{ root: classes.deleteButton }}>\r\n\t\t\t\t<DeleteIcon />\r\n\t\t\t</IconButton>\r\n\t\t</React.Fragment>\r\n\t</ListItemIcon>\r\n\t<ListItemText\r\n\t\tdisableTypography={true}\r\n\t\tprimary={[\r\n\t\t\t<Inputs.TextInput\r\n\t\t\t\tkey='Input-tabIcon'\r\n\t\t\t\tid='tabIcon'\r\n\t\t\t\t{...LAYOUT_CONFIG.tabIcon}\r\n\t\t\t\tonChange={this._changeTab(tab.key)}\r\n\t\t\t\tval={tabIcon || ''}\r\n\t\t\t\ticon={tabIcon || ''}\r\n\t\t\t\t/>,\r\n\t\t\t\r\n\t\t\t<Inputs.TextInput\r\n\t\t\t\tkey='Input-tabLabel'\r\n\t\t\t\tid='tabLabel'\r\n\t\t\t\t{...LAYOUT_CONFIG.tabLabel}\r\n\t\t\t\tonChange={this._changeTab(tab.key)}\r\n\t\t\t\tval={tabLabel || ''}\r\n\t\t\t\t/>,\r\n\t\t\t\r\n\t\t\t<Inputs.Button\r\n\t\t\t\tkey='Input-addColumnToTab'\r\n\t\t\t\tid='Input-addColumnToTab'\r\n\t\t\t\tlabel='add new column'\r\n\t\t\t\tdisabled={tab.fullscreen}\r\n\t\t\t\tonClick={() => this._addColumn(tab.key, columns+1)}\r\n\t\t\t\t/>,\r\n\t\t\t\r\n\t\t\t<Inputs.SwitchInput\r\n\t\t\t\tkey='Input-tabFullscreen'\r\n\t\t\t\tid='tabFullscreen'\r\n\t\t\t\t{...LAYOUT_CONFIG.tabFullscreen}\r\n\t\t\t\tdisabled={(columns > 1 || groupsInFirstColumn > 1)}\r\n\t\t\t\tonChange={this._changeTab(tab.key)}\r\n\t\t\t\tval={tab.fullscreen}\r\n\t\t\t\t/>,\r\n\t\t\t\r\n\t\t\t<Grid\r\n\t\t\t\tkey={'Tab-' + tab.key + '-ColumnContainer'}\r\n\t\t\t\tclasses={{ root: classes.columnContainer }}\r\n\t\t\t\tcontainer\r\n\t\t\t\t>\r\n\t\t\t\t\r\n\t\t\t\t{tabColumnsNodes}\r\n\t\t\t</Grid>\r\n\t\t]}\r\n\t\t/>\r\n\t\r\n</ListItem>\r\n\r\n\t\t);\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\trenderTabs(tabs) {\r\n\t\tlet tab = 0;\r\n\t\tlet tabsNodes = [];\r\n\t\t\r\n\t\tconst tabsTotal = Object.keys(tabs).length;\r\n\t\tfor (let tabKey in tabs) {\r\n\t\t\ttab++;\r\n\t\t\ttabsNodes.push(this.renderTab({ entries: tabs[tabKey], key: tabKey, index: tab, lastTab: tab === tabsTotal }));\r\n\t\t}\r\n\t\t\r\n\t\treturn tabsNodes;\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\trender() {\r\n\t\tconst { classes } = this.props;\r\n\t\t\r\n\t\tconst tabs = this.renderTabs(this.state.layout);\r\n\t\tlet config = ModuleConfigurations[this.state.selectedGroup.component || DEFAULTS.MODULE].map(config => {\r\n\t\t\tconst Input = Inputs[config.type || 'TextInput'];\r\n\t\t\treturn (\r\n\r\n<Input\r\n\tkey={'input-group-' + config.parameter}\r\n\tid={'input-group-' + config.parameter}\r\n\tlabel={i18n.t(config.label || config.parameter)}\r\n\tinfo={config.description}\r\n\t{...config}\r\n\tonChange={(id, val) => this.groupEditor[id] = val}\r\n\tval={this.state.selectedGroup[config.parameter] || config.val}\r\n\t/>\r\n\t\r\n\t\t\t);\r\n\t\t});\r\n\t\t\r\n\t\treturn (\r\n\r\n<React.Fragment>\r\n\t<Paper>\r\n\t\t<List className={classes.tabs}>\r\n\t\t\t<ListItem divider classes={{ root: classes.tab }}>\r\n\t\t\t\t<ListItemIcon classes={{ root: classes.iconContainer }}>\r\n\t\t\t\t\t<TabIcon />\r\n\t\t\t\t</ListItemIcon>\r\n\t\t\t\t<ListItemText\r\n\t\t\t\t\tdisableTypography={true}\r\n\t\t\t\t\tprimary={[\r\n\t\t\t\t\t\t<Inputs.Button key='Input-addTabs' id='Input-addTabs' label='add new tab' onClick={() => this._addTab()} />,\r\n\t\t\t\t\t\t<Inputs.SwitchInput\r\n\t\t\t\t\t\t\tkey='Input-tabsHideLabels'\r\n\t\t\t\t\t\t\tid='tabsHideLabels'\r\n\t\t\t\t\t\t\t{...LAYOUT_CONFIG.tabsHideLabels}\r\n\t\t\t\t\t\t\tonChange={(id, userInput) => this.onChange(this.state.layout, { [id]: userInput })}\r\n\t\t\t\t\t\t\tval={this.state.settings['tabsHideLabels']}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t]}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\r\n\t\t\t</ListItem>\r\n\t\t\t\r\n\t\t\t{tabs}\r\n\t\t\t\r\n\t\t</List>\r\n\t</Paper>\r\n\t\r\n\t<Dialog\r\n\t\theader={i18n.t('Group configuration')}\r\n\t\t\r\n\t\tclasses={{ CustomDialogActions: classes.DialogActions }}\r\n\t\tactions={\r\n\t\t\t<Grid container>\r\n\t\t\t\t<Grid item xs={6}>\r\n\t\t\t\t\t{this.state.selectedGroup.key && \r\n\t\t\t\t\t<Button key='action-delete' onClick={() => this._deleteGroup(this.state.selectedTab, this.state.selectedColumn, this.state.selectedGroup.key)} color=\"secondary\" startIcon={<DeleteIcon />}>\r\n\t\t\t\t\t\t{i18n.t('Delete Group')}\r\n\t\t\t\t\t</Button>}\r\n\t\t\t\t</Grid>\r\n\t\t\t\t<Grid item xs={6} className={classes.alignRight}>\r\n\t\t\t\t\t<Button key='action-cancel' onClick={() => this._closePopup('cancel')} color=\"secondary\">\r\n\t\t\t\t\t\t{i18n.t('Cancel')}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t\t<Button key='action-save' onClick={() => this._closePopup('save')} color=\"primary\">\r\n\t\t\t\t\t\t{i18n.t('Ok')}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</Grid>\r\n\t\t\t</Grid>\r\n\t\t}\r\n\t\t\r\n\t\tmaxWidth={'lg'}\r\n\t\topen={this.state.popup}\r\n\t\tonClose={() => this._closePopup('cancel')}\r\n\t\t>\r\n\t\t\r\n\t\t<List>\r\n\t\t\t<ListItem classes={{ gutters: classes.ListItemGutters }} divider>\r\n\t\t\t\t<Inputs.TextAutoCompleteInput\r\n\t\t\t\t\tkey='input-group-key'\r\n\t\t\t\t\tid='input-group-key'\r\n\t\t\t\t\t{...LAYOUT_CONFIG.groupName}\r\n\t\t\t\t\t\r\n\t\t\t\t\tautoComplete\r\n\t\t\t\t\tautoHighlight\r\n\t\t\t\t\t\r\n\t\t\t\t\tonChange={(id, val) => this.groupEditor[id] = val}\r\n\t\t\t\t\tval={this.state.selectedGroup.key || ''}\r\n\t\t\t\t\tautoCompleteValues={this.props.groups || []}\r\n\t\t\t\t\t\r\n\t\t\t\t\trequired={true}\r\n\t\t\t\t\terror={this.state.errors['input-group-key']}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t</ListItem>\r\n\t\t\t<ListItem classes={{ gutters: classes.ListItemGutters }} divider>\r\n\t\t\t\t<Inputs.TextInput key='input-group-title' id='input-group-title' {...LAYOUT_CONFIG.groupTitle} onChange={(id, val) => this.groupEditor[id] = val} val={this.state.selectedGroup.title || ''} />\r\n\t\t\t\t<Inputs.TextInput key='input-group-icon' id='input-group-icon' {...LAYOUT_CONFIG.groupIcon} onChange={(id, val) => this.groupEditor[id] = val} val={this.state.selectedGroup.icon || ''} />\r\n\t\t\t\t<Inputs.TextInput key='input-group-iconStyle' id='input-group-iconStyle' {...LAYOUT_CONFIG.groupIconStyle} onChange={(id, val) => this.groupEditor[id] = val} val={this.state.selectedGroup.iconStyle || ''} />\r\n\t\t\t</ListItem>\r\n\t\t\t<ListItem classes={{ gutters: classes.ListItemGutters }}>\r\n\t\t\t\t<Inputs.TextAutoCompleteInput\r\n\t\t\t\t\tkey='input-group-component'\r\n\t\t\t\t\tid='input-group-component'\r\n\t\t\t\t\t{...LAYOUT_CONFIG.groupModule}\r\n\t\t\t\t\t\r\n\t\t\t\t\tautoComplete\r\n\t\t\t\t\tautoHighlight\r\n\t\t\t\t\t\r\n\t\t\t\t\tonChange={(id, val) => this.groupEditor[id] = val}\r\n\t\t\t\t\tval={this.state.selectedGroup.component || DEFAULTS.MODULE}\r\n\t\t\t\t\t\r\n\t\t\t\t\trequired={true}\r\n\t\t\t\t\terror={this.state.errors['input-group-component']}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t</ListItem>\r\n\t\t\t<ListItem classes={{ gutters: classes.ListItemGutters }}>\r\n\t\t\t\t<Grid container spacing={1}>\r\n\t\t\t\t\t{config}\r\n\t\t\t\t</Grid>\r\n\t\t\t</ListItem>\r\n\t\t</List>\r\n\t</Dialog>\r\n\t\r\n</React.Fragment>\r\n\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(LayoutsPage);\r\n","import React from 'react'\r\n\r\nimport config from '../config/config'\r\nimport Settings from '../Settings'\r\n\r\nimport ExpansionPanel from '@material-ui/core/ExpansionPanel'\r\nimport ExpansionPanelDetails from '@material-ui/core/ExpansionPanelDetails'\r\nimport ExpansionPanelSummary from '@material-ui/core/ExpansionPanelSummary'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore'\r\n\r\nimport Inputs from '../components/Inputs'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles'\r\nconst styles = theme => ({\r\n\theading: {\r\n\t\tfontSize: theme.typography.pxToRem(15),\r\n\t\tflexBasis: '33.33%',\r\n\t\tflexShrink: 0,\r\n\t},\r\n\tsecondaryHeading: {\r\n\t\tfontSize: theme.typography.pxToRem(15),\r\n\t\tcolor: theme.palette.text.secondary,\r\n\t},\r\n});\r\n\r\n\r\nclass SettingsPage extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tdelete Settings.settings.iobroker;\r\n\t\tthis.state = {\r\n\t\t\tpanel: false\r\n\t\t}\r\n\t\t\r\n\t\tthis.onChange = this.props.onChange;\r\n\t\tthis.settings = Settings.getSettings();\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\t_handleSettingsChange = (key, val) => {\r\n\t\tSettings.setSetting(key, val);\r\n\t\t\r\n\t\tif (this.onChange) {\r\n\t\t\tthis.onChange(Settings.getSettings());\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\t_handlePanelChange = panel => (event, isExpanded) => this.setState({ panel: isExpanded ? panel : false });\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\trenderPanel(key, panel) {\r\n\t\tconst { classes } = this.props;\r\n\t\t\r\n\t\tconst settings = Object.keys(panel.settings).map(inputKey => {\r\n\t\t\tconst inputSettings = panel.settings[inputKey];\r\n\t\t\tconst Tag = Inputs[inputSettings.type || 'TextInput'];\r\n\t\t\t\r\n\t\t\treturn <Tag\r\n\t\t\t\t\t\tkey={'Input-' + key + '-' + inputKey}\r\n\t\t\t\t\t\tid={inputKey}\r\n\t\t\t\t\t\tonChange={this._handleSettingsChange}\r\n\t\t\t\t\t\tval={this.props.settings[inputKey] || this.settings[inputKey]}\r\n\t\t\t\t\t\t{...inputSettings}\r\n\t\t\t\t\t\t/>\r\n\t\t});\r\n\t\t\r\n\t\treturn (\r\n\r\n<ExpansionPanel\r\n\tkey={'ExpansionPanel-' + key}\r\n\texpanded={this.state.panel === key}\r\n\tonChange={this._handlePanelChange(key)}\r\n\t>\r\n\t\r\n\t<ExpansionPanelSummary\r\n\t\texpandIcon={<ExpandMoreIcon />}\r\n\t\tid={'panel-header-' + key}\r\n\t\t>\r\n\t\t\r\n\t\t<Typography className={classes.heading}>{panel.label}</Typography>\r\n\t\t{panel.description && <Typography className={classes.secondaryHeading}>{panel.description}</Typography>}\r\n\t\t\r\n\t</ExpansionPanelSummary>\r\n\t<ExpansionPanelDetails>\r\n\t\t{settings}\r\n\t</ExpansionPanelDetails>\r\n</ExpansionPanel>\r\n\r\n\t\t)\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\trender() {\r\n\t\treturn Object.keys(config).map(panel => this.renderPanel(panel, config[panel]))\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(SettingsPage);\r\n","import React from 'react'\r\n\r\nimport { DEFAULTS } from '../config/config'\r\nimport Settings from '../Settings'\r\nimport Connection from '../Connection'\r\nimport i18n from '../i18n'\r\n\r\nimport Button from '@material-ui/core/Button'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport Tabs from '@material-ui/core/Tabs'\r\nimport Tab from '@material-ui/core/Tab'\r\nimport TextField from '@material-ui/core/TextField'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport Dialog from '../components/Dialog'\r\nimport Inputs from '../components/Inputs'\r\n\r\nimport DevicesPage from '../pages/DevicesPage'\r\nimport LayoutsPage from '../pages/LayoutsPage'\r\nimport SettingsPage from '../pages/SettingsPage'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles'\r\nconst styles = theme => ({\r\n\tpinToTop: {\r\n\t\tposition: 'absolute',\r\n\t\ttop: 0,\r\n\t},\r\n\ttitle: {\r\n\t\tpaddingLeft: theme.spacing(2),\r\n\t\tpaddingRight: theme.spacing(1),\r\n\t\tmarginBottom: theme.spacing(1),\r\n\t\tminHeight: '64px',\r\n\t\tdisplay: 'flex',\r\n\t\tposition: 'relative',\r\n\t\talignItems: 'center'\r\n\t},\r\n\trawEditor: {\r\n\t\tfontFamily: 'Roboto Mono,Consolas,Courier New,monospace !important'\r\n\t}\r\n});\r\n\r\n\r\nclass ConfigurationPage extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tlet settings = { ...Settings.getSettings() };\r\n\t\tlet layout = settings.layout;\r\n\t\tdelete settings.layout;\r\n\t\tdelete settings.iobroker;\r\n\t\t\r\n\t\tthis.groups = [];\r\n\t\tObject.keys(this.props.devices).forEach(key => this.groups = this.groups.concat(this.props.devices[key].options.group || []));\r\n\t\tthis.groups = [...new Set(this.groups)].sort();\r\n\t\t\r\n\t\t\r\n\t\tthis.state = {\r\n\t\t\texpertMode: false,\r\n\t\t\ttab: 'devices',\r\n\t\t\t\r\n\t\t\tsettings: settings || {},\r\n\t\t\tlayout: layout || {},\r\n\t\t\tdevices: this.props.devices || {}\r\n\t\t}\r\n\t\t\r\n\t\tthis.socket = Connection.getConnection;\r\n\t\t\r\n\t\tthis._onDevicesChange.bind(this);\r\n\t\tthis._onSettingsChange.bind(this);\r\n\t\tthis._onLayoutsChange.bind(this);\r\n\t}\r\n\t\r\n\t/**\r\n\t * \r\n\t */\r\n\t_onDevicesChange = devices => this.setState({ devices: devices });\r\n\t_onSettingsChange = settings => this.setState({ settings: settings });\r\n\t_onLayoutsChange = (layout, settings) => this.setState(prevState => ({ settings: { ...prevState.settings, ...settings || {} }, layout: layout }));\r\n\t\r\n\t/**\r\n\t * \r\n\t */\r\n\t_handleTabChange = (event, tab) => this.setState({ tab });\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\t_cancel = () => {\r\n\t\t\r\n\t\t// restore old devices\r\n\t\t\r\n\t\t\r\n\t\t// restore old settings\r\n\t\tthis.setState({ settings: Settings.getSettings() });\r\n\t\t\r\n\t\t// close popup\r\n\t\tthis.props.navigate('home');\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\t_save = () => {\r\n\t\tlet result = [\r\n\t\t\tthis.socket.setState(DEFAULTS.NODE_SETTINGS, JSON.stringify({ ...this.state.settings, layout: this.state.layout })),\r\n\t\t\tthis.socket.setState(DEFAULTS.NODE_DEVICES, JSON.stringify(this.state.devices))\r\n\t\t];\r\n\t\t\r\n\t\tPromise.all(result)\r\n\t\t\t.then(() => window.location.reload())\r\n\t\t\t.catch(err => console.error(err));\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\trender() {\r\n\t\tconst { classes } = this.props;\r\n\t\t\r\n\t\treturn (\r\n\r\n<Dialog\r\n\tclasses={{ CustomDialog: classes.pinToTop }}\r\n\tfullWidth={true}\r\n\tmaxWidth={'xl'}\r\n\t\r\n\topen={(this.props.page === 'configuration')}\r\n\tonClose={this._cancel}\r\n\t\r\n\theader={[\r\n\t\t<Typography key=\"header\" variant=\"h6\">\r\n\t\t\tConfiguration\r\n\t\t\t<Inputs.SwitchInlineInput\r\n\t\t\t\tkey=\"Input-expertMode\"\r\n\t\t\t\tid=\"expertMode\"\r\n\t\t\t\tsize=\"small\"\r\n\t\t\t\tlabel={i18n.t('Expert mode')}\r\n\t\t\t\tonChange={(key, val) => this.setState({ expertMode: val })}\r\n\t\t\t\tval={this.state.expertMode}\r\n\t\t\t\t/>\r\n\t\t</Typography>,\r\n\t\t\r\n\t\t<Tabs\r\n\t\t\tkey=\"tabs\"\r\n\t\t\tvalue={this.state.tab}\r\n\t\t\tindicatorColor=\"primary\"\r\n\t\t\ttextColor=\"primary\"\r\n\t\t\tonChange={this._handleTabChange}\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t<Tab value=\"devices\" label={i18n.t('Devices')} />\r\n\t\t\t{this.state.expertMode === true && <Tab value=\"devicesRaw\" label={[i18n.t('Raw Editor'), <br key='tab' />, i18n.t('Devices') ]} />}\r\n\t\t\t<Tab value=\"layout\" label={i18n.t('Layout')} />\r\n\t\t\t{this.state.expertMode === true && <Tab value=\"layoutRaw\" label={[i18n.t('Raw Editor'), <br key='tab' />, i18n.t('Layout') ]} />}\r\n\t\t\t<Tab value=\"settings\" label={i18n.t('Settings')} />\r\n\t\t\t{this.state.expertMode === true && <Tab value=\"settingsRaw\" label={[i18n.t('Raw Editor'), <br key='tab' />, i18n.t('Settings') ]} />}\r\n\t\t</Tabs>\r\n\t]}\r\n\tactions={[\r\n\t\t<Button key='action-cancel' autoFocus onClick={this._cancel} color=\"secondary\">\r\n\t\t\t{i18n.t('Cancel')}\r\n\t\t</Button>,\r\n\t\t<Button key='action-save' onClick={this._save} color=\"primary\">\r\n\t\t\t{i18n.t('Save')}\r\n\t\t</Button>\r\n\t]}\r\n\t>\r\n\t\r\n\t<div hidden={this.state.tab !== 'devices'}>\r\n\t\t<Paper>\r\n\t\t\t{this.state.tab === 'devices' && <DevicesPage devices={this.state.devices} onChange={this._onDevicesChange} />}\r\n\t\t\t\r\n\t\t</Paper>\r\n\t\t\r\n\t</div>\r\n\t{this.state.expertMode === true && \r\n\t<div hidden={this.state.tab !== 'devicesRaw'}>\r\n\t\t<Paper className={classes.paper}>\r\n\t\t\t<Typography className={classes.title} variant=\"h6\">\r\n\t\t\t\t{i18n.t('Raw Editor') + ' ' + i18n.t('Devices')}\r\n\t\t\t</Typography>\r\n\t\t\t<TextField\r\n\t\t\t\tkey='TextField-Raw-Devices'\r\n\t\t\t\tInputProps={{ className: classes.rawEditor }}\r\n\t\t\t\tmultiline\r\n\t\t\t\tfullWidth\r\n\t\t\t\tonChange={event => this._onDevicesChange(JSON.parse((event && event.target && event.target.value) || '{}'))}\r\n\t\t\t\tvalue={JSON.stringify(this.state.devices, null, 3)}\r\n\t\t\t\t/>\r\n\t\t\t\r\n\t\t</Paper>\r\n\t</div>}\r\n\t<div hidden={this.state.tab !== 'settings'} style={{ width: '100%' }}>\r\n\t\t<Paper className={classes.title}>\r\n\t\t\t<Typography variant=\"h6\">\r\n\t\t\t\t{i18n.t('Settings')}\r\n\t\t\t</Typography>\r\n\t\t</Paper>\r\n\t\t{this.state.tab === 'settings' && <SettingsPage settings={this.state.settings} onChange={this._onSettingsChange} />}\r\n\t\t\r\n\t</div>\r\n\t{this.state.expertMode === true && \r\n\t<div hidden={this.state.tab !== 'settingsRaw'} style={{ width: '100%' }}>\r\n\t\t<Paper className={classes.paper}>\r\n\t\t\t<Typography className={classes.title} variant=\"h6\">\r\n\t\t\t\t{i18n.t('Raw Editor') + ' ' + i18n.t('Settings')}\r\n\t\t\t</Typography>\r\n\t\t\t<TextField\r\n\t\t\t\tkey='TextField-Raw-Settings'\r\n\t\t\t\tInputProps={{ disableUnderline: true, className: classes.rawEditor }}\r\n\t\t\t\tmultiline\r\n\t\t\t\tfullWidth\r\n\t\t\t\tonChange={event => this._onSettingsChange(JSON.parse((event && event.target && event.target.value) || '{}'))}\r\n\t\t\t\tvalue={JSON.stringify(this.state.settings, null, 3)}\r\n\t\t\t\t/>\r\n\t\t\t\r\n\t\t</Paper>\r\n\t</div>}\r\n\t<div hidden={this.state.tab !== 'layout'}>\r\n\t\t<Paper>\r\n\t\t\t<Typography className={classes.title} variant=\"h6\">\r\n\t\t\t\t{i18n.t('Layout')}\r\n\t\t\t</Typography>\r\n\t\t</Paper>\r\n\t\t{this.state.tab === 'layout' && <LayoutsPage groups={this.groups} settings={this.state.settings} layout={this.state.layout} onChange={this._onLayoutsChange} />}\r\n\t\t\r\n\t</div>\r\n\t{this.state.expertMode === true && \r\n\t<div hidden={this.state.tab !== 'layoutRaw'} style={{ width: '100%' }}>\r\n\t\t<Paper className={classes.paper}>\r\n\t\t\t<Typography className={classes.title} variant=\"h6\">\r\n\t\t\t\t{i18n.t('Raw Editor') + ' ' + i18n.t('Layout')}\r\n\t\t\t</Typography>\r\n\t\t\t<TextField\r\n\t\t\t\tkey='TextField-Raw-Layout'\r\n\t\t\t\tInputProps={{ disableUnderline: true, className: classes.rawEditor }}\r\n\t\t\t\tmultiline\r\n\t\t\t\tfullWidth\r\n\t\t\t\tonChange={event => this._onLayoutsChange(JSON.parse((event && event.target && event.target.value) || '{}'))}\r\n\t\t\t\tvalue={JSON.stringify(this.state.layout || {}, null, 3)}\r\n\t\t\t\t/>\r\n\t\t\t\r\n\t\t</Paper>\r\n\t</div>}\r\n\t\r\n</Dialog>\r\n\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(ConfigurationPage);\r\n","\r\nexport const ModuleSettings = {\r\n\tAdapterStatus: require('./AdapterStatus').ModuleSettings || {},\r\n\tChart: require('./Chart').ModuleSettings || {},\r\n\tDateTime: require('./DateTime').ModuleSettings || {},\r\n\tMap: require('./Map').ModuleSettings || {},\r\n\tMultimedia: require('./Multimedia').ModuleSettings || {},\r\n\tStateList: require('./StateList').ModuleSettings || {},\r\n\tStateListHorizontal: require('./StateListHorizontal').ModuleSettings || {},\r\n\tWeather: require('./Weather').ModuleSettings || {}\r\n}\r\n\r\nexport const ModuleConfigurations = {\r\n\tAdapterStatus: require('./AdapterStatus').ModuleConfig || [],\r\n\tChart: require('./Chart').ModuleConfig || [],\r\n\tDateTime: require('./DateTime').ModuleConfig || [],\r\n\tMap: require('./Map').ModuleConfig || [],\r\n\tMultimedia: require('./Multimedia').ModuleConfig || [],\r\n\tStateList: require('./StateList').ModuleConfig || [],\r\n\tStateListHorizontal: require('./StateListHorizontal').ModuleConfig || [],\r\n\tWeather: require('./Weather').ModuleConfig || []\r\n}\r\n\r\nexport default {\r\n\tAdapterStatus: require('./AdapterStatus').default,\r\n\tChart: require('./Chart').default,\r\n\tDateTime: require('./DateTime').default,\r\n\tMap: require('./Map').default,\r\n\tMultimedia: require('./Multimedia').default,\r\n\tStateList: require('./StateList').default,\r\n\tStateListHorizontal: require('./StateListHorizontal').default,\r\n\tWeather: require('./Weather').default\r\n}","import React from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport DialogActions from '@material-ui/core/DialogActions'\r\n\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport CloseIcon from '@material-ui/icons/Close'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nconst useStyles = makeStyles(theme => ({\r\n\tcloseButton: {\r\n\t\tposition: 'absolute',\r\n\t\tright: theme.spacing(1),\r\n\t\ttop: theme.spacing(1),\r\n\t\tcolor: theme.palette.grey[500],\r\n\t},\r\n\tDialog: {\r\n\t},\r\n\tCustomDialog: {\r\n\t},\r\n\tDialogContent: {\r\n\t\tbackgroundColor: '#fafafa'\r\n\t},\r\n\tCustomDialogContent: {\r\n\t},\r\n\tDialogActions: {\r\n\t\tmargin: 0,\r\n\t\tpadding: theme.spacing(1),\r\n\t},\r\n\tCustomDialogActions: {\r\n\t}\r\n}));\r\n\r\n\r\nexport default function CustomDialog(props) {\r\n\tconst { header, onClose, children, actions } = props;\r\n\tconst classes = useStyles(props);\r\n\t\r\n\treturn (\r\n\r\n<Dialog\r\n\tclasses={{ paper: clsx(classes.Dialog, classes.CustomDialog) }}\r\n\tfullWidth={props.fullWidth}\r\n\tmaxWidth={props.maxWidth}\r\n\t\r\n\topen={props.open}\r\n\tonClose={props.onClose}\r\n\t>\r\n\t\r\n\t<DialogTitle disableTypography>\r\n\t\t{typeof header !== 'string' ? header : <Typography variant=\"h6\">\r\n\t\t\t{header}\r\n\t\t</Typography>}\r\n\t\t<IconButton aria-label=\"close\" className={classes.closeButton} onClick={onClose}>\r\n\t\t\t<CloseIcon />\r\n\t\t</IconButton>\r\n\t</DialogTitle>\r\n\t\r\n\t<DialogContent className={clsx(classes.DialogContent, classes.CustomDialogContent)} dividers>\r\n\t\t{children}\r\n\t</DialogContent>\r\n\t\r\n\t<DialogActions classes={{ root: clsx(classes.DialogActions, classes.CustomDialogActions) }}>\r\n\t\t{actions}\r\n\t</DialogActions>\r\n</Dialog>\r\n\r\n\t);\r\n}\r\n"],"sourceRoot":""}