(this.webpackJsonpjarvis=this.webpackJsonpjarvis||[]).push([[0],{107:function(e,t,a){"use strict";var n=a(12),i=a(88),r=a(109);t.a={timeToSeconds:function(e){if(e.toString().indexOf(":")>-1){var t=(e=e.toString()).split(":").length-1>1?e.split(":"):("0:"+e).split(":"),a=Object(n.a)(t,3),i=a[0],r=a[1],s=a[2];e=3600*parseInt(i)+60*parseInt(r)+parseInt(s)}return parseInt(e)},timeToHoursMinutesSeconds:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.toString().indexOf(":")>-1)return e;if(e=parseInt(e),t=t||e>3600,Number.isNaN(e))return t?"00:00:00":"00:00";var a="0"+Math.floor(e/3600),n="0"+Math.floor(e/60),i="0"+e%60;return t?[a.substr(-2),n.substr(-2),i.substr(-2)].join(":"):[n.substr(-2),i.substr(-2)].join(":")},secondsToDateTime:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"dd. MMM yyyy, HH:mm";return Object(i.a)(new Date(1e3*e),t,{locale:r.a})}}},11:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(36),i=a(22),r=a(19),s=function(){function e(){Object(i.a)(this,e)}return Object(r.a)(e,null,[{key:"setLanguage",value:function(t){return!!t&&(e.language=t,console.log("i18n: Set language to "+t+"."),!0)}},{key:"loadTranslations",value:function(t){return!!t&&((t=Array.isArray(t)?t:[t]).forEach((function(t){return e.loadTranslation(t)})),!0)}},{key:"loadTranslation",value:function(t){if(t){var n;try{n=a(336)("./"+t+".js").default}catch(i){return console.error(i.message),!1}return e.setTranslation(t,n),!0}return!1}},{key:"setTranslation",value:function(t,a){return!(!t||!a)&&(e.translations[t]=Object(n.a)({},e.translations[t]||{},{},a),console.log("i18n: Set translations for language "+t+"."),!0)}},{key:"getLanguage",value:function(){return e.lang}},{key:"t",value:function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.language;if(t=t.toString(),e.translations[i])if(t.indexOf("#")>-1){for(var r=t.split("#");r.length>0&&!e.translations[i][r.join("#")];)r.shift();t=e.translations[i][r.join("#")]||t}else t=e.translations[i][t]||t;for(var s in n)t=t.replace(RegExp("%"+s+"%","g"),n[s]);return a.ucFirst&&(t=t.charAt(0).toUpperCase()+t.slice(1)),t}}]),e}();s.translations={},s.language=navigator.language||navigator.userLanguage||"en"},140:function(e,t,a){"use strict";a.r(t);var n=a(3),i=a(22),r=a(19),s=a(31),o=a(17),c=a(32),l=a(8),u=a(0),d=a.n(u),p=a(11),m=a(545),h=a(117),f=a(304),g=a(198),v=a(36),b=a(2),y=a(609),O=a(5),S=function(e){return{defaultListDivider:{margin:"0 0 5px 0"},defaultListIcon:function(t){return Object(v.a)({},e.components.icon,{},t.styles)},horizontalListItem:{display:"inline-block",textAlign:"center",paddingRight:"16px",width:"140px",marginTop:"10px"},horizontalListItemIcon:{minWidth:"auto"},horizontalListItemAction:{textAlign:"center",top:0,right:0,position:"static",transform:"none"},verticalListItemAction:{textAlign:"right"}}},j=Object(O.a)(S)((function(e){var t=e.customClassNames,a=e.children,n=e.classes,i=Array.isArray(t)?t:[t];return i=i.map((function(e){return n[e]?n[e]:e})),d.a.createElement("span",{className:Object(b.a)(i)},a)})),k=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(o.a)(t).call(this,e))).state={},a.state[a.props.device.primaryStateKey]=a.props.device.getDeviceState()||{},a.props.device.secondaryStateKey&&(a.state[a.props.device.secondaryStateKey]=a.props.device.getDeviceState(a.props.device.secondaryStateKey)||{}),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.device.on("stateChange",(function(t,a){t!==e.props.device.primaryStateKey&&t!==e.props.device.secondaryStateKey||e.setState(Object(l.a)({},t,a))}))}},{key:"openDialog",value:function(){this.props.openDialog(this.props.device)}},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.horizontal,n=e.device,i=e.component,r=e.action,s=this.state[n.primaryStateKey],o=n.get("options"),c=n.getIcon(n.primaryStateKey,s.val),l=n.getAction(n.primaryStateKey,!1===n.options.primaryAction),u=r&&this.state[n.secondaryStateKey]?n.getAction(n.secondaryStateKey):null;return d.a.createElement(d.a.Fragment,null,o.divider&&"after"!==o.divider&&d.a.createElement(h.a,{divider:!0,className:t.defaultListDivider}),d.a.createElement(h.a,{className:Object(b.a)(this.props.openDialog&&t.finger,a&&t.horizontalListItem),button:null!==this.props.openDialog,onClick:this.props.openDialog&&this.openDialog.bind(this)},d.a.createElement(y.a,{className:Object(b.a)(a&&t.horizontalListItemIcon)},null===c?d.a.createElement(d.a.Fragment,null):d.a.createElement(j,{customClassNames:["defaultListIcon","mdi mdi-"+c],styles:n.getStyle("icon",n.primaryStateKey,s.val)})),d.a.createElement(g.a,{primary:i&&n.getComponent()||n.getOption("label"),secondary:null!==o.subtitle&&(o.subtitle||s&&s.timeChanged)||null}),d.a.createElement(f.a,{className:a?t.horizontalListItemAction:t.verticalListItemAction},u?[l,d.a.createElement("br",{key:"br_"+n.id}),u]:l)),o.divider&&"after"===o.divider&&d.a.createElement(h.a,{divider:!0,style:{margin:"5px 0"}}))}}]),t}(d.a.Component),E=Object(O.a)(S)(k),w=a(97),C=a(302),x=function(e){return{defaultListSectionDivider:{margin:"5px 0 0 0"},defaultListSectionDividerItem:{margin:"6px 0 7px 0",padding:"0 16px !important"},defaultListSectionText:Object(l.a)({margin:0},e.breakpoints.down("md"),{margin:"0 0 0 10px"}),horizontalList:{display:"flex",flexDirection:"row",flexWrap:"wrap"}}},D=Object(O.a)(x)((function(e){var t=e.classes,a=e.getDevicesBySubgroup,n=e.subgroup,i=e.title,r=e.subgroupActions,s=function(e){a(n).forEach((function(t){var a=e;"level"===t.primaryStateKey&&(a=a?100:0),t.setDeviceState(null,a)}))};return d.a.createElement(d.a.Fragment,null,d.a.createElement(h.a,{divider:!0,className:t.defaultListSectionDivider}),d.a.createElement(h.a,{className:t.defaultListSectionDividerItem},d.a.createElement(g.a,{className:t.defaultListSectionText,primary:i}),d.a.createElement(f.a,null,null===r||!1===r?null:d.a.createElement(C.a,{color:"primary",size:"small"},d.a.createElement(w.a,{onClick:function(){return s(!0)}},p.a.t("on")),d.a.createElement(w.a,{onClick:function(){return s(!1)}},p.a.t("off"))))))})),T=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(r.a)(t,[{key:"getDevicesBySubgroup",value:function(e){var t=[];return this.props.devices.forEach((function(a){e===a.getOption("subgroup")&&t.push(a)})),t}},{key:"render",value:function(){var e,t=this,a=this.props,i=a.classes,r=a.horizontal,s=a.devices,o=a.settings,c=a.component,l=a.action,u=Object(n.a)(a,["classes","horizontal","devices","settings","component","action"]);return d.a.createElement(m.a,{dense:!0,className:r&&i.horizontalList},s.map((function(a,n){var i=null!==e&&null!==a.options.subgroup&&a.options.subgroup!==e&&d.a.createElement(D,{key:"ListDivider-"+a.get("id"),getDevicesBySubgroup:t.getDevicesBySubgroup.bind(t),subgroup:a.getOption("subgroup"),title:a.options.subgroup,subgroupActions:o.subgroupActions||a.options.subgroupActions}),s=d.a.createElement(E,Object.assign({},u,{key:"StateListItem-"+a.get("id"),horizontal:r,device:a,component:c||!1,action:l||!0}));return e=a.getOption("subgroup"),[i,s]})))}}]),t}(d.a.Component);t.default=Object(O.a)(x)(T)},230:function(e,t,a){"use strict";a.r(t);var n=a(12),i=a(0),r=a.n(i),s=a(97),o=a(302),c=a(277),l=a.n(c),u=a(278),d=a.n(u),p=a(147),m=a.n(p),h=a(38),f=a(164),g=Object(f.a)((function(e){return{value:function(e){return{float:"left",lineHeight:"32px",marginRight:"10px"}},noBorder:{borderLeftColor:"transparent"}}}));t.default={configurations:{level:{value:function(e){return Math.round(e)},icon:{default:"window-shutter-open",">90":"window-shutter-open","<=90":"window-shutter"}},level2:{value:function(e){return Math.round(e)},unit:" %",icon:{default:"window-shutter-open",">90":"window-shutter-open","<=90":"window-shutter"}}},components:{level2:h.default.components.LevelComponent},actions:{level:function(e){var t=e.device,a=e.state,c=e.stateKey,u=g(),p=Object(i.useState)(a.value),h=Object(n.a)(p,2),f=h[0],v=h[1];Object(i.useEffect)((function(){return v(a.value)}),[a.value]);var b=Object(i.useState)(null),y=Object(n.a)(b,2),O=y[0],S=y[1];return Object(i.useEffect)((function(){t.states.activity&&t.states.activity.state&&(t.states.activity.state="string"===typeof t.states.activity.state?{node:t.states.activity.state}:t.states.activity.state,t.requestDeviceState("activity",!0).catch((function(e){return console.error(e)})),t.on("stateChange",(function(e,a){if("activity"===e){var n=a.val;if("HomeMatic"===t.options.manufacturer)switch(n){case 1:case 2:n=!0;break;case 3:default:n=!1}S(n)}})))}),[t]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:u.value},f+a.unit),r.a.createElement(o.a,{size:"small"},r.a.createElement(s.a,{color:"primary",onClick:function(){v(100),S(!0),t.setDeviceState(c,100).catch((function(e){return console.error(e)}))}},r.a.createElement(l.a,null)),null!==O&&r.a.createElement(s.a,{color:"secondary",style:{borderRightColor:O?"rgba(245, 0, 87, 0.5)":"transparent"},onClick:function(){S(!1),t.setDeviceState("activity",!0).catch((function(e){return console.error(e)}))},disabled:!O},r.a.createElement(m.a,null)),r.a.createElement(s.a,{color:"primary",style:null!==O?{borderLeftColor:O?"transparent":"rgba(0, 0, 0, 0.26)"}:{},onClick:function(){v(0),S(!0),t.setDeviceState(c,0).catch((function(e){return console.error(e)}))}},r.a.createElement(d.a,null))))}},styles:{}}},264:function(e,t,a){"use strict";a.r(t),a.d(t,"Settings",(function(){return T}));var n=a(23),i=a(56),r=a(63),s=a(64),o=a(68),c=a(65),l=a(67),u=a(0),d=a.n(u),p=a(2),m=a(88),h=a(109),f=a(83),g=a(11),v=a(118),b=a(89),y=a(199),O=a(545),S=a(303),j=a(117),k=a(198),E=a(304),w=a(283),C=a.n(w),x=a(5),D=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).state={adapterInformation:[],adapterAliveStatus:{},newUpdates:!1,updatesJson:{},lastUpdateCheck:""},a.socket=f.a.getConnection,a.list=a.props.settings.list?Array.isArray(a.props.settings.list)?a.props.settings.list:a.props.settings.list.split(","):null,a.blacklist=a.props.settings.blacklist?Array.isArray(a.props.settings.blacklist)?a.props.settings.blacklist:a.props.settings.blacklist.split(","):null,a}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;if(!1!==this.props.settings.updates){var t=["admin.0.info.newUpdates","admin.0.info.lastUpdateCheck","admin.0.info.updatesJson"];this.socket.getStates(t,(function(a,n){e.setState({newUpdates:n["admin.0.info.newUpdates"].val,lastUpdateCheck:n["admin.0.info.lastUpdateCheck"].val,updatesJson:n["admin.0.info.updatesJson"].val}),e.socket.subscribeStates(t,(function(t,a){t=t.substr(t.lastIndexOf(".")+1),console.log(t),e.state[t]!==a.val&&e.setState(Object(i.a)({},t,a.val),(function(){return console.log(e.state)}))}))}))}this.socket.getAdapterInstances((function(t,a){var r=[];if(a&&a.rows){var s=[];a.rows.forEach((function(t,a){(!e.list||e.list&&e.list.indexOf(t.value.common.name)>-1)&&(!e.blacklist||e.blacklist&&-1===e.blacklist.indexOf(t.value.common.name))&&(s.push(t),r=r.concat([t.id+".alive",t.id+".connected",t.id.replace("system.adapter.","")+".info.connection"]))})),e.setState({adapterInformation:s.sort((function(e,t){return e.id>t.id?1:t.id>e.id?-1:0}))}),e.socket.getStates(r,(function(t,a){e.setState({adapterAliveStatus:a}),e.socket.subscribeStates(r,(function(t,a){!a||e.state.adapterAliveStatus[t]&&a.val===e.state.adapterAliveStatus[t].val||e.setState((function(e){return{adapterAliveStatus:Object(n.a)({},e.adapterAliveStatus,Object(i.a)({},t,a))}}))}))}))}}))}},{key:"render",value:function(){var e=this,t=this.props.classes,a=this.state.updatesJson&&this.state.updatesJson.val&&JSON.parse(this.state.updatesJson.val)||{},n=Object.keys(a).length,i=d.a.createElement(j.a,{key:"loading",className:t.loading},d.a.createElement(v.a,{size:20}));return this.state.adapterInformation.length>0&&(i=this.state.adapterInformation.map((function(n){n.update=a[n.value.common.name]||!1;var i=n.value.common.enabled,r=e.state.adapterAliveStatus[n.id+".alive"]&&e.state.adapterAliveStatus[n.id+".alive"].val||!1,s=e.state.adapterAliveStatus[n.id+".connected"]&&e.state.adapterAliveStatus[n.id+".connected"].val||!1,o=!e.state.adapterAliveStatus[n.id.replace("system.adapter.","")+".info.connection"]||e.state.adapterAliveStatus[n.id.replace("system.adapter.","")+".info.connection"].val,c=g.a.t("Adapter")+" "+(i?r&&s&&o?g.a.t("alive"):g.a.t("not alive"):g.a.t("disabled"));return d.a.createElement(j.a,{key:"adapter-"+n.id},d.a.createElement(S.a,null,d.a.createElement(y.a,{alt:n.value.common.name,src:n.value.common.extIcon,className:t.small})),d.a.createElement(k.a,{primary:n.value.common.title,secondary:["v"+n.value.common.version,n.update&&d.a.createElement("span",{key:"updates-"+n.id},", ",d.a.createElement("span",{className:t.UpdateAvailable},g.a.t("Update available")+" v"+n.update.availableVersion)),n.value.common.runAsCompactMode&&", "+g.a.t("Compact Mode")+" "+g.a.t("on")+" ("+g.a.t("Group")+" "+n.value.common.compactGroup+")"]}),d.a.createElement(E.a,{className:Object(p.a)(t.StatusIndicator,i?r&&s&&o?t.alive:t.notAlive:t.disabled)},d.a.createElement(b.a,{title:c},d.a.createElement("span",{className:i?r&&s&&o?"mdi mdi-check-circle":"mdi mdi-alert":"mdi mdi-close"}))))}))),d.a.createElement(O.a,{dense:!0},!1===this.state.newUpdates?this.state.lastUpdateCheck&&d.a.createElement(j.a,{key:"updates",classes:{root:t.noUpdates}},d.a.createElement(k.a,{primary:g.a.t("last update")+": "+Object(m.a)(new Date(this.state.lastUpdateCheck),"dd.MM.yyyy HH:mm:ss",{locale:h.a})})):d.a.createElement(j.a,{key:"updates",classes:{container:t.UpdatesListItem}},d.a.createElement(S.a,null,d.a.createElement(C.a,null)),d.a.createElement(k.a,{primary:g.a.t("Updates available")+"!"}),d.a.createElement(E.a,{className:Object(p.a)(t.StatusIndicator,t.UpdatesIndicator)},n)),i)}}]),t}(d.a.Component),T={noDevicesAllowed:!0,title:g.a.t("Adapter Status"),icon:"traffic-light"};t.default=Object(x.a)((function(e){return{noUpdates:{fontStyle:"italic",textAlign:"right",color:"rgba(0, 0, 0, 0.54)"},UpdateAvailable:{color:"#CCAA00"},UpdatesListItem:{backgroundColor:"#ffd700",color:"#fff",margin:e.spacing(0,-2),paddingLeft:e.spacing(2)},UpdatesIndicator:{right:e.spacing(3.75),backgroundColor:"#CCAA00",borderRadius:"50%",width:e.spacing(3),height:e.spacing(3),color:"#fff",textAlign:"center",fontSize:"1rem !important"},StatusIndicator:{fontSize:"1.4rem"},loading:{textAlign:"center",marginTop:"5px"},small:{width:e.spacing(3),height:e.spacing(3)},alive:{color:"#86d686"},notAlive:{color:"#f7e43b"},disabled:{color:"#bababa"}}}))(D)},265:function(e,t,a){"use strict";a.r(t);var n=a(50),i=a(23),r=a(63),s=a(64),o=a(68),c=a(65),l=a(84),u=a(67),d=a(0),p=a.n(d),m=a(2),h=a(284),f=(a(539),a(540),a(109)),g=a(297),v=a(11),b=a(107),y=a(118),O=a(97),S=a(302),j=a(551),k=a(89),E=a(96),w=a(305),C=a(30),x=a(547),D=a(200),T=a(550),N=a(110),I=a(301),A=a(288),R=a.n(A),L=a(289),M=a.n(L),K=a(286),_=a.n(K),H=a(287),B=a.n(H),P=a(291),U=a.n(P),z=a(290),F=a.n(z),V=a(5),G=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).chartFilter=a.props.settings.chartFilter||{},a.chartConfig=a.props.settings.chartConfig||{},a.chartConfig.yAxes=a.chartConfig.yAxes||[],a.chartConfig.yAxes.unshift({id:"left",type:"linear",position:"left",ticks:{callback:function(e){return(a.chartConfig.yLeftAxisUnitBefore||"")+Number.parseFloat(e).toFixed(1)+(a.chartConfig.yLeftAxisUnitAfter||"")}}}),a.state={loading:!0,errors:[],datePicker:!1,selectedTimeRangeValue:a.chartFilter&&a.chartFilter.selectedTimeRangeValue||1,selectedTimeRangeUnit:a.chartFilter&&a.chartFilter.selectedTimeRangeUnit||"days",selectedDateTime:a.chartFilter&&a.chartFilter.selectedDateTime&&new Date(a.chartFilter.selectedDateTime)||new Date,dateNow:!a.chartFilter||!a.chartFilter.selectedDateTime,chartLabels:[],chartData:{labels:[],datasets:[]},chartPan:!0,chartZoom:!0},a.timer=null,a.timeRangeRef=p.a.createRef(),a.chartRef=p.a.createRef(),a.chartUpdates={},a.chartOptions={maintainAspectRatio:!1,spanGaps:!0,legend:{onClick:a.legendClickHandler.bind(Object(l.a)(a))},tooltips:{callbacks:{label:function(e,t){return t.datasets[e.datasetIndex].label+": "+e.value+t.datasets[e.datasetIndex].unit}}},scales:{yAxes:a.chartConfig.yAxes},plugins:{colorschemes:{scheme:"brewer.SetOne9"},zoom:{pan:{enabled:!0,mode:"xy"},zoom:{enabled:!0,mode:"xy"}}}},a}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=Object(i.a)({},this.getTimeRange(),{axis:this.getAxis()});this.props.devices.forEach((function(a){a.label=a.name+" ("+v.a.t(a.primaryStateKey)+")",a.requestDeviceStateHistory(a.options.history||null,!0,{start:t.start,end:t.end,step:t.step,aggregate:"average",ignoreNull:!0}).catch((function(e){console.error(e)})),a.on("historyChange",(function(n,r,s){e.addChartGraph(a,r,Object(i.a)({},t,{axis:e.getAxis(t.start,t.end)})),e.setState({loading:!1})})),null!==e.props.settings.liveUpdates&&!1!==e.props.settings.liveUpdates&&e.state.dateNow&&a.on("stateChange",(function(n,r,s){return e.updateChartGraph(a,r,Object(i.a)({},t,{axis:e.getAxis(t.end,new Date)}))}))}))}},{key:"componentDidUpdate",value:function(e,t){var a=this;!this.state.selectedTimeRangeValue||t.selectedDateTime===this.state.selectedDateTime&&t.selectedTimeRangeValue===this.state.selectedTimeRangeValue&&t.selectedTimeRangeUnit===this.state.selectedTimeRangeUnit||(this.setState({loading:!0,errors:[]}),clearTimeout(this.timer),this.timer=setTimeout((function(){var e=a.getTimeRange();a.props.devices.forEach((function(t){t.requestDeviceStateHistory(t.options.history||null,!0,{start:e.start,end:e.end,step:e.step,aggregate:"average",ignoreNull:!0}).catch((function(e){console.error(e)}))}))}),500))}},{key:"getTimeRange",value:function(){var e=this.state.selectedDateTime.getTime(),t=this.state.selectedTimeRangeValue,a=1,n="dd. MMM yyyy, HH:mm";switch(this.state.selectedTimeRangeUnit){default:break;case"seconds":n="dd. MMM yyyy, HH:mm:ss";break;case"minutes":n="dd. MMM yyyy, HH:mm:ss",t*=60;break;case"hours":n="dd. MMM yyyy, HH:mm",t=60*t*60,a*=60;break;case"days":n="dd. MMM yyyy, HH:mm",t=60*t*60*24,a=60*a*60;break;case"months":n="dd. MMM yyyy",t=60*t*60*24*31,a=60*a*60*24;break;case"years":n="dd. MMM yyyy",t=60*t*60*24*365,a=60*a*60*24*31}return{axisTimeFormat:n,start:e-1e3*t,end:e,timeRange:1e3*t,step:1e3*a}}},{key:"getAxis",value:function(e,t){for(var a=this.getTimeRange(),n=a.step,i=a.axisTimeFormat,r={},s=e;s<=t;s+=n)r[s]=b.a.secondsToDateTime(s/1e3,i);return r}},{key:"groupChartData",value:function(e,t){var a,i=[],r=Object.keys(t);return r.forEach((function(t,s){for(var o in a=r[s-1>0?s-1:0],e){var c=e[o];if(c.val=parseFloat(c.val),c.ts&&null!==c.val&&!(a>c.ts))if(a<c.ts&&c.ts<=t)i[s]=i[s]?[].concat(Object(n.a)(i[s]),[c.val]):[c.val];else if(c.ts>t)break}i[s]&&(1===i[s].length?i[s]=i[s][0]:i[s]=i[s].reduce((function(e,t){return e+t}),0)/i[s].length)})),i}},{key:"updateChartGraph",value:function(e,t,a){var i=this.state.chartLabels.findIndex((function(t){return t===e.label}));if(-1===i)return!1;this.chartUpdates[i]=this.chartUpdates[i]||[],this.chartUpdates[i].push({ts:t.ts,val:t.val});var r=this.groupChartData(this.chartUpdates[i],a.axis);this.chartRef.current.chartInstance.data.labels=[].concat(Object(n.a)(this.state.chartData.labels),Object(n.a)(Object.values(a.axis))),this.chartRef.current.chartInstance.data.datasets[i].data=[].concat(Object(n.a)(this.state.chartData.datasets[i].data),Object(n.a)(r)),this.chartRef.current.chartInstance.update()}},{key:"addChartGraph",value:function(e,t,a){if(!t||!t.length){var r=v.a.t("No history data given for %s").replace("%s",e.label)+"!";return this.setState((function(e){return{errors:[].concat(Object(n.a)(e.errors),[r])}})),!1}var s=this.groupChartData(t,a.axis),o=this.state.chartLabels.findIndex((function(t){return t===e.label}));if(o>-1)this.chartRef.current.chartInstance.data.labels=Object.values(a.axis),this.chartRef.current.chartInstance.data.datasets[o].data=s,this.chartRef.current.chartInstance.update();else{this.setState((function(t){return{chartLabels:[].concat(Object(n.a)(t.chartLabels),[e.label])}}));var c=Object(i.a)({label:e.label,unit:e.states[e.primaryStateKey].state.value.unit||"",fill:!1},e.options.graphConfig||{},{data:s});this.setState((function(e){return{axisTimeFormat:a.axisTimeFormat,chartData:{labels:Object.values(a.axis),datasets:[].concat(Object(n.a)(e.chartData.datasets),[c])}}}))}}},{key:"legendClickHandler",value:function(e,t){var a=t.datasetIndex,n=this.chartRef.current.chartInstance,i=n.getDatasetMeta(a);i.hidden=null===i.hidden?!n.data.datasets[a].hidden:null,n.update(),n.resetZoom()}},{key:"disablePan",value:function(){var e=this.chartRef.current.chartInstance.options.plugins.zoom.pan.enabled;this.chartRef.current.chartInstance.options.plugins.zoom.pan.enabled=!1===e,this.setState({chartPan:!1===e})}},{key:"disableZoom",value:function(){var e=this.chartRef.current.chartInstance.options.plugins.zoom.zoom.enabled;this.chartRef.current.chartInstance.options.plugins.zoom.zoom.enabled=!1===e,this.setState({chartZoom:!1===e})}},{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=t.settings;return p.a.createElement("div",null,p.a.createElement("div",{className:a.options},p.a.createElement(E.a,{className:a.datePicker},p.a.createElement(k.a,{title:v.a.t("Period shown in Chart")},p.a.createElement(_.a,{className:a.icon})),p.a.createElement(D.a,{inputRef:this.timeRangeRef,className:a.input,value:this.state.selectedTimeRangeValue,onChange:function(t){return e.setState({selectedTimeRangeValue:t.target.value})}}),p.a.createElement(T.a,{value:this.state.selectedTimeRangeUnit,onChange:function(t){return e.setState({selectedTimeRangeUnit:t.target.value})},displayEmpty:!0,disableUnderline:!0,className:a.select},p.a.createElement(N.a,{value:"seconds"},v.a.t("Seconds")),p.a.createElement(N.a,{value:"minutes"},v.a.t("Minutes")),p.a.createElement(N.a,{value:"hours"},v.a.t("Hours")),p.a.createElement(N.a,{value:"days"},v.a.t("Days")),p.a.createElement(N.a,{value:"months"},v.a.t("Months")),p.a.createElement(N.a,{value:"years"},v.a.t("Years")))),p.a.createElement(E.a,{className:a.datePicker},p.a.createElement(k.a,{title:v.a.t("End date")},p.a.createElement(B.a,{className:a.icon})),p.a.createElement(C.a,{locale:f.a,utils:g.a},p.a.createElement(x.a,{className:a.input,value:this.state.selectedDateTime,onChange:function(t){return e.setState({selectedDateTime:t,dateNow:!1})},open:this.state.datePicker,onOpen:function(){return e.setState({datePicker:!0})},onClose:function(){return e.setState({datePicker:!1})},variant:"inline",ampm:!1,format:"dd.MM.yyyy HH:mm",InputProps:{disableUnderline:!0}})),p.a.createElement(k.a,{title:v.a.t("Select end date")},p.a.createElement(I.a,{color:"primary",className:a.iconButton,onClick:function(){return e.setState({datePicker:!0})}},p.a.createElement(R.a,null))),p.a.createElement(w.a,{className:a.dividerVertical,orientation:"vertical"}),p.a.createElement(k.a,{title:v.a.t("Select today as end date")},p.a.createElement(I.a,{className:a.iconButton,onClick:function(){return e.setState({selectedDateTime:new Date,dateNow:!0})}},p.a.createElement(M.a,null)))),p.a.createElement(k.a,{title:v.a.t("Live updates are "+(null!==this.props.settings.liveUpdates&&!1!==this.props.settings.liveUpdates&&this.state.dateNow?"on":"off")),placement:"top",style:{display:"flex"}},p.a.createElement("span",null,p.a.createElement(O.a,{disabled:!0,className:Object(m.a)(a.datePicker,null!==this.props.settings.liveUpdates&&!1!==this.props.settings.liveUpdates&&this.state.dateNow?a.button:a.buttonDisabled)},p.a.createElement(F.a,null))))),p.a.createElement(w.a,{className:a.divider}),p.a.createElement("div",{className:a.toolbar},p.a.createElement("div",{className:a.errorMessage},this.state.errors.length>0&&p.a.createElement(j.a,{severity:"error"},this.state.errors.map((function(e,t){return[e,p.a.createElement("br",{key:"br-error-"+t})]})))),p.a.createElement(S.a,{className:a.toolbarButtons,color:"primary"},p.a.createElement(O.a,{disableElevation:!0,variant:"contained",onClick:function(){return e.chartRef.current.chartInstance.resetZoom()}},p.a.createElement(k.a,{title:v.a.t("Reset Zoom")},p.a.createElement(U.a,null))))),p.a.createElement("div",{className:"chart-container",style:{position:"relative",height:n.chartHeight||"500px"}},this.state.loading&&p.a.createElement("div",{className:a.loading},p.a.createElement(y.a,null)),p.a.createElement(h.a,{ref:this.chartRef,data:this.state.chartData,options:this.chartOptions})))}}]),t}(p.a.Component);t.default=Object(V.a)((function(e){return{loading:{position:"absolute",backgroundColor:"rgba(0, 0, 0, 0.3)",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},errorMessage:{marginBottom:5,marginRight:15,width:"100%"},toolbar:{display:"flex"},toolbarButtons:{display:"initial",whiteSpace:"nowrap"},options:{display:"flex",justifyContent:"center"},datePicker:{padding:"2px 4px",display:"flex",alignItems:"center",margin:2},input:{marginLeft:e.spacing(1),flex:1},select:{width:100},icon:{margin:10},iconButton:{padding:10},divider:{margin:"15px 0"},dividerVertical:{height:28,margin:4},button:{backgroundColor:e.palette.primary.main,color:"#fff !important",margin:"4px"},buttonDisabled:{backgroundColor:"#eee",margin:"4px"}}}))(G)},266:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return p})),a.d(t,"Settings",(function(){return m}));var n=a(23),i=a(60),r=a(0),s=a.n(r),o=a(88),c=a(109),l=a(196),u=a(11),d=a(118);function p(e){var t=e.settings,a=Object(r.useRef)(),p=Object(r.useState)(Object(o.a)(new Date,t.format,{locale:c.a})),m=Object(i.a)(p,2),h=m[0],f=m[1],g=Object(r.useState)(""),v=Object(i.a)(g,2),b=v[0],y=v[1],O=Object(r.useState)(""),S=Object(i.a)(O,2),j=S[0],k=S[1],E=Object(r.useState)(""),w=Object(i.a)(E,2),C=w[0],x=w[1];return t.style=Object(n.a)({fontSize:"1.5rem",textAlign:"center"},t.style),t.format=t.format||"dd.MM.yyyy HH:mm:ss",t.refresh=t.format.indexOf("s")>-1?1e3:t.format.indexOf("i")>-1?6e4:36e5,Object(r.useEffect)((function(){clearTimeout(a.current),a.current=setTimeout((function(){return f(Object(o.a)(new Date,t.format,{locale:c.a}))}),t.refresh),t._global.iobroker.latitude&&t._global.iobroker.longitude&&(k(Object(l.getSunrise)(t._global.iobroker.latitude,t._global.iobroker.longitude)),x(Object(l.getSunset)(t._global.iobroker.latitude,t._global.iobroker.longitude))),t._global.iobroker.city&&y(t._global.iobroker.city)}),[t]),s.a.createElement("div",{style:t.style},u.a.t("%DateTime").replace(/%DateTime/,h),!1!==t.sun&&s.a.createElement("div",{style:{margin:"5px 0",fontSize:"1.2rem"}},s.a.createElement("span",{className:"mdi mdi-city-variant-outline"})," ",b||s.a.createElement(d.a,{size:"1.2rem"}),s.a.createElement("span",{style:{margin:"0 10px"}}),s.a.createElement("span",{className:"mdi mdi-weather-sunset-up"})," ",j?Object(o.a)(j,"HH:mm"):s.a.createElement(d.a,{size:"1.2rem"}),s.a.createElement("span",{style:{margin:"0 10px"}}),s.a.createElement("span",{className:"mdi mdi-weather-sunset-down"})," ",C?Object(o.a)(C,"HH:mm"):s.a.createElement(d.a,{size:"1.2rem"})))}var m={noDevicesAllowed:!0,title:u.a.t("Time"),icon:"clock-outline"}},267:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return j}));var n=a(56),i=a(23),r=a(60),s=a(0),o=a.n(s),c=a(2),l=a(35),u=a.n(l),d=a(553),p=a(555),m=a(546),h=a(554),f=a(11),g=a(549),v=a(51),b=a(89),y=a(199),O=a(164),S=Object(O.a)((function(e){return{map:{width:"100%",height:"100%"},mapOverview:{color:"#666",position:"absolute",left:0,bottom:0,width:"100%",height:"60px",zIndex:999,display:"flex",alignItems:"center","& > *":{margin:e.spacing(1),cursor:"pointer"}},mapIconContainer:{},mapIconParent:{backgroundColor:"#fff",boxShadow:"0 0 0 8px rgba(255, 255, 255, 0.3)",borderRadius:"50%",width:"100%",height:"100%"},mapIcon:{fontSize:"2rem",color:e.palette.primary.main,transform:"translate3d(4px, -4px,0)",display:"block","&:after":{content:'""',display:"block",padding:"50% 0%"}},mapTooltip:{}}}));function j(e){var t=e.settings,a=e.devices,l=S(),u=Object(s.useState)(t.component.defaultZoom),m=Object(r.a)(u,1)[0],h=Object(s.useState)(t.component.defaultPosition?Array.isArray(t.component.defaultPosition)?t.component.defaultPosition:t.component.defaultPosition.split(","):[t._global.iobroker.latitude,t._global.iobroker.longitude]),O=Object(r.a)(h,1)[0],j=Object(s.useState)({}),E=Object(r.a)(j,2),w=E[0],C=E[1],x=Object(s.useRef)(),D=Object(s.useCallback)((function(){x.current=this}),[]),T=Object(s.useCallback)((function(e){return x.current.flyTo(e.split(","))}),[]);Object(s.useEffect)((function(){a.forEach((function(e){e.requestDeviceState("position").catch((function(t){console.error(t),C((function(t){return t[e.id]?t:Object(i.a)({},t,Object(n.a)({},e.id,null))}))})),e.on("stateChange",(function(t,a){"position"===t&&C((function(t){return t[e.id]&&t[e.id].position===a.val?t:(e.options.position=a.val,Object(i.a)({},t,Object(n.a)({},e.id,e)))}))}))}))}),[a]);var N=[],I=[];if(a.length>0&&a.length===Object.keys(w).length){var A=function(e){var a=w[e];if(null!==a){var n=o.a.createElement(k,{key:"marker-"+a.id,position:a.options.position,device:a,settings:t.component});N.push(n);var i=null;if(a.attributes.avatar)i=o.a.createElement(y.a,{key:"overview-"+a.id,alt:a.name,src:a.attributes.avatar,onClick:function(){return T(a.options.position)}});else{var r=a.getIcon("position");i=o.a.createElement(y.a,{key:"overview-"+a.id,alt:a.name,onClick:function(){return T(a.options.position)}},o.a.createElement("span",{className:Object(c.a)("mdi mdi-"+r)}))}I.push(o.a.createElement(b.a,{key:"tooltip-"+a.id,title:a.name,"aria-label":a.name,arrow:!0},i))}};for(var R in w)A(R)}return o.a.createElement(o.a.Fragment,null,o.a.createElement(g.a,{className:l.mapOverview},o.a.createElement(v.a,null,f.a.t("Jump to"),":"),I),o.a.createElement(d.a,{useFlyTo:!0,center:O,zoom:m,className:l.map,whenReady:D},o.a.createElement(p.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.osm.org/{z}/{x}/{y}.png"}),N))}function k(e){var t=e.position,a=e.device,n=e.settings,i=S(),r=null,l=40;if(console.info("Marker for "+a.function+" "+a.name+" added to map."),a.attributes&&a.attributes.avatar&&"data:image/"===a.attributes.avatar.substr(0,11))r=u.a.divIcon({className:i.mapIconContainer,html:'<img src="'+a.attributes.avatar+'" class="'+i.mapIconParent+'" />',iconSize:[64,64]});else{l=30;var d=a.getIcon("position");r=u.a.divIcon({className:i.mapIconContainer,html:'<div class="'+i.mapIconParent+'"><span class="'+Object(c.a)(i.mapIcon,"mdi mdi-"+d)+'"></span></div>',iconSize:[40,40]})}var p=Object(s.useCallback)((function(){this.closeTooltip().openTooltip()}),[]);return o.a.createElement(m.a,{riseOnHover:!0,position:Array.isArray(t)?t:t.split(","),icon:r,onMouseOver:p},o.a.createElement(h.a,{className:i.mapTooltip,direction:n.tooltipDirection||"bottom",permanent:n.tooltipPermanent||!0,offset:[0,l]},a.name))}},268:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return s}));var n=a(0),i=a.n(n),r=a(140);function s(e){return i.a.createElement(r.default,Object.assign({horizontal:!0},e))}},269:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return m})),a.d(t,"Settings",(function(){return h}));var n=a(12),i=a(0),r=a.n(i),s=a(83),o=a(11),c=a(300),l=a(96),u=a(51),d=a(164),p=Object(d.a)((function(e){return{paper:{width:100,height:160,padding:5,textAlign:"center"}}}));function m(e){var t=e.settings,a=p(),d=Object(i.useState)(null),m=Object(n.a)(d,2),h=m[0],f=m[1];Object(i.useEffect)((function(){s.a.getConnection.getRemoteResource(t.url).then((function(e){200===e.statusCode&&f(JSON.parse(e.body))}),(function(e){return console.error(e)}))}),[t.url]);var g=[];if(!h)return null;for(var v in h.day){var b=h.day[v];b.title=1===v?o.a.t("today"):2===v?o.a.t("tomorrow"):b.name;var y=r.a.createElement(c.a,{key:"day-"+v,item:!0},r.a.createElement(l.a,{className:a.paper},r.a.createElement(u.a,{variant:"body1"},b.title),r.a.createElement(u.a,{variant:"caption"},b.date)));g.push(y)}return r.a.createElement(c.a,{container:!0,justify:"space-between",spacing:1},g)}var h={noDevicesAllowed:!0,title:o.a.t("Weather"),icon:"weather-partly-cloudy"}},270:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(36),s=a(8),o=a(22),c=a(19),l=a(31),u=a(17),d=a(32),p=a(2),m=a(107),h=a(305),f=a(608),g=a(293),v=a.n(g),b=a(292),y=a.n(b),O=a(147),S=a.n(O),j=a(294),k=a.n(j),E=a(295),w=a.n(E),C=a(5),x=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;for(var t in this.props.device.states)this.props.device.requestDeviceState(t,!0).catch((function(e){return console.error(e)}));this.props.device.on("stateChange",(function(t,a){"duration"===t&&a&&-1===a.val.indexOf(":")&&(a.val=m.a.timeToHoursMinutesSeconds(a.val)),"isRunning"===t&&a&&"string"===typeof a.val&&(a.val=a.val.indexOf("play")>-1),e.setState(Object(s.a)({},t,a),(function(){e.progress()}))}))}},{key:"progress",value:function(){var e=this;clearTimeout(this.progressTimeout),this.state.isRunning&&!0===this.state.isRunning.val&&this.state.progress&&this.state.progress.val&&this.state.duration&&this.state.duration.val&&(this.progressTimeout=setTimeout((function(){e.setState((function(e){return{progress:Object(r.a)({},e.progress,{val:m.a.timeToSeconds(e.progress.val)+1})}}),(function(){return e.progress()}))}),1e3))}},{key:"openDialog",value:function(){this.props.openDialog(this.props.device)}},{key:"setDeviceState",value:function(e,t){this.props.device.setDeviceState(e,t).catch((function(e){return console.error(e)}))}},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.noHeader,n=e.index,r=e.device,s={},o={};this.state.background&&""!==this.state.background.val&&(s.backgroundImage="url("+((r.options.backgroundUrlPrepend||"")+this.state.background.val)+")"),this.state.duration&&this.state.duration.val&&(o.width=(this.state.progress&&this.state.progress.val||0)+"px");var c=this.state.isRunning&&this.state.isRunning.val?[i.a.createElement(y.a,{onClick:this.setDeviceState.bind(this,"pause",!0)}),i.a.createElement(S.a,null)]:[i.a.createElement(v.a,{onClick:this.setDeviceState.bind(this,"play",!0)})];return i.a.createElement(i.a.Fragment,null,n>0&&i.a.createElement(h.a,{className:t.divider}),i.a.createElement("div",{className:Object(p.a)(t.container,a&&t.noHeader)},i.a.createElement("div",{className:Object(p.a)(this.state.background&&""!==this.state.background.val?t.image:t.noImage),style:s,onClick:this.openDialog.bind(this)},i.a.createElement("div",{className:t.information},i.a.createElement("p",{className:t.informationLeft},this.state.grandParent&&this.state.grandParent.val&&[this.state.grandParent.val,i.a.createElement("br",{key:"br-"+r.id})],this.state.parent&&this.state.parent.val&&this.state.parent.val+" - ",this.state.title&&this.state.title.val),i.a.createElement("p",{className:t.informationRight},this.state.progress&&m.a.timeToHoursMinutesSeconds(this.state.progress.val)," / ",this.state.duration&&this.state.duration.val))),i.a.createElement("div",{className:t.length,style:{}},i.a.createElement("div",{className:t.lengthBar,style:o})),i.a.createElement("div",{className:t.controls},i.a.createElement("div",{className:Object(p.a)(t.controlsBox,t.controlsBoxLeft)}),i.a.createElement("div",{className:Object(p.a)(t.controlsBox,t.controlsBoxCenter)},i.a.createElement(f.a,{className:t.controlButton,size:"small",color:"secondary"},i.a.createElement(k.a,{onClick:this.setDeviceState.bind(this,"previous",!0)})),c.map((function(e,a){return i.a.createElement(f.a,{key:"icon-"+a,className:t.controlButton,size:"large",color:"primary"},e)})),i.a.createElement(f.a,{className:t.controlButton,size:"small",color:"secondary"},i.a.createElement(w.a,{onClick:this.setDeviceState.bind(this,"next",!0)}))),i.a.createElement("div",{className:Object(p.a)(t.controlsBox,t.controlsBoxRight)}))))}}]),t}(i.a.Component),D=Object(C.a)((function(e){return{divider:{margin:"15px -16px"},container:{margin:e.spacing(0,-2)},noHeader:{marginTop:e.spacing(-4)},image:{height:"200px",display:"flex",alignItems:"flex-end",backgroundPosition:"center",cursor:"pointer"},noImage:{backgroundColor:e.palette.primary.main,display:"flex",cursor:"pointer"},information:{backgroundColor:e.palette.primary.main+"66",color:"#fff",padding:"10px",margin:0,width:"100%",minHeight:"45px"},informationLeft:{width:"80%",float:"left",margin:0},informationRight:{width:"19%",float:"right",margin:0,textAlign:"right"},length:{backgroundColor:e.palette.primary.main,width:"100%",height:"7px"},lengthBar:{backgroundColor:e.palette.secondary.main,height:"100%"},controls:{display:"flex",alignItems:"stretch"},controlsBox:{display:"flex",justifyContent:"center",alignItems:"center",paddingTop:"30px"},controlsBoxLeft:{flex:1,flexDirection:"column",alignItems:"baseline"},controlsBoxCenter:{flex:3},controlsBoxRight:{flex:1,justifyContent:"end"},controlButton:{margin:"0 5px"},controlButtonSmall:{margin:"0 10px",fontSize:"1.2rem",height:"32px",width:"32px"}}}))(x);function T(e){var t=e.devices,a=e.settings;return t.map((function(t,n){return i.a.createElement(D,Object.assign({key:"MultimediaItem-"+t.id},e,{index:n,noHeader:0===n&&null===a.icon&&null===a.title,device:t}))}))}a.d(t,"default",(function(){return T}))},323:function(e,t,a){e.exports=a(542)},328:function(e,t,a){},336:function(e,t,a){var n={"./de.js":337,"./en.js":338};function i(e){var t=r(e);return a(t)}function r(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}i.keys=function(){return Object.keys(n)},i.resolve=r,e.exports=i,i.id=336},337:function(e,t,a){"use strict";a.r(t),t.default={"Retrieving settings":"Einstellungen werden geladen","last update":"letzte Aktualisierung","Updates available":"Aktualisierung verf\xfcgbar",on:"an",off:"aus",user:"User",users:"Users",door:"T\xfcr",window:"Fenster",open:"offen",closed:"geschlossen","turn on":"anschalten",power:"Ger\xe4te Status",trigger:"Ger\xe4te Status",brightness:"Helligkeit",wind:"Wind",battery:"Batterie","%DateTime":"%DateTime Uhr",boost:"Boost","blind#level":"Behangh\xf6he","blind#level2":"Lamellenposition","light#power":"Licht","light#level":"Helligkeit",colorTemperature:"Farbtemperatur",hue:"Farbe","light#rgb":"Farbraum Rot-Gr\xfcn-Blau (RGB)",hex:"Farbe",temperature:"Temperatur",humidity:"Luftfeuchtigkeit",setTemperature:"eingestellte Temperatur",bell:"Klingel",lock:"Schlo\xdf",presence:"Pr\xe4senz",running:"Ger\xe4t l\xe4uft",consumption:"Verbrauch"}},338:function(e,t,a){"use strict";a.r(t),t.default={level:"Brightness",colorTemperature:"Color Temperature",hue:"Color",color:"Color",hex:"Color"}},366:function(e,t){},369:function(e,t,a){"use strict";a.r(t),t.default={configurations:{open:{icon:{true:"door-open",false:"door-closed"},state:{true:"open",false:"closed"}}},components:{},actions:{},styles:{}}},370:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(38);t.default={configurations:{temperature:{value:function(e){return e.toFixed(1)},unit:" \xb0C"},setTemperature:{unit:" \xb0C",icon:"thermometer-chevron-up"},humidity:{unit:" %"},boost:{icon:"radiator"}},components:{setTemperature:function(e){var t=r.default.components.LevelComponent;return i.a.createElement(t,Object.assign({min:0,max:35},e))}},actions:{boost:r.default.actions.PowerAction},styles:{}}},38:function(e,t,a){"use strict";a.r(t);var n=a(34),i=a(12),r=a(8),s=a(36),o=a(0),c=a.n(o),l=a(2),u=a(11),d=a(556),p=a(557),m=a(97),h=a(164),f=a(5),g=Object(h.a)((function(e){return{component:{padding:e.spacing(2,8,2,2)},sliderMarkLabel:Object(r.a)({},e.breakpoints.down("md"),{display:"none","&:nth-child(5)":{display:"block"},"&:nth-child(15)":{display:"block"},"&:nth-child(25)":{display:"block"}})}})),v=Object(f.a)((function(e){return{primaryAction:function(e){return Object(s.a)({},e.styles)},secondaryAction:function(e){return Object(s.a)({color:"#999",fontSize:"14px"},e.styles)}}}))((function(e){var t=e.classes,a=e.device,n=e.state,i=e.stateKey;return c.a.createElement("span",{className:Object(l.a)(i===a.primaryStateKey&&t.primaryAction||i===a.secondaryStateKey&&t.secondaryAction)},n.value," ",n.unit)}));function b(e){var t=e.device,a=e.stateKey,n=e.stateVal,r=e.onChange,s=Object(o.useState)(n),l=Object(i.a)(s,2),u=l[0],d=l[1];return Object(o.useEffect)((function(){return d(n)}),[n]),c.a.createElement(p.a,{checked:u,onChange:r||function(e){d(e.target.checked),t.setDeviceState(a,e.target.checked).catch((function(e){return console.error(e)}))},value:!0!==u,color:"primary"})}function y(e){var t=e.device,a=e.stateKey,n=e.stateVal;if(!0===n||n>0)return c.a.createElement(v,Object.assign({},e,{onChange:null}));return c.a.createElement(m.a,{variant:"outlined",color:"primary",size:"small",startIcon:c.a.createElement("span",{className:"mdi mdi-power"}),onClick:function(){t.setDeviceState(a,!0).catch((function(e){return console.error(e)}))}},u.a.t("turn on"))}function O(e){var t=e.label,a=e.br||!1;return c.a.createElement(c.a.Fragment,null,t,a&&c.a.createElement("br",null))}function S(e){var t=e.title,a=e.children,n=g();return c.a.createElement(c.a.Fragment,null,c.a.createElement(O,{label:t}),c.a.createElement("div",{className:n.component},a))}function j(e){var t=e.device,a=e.stateKey,r=e.stateVal,s=e.title,l=e.min,u=e.max,p=e.step,m=e.markSteps,h=g(),f=Object(o.useState)(r),v=Object(i.a)(f,2),b=v[0],y=v[1];Object(o.useEffect)((function(){return y(r)}),[r]),p=p||1;var O=((u=u||100)-(l=l||0))/((m=m||11)-1)||10;return c.a.createElement(S,{title:s||a},c.a.createElement(d.a,{classes:{markLabel:h.sliderMarkLabel},onChangeCommitted:function(e,n){y(n),t.setDeviceState(a,n).catch((function(e){return console.error(e)}))},defaultValue:b,valueLabelDisplay:"auto",marks:Object(n.a)(Array(m).keys()).map((function(e){return{value:l+e*O,label:l+e*O}})),min:l,max:u,step:p}))}t.default={configurations:{_any:{value:function(e){return e.toString()}},battery:{unit:" %",icon:"battery-medium"},door:{icon:{true:"door-open",false:"door-closed"},state:{true:"open",false:"closed"}},humidity:{unit:" %",icon:"water-percent"},level:{unit:" %"},position:{icon:"map-marker"},power:{state:{true:"on",false:"off"},icon:"power"},temperature:{unit:" \xb0C",icon:"thermometer"},trigger:{state:{true:"on",false:"off"},icon:"power"},wind:{unit:" km/h",icon:"weather-windy"}},components:{Label:O,Component:S,LevelComponent:j,level:j},actions:{Action:v,PowerAction:b,TriggerAction:y,power:b,trigger:y},styles:{_any:{state:{true:{color:"#090",fontWeight:"bold"},false:{color:"#999"}}}}}},532:function(e,t,a){"use strict";a.r(t),t.default={configurations:{position:{icon:"home"}},components:{},actions:{},styles:{}}},533:function(e,t,a){"use strict";a.r(t),t.default={configurations:{position:{icon:"account"}},components:{},actions:{},styles:{}}},534:function(e,t,a){"use strict";a.r(t),t.default={configurations:{open:{icon:{true:"window-open-variant",false:"window-closed-variant"},state:{true:"open",false:"closed"}}},components:{},actions:{},styles:{}}},542:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(18),s=a.n(r),o=(a(328),a(50)),c=a(23),l=a(63),u=a(64),d=a(68),p=a(65),m=a(67),h=a(56),f=a(194),g=a.n(f),v=a(271),b=a.n(v),y=a(300),O=a(118),S=a(51),j=a(615),k=a(8),E=a(164),w=Object(E.a)((function(e){return{gridContainer:Object(k.a)({paddingLeft:e.spacing(1)},e.breakpoints.down("md"),{paddingLeft:e.spacing(.4)})}}));function C(e){for(var t=e.contents,a=void 0===t?{}:t,n=w(),r=Object.keys(a).length,s=[],o=1;o<=r;o++)a[o]?s.push(i.a.createElement(y.a,{key:o,item:!0,xs:12,sm:6,md:6,lg:Math.round(12/r),xl:Math.round(12/r)},a[o])):console.warn("No content for column #"+o+"!");return i.a.createElement(y.a,{container:!0,spacing:0,className:n.gridContainer},s)}var x=a(3),D=a(2),T=a(620),N=a(598),I=a(301),A=a(145),R=a.n(A),L=a(272),M=a.n(L),K=a(273),_=a.n(K),H=a(274),B=a.n(H),P=a(275),U=a.n(P),z=a(163),F=a(597),V=Object(E.a)((function(e){return{success:{backgroundColor:z.a[600]},error:{backgroundColor:e.palette.error.dark},info:{backgroundColor:e.palette.primary.main},warning:{backgroundColor:F.a[700]},icon:{fontSize:20},iconVariant:{opacity:.9,marginRight:e.spacing(1)},message:{display:"flex",alignItems:"center"}}})),G={success:M.a,warning:_.a,error:B.a,info:U.a};function J(e){var t=V(),a=e.className,n=e.open,r=e.autoHideDuration,s=e.message,o=e.closeButton,c=e.onClose,l=e.variant,u=Object(x.a)(e,["className","open","autoHideDuration","message","closeButton","onClose","variant"]),d=G[l];return n=n||!0,r=r||null,i.a.createElement(T.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:n,autoHideDuration:r,onClose:c},i.a.createElement(N.a,Object.assign({className:Object(D.a)(t[l],a),message:i.a.createElement("span",{id:"client-snackbar",className:t.message},i.a.createElement(d,{className:Object(D.a)(t.icon,t.iconVariant)}),s),action:o&&[i.a.createElement(I.a,{key:"close","aria-label":"close",color:"inherit",onClick:c},i.a.createElement(R.a,{className:t.icon}))]},u)))}var q=a(11),W=a(83),Z=a(22),Y=a(19),$=a(31),Q=a(17),X=a(61),ee=a(32),te=a(36),ae=a(146),ne=a.n(ae),ie={defaults:a(38).default,blind:a(230).default,door:a(369).default,heating:a(370).default,jalousie:a(230).default,light:a(543).default,location:a(532).default,user:a(533).default,window:a(534).default},re=function(e){function t(e){var a;if(Object(Z.a)(this,t),(a=Object($.a)(this,Object(Q.a)(t).call(this))).function=e,!a.function)throw new Error("No function given!");return a.functionId=a.function.toLowerCase(),a.defaults=ie.defaults.configurations,a.configurations=ie[a.functionId]&&ie[a.functionId].configurations||{},a.defaultStyles=ie.defaults.styles,a.styles=ie[a.functionId]&&ie[a.functionId].styles||{},a.components=Object(te.a)({},ie.defaults.components,{},ie[a.functionId]&&ie[a.functionId].components||{}),a.actions=Object(te.a)({},ie.defaults.actions,{},ie[a.functionId]&&ie[a.functionId].actions||{}),a}return Object(ee.a)(t,e),Object(Y.a)(t,[{key:"_applyFunction",value:function(e,t){return this._isFunction(e)?e(t):t}},{key:"_getValueFromSettings",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";for(var a in e)if(void 0!==e[a])return e[a];return t}},{key:"_isFunction",value:function(e){return e&&"function"===typeof e}},{key:"_isValue",value:function(e){return void 0!==e}},{key:"_setObjectStructure",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return e&&"object"==typeof e?"object"!=typeof e||e.default||(e.default=t):e={default:e||t},e}}]),t}(ne.a),se={"hm-rpc":"HomeMatic"},oe=a(617),ce=a(109),le=function(e){function t(e,a){var n;arguments.length>2&&void 0!==arguments[2]?arguments[2]:window.sysLang;Object(Z.a)(this,t);try{n=Object($.a)(this,Object(Q.a)(t).call(this,e.function))}catch(i){throw new Error("No function given for device "+e.name+"!")}if(n.id=e.id,n.name=e.name,n.room=e.room||null,n.states=e.states,n.options=e.options,n.attributes=e.attributes||{},n.socket=a,!n.options||"object"!==typeof n.options||0===Object.keys(n.options).length)throw new Error("Device"+(e.id||e.name?" "+(e.name||e.id):"")+" not defined for jarvis!");if(!n.states||"object"!==typeof n.states||0===Object.keys(n.states).length)throw new Error("Insufficent properties provided"+(e.id||e.name?" for device "+(e.name||e.id):"")+" (no states defined)!");if(!(n.id&&n.name&&n.function))throw new Error("Insufficent properties provided"+(e.id||e.name?" for device "+(e.name||e.id):"")+" (no id, name or function defined)!");if(!n.socket)throw new Error("No socket given!");return n.children=e.children||[],n.parent=e.parent||null,n._setProperties(),n.stateSubscriptions=[],n.on("error",(function(e){return console.error("Device error occured!",e)})),n}return Object(ee.a)(t,e),Object(Y.a)(t,[{key:"_getStateFromKey",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"state";if(e&&"object"===typeof e)return e;var a=this.states[e||this.primaryStateKey];return"string"===typeof a?(this.states[e||this.primaryStateKey]=Object(k.a)({},t,{node:a}),a=this.states[e||this.primaryStateKey]):"string"===typeof a[t]&&(this.states[e||this.primaryStateKey][t]={node:a[t]},a=this.states[e||this.primaryStateKey]),a&&a[t]?"object"!=typeof a[t]||a[t].node?a:"No "+t+" specified for device "+this.name+"!":"Incorrect or non-defined state key for device "+this.name+"!"}},{key:"_getConfigurationSetting",value:function(e,a,n,i){if(this[e][a]){if("object"===typeof this[e][a][n])return Object(X.a)(Object(Q.a)(t.prototype),"_isValue",this).call(this,this[e][a][n][i])?this[e][a][n][i]:this[e][a][n].default;if(Object(X.a)(Object(Q.a)(t.prototype),"_isFunction",this).call(this,this[e][a][n]))return this[e][a][n](i);if("string"===typeof this[e][a][n])return this[e][a][n]}else if(this[e]._any){if("object"===typeof this[e]._any[n])return Object(X.a)(Object(Q.a)(t.prototype),"_isValue",this).call(this,this[e]._any[n][i])?this[e]._any[n][i]:this[e]._any[n].default;if(Object(X.a)(Object(Q.a)(t.prototype),"_isFunction",this).call(this,this[e]._any[n]))return this[e]._any[n](i)}}},{key:"_getUserSetting",value:function(e,a,n){if(this.options[a][e])return"object"===typeof this.options[a][e]?Object(X.a)(Object(Q.a)(t.prototype),"_isValue",this).call(this,this.options[a][e][n])?this.options[a][e][n]:this.options[a][e].default:Object(X.a)(Object(Q.a)(t.prototype),"_isFunction",this).call(this,this.options[a][e])?this.options[a][e](n):this.options[a][e]}},{key:"_setProperties",value:function(){var e=this,a=Object.keys(this.states);this.options.ignoredStates&&(this.options.ignoredStates=Array.isArray(this.options.ignoredStates)?this.options.ignoredStates:[this.options.ignoredStates],this.options.ignoredStates.forEach((function(t){e.states[t]&&delete e.states[t]}))),this.options.hiddenStates=[],this.options.hideStates&&(this.options.hideStates=Array.isArray(this.options.hideStates)?this.options.hideStates:[this.options.hideStates],this.options.hideStates.forEach((function(t){e.states[t]&&e.options.hiddenStates.push(t)}))),this.primaryStateKey=this.options.primary||a[0],this.secondaryStateKey=this.options.secondary||null,["value","state","unit","icon","styles"].forEach((function(n){var i=e.options[n]&&Object.keys(e.options[n])[0];e.options[n]=e.options[n]?Object(X.a)(Object(Q.a)(t.prototype),"_setObjectStructure",e).call(e,i&&a.indexOf(i)>-1?e.options[n]:Object(k.a)({},e.primaryStateKey,e.options[n])):{}})),this.states[this.primaryStateKey]=this._getStateFromKey(this.primaryStateKey),this.options.manufacturer=this.primaryStateKey&&se[this.states[this.primaryStateKey].state.node.substr(0,this.states[this.primaryStateKey].state.node.indexOf("."))]||"unknown",this.options.groups=Array.isArray(this.options.group)?this.options.group:[this.options.group],this.options.sort=this.options.sort||999,this.options.label=this.options.label&&"string"===typeof this.options.label&&this.options.label.replace(/%name%/g,this.name)||this.options.label||this.name,this.options.divider=this.options.divider||!1}},{key:"_updateDeviceState",value:function(e,a){var n=this;return a.timeChanged=Object(oe.a)(new Date(a.lc-5e3),{locale:ce.a,includeSeconds:!0,addSuffix:!0}),a.unit="",a.value=a.val,[{value:"value"},{state:"value"},{unit:"unit"}].forEach((function(i){var r=Object.keys(i).toString(),s=Object.values(i).toString(),o={};o.options=n._getUserSetting(e,r,a.value),["configurations","defaults"].forEach((function(t){o[t]=n._getConfigurationSetting(t,e,r,a.value)})),a[s]=Object(X.a)(Object(Q.a)(t.prototype),"_getValueFromSettings",n).call(n,o,a[s])})),a.value=q.a.t(a.value),a}},{key:"get",value:function(e){return this[e]||null}},{key:"getAction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e=e||this.primaryStateKey;var a=this.states[e].state.value,n=a.val,r=!t&&this.actions[e]||this.actions.Action;return i.a.createElement(r,{key:"action-"+this.id+"-"+e,device:this,state:a,stateKey:e,stateVal:n,styles:this.getStyle("state",e,n)})}},{key:"getComponent",value:function(e){e=e||this.primaryStateKey;var t=this.states[e].state.value.val,a=this.components[e];return a&&i.a.createElement(a,{title:q.a.t(this.function+"#"+e),device:this,stateKey:e,stateVal:t})||q.a.t(this.function+"#"+e)}},{key:"getDeviceState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=this.states[e||this.primaryStateKey],n=null;return a&&a.state&&null!==t&&void 0!==a.state.value&&void 0!==a.state.value[t]?n=a.state.value[t]:a&&a.state&&null===t&&void 0!==a.state.value&&(n=a.state.value),n}},{key:"getIcon",value:function(e){var a=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"?";e=e||this.primaryStateKey;var r={};return r.options=this._getUserSetting(e,"icon",n),["configurations","defaults"].forEach((function(t){r[t]=a._getConfigurationSetting(t,e,"icon",n)})),Object(X.a)(Object(Q.a)(t.prototype),"_getValueFromSettings",this).call(this,r,i)}},{key:"getOption",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default";return this.options[e]&&(this.options[e][t]||this.options[e].default)||this.options[e]||null}},{key:"getStyle",value:function(e,a){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default",r={};return r.options=this._getUserSetting(a,"styles",e,i),["styles","defaultStyles"].forEach((function(t){r[t]=n._getConfigurationSetting(t,a,e,i)})),Object(X.a)(Object(Q.a)(t.prototype),"_getValueFromSettings",this).call(this,r,{})}},{key:"requestDeviceStates",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=[];for(var a in this.states)t.push(this.requestDeviceState(a,e));return t}},{key:"requestDeviceState",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t=t||this.primaryStateKey;var n=this._getStateFromKey(t);return"string"==typeof n?Promise.reject({success:!1,stateKey:t,error:n}):new Promise((function(i,r){void 0!==n.state.value&&e.stateSubscriptions.indexOf(t)>-1?(e.emit("stateChange",t,n.state.value),i({success:!0,stateKey:t,cached:!0})):e.socket.getState(n.state.node).then((function(s){null===s&&r({success:!1,stateKey:t,error:"State "+n.state.node+" not found!"}),n.state.value=e._updateDeviceState(t,s),e.emit("stateChange",t,n.state.value),a&&e.subscribeDeviceState(t).catch((function(e){return r(e)})),i({success:!0,stateKey:t,cached:!1})})).catch((function(e){return r({success:!1,stateKey:t,error:e})}))}))}},{key:"requestDeviceStateHistory",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t=t||this.primaryStateKey;var i=this._getStateFromKey(t);return"string"==typeof i?Promise.reject({success:!1,stateKey:t,error:i}):new Promise((function(r,s){i.state.historyCache=i.state.historyCache||{},n.start&&n.end&&n.step&&void 0!==i.state.historyCache[n.start+"#"+n.end+"#"+n.step]?(e.emit("historyChange",t,i.state.historyCache[n.start+"#"+n.end+"#"+n.step],i.state),r({success:!0,stateKey:t,cached:!0})):e.socket.getStateHistory(i.state.node,n).then((function(o){null===o&&s({success:!1,stateKey:t,error:"State "+i.state.node+" not found!"}),n.start&&n.end&&n.step&&(i.state.historyCache[n.start+"#"+n.end+"#"+n.step]=o),i.state.history=o,e.emit("historyChange",t,i.state.history,i.state),a&&e.subscribeDeviceState(t).catch((function(e){return s(e)})),r({success:!0,stateKey:t,cached:!1})})).catch((function(e){return s({success:!1,stateKey:t,error:e})}))}))}},{key:"setAction",value:function(e){this.options.action=e}},{key:"setComponent",value:function(e){this.options.label=e}},{key:"setDeviceState",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1?arguments[1]:void 0;t=t||this.primaryStateKey;var n=this._getStateFromKey(t,"action");return"string"==typeof n?Promise.reject({success:!1,stateKey:t,error:n}):new Promise((function(i,r){e.socket.setState(n.action.node,a).then((function(a){-1===e.stateSubscriptions.indexOf(t)&&e.requestDeviceState(t),i({success:!0,stateKey:t})})).catch((function(e){return r({success:!1,stateKey:t,error:e})}))}))}},{key:"subscribeDeviceState",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t=t||this.primaryStateKey;var a=this._getStateFromKey(t);return"string"==typeof a?Promise.reject({success:!1,stateKey:t,error:a}):(this.stateSubscriptions.push(t),new Promise((function(n){e.socket.subscribeState(a.state.node,(function(n,i,r){i&&i.val!==e.getDeviceState(t,"val")&&(a.state.value=e._updateDeviceState(t,i),e.emit("stateChange",t,a.state.value),e.children.forEach((function(e){return e.emit("stateChange",t,a.state.value)})))})),n({success:!0,stateKey:t})})))}}]),t}(re),ue=a(84),de=a(60),pe=a(599),me=a(600),he=a(89),fe=a(279),ge=a.n(fe),ve=a(280),be=a.n(ve),ye=a(281),Oe=a.n(ye),Se=Object(E.a)((function(e){return{appBar:{flexGrow:1,boxShadow:"none",transform:"none"},toolbar:{backgroundColor:e.palette.primary.main},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1},icon:Object(c.a)({},e.components.icon,{color:"#fff",paddingRight:"6px",width:"1em",height:"1em",display:"inline-block",fontSize:"1.5rem",transition:"fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms",flexShrink:0,userSelect:"none"})}}));function je(e){var t=Se(),a=e.children,n=e.title,r=e.connectionStatus,s=n.indexOf("|")>-1?n.split("|"):[null,n],o=Object(de.a)(s,2),c=o[0],l=o[1],u=r?i.a.createElement(ge.a,null):"pending"===r?i.a.createElement(be.a,null):i.a.createElement(Oe.a,null),d=r?"Connected to ioBroker":"pending"===r?"Not connected to ioBroker! Reconnecting..":"Not connected to ioBroker! Connection failed!";return i.a.createElement(pe.a,{id:"appBar",position:"static",className:t.appBar},i.a.createElement(me.a,{className:t.toolbar},i.a.createElement(S.a,{variant:"h6",className:t.title},c&&i.a.createElement("span",{className:Object(D.a)(t.icon,"mdi mdi-"+c)}),"null"!==l&&l),i.a.createElement(I.a,{color:"inherit"},i.a.createElement(he.a,{title:q.a.t(d)},u))),a)}var ke=a(12);function Ee(){var e=window;return{width:e.innerWidth,height:e.innerHeight}}var we=a(616),Ce=a(602),xe=a(549),De=Object(E.a)((function(e){return{icon:Object(te.a)({},e.components.icon,{color:"#fff",paddingBottom:"6px",width:"1em",height:"1em",display:"inline-block",fontSize:"1.5rem",transition:"fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms",flexShrink:0,userSelect:"none"}),tabs:{backgroundColor:e.palette.primary.main,paddingLeft:e.spacing(),color:"#fff",width:"calc(100% - "+e.spacing()+"px)",zIndex:101,borderBottom:"5px solid #eee"},fixed:{position:"fixed",top:0},indicator:{backgroundColor:"#fff"},fullscreen:{marginLeft:-e.spacing(),marginTop:"-5px"},grid:{paddingBottom:"30px"}}}));function Te(e){var t=e.tabs,a=e.selectTab,r=De(),s=Object(n.useRef)({}),o=Object(n.useState)(0),c=Object(ke.a)(o,2),l=c[0],u=c[1],d=Object(n.useState)(!1),p=Object(ke.a)(d,2),m=p[0],h=p[1],f=Object(n.useCallback)((function(){var e=s.current.top+s.current.height-53,t=window.scrollY>=e;h((function(a){return a!==t?(document.getElementById("root").style.paddingTop=t?e-5-8+"px":0,t):a}))}),[s]);Object(n.useEffect)((function(){return s.current={top:document.getElementById("tabBar").offsetTop,height:document.getElementById("tabBar").offsetHeight},window.addEventListener("scroll",f),function(){return window.removeEventListener("keydown",f,0)}}),[f]);var g=t.map((function(e,t){var a=e.indexOf("|")>-1?e.split("|"):[null,e],n=Object(ke.a)(a,2),s=n[0],o=n[1];return i.a.createElement(Ce.a,{key:"tab"+t,icon:i.a.createElement("span",{className:Object(D.a)(r.icon,"mdi mdi-"+s)}),label:m||"null"===o?null:o})}));return i.a.createElement(we.a,{id:"tabBar",value:l,onChange:function(e,n){a(n,t[n]),u(n)},variant:"scrollable",classes:{root:Object(D.a)(r.tabs,m&&r.fixed),indicator:r.indicator}},g)}function Ne(e){var t=e.children,a=e.selectedTab,r=e.renderedTab,s=e.fullscreen,o=De(),c=function(){var e=Object(n.useState)(Ee()),t=Object(ke.a)(e,2),a=t[0],i=t[1];return Object(n.useEffect)((function(){function e(){i(Ee())}return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]),a}().height,l=Object(n.useState)(c),u=Object(ke.a)(l,2),d=u[0],p=u[1],m=Object(n.useRef)({});Object(n.useEffect)((function(){m.current=document.getElementById("appBar").offsetHeight,p(c-m.current+5)}),[c]);var h=Object(n.useState)(null),f=Object(ke.a)(h,2),g=f[0],v=f[1];return Object(n.useEffect)((function(){setTimeout((function(){return v(a!==r)}),10)}),[a,r]),i.a.createElement(xe.a,{role:"tabpanel",hidden:g,id:"tabpanel-"+r,className:Object(D.a)(s?o.fullscreen:o.grid),style:{height:d+"px"}},t)}var Ie=a(97),Ae=a(618),Re=a(610),Le=a(606),Me=a(607),Ke={AdapterStatus:a(264).Settings||{},Chart:a(265).Settings||{},DateTime:a(266).Settings||{},Map:a(267).Settings||{},Multimedia:a(270).Settings||{},StateList:a(140).Settings||{},StateListHorizontal:a(268).Settings||{},Weather:a(269).Settings||{}},_e={AdapterStatus:a(264).default,Chart:a(265).default,DateTime:a(266).default,Map:a(267).default,Multimedia:a(270).default,StateList:a(140).default,StateListHorizontal:a(268).default,Weather:a(269).default},He=a(5),Be=Object(He.a)((function(e){return{root:{margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}}))((function(e){var t=e.children,a=e.classes,n=e.onClose,r=Object(x.a)(e,["children","classes","onClose"]);return i.a.createElement(Re.a,Object.assign({disableTypography:!0,className:a.root},r),i.a.createElement(S.a,{variant:"h6"},t),n?i.a.createElement(I.a,{"aria-label":"close",className:a.closeButton,onClick:n},i.a.createElement(R.a,null)):null)})),Pe=Object(He.a)((function(e){return{root:Object(k.a)({padding:e.spacing(2)},e.breakpoints.down("md"),{paddingLeft:e.spacing(1)})}}))(Le.a),Ue=Object(He.a)((function(e){return{root:{margin:0,padding:e.spacing(1)}}}))(Me.a),ze=function(e){function t(e){var a;return Object(Z.a)(this,t),(a=Object($.a)(this,Object(Q.a)(t).call(this,e))).state={children:[]},a}return Object(ee.a)(t,e),Object(Y.a)(t,[{key:"componentDidUpdate",value:function(e,t){var a=this,n=this.props.contents&&this.props.contents.device;if(n.id&&this.props.contents.ts!==e.contents.ts)if(n.children.length)console.info("Got "+Object.keys(n.children).length+" states for device "+n.name+" from cache."),this.setState({children:n.children},(function(){return a.forceUpdate()}));else{var i=[],r=[];for(var s in n.states)if(!(void 0===n.states[s].state||n.options.hiddenStates.indexOf(s)>-1)){var o=new le({parent:n,id:n.id+"#"+s,name:n.name,function:n.function,states:Object(k.a)({},s,n.states[s]),options:{primary:s,divider:0!==r.length,subgroup:null,subtitle:null}},W.a.getConnection,window.language);n.children.push(o),i.push(o.requestDeviceState(null,!0)),r.push(o)}Promise.allSettled(i).then((function(){console.info("Retrieved "+Object.keys(r).length+" states for device "+n.name+".",i),a.setState({children:r},(function(){return a.forceUpdate()}))}))}else n.id||this.props.contents.ts===e.contents.ts||this.setState({children:[]},(function(){return a.forceUpdate()}))}},{key:"shouldComponentUpdate",value:function(e,t){return!this.props.contents||this.props.contents.ts!==e.contents.ts}},{key:"render",value:function(){var e=this.props,t=e.open,a=e.closeDialog,n=e.contents.device;return i.a.createElement(Ae.a,{onClose:a,open:t||!1,maxWidth:"md",fullWidth:!0},i.a.createElement(Be,{onClose:a},n.name),i.a.createElement(Pe,{dividers:!0,style:{padding:0}},i.a.createElement(_e.StateList,{openDialog:null,devices:this.state.children,component:!0,action:!0})),i.a.createElement(Ue,null,i.a.createElement(Ie.a,{autoFocus:!0,onClick:a,color:"primary"},"Close")))}}]),t}(i.a.Component),Fe=a(611),Ve=a(612),Ge=a(613),Je=a(199),qe=Object(E.a)((function(e){return{card:Object(k.a)({margin:e.spacing(1,1,0,0)},e.breakpoints.down("md"),{margin:e.spacing(.4,.4,0,0)}),cardHeaderNoContents:{padding:e.spacing()},cardAvatar:function(t){return Object(te.a)({backgroundColor:e.palette.primary.main,color:"#fff",fontSize:"24px"},t)},cardContent:Object(k.a)({padding:e.spacing(0,2)},e.breakpoints.down("md"),{padding:e.spacing(0)})}}));function We(e){var t=e.title,a=e.icon,n=e.iconStyle,r=qe(n);return i.a.createElement(Fe.a,{className:r.card},i.a.createElement(Ve.a,{avatar:null!==a&&i.a.createElement(Je.a,{variant:"rounded",classes:{root:r.cardAvatar}},i.a.createElement("span",{className:"mdi mdi-"+(a||"home")})),title:t&&i.a.createElement(S.a,{variant:"h5",component:"h2"},t)}),i.a.createElement(Ge.a,{className:r.cardContent},e.children))}var Ze=a(614),Ye=a(298),$e=a(162),Qe=a(296),Xe=a.n(Qe).a[700],et=$e.a,tt=Object(Ye.a)({palette:{primary:{main:Xe},secondary:et},components:{icon:{fontSize:"24px",color:Xe},finger:{cursor:"pointer"}}}),at=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t&&!0!==Ke[t.settings.component.module].noDevicesAllowed)return console.error("Group "+e+" defined in columns but not assigned to any devices!"),null;t.settings._global=a.settings,t.settings.component="string"===typeof t.settings.component?{module:t.settings.component}:t.settings.component||{};var n=_e[t.settings.component.module||"StateList"];return void 0===n?(console.error('Undefined component "'+t.settings.component.module+'" used!'),null):i.a.createElement(n,{key:"Tag"+e,devices:t.devices,openDialog:a.action?a.action:null,settings:Object(c.a)({},t.settings,{},a)})},nt=function(e,t){for(var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n={},r=Object.keys(e).length,s=1;s<=r;s++){var o=e[s];if(n[s]=n[s]||[],o&&Object.keys(o).length)for(var c in o){var l=t[c]||{};l.settings=o[c]||{},l.settings._global=a.settings,l.settings.component="string"===typeof l.settings.component?{module:l.settings.component}:l.settings.component||{};var u=at(c,l,a);u&&n[s].push(i.a.createElement(We,{key:"Box-"+c,title:null===l.settings.title?null:l.settings.title||l.name||Ke[l.settings.component.module]&&Ke[l.settings.component.module].title,icon:null===l.settings.icon?null:l.settings.icon||Ke[l.settings.component.module]&&Ke[l.settings.component.module].icon,iconStyle:l.settings.iconStyle},u))}else n[s].push(null)}return n},it=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={selectedTab:0,tabTitle:"",notificationDrawer:!1,dialog:!1,dialogContents:{ts:0,device:{}}},a.closeDialog=a.closeDialog.bind(Object(ue.a)(a)),a.openDialog=a.openDialog.bind(Object(ue.a)(a)),a.selectTab=a.selectTab.bind(Object(ue.a)(a)),a.gridContents={},a.layout=a.props.settings.layout,a.tabs=Object.keys(a.layout),a.tabsEnabled=1!==a.tabs[0],a.state.tabTitle=a.tabs[a.state.selectedTab],a.tabsEnabled||(a.layout={Home:a.layout},a.tabs.push("1")),a.widgetProps={},a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"getTabPanels",value:function(){var e=0,t=[];for(var a in this.layout){var n=this.layout[a],r=Object.keys(n)[0],s=Number.isNaN(parseInt(r));!this.gridContents[a]&&s?this.gridContents[a]=at(n,Object(c.a)({},this.props.groups[r],{settings:n[r]}),Object(c.a)({settings:this.props.settings,action:this.openDialog},this.widgetProps)):this.gridContents[a]||(this.gridContents[a]=i.a.createElement(C,{contents:nt(n,this.props.groups,Object(c.a)({settings:this.props.settings,action:this.openDialog},this.widgetProps))}));var o=i.a.createElement(Ne,{key:"tabPanel-"+e,renderedTab:e,selectedTab:this.state.selectedTab,fullscreen:s},this.gridContents[a]);t.push(o),e++}return t}},{key:"closeDialog",value:function(){this.setState({dialog:!1,dialogContents:{ts:Date.now(),device:{}}})}},{key:"openDialog",value:function(e){this.setState({dialog:!0,dialogContents:{ts:Date.now(),device:e}})}},{key:"selectTab",value:function(e,t){this.setState({selectedTab:e,tabTitle:t})}},{key:"render",value:function(){return i.a.createElement(Ze.a,{theme:tt},i.a.createElement(je,{title:this.props.settings.topBarTitle||this.tabsEnabled&&this.state.tabTitle||"jarvis",connectionStatus:this.props.connectionStatus},this.tabsEnabled&&i.a.createElement(Te,{tabs:this.tabs,selectTab:this.selectTab})),i.a.createElement(ze,{open:this.state.dialog,contents:this.state.dialogContents,closeDialog:this.closeDialog}),this.getTabPanels())}}]),t}(i.a.Component),rt=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={loaded:[],connected:!1,error:!1,errorMessage:""},a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this,t="localhost"===window.location.hostname?"https://192.168.178.29:8082":window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""),a=[{event:"connect",callback:function(){return e.setState({connected:!0,error:!1,errorMessage:""})}},{event:"reconnect",callback:function(){return e.setState({connected:"pending",error:!1,errorMessage:""})}},{event:"disconnect",callback:function(t){return e.setState({connected:!1,error:!0,errorMessage:t+".."})}},{event:"error",callback:function(t){return e.setState({connected:!1,error:!0,errorMessage:t+".."})}}];this.socket=W.a.connect(t,a),this.settings={},this.socket.getState("jarvis.0.settings").then((function(t){try{t&&(e.settings=Object(c.a)({},e.settings,{},JSON.parse(t.val)||{}),e.useSettings()),e.setState({loaded:[].concat(Object(o.a)(e.state.loaded),["settings"])})}catch(a){console.error("GET_SETTINGS: "+a.message),e.setState({error:!0,errorMessage:"Error parsing settings!"})}})).catch((function(t){console.error("GET_SETTINGS: "+t.message),e.setState({error:!0,errorMessage:t})})),this.settings.iobroker={},this.socket.getObject("system.config",(function(t,a){a&&a.common&&(e.settings.iobroker=a.common)})),this.devices={},this.groups={},this.socket.getState("jarvis.0.devices").then((function(t){try{e.devices=JSON.parse(t.val),e.processDevices(e.devices).then((function(t){e.groups=t,e.setState({loaded:[].concat(Object(o.a)(e.state.loaded),["groups"])})}))}catch(a){console.error("GET_DEVICES: "+a.message),e.setState({error:!0,errorMessage:"Error parsing devices!"})}})).catch((function(t){console.error("GET_DEVICES: "+t.message),e.setState({error:!0,errorMessage:"Socket failed while getting devices!"})}))}},{key:"useSettings",value:function(){if(this.settings.debug&&this.settings.debug.name&&this.settings.debug.email&&this.settings.debug.email.indexOf("@")>-1){g.a.init("36n1xl/jarvis");var e=b()(this.settings.debug.name+"#"+this.settings.debug.email,"e63359dc-bc1c-476e-81cd-8f580d09a557");g.a.identify(e,{name:this.settings.debug.name,email:this.settings.debug.email}),console.info("Opt-In for providing debugging details to the developer. Your ID is: "+e)}if(window.language=(this.settings.language||navigator.language||navigator.userLanguage||"en").substr(0,2),q.a.setLanguage(window.language),q.a.loadTranslations(["en","de"]),this.settings.pageTitle&&(document.title=this.settings.pageTitle),this.settings.pageFavicon&&"data:"===this.settings.pageFavicon.substr(0,5)&&(document.getElementById("favicon").href=this.settings.pageFavicon),this.settings.translations){var t=this.settings.translations;for(var a in t)q.a.setTranslation(a,t[a])}}},{key:"groupDevice",value:function(e,t){return t.get("options").groups.forEach((function(a){var n=a.toLowerCase().replace(/ /g,"");e[n]?e[n].devices.push(t):e[n]={id:n,name:a,devices:[t]}})),e}},{key:"processDevice",value:function(e){var t=[],a=null;try{a=new le(e,this.socket,window.language),t.push(a.requestDeviceState(null,!0)),a.secondaryStateKey&&t.push(a.requestDeviceState(a.secondaryStateKey,!0))}catch(n){console.warn(n.message)}return new Promise((function(e){Promise.allSettled(t).then((function(t){t.forEach((function(e){"rejected"===e.status&&console.error(e)})),e(a)}))}))}},{key:"processDevices",value:function(e){var t=this,a=[],n={},i=0,r=0,s=function(s){i++,e[s].options=e[s].jarvis,delete e[s].jarvis;var o=Object(c.a)({},e[s],{id:s});a.push(new Promise((function(e,a){t.processDevice(o).then((function(i){null!==i&&(r++,n=t.groupDevice(n,i),e(s)),a(s)}))})));var l=function(e){var i=o.states[e];i&&void 0!==i.jarvis&&a.push(new Promise((function(a,l){t.processDevice(Object(c.a)({},o,{id:s+"#"+e,states:Object(h.a)({},e,i),options:i.jarvis})).then((function(e){null!==e&&(r++,n=t.groupDevice(n,e),a(s)),l(s)}))})))};for(var u in o.states)l(u)};for(var o in e)s(o);return new Promise((function(e){return Promise.allSettled(a).then((function(t){for(var a in n)n[a].devices.sort((function(e,t){return e.options.sort>t.options.sort?1:t.options.sort>e.options.sort?-1:0}));console.info("Processed "+i+" devices. Added "+r+" devices in "+Object.keys(n).length+" groups.",t,n),e(n)}))}))}},{key:"renderError",value:function(){return console.error(JSON.stringify(this.state.errorMessage)),i.a.createElement(J,{key:"StatusSnackbar",variant:"error",closeButton:!1,message:this.state.errorMessage.toString()})}},{key:"renderLoadingProgress",value:function(){var e=this.props.classes;return i.a.createElement(y.a,{key:"loadingProcess",container:!0,spacing:0,direction:"column",justify:"center",alignItems:"center",style:{minHeight:"100vh"}},i.a.createElement(O.a,null),i.a.createElement(S.a,{className:e.loading},q.a.t("Retrieving settings"),"..."))}},{key:"renderLoadingSkeleton",value:function(e){for(var t=this.props.classes,a=e.topBar,n=e.tabBar,r=e.gridColumns,s=function(e){return i.a.createElement(j.a,{animation:"wave",variant:"rect",className:t.gridItem,height:e.height})},o={},c=1;c<=r;c++){o[c]=o[c]||[];for(var l=3*Math.random()+2,u=1;u<=l;u++)o[c].push(i.a.createElement(s,{key:c+"#"+u,height:300*Math.random()+100}))}return i.a.createElement(i.a.Fragment,null,a&&i.a.createElement(j.a,{animation:"wave",variant:"rect",height:64}),n&&i.a.createElement(j.a,{animation:"wave",variant:"rect",height:48}),i.a.createElement(C,{key:"loadingSkeleton",contents:o}))}},{key:"render",value:function(){var e=this.state.error?this.renderError():null;if(this.state.error&&this.state.loaded.length<2)return e;if(-1===this.state.loaded.indexOf("settings"))return this.renderLoadingProgress();if(-1===this.state.loaded.indexOf("groups")){var t=Object.keys(this.settings.layout)[0];return this.renderLoadingSkeleton({topBar:!0,tabBar:1!==t,gridColumns:1!==t?Object.keys(this.settings.layout[t]).length:t.length})}return[e,i.a.createElement(it,{key:"jarvis",connectionStatus:this.state.connected,settings:this.settings,groups:this.groups})]}}]),t}(i.a.Component),st=Object(He.a)((function(e){return{loading:{margin:"10px 0 0 0",color:"#999"},gridItem:Object(h.a)({margin:e.spacing(1,1,0,0)},e.breakpoints.down("md"),{marginRight:e.spacing(.4,.4,0,0)})}}))(rt);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(i.a.createElement(st,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},543:function(e,t,a){"use strict";a.r(t);var n=a(12),i=a(0),r=a.n(i),s=a(195);var o={HsvToRgb:function(e){var t,a,i,r,s,o,c,l,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(Array.isArray(e))d=e[2],u=e[1],e=e[0];else if("string"===typeof e&&e.indexOf(",")){var p=e.split(","),m=Object(n.a)(p,3);e=m[0],u=m[1],d=m[2]}switch(e>1&&(e/=360),o=d*(1-u),c=d*(1-(s=6*e-(r=Math.floor(6*e)))*u),l=d*(1-(1-s)*u),r%6){case 0:t=d,a=l,i=o;break;case 1:t=c,a=d,i=o;break;case 2:t=o,a=d,i=l;break;case 3:t=o,a=c,i=d;break;case 4:t=l,a=o,i=d;break;case 5:t=d,a=o,i=c}return[Math.round(255*t),Math.round(255*a),Math.round(255*i)]},RgbToHex:function(e,t,a){if(Array.isArray(e))a=e[2],t=e[1],e=e[0];else if("string"===typeof e&&e.indexOf(",")){var i=e.split(","),r=Object(n.a)(i,3);e=r[0],t=r[1],a=r[2]}return e=parseInt(e).toString(16),t=parseInt(t).toString(16),a=parseInt(a).toString(16),1===e.length&&(e="0"+e),1===t.length&&(t="0"+t),1===a.length&&(a="0"+a),"#"+e+t+a}},c=a(38);function l(e){var t=e.stateKey,a=e.stateVal,s=Object(i.useState)(a),o=Object(n.a)(s,2),l=o[0],u=o[1];Object(i.useEffect)((function(){return u(a)}),[a]);var d,p={};"rgb"===t&&l?p={Red:(d=l.split(","))[0],Green:d[1],Blue:d[2]}:"hsv"===t&&l&&(p={Hue:(d=l.split(","))[0],Saturation:d[1],Brightness:d[2]});var m=c.default.components.Label,h=[];for(var f in p)h.push(r.a.createElement(m,{key:f,label:f+" "+p[f],br:!0}));return h}function u(e){var t=e.device,a=e.stateKey,l=e.stateVal,u=e.title,d=l||"#ffffff";"rgb"===a?d=o.RgbToHex(d):"hsv"===a&&(d=o.RgbToHex(o.HsvToRgb(d)));var p=Object(i.useState)(d),m=Object(n.a)(p,2),h=m[0],f=m[1];Object(i.useEffect)((function(){"rgb"===a?f(o.RgbToHex(l)):"hsv"===a?f(o.RgbToHex(o.HsvToRgb(l))):"hex"===a&&f(l)}),[a,l]);var g=c.default.components.Component;return r.a.createElement(g,{title:u||a},r.a.createElement(s.SketchPicker,{color:h,width:"100%",onChangeComplete:function(e,n){e=e[a],"rgb"===a?e=[e.r,e.g,e.b].join(","):"hsv"===a&&(e=[e.h,e.s,e.v].join(",")),t.setDeviceState(a,e).catch((function(e){return console.error(e)}))}}))}var d={icon:{default:"palette"},unit:" \xb0"};t.default={configurations:{power:{icon:{true:"lightbulb-on",false:"lightbulb-off-outline"}},level:{value:function(e){return e>0&&e<=1?100*e:e},unit:function(e){return"off"!==e?" %":null},icon:{default:"lightbulb-on",0:"lightbulb-off-outline"},state:{0:"off"}},colorTemperature:{icon:{default:"thermometer"},unit:" \xb0K"},hue:d,rgb:d,hsv:d,hex:d},components:{level:c.default.components.LevelComponent,colorTemperature:function(e){var t=c.default.components.LevelComponent;return r.a.createElement(t,Object.assign({min:2e3,max:6500,step:10},e))},rgb:u,hsv:u,hex:u,hue:function(e){var t=e.device,a=e.stateKey,l=e.stateVal,u=e.title,d=Object(i.useState)(l),p=Object(n.a)(d,2),m=p[0],h=p[1];Object(i.useEffect)((function(){return h(l)}),[l]);var f=c.default.components.Component,g=o.RgbToHex(o.HsvToRgb(m));return r.a.createElement(f,{title:u||a},r.a.createElement(s.HuePicker,{color:g,width:"100%",onChangeComplete:function(e,n){h(Math.round(e.hsl.h)),t.setDeviceState(a,Math.round(e.hsl.h)).catch((function(e){return console.error(e)}))}}))}},actions:{power:c.default.actions.PowerAction,level:function(e){var t=e.device,a=e.stateKey,s=e.stateVal,o=function(e){p(e.target.checked),t.setDeviceState(a,e.target.checked?100:0).catch((function(e){return console.error(e)}))},l=Object(i.useState)(s>0),u=Object(n.a)(l,2),d=u[0],p=u[1];return Object(i.useEffect)((function(){return p(s>0)}),[s]),t.parent&&t.parent.states.power?r.a.createElement(c.default.actions.Action,Object.assign({},e,{stateVal:d,onChange:o})):r.a.createElement(c.default.actions.PowerAction,Object.assign({},e,{stateVal:d,onChange:o}))},rgb:l,hsv:l,hex:l},styles:{_any:{state:{0:{color:"#999"}}}}}},83:function(e,t,a){"use strict";var n=a(22),i=a(19),r=a(23),s=a(63),o=a(64),c=a(68),l=a(65),u=a(67),d=a(146),p=a.n(d),m=a(276),h=a.n(m),f=function(e){function t(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(s.a)(this,t),(e=Object(c.a)(this,Object(l.a)(t).call(this))).socket=h()(a,Object(r.a)({timeout:1e4},n,{query:"ws=true"})),e.statesSubscribes={},e.socket.on("connect",(function(){return e.emit("connect")})),e.socket.on("reconnect",(function(t){return e.emit("reconnect",t)})),e.socket.on("reconnect_error",(function(t){return e.emit("error",{type:"reconnect",event:"reconnect_error",message:t.message})})),e.socket.on("reconnect_failed",(function(){return e.emit("error",{type:"reconnect",event:"reconnect_failed",message:"Reconnection failed!"})})),e.socket.on("disconnect",(function(t){return e.emit("disconnect",t)})),e.socket.on("connect_error",(function(t){return e.emit("error",{type:"connect",event:"connect_error",message:t.message})})),e.socket.on("connect_timeout",(function(){return e.emit("error",{type:"connect",event:"connect_timeout",message:"Connect ran into timeout!"})})),e.socket.on("error",(function(t){return e.emit("error",{type:"error",event:"error",message:t.message})})),e.socket.on("stateChange",(function(t,a){return setTimeout((function(){return e.stateChange(t,a)}),0)})),e}return Object(u.a)(t,e),Object(o.a)(t,[{key:"subscribeStates",value:function(e,t){var a=this;(e=Array.isArray(e)?e:[e]).forEach((function(e){return a.subscribeState(e,t)}))}},{key:"subscribeState",value:function(e,t){if(this.statesSubscribes[e])-1===this.statesSubscribes[e].cbs.indexOf(t)&&this.statesSubscribes[e].cbs.push(t);else{var a=e.replace(/\./g,"\\.").replace(/\*/g,".*").replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/\+/g,"\\+").replace(/\[/g,"\\[");-1===a.indexOf("*")&&(a+="$"),this.statesSubscribes[e]={reg:new RegExp(a),cbs:[t]},this.socket.connected&&this.socket.emit("subscribe",e)}}},{key:"stateChange",value:function(e,t){for(var a in e=e?e.replace(/[\s'"]/g,"_"):"",this.statesSubscribes)this.statesSubscribes.hasOwnProperty(a)&&this.statesSubscribes[a].reg.test(e)&&this.statesSubscribes[a].cbs.forEach((function(a){return a(e,t)}))}},{key:"getAdapterInstances",value:function(e,t){return"function"===typeof e&&(t=e,e=null),this.getObjectView("system","instance",{startkey:"system.adapter."+(e?e+".":""),endkey:"system.adapter."+(e?e+".999":"zzz")},t)}},{key:"getObject",value:function(e,t){var a=this;if(!t)return new Promise((function(t,n){return a.getObject(e,(function(e,a){return e?n(e):t(a)}))}));this.socket.emit("getObject",e,t)}},{key:"getObjectView",value:function(e,t,a,n){var i=this;if(!n)return new Promise((function(n,r){return i.getObjectView(e,t,a,(function(e){return e?r(e):n()}))}));this.socket.emit("getObjectView",e,t,a,n)}},{key:"getRemoteResource",value:function(e,t){var a=this;if(!t)return new Promise((function(t,n){return a.getRemoteResource(e,(function(e,a){return e?n(e):t(a)}))}));this.socket.emit("httpGet",e,t)}},{key:"getState",value:function(e,t){var a=this;if(!t)return new Promise((function(t,n){return a.getState(e,(function(e,a){return e?n(e):t(a)}))}));this.socket.emit("getState",e,t)}},{key:"getStates",value:function(e,t){var a=this;if(!t)return new Promise((function(t,n){return a.getStates(e,(function(e,a){return e?n(e):t(a)}))}));this.socket.emit("getStates",e,t)}},{key:"getStateHistory",value:function(e,t,a){var n=this;if("function"===typeof t&&(a=t,t={}),!a)return new Promise((function(a,i){return n.getStateHistory(e,t,(function(e,t){return e?i(e):a(t)}))}));this.socket.emit("getHistory",e,t,a)}},{key:"setState",value:function(e,t,a){var n=this;if(!a)return new Promise((function(a,i){return n.setState(e,t,(function(e){return e?i(e):a()}))}));this.socket.emit("setState",e,t,a)}}]),t}(p.a);a.d(t,"a",(function(){return g}));var g=function(){function e(){Object(n.a)(this,e)}return Object(i.a)(e,null,[{key:"connect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t&&(e.setUrl=t),e.connection=new f(e.url),a&&(e.setListeners=a),e.connection}},{key:"getConnection",get:function(){return e.connection||null}},{key:"getUrl",get:function(){return e.url}},{key:"setListener",set:function(t){e.connection.on(t.event,t.callback)}},{key:"setListeners",set:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return!(!t||!Array.isArray(t))&&(t.forEach((function(t){return e.setListener=t})),!0)}},{key:"setUrl",set:function(t){e.url=t}}]),e}();g.url=window.location.hostname,g.connection=null}},[[323,1,2]]]);
//# sourceMappingURL=main.6eae72af.chunk.js.map