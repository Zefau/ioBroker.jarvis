{"version":3,"sources":["i18n.js","modules/StateListItem.js","modules/StateList.js","functions/blind.js","modules/AdapterStatus.js","modules/Chart.js","modules/DateTime.js","modules/Map.js","modules/StateListHorizontal.js","modules/Weather.js","modules/MultimediaItem.js","modules/Multimedia.js","i18n sync /^/.*/.js$","i18n/de.js","i18n/en.js","functions/door.js","functions/heating.js","functions/defaults.js","functions/location.js","functions/user.js","functions/window.js","components/GridContainer.js","components/StatusSnackbar.js","functions/index.js","Function.js","Adapters.js","Device.js","components/TopBar.js","helpers/useWindowDimensions.js","components/TabBar.js","modules/index.js","components/Popup.js","components/Widget.js","theme.js","Jarvis.js","App.js","serviceWorker.js","index.js","helpers/colorConverter.js","functions/light.js","Socket.js","Connection.js","helpers/timeConverter.js"],"names":["i18n","language","console","log","languages","Array","isArray","forEach","loadTranslation","translation","require","default","err","error","message","setTranslation","translations","lang","word","options","placeholders","toString","indexOf","parts","split","length","join","shift","key","replace","RegExp","ucFirst","charAt","toUpperCase","slice","navigator","userLanguage","styles","theme","defaultListDivider","margin","defaultListIcon","props","components","icon","horizontalListItem","display","textAlign","paddingRight","width","marginTop","horizontalListItemIcon","minWidth","horizontalListItemAction","top","right","position","transform","verticalListItemAction","ListItemIconElement","withStyles","customClassNames","children","classes","classNames","map","className","clsx","StateListItem","state","device","primaryStateKey","getDeviceState","secondaryStateKey","this","on","stateKey","setState","openDialog","horizontal","component","action","get","getIcon","val","primary","getAction","primaryAction","secondary","Fragment","divider","ListItem","finger","button","onClick","bind","ListItemIcon","getStyle","ListItemText","getComponent","getOption","subtitle","timeChanged","ListItemSecondaryAction","id","style","React","Component","defaultListSectionDivider","defaultListSectionDividerItem","padding","defaultListSectionText","breakpoints","down","horizontalList","flexDirection","flexWrap","ListDivider","getDevicesBySubgroup","subgroup","title","subgroupActions","handleChange","targetStatus","status","setDeviceState","ButtonGroup","color","size","Button","t","StateList","devices","push","settings","List","dense","i","listSection","listItem","useStyles","makeStyles","value","float","lineHeight","marginRight","noBorder","borderLeftColor","configurations","level","Math","round","level2","unit","defaults","LevelComponent","actions","useState","setLevel","useEffect","activity","setActivity","states","requestDeviceState","catch","sKey","s","manufacturer","borderRightColor","disabled","AdapterStatus","adapterInformation","adapterAliveStatus","adapterUpdates","socket","Connection","getConnection","list","blacklist","updates","getState","subscribeState","getAdapterInstances","instances","rows","adapters","instance","common","name","concat","sort","item1","item2","getStates","subscribeStates","aliveStatus","prevState","updateList","JSON","parse","Object","keys","adapterList","loading","adapter","update","enabled","alive","connected","connection","tooltip","alt","src","extIcon","small","version","UpdateAvailable","availableVersion","runAsCompactMode","compactGroup","StatusIndicator","notAlive","container","UpdatesListItem","UpdatesIndicator","Settings","noDevicesAllowed","backgroundColor","spacing","paddingLeft","borderRadius","height","fontSize","Chart","chartFilter","chartConfig","yAxes","unshift","type","ticks","callback","yLeftAxisUnitBefore","Number","parseFloat","toFixed","yLeftAxisUnitAfter","errors","datePicker","selectedTimeRangeValue","selectedTimeRangeUnit","selectedDateTime","Date","chartLabels","chartData","labels","datasets","chartPan","chartZoom","timer","timeRangeRef","createRef","chartRef","chartUpdates","chartOptions","maintainAspectRatio","spanGaps","legend","legendClickHandler","tooltips","callbacks","label","item","data","datasetIndex","scales","plugins","colorschemes","scheme","zoom","pan","mode","getTimeRange","axis","getAxis","requestDeviceStateHistory","history","start","end","step","addChartGraph","liveUpdates","updateChartGraph","prevProps","clearTimeout","setTimeout","getTime","timeRange","axisTimeFormat","time","helpers","secondsToDateTime","prevMarker","markers","marker","index","entry","ts","reduce","a","b","chartIndex","findIndex","groupChartData","current","chartInstance","values","prevStates","dataSet","fill","graphConfig","e","legendItem","ci","meta","getDatasetMeta","hidden","resetZoom","inputRef","input","onChange","event","target","displayEmpty","disableUnderline","select","locale","deLocale","utils","DateFnsUtils","open","onOpen","onClose","variant","ampm","format","InputProps","iconButton","dividerVertical","orientation","toolbar","errorMessage","severity","createElement","toolbarButtons","disableElevation","chartHeight","ref","alignItems","justifyContent","marginBottom","whiteSpace","marginLeft","flex","DateTime","refTimer","useRef","de","setDateTime","refresh","mapOverview","left","bottom","zIndex","cursor","mapIconContainer","mapIconParent","boxShadow","mapIcon","palette","main","content","mapTooltip","Map","defaultZoom","defaultPosition","setMarkers","memoizedMapInitialised","useCallback","memoizedHandleClick","flyTo","prevMarkers","mapMarkers","Marker","attributes","avatar","aria-label","arrow","useFlyTo","center","whenReady","attribution","url","markerIcon","offset","info","function","substr","L","divIcon","html","iconSize","memoizedHandleMouseEvent","closeTooltip","openTooltip","riseOnHover","onMouseOver","direction","tooltipDirection","permanent","tooltipPermanent","StateListHorizontal","paper","Weather","setData","getRemoteResource","then","response","statusCode","body","weatherForecast","day","forecast","dailyForecast","date","justify","Multimedia","timeToHoursMinutesSeconds","progress","progressTimeout","isRunning","duration","timeToSeconds","noHeader","styleImage","styleLengthBar","background","backgroundImage","backgroundUrlPrepend","playIconElements","Divider","image","noImage","information","informationLeft","grandParent","parent","informationRight","lengthBar","controls","controlsBox","controlsBoxLeft","controlsBoxCenter","Fab","controlButton","controlsBoxRight","backgroundPosition","minHeight","paddingTop","controlButtonSmall","MultimediaItem","webpackContext","req","webpackContextResolve","__webpack_require__","o","Error","code","resolve","module","exports","temperature","setTemperature","humidity","boost","Level","min","max","PowerAction","sliderMarkLabel","Action","secondaryAction","stateVal","parentOnChange","checked","setChecked","TriggerAction","startIcon","Label","linebreak","br","markSteps","markStep","markLabel","onChangeCommitted","defaultValue","valueLabelDisplay","marks","number","_any","battery","door","power","trigger","wind","gridContainer","GridContainer","contents","columns","grid","column","Grid","xs","sm","md","lg","xl","warn","success","green","dark","warning","amber","iconVariant","opacity","variantIcon","CheckCircleIcon","WarningIcon","ErrorIcon","InfoIcon","StatusSnackbar","autoHideDuration","closeButton","other","Icon","Snackbar","anchorOrigin","vertical","SnackbarContent","IconButton","blind","heating","jalousie","light","location","user","window","Function","functionType","functionId","toLowerCase","functions","defaultStyles","_isFunction","undefined","obj","EventEmitter","Device","deviceProperties","sysLang","room","_setProperties","stateSubscriptions","stateType","node","config","attribute","ignoredStates","ignoredState","hiddenStates","hideStates","hideState","stateOrAttribute","_getStateFromKey","Adapters","groups","group","formatDistanceToNow","lc","includeSeconds","addSuffix","pair","option","_getUserSetting","_getConfigurationSetting","property","forceDefault","stateProperty","deviceState","defaultIcon","subscribe","responses","Promise","reject","emit","_updateDeviceState","subscribeDeviceState","historyCache","getStateHistory","res","params","child","appBar","flexGrow","menuButton","transition","flexShrink","userSelect","TopBar","AppBar","Toolbar","Typography","getWindowDimensions","innerWidth","innerHeight","paddingBottom","tabs","borderBottom","fixed","indicator","fullscreen","TabBar","selectTab","tabBarProps","tab","setTab","setFixed","handleScroll","threshold","scrollY","prevFixed","document","getElementById","offsetTop","offsetHeight","addEventListener","removeEventListener","renderedTabs","Tab","Tabs","selectedTab","root","TabPanel","renderedTab","windowDimensions","setWindowDimensions","handleResize","useWindowDimensions","mapHeight","setMapHeight","topBarHeight","setHidden","Box","role","ModuleSettings","DialogTitle","grey","disableTypography","DialogContent","MuiDialogContent","DialogActions","MuiDialogActions","Popup","forceUpdate","allSettled","nextProps","nextState","closeDialog","Dialog","maxWidth","fullWidth","dividers","autoFocus","card","cardHeaderNoContents","cardAvatar","cardContent","Widget","iconStyle","Card","CardHeader","Avatar","CardContent","blue","pink","createMuiTheme","getGroup","groupId","Tag","Modules","getGridContents","gridContents","columnContents","Jarvis","tabTitle","notificationDrawer","dialog","dialogContents","layout","tabsEnabled","widgetProps","tabPanels","tabLabel","isNaN","parseInt","tabPanel","now","ThemeProvider","topBarTitle","getTabPanels","App","loaded","noErrorFunction","hostname","protocol","port","listeners","connect","useSettings","processDevices","debug","email","LogRocket","init","uuid","identify","setLanguage","loadTranslations","pageTitle","pageFavicon","href","promises","results","result","deviceList","groupedDevices","deviceId","jarvis","processDevice","groupDevice","stringify","CircularProgress","topBar","tabBar","gridColumns","SkeletonLoader","Skeleton","animation","gridItem","loaders","random","loader","renderError","renderLoadingProgress","renderLoadingSkeleton","Boolean","match","ReactDOM","render","serviceWorker","ready","registration","unregister","HsvToRgb","h","r","g","f","p","q","v","floor","RgbToHex","LightColorAction","colorSpace","setColorSpace","colors","Red","Green","Blue","Hue","Saturation","Brightness","LightColorComponent","initialColor","onChangeComplete","colorTemperature","hue","rgb","hsv","hex","setHue","hsl","Socket","io","timeout","query","statesSubscribes","attempts","reason","stateChange","ids","cb","cbs","reg","task","hasOwnProperty","test","getObjectView","design","search","pattern","setUrl","setListeners","listener","setListener","hours","minutes","seconds","withHours","dateTimeFormat"],"mappings":"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","file":"static/js/main.3faaf593.chunk.js","sourcesContent":["/**\r\n * Internationalization\r\n * Based on https://raw.githubusercontent.com/ioBroker/adapter-react/master/src/i18n.js.\r\n * Copyright 2018-2019 bluefox <dogafox@gmail.com>\r\n *\r\n * MIT License\r\n *\r\n *\r\n */\r\nexport default class i18n {\r\n\r\n\t/*\r\n\t * holds the translations\r\n\t */\r\n\tstatic translations = {};\r\n\r\n\t/*\r\n\t * default language\r\n\t */\r\n\tstatic language = navigator.language || navigator.userLanguage || 'en';\r\n\r\n\t/**\r\n\t * Override default language.\r\n\t *\r\n\t * @param\t{String}\tlanguage\r\n\t * @return\t{Boolean}\r\n\t */\r\n\tstatic setLanguage(language) {\r\n\t\tif (language) {\r\n\t\t\ti18n.language = language;\r\n\t\t\tconsole.log('i18n: Set language to ' + language + '.');\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Loads multiple translations.\r\n\t *\r\n\t * @param\t{String|Array}\tlanguages\r\n\t * @return\t{Boolean}\r\n\t */\r\n\tstatic loadTranslations(languages) {\r\n\t\t\r\n\t\tif (languages) {\r\n\t\t\tlanguages = Array.isArray(languages) ? languages : [languages];\r\n\t\t\tlanguages.forEach(language => i18n.loadTranslation(language));\r\n\t\t\t\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Loads a translation.\r\n\t *\r\n\t * @param\t{String}\tlanguage\r\n\t * @return\t{Boolean}\r\n\t */\r\n\tstatic loadTranslation(language) {\r\n\t\t\r\n\t\tif (language) {\r\n\t\t\tlet translation;\r\n\t\t\ttry {\r\n\t\t\t\ttranslation = require('./i18n/' + language + '.js').default;\r\n\t\t\t}\r\n\t\t\tcatch(err) {\r\n\t\t\t\tconsole.error(err.message);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\ti18n.setTranslation(language, translation);\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * Set a translation for language.\r\n\t *\r\n\t * @param\t{String}\tlanguage\r\n\t * @param\t{Object}\ttranslation\r\n\t * @return\t{Boolean}\r\n\t */\r\n\tstatic setTranslation(language, translation) {\r\n\t\tif (language && translation) {\r\n\t\t\ti18n.translations[language] = { ...i18n.translations[language] || {}, ...translation };\r\n\t\t\tconsole.log('i18n: Set translations for language ' + language + '.');\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get current set language.\r\n\t *\r\n\t * @param\tvoid\r\n\t * @return\t{String}\r\n\t */\r\n\tstatic getLanguage() {\r\n\t\treturn i18n.lang;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get current set language.\r\n\t *\r\n\t * @param\t{String}\tword\r\n\t * @param\t{Object}\t[options={}]\r\n\t * @param\t{Boolean}\t[options.ucFirst=false]\r\n\t * @param\t{Object}\t[placeholders={}]\r\n\t * @param\t{String}\t[language=i18n.language]\r\n\t * @return\t{String}\r\n\t */\r\n\tstatic t(word, options = {}, placeholders = {}, language = i18n.language) {\r\n\t\t\r\n\t\tword = word.toString();\r\n\t\tif (i18n.translations[language]) {\r\n\t\t\t\r\n\t\t\t// check if word is concatenated\r\n\t\t\tif (word.indexOf('#') > -1) {\r\n\t\t\t\t\r\n\t\t\t\tlet parts = word.split('#');\r\n\t\t\t\twhile (parts.length > 0 && !i18n.translations[language][parts.join('#')]) {\r\n\t\t\t\t\tparts.shift();\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tword = i18n.translations[language][parts.join('#')] || word;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tword = i18n.translations[language][word] || word;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// replace placeholders\r\n\t\tfor (let key in placeholders) {\r\n\t\t\tword = word.replace(RegExp('%' + key + '%', 'g'), placeholders[key]);\r\n\t\t}\r\n\t\t\r\n\t\t// options\r\n\t\tif (options.ucFirst) {\r\n\t\t\tword = word.charAt(0).toUpperCase() + word.slice(1);\r\n\t\t}\r\n\t\t\r\n\t\treturn word;\r\n\t}\r\n}\r\n","import React from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\r\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tdefaultListDivider: {\r\n\t\tmargin: '0 0 5px 0'\r\n\t},\r\n\tdefaultListIcon: props => ({\r\n\t\t...theme.components.icon,\r\n\t\t...props.styles\r\n\t}),\r\n\thorizontalListItem: {\r\n\t\tdisplay: 'inline-block',\r\n\t\ttextAlign: 'center',\r\n\t\tpaddingRight: '16px',\r\n\t\twidth: '140px',\r\n\t\tmarginTop: '10px'\r\n\t},\r\n\thorizontalListItemIcon: {\r\n\t\tminWidth: 'auto'\r\n\t},\r\n\thorizontalListItemAction: {\r\n\t\ttextAlign: 'center',\r\n\t\ttop: 0,\r\n\t\tright: 0,\r\n\t\tposition: 'static',\r\n\t\ttransform: 'none',\r\n\t},\r\n\tverticalListItemAction: {\r\n\t\ttextAlign: 'right'\r\n\t},\r\n});\r\n\r\n\r\nconst ListItemIconElement = withStyles(styles)(props => {\r\n\tconst { customClassNames, children, classes } = props;\r\n\t\r\n\tlet classNames = Array.isArray(customClassNames) ? customClassNames : [customClassNames];\r\n\tclassNames = classNames.map(className => (classes[className] ? classes[className] : className));\r\n\t\r\n\treturn <span className={clsx(classNames)}>{children}</span>\r\n});\r\n\r\n\r\nclass StateListItem extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {}\r\n\t\tthis.state[this.props.device.primaryStateKey] = this.props.device.getDeviceState() || {}\r\n\t\t\r\n\t\tif (this.props.device.secondaryStateKey) {\r\n\t\t\tthis.state[this.props.device.secondaryStateKey] = this.props.device.getDeviceState(this.props.device.secondaryStateKey) || {}\r\n\t\t}\r\n\t}\r\n\t\r\n\tcomponentDidMount() {\r\n\t\t\r\n\t\tthis.props.device.on('stateChange', (stateKey, state) => {\r\n\t\t\tif (stateKey === this.props.device.primaryStateKey || stateKey === this.props.device.secondaryStateKey) {\r\n\t\t\t\tthis.setState({ [stateKey]: state });\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\topenDialog() {\r\n\t\tthis.props.openDialog(this.props.device);\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { classes, horizontal, device, component, action } = this.props;\r\n\t\t\r\n\t\tconst state = this.state[device.primaryStateKey];\r\n\t\tconst options = device.get('options');\r\n\t\t\r\n\t\tlet icon = device.getIcon(device.primaryStateKey, state.val);\r\n\t\tlet primary = device.getAction(device.primaryStateKey, device.options.primaryAction === false);\r\n\t\tlet secondary = action && this.state[device.secondaryStateKey] ? device.getAction(device.secondaryStateKey) : null;\r\n\t\t\r\n\t\treturn (\r\n\r\n<React.Fragment>\r\n\t\r\n\t{options.divider && options.divider !== 'after' && <ListItem divider className={classes.defaultListDivider} />}\r\n\t\r\n\t<ListItem\r\n\t\tclassName={clsx(this.props.openDialog && classes.finger, horizontal && classes.horizontalListItem)}\r\n\t\tbutton={this.props.openDialog !== null}\r\n\t\tonClick={this.props.openDialog && this.openDialog.bind(this)}\r\n\t\t>\r\n\t\t\r\n\t\t<ListItemIcon className={clsx(horizontal && classes.horizontalListItemIcon)}>\r\n\t\t{icon === null ? <React.Fragment /> :\r\n\t\t\t<ListItemIconElement customClassNames={['defaultListIcon','mdi mdi-' + icon]} styles={device.getStyle('icon', device.primaryStateKey, state.val)} />\r\n\t\t}\r\n\t\t</ListItemIcon>\r\n\t\t\r\n\t\t<ListItemText\r\n\t\t\tprimary={(component && device.getComponent()) || device.getOption('label')}\r\n\t\t\tsecondary={(options.subtitle !== null ? (options.subtitle || (state && state.timeChanged) || null) : null)}\r\n\t\t\t/>\r\n\t\t\r\n\t\t<ListItemSecondaryAction className={ horizontal ? classes.horizontalListItemAction : classes.verticalListItemAction }>\r\n\t\t\t{!secondary ? primary : [ primary, <br key={'br_' + device.id} />, secondary ]}\r\n\t\t</ListItemSecondaryAction>\r\n\t</ListItem>\r\n\t\r\n\t{options.divider && options.divider === 'after' && <ListItem divider style={{margin: '5px 0'}} />}\r\n\t\r\n</React.Fragment>\r\n\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(StateListItem);\r\n","import React from 'react'\r\nimport i18n from '../i18n'\r\n\r\nimport List from '@material-ui/core/List'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\nimport StateListItem from './StateListItem'\r\nimport Button from '@material-ui/core/Button'\r\nimport ButtonGroup from '@material-ui/core/ButtonGroup'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tdefaultListSectionDivider: {\r\n\t\tmargin: '5px 0 0 0'\r\n\t},\r\n\tdefaultListSectionDividerItem: {\r\n\t\tmargin: '6px 0 7px 0',\r\n\t\tpadding: '0 16px !important'\r\n\t},\r\n\tdefaultListSectionText: {\r\n\t\tmargin: 0,\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tmargin: '0 0 0 10px',\r\n\t\t}\r\n\t},\r\n\thorizontalList: {\r\n\t\tdisplay: 'flex',\r\n\t\tflexDirection: 'row',\r\n\t\tflexWrap: 'wrap'\r\n\t}\r\n});\r\n\r\n\r\nconst ListDivider = withStyles(styles)(props => {\r\n\tconst { classes, getDevicesBySubgroup, subgroup, title, subgroupActions } = props;\r\n\t\r\n\tconst handleChangeOn = () => handleChange(true);\r\n\tconst handleChangeOff = () => handleChange(false);\r\n\tconst handleChange = targetStatus => {\r\n\t\t\r\n\t\tconst devices = getDevicesBySubgroup(subgroup);\r\n\t\tdevices.forEach(device => {\r\n\t\t\t\r\n\t\t\tlet status = targetStatus;\r\n\t\t\tif (device.primaryStateKey === 'level') {\r\n\t\t\t\tstatus = status ? 100 : 0;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tdevice.setDeviceState(null, status);\r\n\t\t});\r\n\t}\r\n\t\r\n\treturn (\r\n\t\r\n<React.Fragment>\r\n\t<ListItem divider className={classes.defaultListSectionDivider} />\r\n\t<ListItem className={classes.defaultListSectionDividerItem}>\r\n\t\t<ListItemText\r\n\t\t\tclassName={classes.defaultListSectionText}\r\n\t\t\tprimary={title}\r\n\t\t\t/>\r\n\t\t\r\n\t\t<ListItemSecondaryAction>\r\n\t\t{subgroupActions === null || subgroupActions === false ? null :\r\n\t\t\t<ButtonGroup color=\"primary\" size=\"small\">\r\n\t\t\t\t<Button onClick={handleChangeOn}>{i18n.t('on')}</Button>\r\n\t\t\t\t<Button onClick={handleChangeOff}>{i18n.t('off')}</Button>\r\n\t\t\t</ButtonGroup>\r\n\t\t}\r\n\t\t\r\n\t\t</ListItemSecondaryAction>\r\n\t</ListItem>\r\n</React.Fragment>\r\n\t\r\n\t);\r\n});\r\n\r\nclass StateList extends React.Component {\r\n\t\r\n\tgetDevicesBySubgroup(subgroup) {\r\n\t\t\r\n\t\tlet devices = [];\r\n\t\tthis.props.devices.forEach(device => {\r\n\t\t\t\r\n\t\t\tif (subgroup === device.getOption('subgroup')) {\r\n\t\t\t\tdevices.push(device);\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\treturn devices;\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { classes, horizontal, devices, settings, component, action, ...props } = this.props;\r\n\t\tlet subgroup;\r\n\t\t\r\n\t\treturn (\r\n\r\n<List dense={true} className={horizontal && classes.horizontalList}>\r\n\t{devices.map((device, i) => {\r\n\t\t\r\n\t\tconst listSection = subgroup !== null && device.options.subgroup !== null && device.options.subgroup !== subgroup && <ListDivider\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={'ListDivider-' + device.get('id')}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tgetDevicesBySubgroup={this.getDevicesBySubgroup.bind(this)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsubgroup={device.getOption('subgroup')}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle={device.options.subgroup}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsubgroupActions={settings.subgroupActions || device.options.subgroupActions}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\r\n\t\tconst listItem = <StateListItem\r\n\t\t\t\t\t\t\t{...props}\r\n\t\t\t\t\t\t\tkey={'StateListItem-' + device.get('id')}\r\n\t\t\t\t\t\t\thorizontal={horizontal}\r\n\t\t\t\t\t\t\tdevice={device}\r\n\t\t\t\t\t\t\tcomponent={component || false}\r\n\t\t\t\t\t\t\taction={action || true}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\r\n\t\tsubgroup = device.getOption('subgroup');\r\n\t\treturn [ listSection, listItem ];\r\n\t})}\r\n</List>\r\n\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(StateList);\r\n","import React, { useState, useEffect } from 'react'\r\n\r\nimport Button from '@material-ui/core/Button'\r\nimport ButtonGroup from '@material-ui/core/ButtonGroup'\r\nimport ExpandLessIcon from '@material-ui/icons/ExpandLess'\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore'\r\nimport StopIcon from '@material-ui/icons/Stop';\r\n\r\nimport defaults from './defaults'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tvalue: props => ({\r\n\t\tfloat: 'left',\r\n\t\tlineHeight: '32px',\r\n\t\tmarginRight: '10px'\r\n\t}),\r\n\tnoBorder: {\r\n\t\tborderLeftColor: 'transparent'\r\n\t}\r\n}));\r\n\r\n\r\n/*\r\n * ACTIONS\r\n *\r\n */\r\nfunction BlindLevelAction(props) {\r\n\tconst { device, state, stateKey } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst onGoUp = () => {\r\n\t\tsetLevel(100);\r\n\t\tsetActivity(true);\r\n\t\tdevice.setDeviceState(stateKey, 100).catch(err => console.error(err));\r\n\t}\r\n\t\r\n\tconst onGoDown = () => {\r\n\t\tsetLevel(0);\r\n\t\tsetActivity(true);\r\n\t\tdevice.setDeviceState(stateKey, 0).catch(err => console.error(err));\r\n\t}\r\n\t\r\n\tconst onStop = () => {\r\n\t\tsetActivity(false);\r\n\t\tdevice.setDeviceState('activity', true).catch(err => console.error(err));\r\n\t}\r\n\t\r\n\t// level\r\n\tconst [level, setLevel] = useState(state.value);\r\n\tuseEffect(() => setLevel(state.value), [state.value]);\r\n\t\r\n\t// activity\r\n\tconst [activity, setActivity] = useState(null);\r\n\tuseEffect(() => {\r\n\t\t\r\n\t\tif (device.states.activity && device.states.activity.state) {\r\n\t\t\tdevice.states.activity.state = typeof device.states.activity.state === 'string' ? { 'node': device.states.activity.state } : device.states.activity.state;\r\n\t\t\t\r\n\t\t\t// request device state\r\n\t\t\tdevice.requestDeviceState('activity', true).catch(err => console.error(err));\r\n\t\t\t\r\n\t\t\t// listen for updates\r\n\t\t\tdevice.on('stateChange', (sKey, s) => {\r\n\t\t\t\tif (sKey === 'activity') {\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet val = s.val;\r\n\t\t\t\t\t\r\n\t\t\t\t\t// HomeMatic\r\n\t\t\t\t\tif (device.options.manufacturer === 'HomeMatic') {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tswitch(val) {\r\n\t\t\t\t\t\t\tcase 1: // UP\r\n\t\t\t\t\t\t\tcase 2: // DOWN\r\n\t\t\t\t\t\t\t\tval = true;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tcase 3: // STABLE\r\n\t\t\t\t\t\t\tdefault: // UNKNOWN\r\n\t\t\t\t\t\t\t\tval = false;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t//\r\n\t\t\t\t\tsetActivity(val);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t}, [device]);\r\n\t\r\n\treturn (\r\n\r\n<React.Fragment>\r\n\t\r\n\t<div className={classes.value}>\r\n\t\t{level + state.unit}\r\n\t</div>\r\n\t\r\n\t<ButtonGroup size=\"small\">\r\n\t\t<Button color=\"primary\" onClick={onGoUp}><ExpandLessIcon /></Button>\r\n\t\t\t{activity !== null && <Button color=\"secondary\" style={{ borderRightColor: !activity ? 'transparent' : 'rgba(245, 0, 87, 0.5)' }} onClick={onStop} disabled={!activity}><StopIcon /></Button>}\r\n\t\t<Button color=\"primary\" style={activity !== null ? { borderLeftColor: !activity ? 'rgba(0, 0, 0, 0.26)' : 'transparent' } : {}} onClick={onGoDown}><ExpandMoreIcon /></Button>\r\n\t</ButtonGroup>\r\n</React.Fragment>\r\n\r\n\t);\r\n}\r\n\r\n\r\nexport default {\r\n\tconfigurations: {\r\n\t\tlevel: {\r\n\t\t\tvalue: val => Math.round(val),\r\n\t\t\ticon: {\r\n\t\t\t\t'default': 'window-shutter-open',\r\n\t\t\t\t'>90': 'window-shutter-open',\r\n\t\t\t\t'<=90': 'window-shutter'\r\n\t\t\t}\r\n\t\t},\r\n\t\tlevel2: {\r\n\t\t\tvalue: val => Math.round(val),\r\n\t\t\tunit: ' %',\r\n\t\t\ticon: {\r\n\t\t\t\t'default': 'window-shutter-open',\r\n\t\t\t\t'>90': 'window-shutter-open',\r\n\t\t\t\t'<=90': 'window-shutter'\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t\tlevel2: defaults.components.LevelComponent\r\n\t},\r\n\tactions: {\r\n\t\tlevel: BlindLevelAction\r\n\t},\r\n\tstyles: {\r\n\t}\r\n}","import React from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport Connection from '../Connection'\r\nimport i18n from '../i18n'\r\n\r\nimport CircularProgress from '@material-ui/core/CircularProgress'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\nimport Avatar from '@material-ui/core/Avatar'\r\nimport List from '@material-ui/core/List'\r\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction'\r\nimport StarIcon from '@material-ui/icons/Star';\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tUpdateAvailable: {\r\n\t\tcolor: '#CCAA00',\r\n\t},\r\n\tUpdatesListItem: {\r\n\t\tbackgroundColor: '#ffd700',\r\n\t\tcolor: '#fff',\r\n\t\tmargin: theme.spacing(0, -2),\r\n\t\tpaddingLeft: theme.spacing(2)\r\n\t},\r\n\tUpdatesIndicator: {\r\n\t\tright: theme.spacing(3.75),\r\n\t\tbackgroundColor: '#CCAA00',\r\n\t\tborderRadius: '50%',\r\n\t\twidth: theme.spacing(3),\r\n\t\theight: theme.spacing(3),\r\n\t\tcolor: '#fff',\r\n\t\ttextAlign: 'center',\r\n\t\tfontSize: '1rem !important'\r\n\t},\r\n\tStatusIndicator: {\r\n\t\tfontSize: '1.4rem'\r\n\t},\r\n\tloading: {\r\n\t\ttextAlign: 'center',\r\n\t\tmarginTop: '5px'\r\n\t},\r\n\tsmall: {\r\n\t\twidth: theme.spacing(3),\r\n\t\theight: theme.spacing(3),\r\n\t},\r\n\talive: {\r\n\t\tcolor: '#86d686'\r\n\t},\r\n\tnotAlive: {\r\n\t\tcolor: '#f7e43b'\r\n\t},\r\n\tdisabled: {\r\n\t\tcolor: '#bababa'\r\n\t}\r\n});\r\n\r\n\r\nclass AdapterStatus extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {\r\n\t\t\tadapterInformation: [],\r\n\t\t\tadapterAliveStatus: {},\r\n\t\t\tadapterUpdates: {}\r\n\t\t}\r\n\t\t\r\n\t\tthis.socket = Connection.getConnection;\r\n\t\tthis.list = this.props.settings.list ? (Array.isArray(this.props.settings.list) ? this.props.settings.list : this.props.settings.list.split(',')) : null;\r\n\t\tthis.blacklist = this.props.settings.blacklist ? (Array.isArray(this.props.settings.blacklist) ? this.props.settings.blacklist : this.props.settings.blacklist.split(',')) : null;\r\n\t}\r\n\t\r\n\tcomponentDidMount() {\r\n\t\t\r\n\t\t// retrieve updates\r\n\t\tif (this.props.settings.updates !== false) {\r\n\t\t\tthis.socket.getState('admin.0.info.updatesJson', (id, adapterUpdates) => {\r\n\t\t\t\tthis.setState({ adapterUpdates });\r\n\t\t\t\t\r\n\t\t\t\t// get state updates\r\n\t\t\t\tthis.socket.subscribeState('admin.0.info.updatesJson', (err, adapterUpdates) => this.setState({ adapterUpdates }));\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\t// get adapter instances\r\n\t\tthis.socket.getAdapterInstances((err, instances) => {\r\n\t\t\t\r\n\t\t\tlet states = [];\r\n\t\t\tif (instances && instances.rows) {\r\n\t\t\t\tlet adapters = [];\r\n\t\t\t\t\r\n\t\t\t\t// states per instance to retrieve\r\n\t\t\t\tinstances.rows.forEach((instance, i) => {\r\n\t\t\t\t\t\r\n\t\t\t\t\t// get alive / connected states\r\n\t\t\t\t\tif ((!this.list || (this.list && this.list.indexOf(instance.value.common.name) > -1)) && (!this.blacklist || (this.blacklist && this.blacklist.indexOf(instance.value.common.name) === -1))) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tadapters.push(instance);\r\n\t\t\t\t\t\tstates = states.concat([\r\n\t\t\t\t\t\t\tinstance.id + '.alive',\r\n\t\t\t\t\t\t\tinstance.id + '.connected',\r\n\t\t\t\t\t\t\tinstance.id.replace('system.adapter.', '') + '.info.connection'\r\n\t\t\t\t\t\t]);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\t// sort instances\r\n\t\t\t\tthis.setState({ adapterInformation: adapters.sort((item1, item2) => {\r\n\t\t\t\t\t\tif (item1.id > item2.id) return 1;\r\n\t\t\t\t\t\telse if (item2.id > item1.id) return -1;\r\n\t\t\t\t\t\telse return 0;\r\n\t\t\t\t\t})\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\t// retrieve intial states\r\n\t\t\t\tthis.socket.getStates(states, (id, adapterAliveStatus) => {\r\n\t\t\t\t\tthis.setState({ adapterAliveStatus });\r\n\t\t\t\t\t\r\n\t\t\t\t\t// get state updates\r\n\t\t\t\t\tthis.socket.subscribeStates(states, (id, aliveStatus) => {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (aliveStatus && (!this.state.adapterAliveStatus[id] || (aliveStatus.val !== this.state.adapterAliveStatus[id].val))) {\r\n\t\t\t\t\t\t\tthis.setState(prevState => ({ adapterAliveStatus: { ...prevState.adapterAliveStatus, [id]: aliveStatus } }));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { classes } = this.props;\r\n\t\t\r\n\t\t// adapter updates\r\n\t\tconst updateList = (this.state.adapterUpdates && this.state.adapterUpdates.val && JSON.parse(this.state.adapterUpdates.val)) || {};\r\n\t\tconst updates = Object.keys(updateList).length\r\n\t\t\r\n\t\t// adapter instances\r\n\t\tlet adapterList = <ListItem key='loading' className={classes.loading}><CircularProgress size={20} /></ListItem>\r\n\t\t\r\n\t\tif (this.state.adapterInformation.length > 0) {\r\n\t\t\t\r\n\t\t\tadapterList = this.state.adapterInformation.map(adapter => {\r\n\t\t\t\tadapter.update = updateList[adapter.value.common.name] || false;\r\n\t\t\t\t\r\n\t\t\t\tconst enabled = adapter.value.common.enabled;\r\n\t\t\t\tconst alive = (this.state.adapterAliveStatus[adapter.id + '.alive'] && this.state.adapterAliveStatus[adapter.id + '.alive'].val) || false;\r\n\t\t\t\tconst connected = (this.state.adapterAliveStatus[adapter.id + '.connected'] && this.state.adapterAliveStatus[adapter.id + '.connected'].val) || false;\r\n\t\t\t\tconst connection = this.state.adapterAliveStatus[adapter.id.replace('system.adapter.', '') + '.info.connection'] ? this.state.adapterAliveStatus[adapter.id.replace('system.adapter.', '') + '.info.connection'].val : true;\r\n\t\t\t\t\r\n\t\t\t\tconst tooltip = i18n.t('Adapter') + ' ' + (enabled ? (alive && connected && connection ? i18n.t('alive') : i18n.t('not alive')) : i18n.t('disabled'));\r\n\t\t\t\t\r\n\t\t\t\treturn (\r\n\t\t\t\t\r\n\t\t\t\t\t<ListItem key={'adapter-' + adapter.id}>\r\n\t\t\t\t\t\t<ListItemAvatar>\r\n\t\t\t\t\t\t\t<Avatar alt={adapter.value.common.name} src={adapter.value.common.extIcon} className={classes.small} />\r\n\t\t\t\t\t\t</ListItemAvatar>\r\n\t\t\t\t\t\t<ListItemText\r\n\t\t\t\t\t\t\tprimary={adapter.value.common.title}\r\n\t\t\t\t\t\t\tsecondary={[\r\n\t\t\t\t\t\t\t\t'v' + adapter.value.common.version,\r\n\t\t\t\t\t\t\t\t(adapter.update && (<span key={'updates-' + adapter.id}>, <span className={classes.UpdateAvailable}>{i18n.t('Update available') + ' v' + adapter.update.availableVersion}</span></span>)),\r\n\t\t\t\t\t\t\t\t(adapter.value.common.runAsCompactMode && ', ' + i18n.t('Compact Mode') + ' ' + i18n.t('on') + ' (' + i18n.t('Group') + ' ' + adapter.value.common.compactGroup + ')')\r\n\t\t\t\t\t\t\t]}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<ListItemSecondaryAction className={clsx(classes.StatusIndicator, enabled ? (alive && connected && connection ? classes.alive : classes.notAlive) : classes.disabled)}>\r\n\t\t\t\t\t\t\t<Tooltip title={tooltip}>\r\n\t\t\t\t\t\t\t\t<span className={enabled ? (alive && connected && connection ? 'mdi mdi-check-circle' : 'mdi mdi-alert') : 'mdi mdi-close'}></span>\r\n\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t</ListItemSecondaryAction>\r\n\t\t\t\t\t</ListItem>\r\n\t\t\t\t\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\treturn (\r\n\r\n<List dense>\r\n\t{updates > 0 &&\r\n\t<ListItem key=\"updates\" classes={{ container: classes.UpdatesListItem }}>\r\n\t\t<ListItemAvatar>\r\n\t\t\t<StarIcon />\r\n\t\t</ListItemAvatar>\r\n\t\t<ListItemText\r\n\t\t\tprimary={i18n.t('Updates available') + '!'}\r\n\t\t\t/>\r\n\t\t\r\n\t\t<ListItemSecondaryAction className={clsx(classes.StatusIndicator, classes.UpdatesIndicator)}>\r\n\t\t\t{updates}\r\n\t\t</ListItemSecondaryAction>\r\n\t</ListItem>\r\n\t}\r\n\t\r\n\t{adapterList}\r\n</List>\r\n\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport const Settings = {\r\n\tnoDevicesAllowed: true,\r\n\ttitle: i18n.t('Adapter Status'),\r\n\ticon: 'traffic-light'\r\n}\r\n\r\nexport default withStyles(styles)(AdapterStatus);\r\n","import React from 'react'\r\n//import clsx from 'clsx'\r\n\r\nimport { Line } from 'react-chartjs-2'\r\n// eslint-disable-next-line\r\nimport chartjs_colorschemes from 'chartjs-plugin-colorschemes'\r\n// eslint-disable-next-line\r\nimport chartjs_zoom from 'chartjs-plugin-zoom'\r\n\r\nimport deLocale from 'date-fns/locale/de'\r\nimport DateFnsUtils from '@date-io/date-fns'\r\n\r\nimport i18n from '../i18n'\r\nimport helpers from '../helpers/timeConverter'\r\n\r\nimport CircularProgress from '@material-ui/core/CircularProgress'\r\nimport Button from '@material-ui/core/Button'\r\nimport ButtonGroup from '@material-ui/core/ButtonGroup'\r\nimport Alert from '@material-ui/lab/Alert'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport Divider from '@material-ui/core/Divider'\r\nimport { MuiPickersUtilsProvider, DateTimePicker } from '@material-ui/pickers'\r\nimport InputBase from '@material-ui/core/InputBase'\r\nimport Select from '@material-ui/core/Select'\r\nimport MenuItem from '@material-ui/core/MenuItem'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport CalendarIcon from '@material-ui/icons/Event'\r\nimport CalendarTodayIcon from '@material-ui/icons/EventAvailable'\r\nimport HistoryIcon from '@material-ui/icons/History'\r\nimport FastRewindIcon from '@material-ui/icons/FastRewind'\r\nimport DisablePan from '@material-ui/icons/SelectAll'\r\nimport DisableZoom from '@material-ui/icons/LocationDisabled'\r\nimport ResetZoom from '@material-ui/icons/ZoomOutMap'\r\n\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tloading: {\r\n\t\tposition: 'absolute',\r\n\t\tbackgroundColor: 'rgba(0, 0, 0, 0.3)',\r\n\t\twidth: '100%',\r\n\t\theight: '100%',\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center',\r\n\t\tjustifyContent: 'center',\r\n\t},\r\n\terrorMessage: {\r\n\t\tmarginBottom: 5,\r\n\t\tmarginRight: 15,\r\n\t\twidth: '100%'\r\n\t},\r\n\ttoolbar: {\r\n\t\tdisplay: 'flex'\r\n\t},\r\n\ttoolbarButtons: {\r\n\t\tdisplay: 'initial',\r\n\t\twhiteSpace: 'nowrap'\r\n\t},\r\n\toptions: {\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center'\r\n\t},\r\n\tdatePicker: {\r\n\t\tpadding: '2px 4px',\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center',\r\n\t\twidth: '50%',\r\n\t\tmargin: 2\r\n\t},\r\n\tinput: {\r\n\t\tmarginLeft: theme.spacing(1),\r\n\t\tflex: 1,\r\n\t},\r\n\tselect: {\r\n\t\twidth: 100\r\n\t},\r\n\ticon: {\r\n\t\tmargin: 10,\r\n\t},\r\n\ticonButton: {\r\n\t\tpadding: 10,\r\n\t},\r\n\tdivider: {\r\n\t\tmargin: '15px 0',\r\n\t},\r\n\tdividerVertical: {\r\n\t\theight: 28,\r\n\t\tmargin: 4,\r\n\t}\r\n});\r\n\r\n\r\nclass Chart extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\t// chart settings\r\n\t\tthis.chartFilter = this.props.settings.chartFilter || {};\r\n\t\tthis.chartConfig = this.props.settings.chartConfig || {};\r\n\t\t\r\n\t\tthis.chartConfig.yAxes = this.chartConfig.yAxes || [];\r\n\t\tthis.chartConfig.yAxes.unshift({\r\n\t\t\tid: 'left',\r\n\t\t\ttype: 'linear',\r\n\t\t\tposition: 'left',\r\n\t\t\tticks: {\r\n\t\t\t\tcallback: value => (this.chartConfig.yLeftAxisUnitBefore || '') + Number.parseFloat(value).toFixed(1) + (this.chartConfig.yLeftAxisUnitAfter || '')\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\t// states\r\n\t\tthis.state = {\r\n\t\t\tloading: true,\r\n\t\t\terrors: [],\r\n\t\t\t\r\n\t\t\tdatePicker: false,\r\n\t\t\tselectedTimeRangeValue: (this.chartFilter && this.chartFilter.selectedTimeRangeValue) || 1,\r\n\t\t\tselectedTimeRangeUnit: (this.chartFilter && this.chartFilter.selectedTimeRangeUnit) || 'days',\r\n\t\t\tselectedDateTime: (this.chartFilter && this.chartFilter.selectedDateTime && new Date(this.chartFilter.selectedDateTime)) || new Date(),\r\n\t\t\t\r\n\t\t\tchartLabels: [],\r\n\t\t\tchartData: {\r\n\t\t\t\tlabels: [],\r\n\t\t\t\tdatasets: []\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tchartPan: true,\r\n\t\t\tchartZoom: true\r\n\t\t}\r\n\t\t\r\n\t\t//\r\n\t\tthis.timer = null;\r\n\t\tthis.timeRangeRef = React.createRef();\r\n\t\t\r\n\t\t// chart instance options\r\n\t\tthis.chartRef = React.createRef();\r\n\t\tthis.chartUpdates = {};\r\n\t\tthis.chartOptions = {\r\n\t\t\tmaintainAspectRatio: false,\r\n\t\t\tspanGaps: true,\r\n\t\t\tlegend: {\r\n\t\t\t\tonClick: this.legendClickHandler.bind(this)\r\n\t\t\t},\r\n\t\t\ttooltips: {\r\n\t\t\t\tcallbacks: {\r\n\t\t\t\t\tlabel: (item, data) => data.datasets[item.datasetIndex].label + ': ' + item.value + data.datasets[item.datasetIndex].unit\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tscales: {\r\n\t\t\t\tyAxes: this.chartConfig.yAxes\r\n\t\t\t},\r\n\r\n\t\t\tplugins: {\r\n\t\t\t\tcolorschemes: {\r\n\t\t\t\t\tscheme: 'brewer.SetOne9'\r\n\t\t\t\t},\r\n\t\t\t\tzoom: {\r\n\t\t\t\t\t// Container for pan options\r\n\t\t\t\t\tpan: {\r\n\t\t\t\t\t\t// Boolean to enable panning\r\n\t\t\t\t\t\tenabled: true,\r\n\r\n\t\t\t\t\t\t// Panning directions\r\n\t\t\t\t\t\tmode: 'xy'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t\r\n\t\t\t\t\t// Container for zoom options\r\n\t\t\t\t\tzoom: {\r\n\t\t\t\t\t\t// Boolean to enable zooming\r\n\t\t\t\t\t\tenabled: true,\r\n\r\n\t\t\t\t\t\t// Zooming directions.\r\n\t\t\t\t\t\tmode: 'xy'\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\t\r\n\tcomponentDidMount() {\r\n\t\t\r\n\t\t// request initial history data\r\n\t\tlet options = { ...this.getTimeRange(), axis: this.getAxis() };\r\n\t\t\r\n\t\tthis.props.devices.forEach(device => {\r\n\t\t\tdevice.label = device.name + ' (' + i18n.t(device.primaryStateKey) + ')';\r\n\t\t\tdevice.requestDeviceStateHistory(device.options.history || null, true, { 'start': options.start, 'end': options.end, 'step': options.step, 'aggregate': 'average', 'ignoreNull': true }).catch(err => {\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t// add listeners for newly requested data\r\n\t\t\tdevice.on('historyChange', (stateKey, history, state) => {\r\n\t\t\t\t\r\n\t\t\t\tthis.addChartGraph(device, history, { ...options, axis: this.getAxis(options.start, options.end) } );\r\n\t\t\t\tthis.setState({ loading: false });\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t// add listeners for data updates\r\n\t\t\tif (this.props.settings.liveUpdates !== null && this.props.settings.liveUpdates !== false) {\r\n\t\t\t\t\r\n\t\t\t\tdevice.on('stateChange', (stateKey, val, state) => this.updateChartGraph(device, val, { ...options, axis: this.getAxis(options.end, new Date()) } ));\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\tcomponentDidUpdate(prevProps, prevState) {\r\n\t\t\r\n\t\tif (this.state.selectedTimeRangeValue &&\r\n\t\t\t\t(prevState.selectedDateTime !== this.state.selectedDateTime || prevState.selectedTimeRangeValue !== this.state.selectedTimeRangeValue || prevState.selectedTimeRangeUnit !== this.state.selectedTimeRangeUnit)\r\n\t\t\t) {\r\n\t\t\t\r\n\t\t\t// request updated history data\r\n\t\t\tthis.setState({ loading: true, errors: [] });\r\n\t\t\t\r\n\t\t\tclearTimeout(this.timer);\r\n\t\t\tthis.timer = setTimeout(() => {\r\n\t\t\t\t\r\n\t\t\t\tconst options = this.getTimeRange();\r\n\t\t\t\tthis.props.devices.forEach(device => {\r\n\t\t\t\t\tdevice.requestDeviceStateHistory(device.options.history || null, true, { 'start': options.start, 'end': options.end, 'step': options.step, 'aggregate': 'average', 'ignoreNull': true }).catch(err => {\r\n\t\t\t\t\t\tconsole.error(err);\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t}, 500);\r\n\t\t}\r\n\t}\r\n\t\r\n\tgetTimeRange() {\r\n\t\t\r\n\t\tconst end = this.state.selectedDateTime.getTime();\r\n\t\tlet timeRange = this.state.selectedTimeRangeValue;\r\n\t\tlet step = 1;\r\n\t\tlet axisTimeFormat = 'dd. MMM yyyy, HH:mm';\r\n\t\t\r\n\t\tswitch(this.state.selectedTimeRangeUnit) {\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t\t\r\n\t\t\tcase 'seconds':\r\n\t\t\t\taxisTimeFormat = 'dd. MMM yyyy, HH:mm:ss';\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tcase 'minutes':\r\n\t\t\t\taxisTimeFormat = 'dd. MMM yyyy, HH:mm:ss';\r\n\t\t\t\ttimeRange = timeRange*60;\r\n\t\t\t\t//step = step;\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tcase 'hours':\r\n\t\t\t\taxisTimeFormat = 'dd. MMM yyyy, HH:mm';\r\n\t\t\t\ttimeRange = timeRange*60*60;\r\n\t\t\t\tstep = step*60;\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tcase 'days':\r\n\t\t\t\taxisTimeFormat = 'dd. MMM yyyy, HH:mm';\r\n\t\t\t\ttimeRange = timeRange*60*60*24;\r\n\t\t\t\tstep = step*60*60;\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tcase 'months':\r\n\t\t\t\taxisTimeFormat = 'dd. MMM yyyy';\r\n\t\t\t\ttimeRange = timeRange*60*60*24*31;\r\n\t\t\t\tstep = step*60*60*24;\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tcase 'years':\r\n\t\t\t\taxisTimeFormat = 'dd. MMM yyyy';\r\n\t\t\t\ttimeRange = timeRange*60*60*24*365;\r\n\t\t\t\tstep = step*60*60*24*31;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\t\r\n\t\treturn {\r\n\t\t\t'axisTimeFormat': axisTimeFormat,\r\n\t\t\t'start': end-timeRange*1000,\r\n\t\t\t'end': end,\r\n\t\t\t'timeRange': timeRange*1000,\r\n\t\t\t'step': step*1000\r\n\t\t};\r\n\t}\r\n\t\r\n\tgetAxis(start, end) {\r\n\t\t\r\n\t\tconst { step, axisTimeFormat } = this.getTimeRange();\r\n\t\tlet axis = {};\r\n\t\t\r\n\t\tfor (let time = start; time <= end; time += step) {\r\n\t\t\taxis[time] = helpers.secondsToDateTime(time/1000, axisTimeFormat);\r\n\t\t}\r\n\t\t\r\n\t\treturn axis;\r\n\t}\r\n\t\r\n\tgroupChartData(chartData, axis) {\r\n\t\t\r\n\t\tlet prevMarker;\r\n\t\tlet data = [];\r\n\t\t\r\n\t\tlet markers = Object.keys(axis);\r\n\t\tmarkers.forEach((marker, i) => {\r\n\t\t\tprevMarker = markers[(i-1 > 0 ? i-1 : 0)];\r\n\t\t\t\r\n\t\t\tfor (let index in chartData) {\r\n\t\t\t\tlet entry = chartData[index];\r\n\t\t\t\tentry.val = parseFloat(entry.val);\r\n\t\t\t\t\r\n\t\t\t\t// \r\n\t\t\t\tif (!entry.ts || entry.val === null) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// before range, continue\r\n\t\t\t\tif (prevMarker > entry.ts) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// in range\r\n\t\t\t\telse if (prevMarker < entry.ts && entry.ts <= marker) {\r\n\t\t\t\t\tdata[i] = !data[i] ? [ entry.val ] : [ ...data[i], entry.val ]; // parseFloat((data[i] ? ((data[i]+entry.val)/2) : entry.val).toFixed(2));\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// beyond range, so next marker\r\n\t\t\t\telse if (entry.ts > marker) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t//\r\n\t\t\tif (!data[i]) {\r\n\t\t\t\t// \r\n\t\t\t}\r\n\t\t\telse if (data[i].length === 1) {\r\n\t\t\t\tdata[i] = data[i][0];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tdata[i] = data[i].reduce((a,b) => a + b, 0) / data[i].length;\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\treturn data;\r\n\t}\r\n\t\r\n\tupdateChartGraph(device, value, options) {\r\n\t\t\r\n\t\tconst chartIndex = this.state.chartLabels.findIndex(entry => entry === device.label);\r\n\t\tif (chartIndex === -1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t\tthis.chartUpdates[chartIndex] = this.chartUpdates[chartIndex] || [];\r\n\t\tthis.chartUpdates[chartIndex].push({\r\n\t\t\t'ts': value.ts,\r\n\t\t\t'val': value.val\r\n\t\t});\r\n\t\t\r\n\t\t// process data\r\n\t\tconst data = this.groupChartData(this.chartUpdates[chartIndex], options.axis);\r\n\t\t\r\n\t\tconsole.log(value);\r\n\t\tconsole.log(options, options.axis, data);\r\n\t\t\r\n\t\t// update chart\r\n\t\tthis.chartRef.current.chartInstance.data.labels = [ ...this.state.chartData.labels, ...Object.values(options.axis) ];\r\n\t\tthis.chartRef.current.chartInstance.data.datasets[chartIndex].data = [ ...this.state.chartData.datasets[chartIndex].data, ...data ];\r\n\t\tthis.chartRef.current.chartInstance.update();\r\n\t}\r\n\t\r\n\taddChartGraph(device, history, options) {\r\n\t\t\r\n\t\t// only add chart if data is given\r\n\t\tif (!history || !history.length) {\r\n\t\t\tlet error = i18n.t('No history data given for %s').replace('%s', device.label) + '!';\r\n\t\t\tthis.setState(prevStates => ({ errors: [ ...prevStates.errors, error ] }));\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t\t// process data\r\n\t\tconst data = this.groupChartData(history, options.axis);\r\n\t\t\r\n\t\t// update chart\r\n\t\tconst chartIndex = this.state.chartLabels.findIndex(entry => entry === device.label);\r\n\t\tif (chartIndex > -1) {\r\n\t\t\tthis.chartRef.current.chartInstance.data.labels = Object.values(options.axis);\r\n\t\t\tthis.chartRef.current.chartInstance.data.datasets[chartIndex].data = data;\r\n\t\t\tthis.chartRef.current.chartInstance.update();\r\n\t\t}\r\n\t\t\r\n\t\t// index chart\r\n\t\telse {\r\n\t\t\tthis.setState(prevStates => ({ chartLabels: [ ...prevStates.chartLabels, device.label ] }));\r\n\t\t\t\r\n\t\t\t// chart dataset\r\n\t\t\tlet dataSet = {\r\n\t\t\t\tlabel: device.label,\r\n\t\t\t\tunit: device.states[device.primaryStateKey].state.value.unit || '',\r\n\t\t\t\tfill: false,\r\n\t\t\t\t...device.options.graphConfig || {},\r\n\t\t\t\tdata: data\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\t// add data to chart\r\n\t\t\tthis.setState(prevStates => ({\r\n\t\t\t\taxisTimeFormat: options.axisTimeFormat,\r\n\t\t\t\tchartData: {\r\n\t\t\t\t\tlabels: Object.values(options.axis),\r\n\t\t\t\t\tdatasets: [ ...prevStates.chartData.datasets, dataSet ],\r\n\t\t\t\t}\r\n\t\t\t}));\r\n\t\t}\r\n\t}\r\n\t\r\n\tlegendClickHandler(e, legendItem) {\r\n\t\t\r\n\t\tlet index = legendItem.datasetIndex;\r\n\t\tlet ci = this.chartRef.current.chartInstance;\r\n\t\tlet meta = ci.getDatasetMeta(index);\r\n\r\n\t\tmeta.hidden = meta.hidden === null ? !ci.data.datasets[index].hidden : null;\r\n\t\tci.update();\r\n\t\tci.resetZoom();\r\n\t}\r\n\t\r\n\tdisablePan() {\r\n\t\tlet pan = this.chartRef.current.chartInstance.options.plugins.zoom.pan.enabled;\r\n\t\tthis.chartRef.current.chartInstance.options.plugins.zoom.pan.enabled = (pan === false);\r\n\t\tthis.setState({ chartPan: (pan === false) });\r\n\t}\r\n\t\r\n\tdisableZoom() {\r\n\t\tlet zoom = this.chartRef.current.chartInstance.options.plugins.zoom.zoom.enabled;\r\n\t\tthis.chartRef.current.chartInstance.options.plugins.zoom.zoom.enabled = (zoom === false);\r\n\t\tthis.setState({ chartZoom: (zoom === false) });\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { classes, settings } = this.props;\r\n\t\treturn (\r\n\r\n<div>\r\n\t<div className={classes.options}>\r\n\t\r\n\t\t<Paper className={classes.datePicker}>\r\n\t\t\t<Tooltip title={i18n.t('Period shown in Chart')}>\r\n\t\t\t\t<HistoryIcon className={classes.icon} />\r\n\t\t\t</Tooltip>\r\n\t\t\t\r\n\t\t\t<InputBase\r\n\t\t\t\tinputRef={this.timeRangeRef}\r\n\t\t\t\tclassName={classes.input}\r\n\t\t\t\tvalue={this.state.selectedTimeRangeValue}\r\n\t\t\t\tonChange={event => this.setState({ selectedTimeRangeValue: event.target.value })}\r\n\t\t\t\t/>\r\n\t\t\t\r\n\t\t\t<Select\r\n\t\t\t\tvalue={this.state.selectedTimeRangeUnit}\r\n\t\t\t\tonChange={event => this.setState({ selectedTimeRangeUnit: event.target.value })}\r\n\t\t\t\tdisplayEmpty\r\n\t\t\t\tdisableUnderline\r\n\t\t\t\tclassName={classes.select}\r\n\t\t\t\t>\r\n\t\t\t\t\r\n\t\t\t\t<MenuItem value=\"seconds\">{i18n.t('Seconds')}</MenuItem>\r\n\t\t\t\t<MenuItem value=\"minutes\">{i18n.t('Minutes')}</MenuItem>\r\n\t\t\t\t<MenuItem value=\"hours\">{i18n.t('Hours')}</MenuItem>\r\n\t\t\t\t<MenuItem value=\"days\">{i18n.t('Days')}</MenuItem>\r\n\t\t\t\t<MenuItem value=\"months\">{i18n.t('Months')}</MenuItem>\r\n\t\t\t\t<MenuItem value=\"years\">{i18n.t('Years')}</MenuItem>\r\n\t\t\t</Select>\r\n\t\t\t\r\n\t\t\t{/*\r\n\t\t\t<IconButton className={classes.iconButton} onClick={() => this.timeRangeRef.current.focus()}>\r\n\t\t\t\t<CalendarIcon />\r\n\t\t\t</IconButton>\r\n\t\t\t*/}\r\n\t\t</Paper>\r\n\r\n\t\t<Paper className={classes.datePicker}>\r\n\t\t\t<Tooltip title={i18n.t('End date')}>\r\n\t\t\t\t<FastRewindIcon className={classes.icon} />\r\n\t\t\t</Tooltip>\r\n\t\t\t\r\n\t\t\t<MuiPickersUtilsProvider locale={deLocale} utils={DateFnsUtils}>\r\n\t\t\t\t<DateTimePicker\r\n\t\t\t\t\tclassName={classes.input}\r\n\t\t\t\t\tvalue={this.state.selectedDateTime}\r\n\t\t\t\t\tonChange={selectedDateTime => this.setState({ selectedDateTime })}\r\n\t\t\t\t\t\r\n\t\t\t\t\topen={this.state.datePicker}\r\n\t\t\t\t\tonOpen={() => this.setState({ datePicker: true })}\r\n\t\t\t\t\tonClose={() => this.setState({ datePicker: false })}\r\n\t\t\t\t\t\r\n\t\t\t\t\tvariant=\"inline\"\r\n\t\t\t\t\tampm={false}\r\n\t\t\t\t\tformat='dd.MM.yyyy HH:mm'\r\n\t\t\t\t\tInputProps={{\r\n\t\t\t\t\t\tdisableUnderline: true,\r\n\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t</MuiPickersUtilsProvider>\r\n\t\t\t\r\n\t\t\t<Tooltip title={i18n.t('Select end date')}>\r\n\t\t\t\t<IconButton color=\"primary\" className={classes.iconButton} onClick={() => this.setState({ datePicker: true })}>\r\n\t\t\t\t\t<CalendarIcon />\r\n\t\t\t\t</IconButton>\r\n\t\t\t</Tooltip>\r\n\t\t\t<Divider className={classes.dividerVertical} orientation=\"vertical\" />\r\n\t\t\t<Tooltip title={i18n.t('Select today as end date')}>\r\n\t\t\t\t<IconButton className={classes.iconButton} onClick={() => this.setState({ selectedDateTime: new Date() })}>\r\n\t\t\t\t\t<CalendarTodayIcon />\r\n\t\t\t\t</IconButton>\r\n\t\t\t</Tooltip>\r\n\t\t</Paper>\r\n\t\t\r\n\t</div>\r\n\t<Divider className={classes.divider} />\r\n\t\r\n\t<div className={classes.toolbar}>\r\n\t\t<div className={classes.errorMessage}>\r\n\t\t\t{this.state.errors.length > 0 && <Alert severity=\"error\">{this.state.errors.map((error, i) => [ error, React.createElement('br', { key: 'br-error-' + i }) ])}</Alert>}\r\n\t\t</div>\r\n\t\t\r\n\t\t<ButtonGroup className={classes.toolbarButtons} color=\"primary\">\r\n\t\t{/*\r\n\t\t\t<Button disableElevation={true} variant={this.state.chartPan ? 'contained' : 'outlined'} onClick={this.disablePan.bind(this)}>\r\n\t\t\t\t<Tooltip title={i18n.t(this.state.chartPan ? 'Disable panning' : 'Enable panning')}>\r\n\t\t\t\t\t<DisablePan />\r\n\t\t\t\t</Tooltip>\r\n\t\t\t</Button>\r\n\t\t\t<Button disableElevation={true} variant={this.state.chartZoom ? 'contained' : 'outlined'} onClick={this.disableZoom.bind(this)}>\r\n\t\t\t\t<Tooltip title={i18n.t(this.state.chartZoom ? 'Disable Zoom' : 'Enable Zoom')}>\r\n\t\t\t\t\t<DisableZoom />\r\n\t\t\t\t</Tooltip>\r\n\t\t\t</Button>\r\n\t\t*/}\r\n\t\t\t<Button disableElevation={true} variant=\"contained\" onClick={() => this.chartRef.current.chartInstance.resetZoom()}>\r\n\t\t\t\t<Tooltip title={i18n.t('Reset Zoom')}>\r\n\t\t\t\t\t<ResetZoom />\r\n\t\t\t\t</Tooltip>\r\n\t\t\t</Button>\r\n\t\t</ButtonGroup>\r\n\t</div>\r\n\t\r\n\t<div className={'chart-container'} style={{ position: 'relative', height: settings.chartHeight || '500px' }}>\r\n\t\t{this.state.loading && <div className={classes.loading}>\r\n\t\t\t<CircularProgress />\r\n\t\t</div>}\r\n\t\t\r\n\t\t<Line\r\n\t\t\tref={this.chartRef}\r\n\t\t\tdata={this.state.chartData}\r\n\t\t\toptions={this.chartOptions}\r\n\t\t\t/>\r\n\t\t\t\r\n\t</div>\r\n</div>\r\n\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(Chart);\r\n","import React, { useState, useEffect, useRef } from 'react'\r\nimport { format } from 'date-fns'\r\nimport { de } from 'date-fns/locale'\r\n\r\nimport i18n from '../i18n'\r\n\r\n\r\nexport default function DateTime(props) {\r\n\tconst { settings } = props;\r\n\t\r\n\tconst refTimer = useRef();\r\n\tconst [DateTime, setDateTime] = useState(format(new Date(), settings.format, { locale: de }));\r\n\t\r\n\t// https://date-fns.org/v2.9.0/docs/format\r\n\tsettings.style = { fontSize: '1.5rem', textAlign: 'center', ...settings.style };\r\n\tsettings.format = settings.format || 'dd.MM.yyyy HH:mm:ss';\r\n\tsettings.refresh = settings.format.indexOf('s') > -1 ? 1000 : (settings.format.indexOf('i') > -1 ? 60*1000 : 60*60*1000);\r\n\t\r\n\tuseEffect(() => {\r\n\t\tclearTimeout(refTimer.current);\r\n\t\trefTimer.current = setTimeout(() => setDateTime(format(new Date(), settings.format, { locale: de })), settings.refresh);\r\n\t});\r\n\t\r\n\treturn (\r\n\r\n<div style={settings.style}>\r\n\t{i18n.t('%DateTime').replace(/%DateTime/, DateTime)}\r\n</div>\r\n\r\n\t);\r\n}\r\n\r\nexport const Settings = {\r\n\tnoDevicesAllowed: true,\r\n\ttitle: i18n.t('Time'),\r\n\ticon: 'clock-outline'\r\n}\r\n","import React, { useState, useEffect, useRef, useCallback } from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport L from 'leaflet'\r\nimport { Map as LeafletMap, TileLayer, Marker as LeafletMarker, Tooltip as LeafletTooltip } from 'react-leaflet'\r\n\r\nimport i18n from '../i18n'\r\nimport Box from '@material-ui/core/Box'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\nimport Avatar from '@material-ui/core/Avatar'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tmap: {\r\n\t\twidth: '100%',\r\n\t\theight: '100%'\r\n\t},\r\n\tmapOverview: {\r\n\t\tcolor: '#666',\r\n\t\tposition: 'absolute',\r\n\t\tleft: 0,\r\n\t\tbottom: 0,\r\n\t\twidth: '100%',\r\n\t\theight: '60px',\r\n\t\tzIndex: 999,\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center',\r\n\t\t\r\n\t\t'& > *': {\r\n\t\t\tmargin: theme.spacing(1),\r\n\t\t\tcursor: 'pointer',\r\n\t\t},\r\n\t},\r\n\t/*\r\n\t * MARKER WITH ICON\r\n\t *\r\n\tmapIconContainer: {\r\n\t\tbackgroundImage: 'url(\"https://unpkg.com/leaflet@1.6.0/dist/images/marker-icon-2x.png\")',\r\n\t\tbackgroundSize: '100% 100%'\r\n\t},\r\n\tmapIconParent: {\r\n\t\tbackgroundColor: '#fff',\r\n\t\tborderRadius: '10px',\r\n\t\theight: '20px',\r\n\t\twidth: '20px',\r\n\t\tmargin: '3px auto',\r\n\t\ttextAlign: 'center'\r\n\t},\r\n\tmapIcon: {\r\n\t\tfontSize: '1.2rem',\r\n\t\tdisplay: 'block',\r\n\t\tmargin: '-4px 0 0 1px',\r\n\t\tcolor: '#f00',\r\n\t\tposition: 'absolute'\r\n\t}\r\n\t*/\r\n\tmapIconContainer: {\r\n\t},\r\n\tmapIconParent: {\r\n\t\tbackgroundColor: '#fff',\r\n\t\tboxShadow: '0 0 0 8px rgba(255, 255, 255, 0.3)',\r\n\t\tborderRadius: '50%',\r\n\t\twidth: '100%',\r\n\t\theight: '100%'\r\n\t},\r\n\tmapIcon: {\r\n\t\tfontSize: '2rem',\r\n\t\tcolor: theme.palette.primary.main,\r\n\t\ttransform: 'translate3d(4px, -4px,0)', /* for fontSize: '2.3rem' -> 'translate3d(2px, -8px,0)', */\r\n\t\tdisplay: 'block',\r\n\t\t\r\n\t\t'&:after': {\r\n\t\t\tcontent: '\"\"',\r\n\t\t\tdisplay: 'block',\r\n\t\t\tpadding: '50% 0%'\r\n\t\t}\r\n\t},\r\n\tmapTooltip: {\r\n\t}\r\n}));\r\n\r\n\r\nexport default function Map(props) {\r\n\tconst { settings, devices } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst [zoom,] = useState(settings.component.defaultZoom);\r\n\tconst [position,] = useState(Array.isArray(settings.component.defaultPosition) ? settings.component.defaultPosition : settings.component.defaultPosition.split(','));\r\n\tconst [markers, setMarkers] = useState({});\r\n\t\r\n\t// map instance\r\n\tconst map = useRef();\r\n\tconst memoizedMapInitialised = useCallback(function() {map.current = this}, [],);\r\n\t\r\n\t// Marker click in overview\r\n\tconst memoizedHandleClick = useCallback(flyTo => map.current.flyTo(flyTo.split(',')), [],);\r\n\t\r\n\t// get gps position coordinates\r\n\tuseEffect(() => {\r\n\t\tdevices.forEach(device => {\r\n\t\t\t\r\n\t\t\t// request device state\r\n\t\t\tdevice.requestDeviceState('position').catch(err => {\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t\t\r\n\t\t\t\tsetMarkers(prevMarkers => {\r\n\t\t\t\t\tif (!prevMarkers[device.id]) {\r\n\t\t\t\t\t\treturn { ...prevMarkers, [device.id]: null };\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\treturn prevMarkers;\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t// listen for updates\r\n\t\t\tdevice.on('stateChange', (stateKey, state) => {\r\n\t\t\t\t\r\n\t\t\t\tif (stateKey === 'position') {\r\n\t\t\t\t\t\r\n\t\t\t\t\tsetMarkers(prevMarkers => {\r\n\t\t\t\t\t\tif (!prevMarkers[device.id] || prevMarkers[device.id].position !== state.val) {\r\n\t\t\t\t\t\t\tdevice.options.position = state.val;\r\n\t\t\t\t\t\t\treturn { ...prevMarkers, [device.id]: device };\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\treturn prevMarkers;\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t\r\n\t}, [devices]);\r\n\t\r\n\t// add markers\r\n\tlet mapMarkers = [], mapOverview = [];\r\n\tif (devices.length > 0 && devices.length === Object.keys(markers).length) {\r\n\t\t\r\n\t\tfor (let key in markers) {\r\n\t\t\tlet device = markers[key];\r\n\t\t\tif (device !== null) {\r\n\t\t\t\tlet marker = <Marker key={'marker-' + device.id} position={device.options.position} device={device} settings={settings.component} />\r\n\t\t\t\tmapMarkers.push(marker);\r\n\t\t\t\t\r\n\t\t\t\tlet item = null;\r\n\t\t\t\tif (device.attributes.avatar) {\r\n\t\t\t\t\titem = <Avatar key={'overview-' + device.id} alt={device.name} src={device.attributes.avatar} onClick={() => memoizedHandleClick(device.options.position)} />\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tconst icon = device.getIcon('position');\r\n\t\t\t\t\titem = <Avatar key={'overview-' + device.id} alt={device.name} onClick={() => memoizedHandleClick(device.options.position)}><span className={clsx('mdi mdi-' + icon)}></span></Avatar>\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tmapOverview.push(<Tooltip key={'tooltip-' + device.id} title={device.name} aria-label={device.name} arrow>{item}</Tooltip>);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn (\r\n\r\n<React.Fragment>\r\n\t<Box className={classes.mapOverview}>\r\n\t\t<Typography>{i18n.t('Jump to')}:</Typography>\r\n\t\t{mapOverview}\r\n\t</Box>\r\n\t<LeafletMap useFlyTo={true} center={position} zoom={zoom} className={classes.map} whenReady={memoizedMapInitialised}>\r\n\t\t<TileLayer\r\n\t\t\tattribution='&amp;copy <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\r\n\t\t\turl='https://{s}.tile.osm.org/{z}/{x}/{y}.png'\r\n\t\t\t/>\r\n\t\t\r\n\t\t{mapMarkers}\r\n\t</LeafletMap>\r\n</React.Fragment>\r\n\r\n\t);\r\n}\r\n\r\n\r\nfunction Marker(props) {\r\n\tconst { position, device, settings } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tlet markerIcon = null, offset = 40;\r\n\tconsole.info('Marker for ' + device.function + ' ' + device.name + ' added to map.');\r\n\t\r\n\t// Marker with avatar / picture\r\n\tif (device.attributes && device.attributes.avatar && device.attributes.avatar.substr(0, 11) === 'data:image/') {\r\n\t\tmarkerIcon = L.divIcon({\r\n\t\t\tclassName: classes.mapIconContainer,\r\n\t\t\thtml: '<img src=\"' + device.attributes.avatar + '\" class=\"' + classes.mapIconParent + '\" />',\r\n\t\t\ticonSize: [ 64, 64 ]\r\n\t\t});\r\n\t}\r\n\t\r\n\t// Marker with Icon\r\n\telse {\r\n\t\toffset = 30;\r\n\t\tconst icon = device.getIcon('position');\r\n\t\t\r\n\t\tmarkerIcon = L.divIcon({\r\n\t\t\tclassName: classes.mapIconContainer,\r\n\t\t\thtml: '<div class=\"' + classes.mapIconParent + '\"><span class=\"' + clsx(classes.mapIcon, 'mdi mdi-' + icon) + '\"></span></div>',\r\n\t\t\ticonSize: [ 40, 40 ]\r\n\t\t});\r\n\t}\r\n\t\r\n\t// Marker MouseOver / MouseOut (bring tooltip to front if markers overlay)\r\n\tconst memoizedHandleMouseEvent = useCallback(function() {this.closeTooltip().openTooltip()}, [],);\r\n\r\n\treturn (\r\n\r\n<LeafletMarker riseOnHover={true} position={Array.isArray(position) ? position : position.split(',')} icon={markerIcon} onMouseOver={memoizedHandleMouseEvent}>\r\n\t<LeafletTooltip className={classes.mapTooltip} direction={settings.tooltipDirection || 'bottom'} permanent={settings.tooltipPermanent || true} offset={[0,offset]}>\r\n\t\t{device.name}\r\n\t</LeafletTooltip>\r\n</LeafletMarker>\r\n\r\n\t);\r\n}","import React from 'react'\r\n\r\nimport StateList from './StateList'\r\n\r\n\r\nexport default function StateListHorizontal(props) {\r\n\treturn (<StateList horizontal={true} {...props} />);\r\n}\r\n","import React, { useState, useEffect } from 'react'\r\n\r\nimport Connection from '../Connection'\r\nimport i18n from '../i18n'\r\n\r\nimport Grid from '@material-ui/core/Grid'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tpaper: {\r\n\t\twidth: 100,\r\n\t\theight: 160,\r\n\t\tpadding: 5,\r\n\t\ttextAlign: 'center',\r\n\t}\r\n}));\r\n\r\n\r\nexport default function Weather(props) {\r\n\tconst { settings } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst [data,setData] = useState(null);\r\n\tuseEffect(() => {\r\n\t\t\r\n\t\tConnection.getConnection.getRemoteResource(settings.url).then(\r\n\t\t\tresponse => {\r\n\t\t\t\t\r\n\t\t\t\tif (response.statusCode === 200) {\r\n\t\t\t\t\tsetData(JSON.parse(response.body));\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terror => console.error(error)\r\n\t\t);\r\n\t\t\r\n\t}, [settings.url]);\r\n\t\r\n\tlet weatherForecast = [];\r\n\t//console.log(data);\r\n\t\r\n\tif (!data) {\r\n\t\treturn null;\r\n\t}\r\n\telse {\r\n\t\tfor (let day in data.day) {\r\n\t\t\tlet forecast = data.day[day];\r\n\t\t\tforecast.title = day === 1 ? i18n.t('today') : (day === 2 ? i18n.t('tomorrow') : forecast.name);\r\n\t\t\t\r\n\t\t\tconst dailyForecast = (\r\n\r\n<Grid key={'day-' + day} item>\r\n\t<Paper className={classes.paper}>\r\n\t\t<Typography variant=\"body1\">\r\n\t\t\t{forecast.title}\r\n\t\t</Typography>\r\n\t\t<Typography variant=\"caption\">\r\n\t\t\t{forecast.date}\r\n\t\t</Typography>\r\n\r\n\r\n\t</Paper>\r\n</Grid>\r\n\r\n\t\t\t);\r\n\t\t\t\r\n\t\t\tweatherForecast.push(dailyForecast);\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn (\r\n\r\n<Grid container justify=\"space-between\" spacing={1}>\r\n\t{weatherForecast}\r\n\t\r\n</Grid>\r\n\r\n\t);\r\n}\r\n\r\nexport const Settings = {\r\n\tnoDevicesAllowed: true,\r\n\ttitle: i18n.t('Weather'),\r\n\ticon: 'weather-partly-cloudy'\r\n}\r\n","import React from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport helpers from '../helpers/timeConverter'\r\n\r\nimport Divider from '@material-ui/core/Divider'\r\n//import IconButton from '@material-ui/core/IconButton'\r\nimport Fab from '@material-ui/core/Fab'\r\nimport PlayIcon from '@material-ui/icons/PlayArrow'\r\nimport PauseIcon from '@material-ui/icons/Pause'\r\nimport StopIcon from '@material-ui/icons/Stop'\r\nimport SkipPreviousIcon from '@material-ui/icons/SkipPrevious'\r\nimport SkipNextIcon from '@material-ui/icons/SkipNext'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tdivider: {\r\n\t\tmargin: '15px -16px'\r\n\t},\r\n\tcontainer: {\r\n\t\tmargin: theme.spacing(0, -2),\r\n\t},\r\n\tnoHeader: {\r\n\t\tmarginTop: theme.spacing(-4),\r\n\t},\r\n\timage: {\r\n\t\theight: '200px',\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'flex-end',\r\n\t\tbackgroundPosition: 'center',\r\n\t\tcursor: 'pointer'\r\n\t},\r\n\tnoImage: {\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t\tdisplay: 'flex',\r\n\t\tcursor: 'pointer'\r\n\t},\r\n\tinformation: {\r\n\t\tbackgroundColor: theme.palette.primary.main + '66',\r\n\t\tcolor: '#fff',\r\n\t\tpadding: '10px',\r\n\t\tmargin: 0,\r\n\t\twidth: '100%',\r\n\t\tminHeight: '45px'\r\n\t},\r\n\tinformationLeft: {\r\n\t\twidth: '80%',\r\n\t\tfloat: 'left',\r\n\t\tmargin: 0\r\n\t},\r\n\tinformationRight: {\r\n\t\twidth: '19%',\r\n\t\tfloat: 'right',\r\n\t\tmargin: 0,\r\n\t\ttextAlign: 'right'\r\n\t},\r\n\tlength: {\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t\twidth: '100%',\r\n\t\theight: '7px',\r\n\t},\r\n\tlengthBar: {\r\n\t\tbackgroundColor: theme.palette.secondary.main,\r\n\t\theight: '100%',\r\n\t},\r\n\tcontrols: {\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'stretch'\r\n\t},\r\n\tcontrolsBox: {\r\n\t\tdisplay: 'flex',\r\n\t\tjustifyContent: 'center',\r\n\t\talignItems: 'center',\r\n\t\tpaddingTop: '30px'\r\n\t},\r\n\tcontrolsBoxLeft: {\r\n\t\tflex: 1,\r\n\t\tflexDirection: 'column',\r\n\t\talignItems: 'baseline'\r\n\t},\r\n\tcontrolsBoxCenter: {\r\n\t\tflex: 3\r\n\t},\r\n\tcontrolsBoxRight: {\r\n\t\tflex: 1,\r\n\t\tjustifyContent: 'end'\r\n\t},\r\n\tcontrolButton: {\r\n\t\tmargin: '0 5px'\r\n\t},\r\n\tcontrolButtonSmall: {\r\n\t\tmargin: '0 10px',\r\n\t\tfontSize: '1.2rem',\r\n\t\theight: '32px',\r\n\t\twidth: '32px'\r\n\t}\r\n});\r\n\r\n\r\nclass Multimedia extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {}\r\n\t}\r\n\t\r\n\tcomponentDidMount() {\r\n\t\t\r\n\t\t// get initial states\r\n\t\tfor (let stateKey in this.props.device.states) {\r\n\t\t\tthis.props.device.requestDeviceState(stateKey, true).catch(err => console.error(err));\r\n\t\t}\r\n\t\t\r\n\t\t// receive updates\r\n\t\tthis.props.device.on('stateChange', (stateKey, state) => {\r\n\t\t\t\r\n\t\t\t// duration\r\n\t\t\tif (stateKey === 'duration' && state && state.val.indexOf(':') === -1) {\r\n\t\t\t\tstate.val = helpers.timeToHoursMinutesSeconds(state.val);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// isRunning\r\n\t\t\tif (stateKey === 'isRunning' && state && typeof state.val === 'string') {\r\n\t\t\t\tstate.val = state.val.indexOf('play') > -1;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis.setState({ [stateKey]: state }, () => {\r\n\t\t\t\tthis.progress();\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\t\r\n\tprogress() {\r\n\t\tclearTimeout(this.progressTimeout);\r\n\t\t\r\n\t\tif (this.state.isRunning && this.state.isRunning.val === true && this.state.progress && this.state.progress.val && this.state.duration && this.state.duration.val) {\r\n\t\t\tthis.progressTimeout = setTimeout(() => {\r\n\t\t\t\tthis.setState(prevState => ({ progress: { ...prevState.progress, val: helpers.timeToSeconds(prevState.progress.val) + 1 }}), () => this.progress());\r\n\t\t\t}, 1000);\r\n\t\t}\r\n\t}\r\n\t\r\n\topenDialog() {\r\n\t\tthis.props.openDialog(this.props.device);\r\n\t}\r\n\t\r\n\tsetDeviceState(stateKey, value) {\r\n\t\tthis.props.device.setDeviceState(stateKey, value).catch(err => console.error(err));\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { classes, noHeader, index, device } = this.props;\r\n\t\tlet styleImage = {}, styleLength = {}, styleLengthBar = {};\r\n\t\t\r\n\t\t// background\r\n\t\tif (this.state.background && this.state.background.val !== '') {\r\n\t\t\tstyleImage.backgroundImage = 'url(' + ((device.options.backgroundUrlPrepend || '') + this.state.background.val) + ')';\r\n\t\t}\r\n\t\t\r\n\t\t// duration\r\n\t\tif (this.state.duration && this.state.duration.val) {\r\n\t\t\tstyleLengthBar.width = ((this.state.progress && this.state.progress.val) || 0) + 'px';\r\n\t\t}\r\n\t\t\r\n\t\tconst playIconElements = this.state.isRunning && this.state.isRunning.val ? [<PauseIcon onClick={this.setDeviceState.bind(this, 'pause', true)} />, <StopIcon />] : [<PlayIcon onClick={this.setDeviceState.bind(this, 'play', true)} />];\r\n\t\t//const repeatIcon = 'repeat'; // repeat, repeat-off, repeat-once\r\n\t\t//const shuffleIcon = 'shuffle-variant'; // shuffle-variant, shuffle-disabled\r\n\t\t//const volumeIcon = 'volume-high'; // volume-variant-off\r\n\t\t\r\n\t\treturn (\r\n\r\n<React.Fragment>\r\n\t\r\n\t{index > 0 && <Divider className={classes.divider} />}\r\n\t<div className={clsx(classes.container, noHeader && classes.noHeader)}>\r\n\t\t\r\n\t\t<div className={clsx(this.state.background && this.state.background.val !== '' ? classes.image : classes.noImage)} style={ styleImage } onClick={this.openDialog.bind(this)}>\r\n\t\t\t\r\n\t\t\t<div className={classes.information}>\r\n\t\t\t\t<p className={classes.informationLeft}>\r\n\t\t\t\t\t{this.state.grandParent && this.state.grandParent.val && [this.state.grandParent.val, <br key={'br-' + device.id} />]}\r\n\t\t\t\t\t{this.state.parent && this.state.parent.val && this.state.parent.val + ' - '}{this.state.title && this.state.title.val}\r\n\t\t\t\t</p>\r\n\t\t\t\t<p className={classes.informationRight}>\r\n\t\t\t\t\t{this.state.progress && helpers.timeToHoursMinutesSeconds(this.state.progress.val)} / {this.state.duration && this.state.duration.val}\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div>\r\n\t\t<div className={classes.length} style={ styleLength }>\r\n\t\t\t<div className={classes.lengthBar} style={ styleLengthBar }></div>\r\n\t\t</div>\r\n\t\t\r\n\t\t<div className={classes.controls}>\r\n\t\t\t<div className={clsx(classes.controlsBox, classes.controlsBoxLeft)}>\r\n\t\t\t\t{/*\r\n\t\t\t\t<IconButton size=\"small\" className={classes.controlButtonSmall}>\r\n\t\t\t\t\t<span className={'mdi mdi-' + repeatIcon}></span>\r\n\t\t\t\t</IconButton>\r\n\t\t\t\t<IconButton size=\"small\" className={classes.controlButtonSmall}>\r\n\t\t\t\t\t<span className={'mdi mdi-' + shuffleIcon}></span>\r\n\t\t\t\t</IconButton>\r\n\t\t\t\t*/}\r\n\t\t\t\t\r\n\t\t\t</div>\r\n\t\t\t<div className={clsx(classes.controlsBox, classes.controlsBoxCenter)}>\r\n\t\t\t\t\r\n\t\t\t\t<Fab className={classes.controlButton} size=\"small\" color=\"secondary\">\r\n\t\t\t\t\t<SkipPreviousIcon onClick={this.setDeviceState.bind(this, 'previous', true)} />\r\n\t\t\t\t</Fab>\r\n\t\t\t\t\r\n\t\t\t\t{playIconElements.map((icon, i) => \r\n\t\t\t\t<Fab key={'icon-' + i} className={classes.controlButton} size=\"large\" color=\"primary\">\r\n\t\t\t\t\t{icon}\r\n\t\t\t\t</Fab>\r\n\t\t\t\t)}\r\n\t\t\t\t\r\n\t\t\t\t<Fab className={classes.controlButton} size=\"small\" color=\"secondary\">\r\n\t\t\t\t\t<SkipNextIcon onClick={this.setDeviceState.bind(this, 'next', true)} />\r\n\t\t\t\t</Fab>\r\n\t\t\t\t\r\n\t\t\t</div>\r\n\t\t\t<div className={clsx(classes.controlsBox, classes.controlsBoxRight)}>\r\n\t\t\t\t{/*\r\n\t\t\t\t<IconButton size=\"small\" className={classes.controlButtonSmall}>\r\n\t\t\t\t\t<span className={'mdi mdi-' + volumeIcon}></span>\r\n\t\t\t\t</IconButton>\r\n\t\t\t\t*/}\r\n\t\t\t\t\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t\r\n\t</div>\r\n\r\n</React.Fragment>\r\n\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(Multimedia);\r\n","import React from 'react'\r\n\r\nimport MultimediaItem from './MultimediaItem'\r\n\r\n\r\nexport default function StateList(props) {\r\n\tconst { devices, settings } = props;\r\n\treturn devices.map((device, i) => <MultimediaItem key={'MultimediaItem-' + device.id} {...props} index={i} noHeader={i === 0 && settings.icon === null && settings.title === null} device={device} />)\r\n}\r\n","var map = {\n\t\"./de.js\": 316,\n\t\"./en.js\": 317\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 315;","export default {\r\n\t/*\r\n\t * LOADING SCREEN\r\n\t */\r\n\t\"Retrieving settings\": \"Einstellungen werden geladen\",\r\n\t\r\n\t/*\r\n\t * GENERAL\r\n\t */\r\n\t\"on\": \"an\",\r\n\t\"off\": \"aus\",\r\n\t\r\n\t\"user\": \"User\",\r\n\t\"users\": \"Users\",\r\n\t\r\n\t\"door\": \"Tr\",\r\n\t\"window\": \"Fenster\",\r\n\t\r\n\t\"open\": \"offen\",\r\n\t\"closed\": \"geschlossen\",\r\n\t\r\n\t\"turn on\": \"anschalten\",\r\n\t\"power\": \"Gerte Status\",\r\n\t\"trigger\": \"Gerte Status\",\r\n\t\r\n\t\"brightness\": \"Helligkeit\",\r\n\t\"wind\": \"Wind\",\r\n\t\"battery\": \"Batterie\",\r\n\t\r\n\t\"%DateTime\": \"%DateTime Uhr\",\r\n\t\"boost\": \"Boost\",\r\n\t\r\n\t/*\r\n\t * BLINDS\r\n\t */\r\n\t\"blind#level\": \"Behanghhe\",\r\n\t\"blind#level2\": \"Lamellenposition\",\r\n\t\r\n\t\r\n\t/*\r\n\t * LIGHT\r\n\t */\r\n\t\"light#power\": \"Licht\",\r\n\t\"light#level\": \"Helligkeit\",\r\n\t\"colorTemperature\": \"Farbtemperatur\",\r\n\t\"hue\": \"Farbe\",\r\n\t\"light#rgb\": \"Farbraum Rot-Grn-Blau (RGB)\",\r\n\t\"hex\": \"Farbe\",\r\n\t\r\n\t\r\n\t/*\r\n\t * HEATING\r\n\t */\r\n\t\"temperature\": \"Temperatur\",\r\n\t\"humidity\": \"Luftfeuchtigkeit\",\r\n\t\"setTemperature\": \"eingestellte Temperatur\",\r\n\t\r\n\t\r\n\t/*\r\n\t * DOOR\r\n\t */\r\n\t\"bell\": \"Klingel\",\r\n\t\"lock\": \"Schlo\",\r\n\t\"presence\": \"Prsenz\",\r\n\t\r\n\t\r\n\t/*\r\n\t * HOUSEHOLD\r\n\t */\r\n\t\"running\": \"Gert luft\",\r\n\t\"consumption\": \"Verbrauch\"\r\n}","export default {\r\n\t/*\r\n\t * LIGHT\r\n\t */\r\n\t\"level\": \"Brightness\",\r\n\t\"colorTemperature\": \"Color Temperature\",\r\n\t\"hue\": \"Color\",\r\n\t\"color\": \"Color\",\r\n\t\"hex\": \"Color\",\r\n}","\r\nexport default {\r\n\tconfigurations: {\r\n\t\topen: {\r\n\t\t\ticon: {\r\n\t\t\t\t'true': 'door-open',\r\n\t\t\t\t'false': 'door-closed'\r\n\t\t\t},\r\n\t\t\tstate: {\r\n\t\t\t\t'true': 'open',\r\n\t\t\t\t'false': 'closed'\r\n\t\t\t},\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t},\r\n\tactions: {\r\n\t},\r\n\tstyles: {\r\n\t}\r\n}","import React from 'react'\r\n\r\nimport defaults from './defaults'\r\n\r\n\r\n/*\r\n * COMPONENTS\r\n *\r\n */\r\nfunction HeatingSetTemperatureComponent(props) {\r\n\tconst Level = defaults.components.LevelComponent;\r\n\treturn (\r\n\t\t<Level min={0} max={35} {...props} />\r\n\t);\r\n}\r\n\r\n\r\n\r\nexport default {\r\n\tconfigurations: {\r\n\t\ttemperature: {\r\n\t\t\tvalue: (val) => val.toFixed(1),\r\n\t\t\tunit: ' C'\r\n\t\t},\r\n\t\tsetTemperature: {\r\n\t\t\tunit: ' C',\r\n\t\t\ticon: 'thermometer-chevron-up'\r\n\t\t},\r\n\t\thumidity: {\r\n\t\t\tunit: ' %'\r\n\t\t},\r\n\t\tboost: {\r\n\t\t\ticon: 'radiator'\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t\tsetTemperature: HeatingSetTemperatureComponent\r\n\t},\r\n\tactions: {\r\n\t\tboost: defaults.actions.PowerAction\r\n\t},\r\n\tstyles: {\r\n\t}\r\n}","import React, { useState, useEffect } from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport i18n from '../i18n'\r\n\r\nimport Slider from '@material-ui/core/Slider'\r\nimport Switch from '@material-ui/core/Switch'\r\nimport Button from '@material-ui/core/Button'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles, withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tprimaryAction: props => ({\r\n\t\t...props.styles\r\n\t}),\r\n\tsecondaryAction: props => ({\r\n\t\tcolor: '#999',\r\n\t\tfontSize: '14px',\r\n\t\t...props.styles\r\n\t}),\r\n});\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n\tcomponent: {\r\n\t\tpadding: theme.spacing(2, 8, 2, 2)\r\n\t},\r\n\tsliderMarkLabel: {\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tdisplay: 'none',\r\n\t\t\t'&:nth-child(5)': { display: 'block' },\r\n\t\t\t'&:nth-child(15)': { display: 'block' },\r\n\t\t\t'&:nth-child(25)': { display: 'block' }\r\n\t\t}\r\n\t}\r\n}));\r\n\r\n\r\n/*\r\n * ACTIONS\r\n *\r\n */\r\nconst Action = withStyles(styles)(props => {\r\n\tconst { classes, device, state, stateKey } = props;\r\n\treturn (\r\n\r\n<span className={clsx((stateKey === device.primaryStateKey && classes.primaryAction) || (stateKey === device.secondaryStateKey && classes.secondaryAction))}>\r\n\t{state.value} {state.unit}\r\n</span>\r\n\r\n\t);\r\n});\r\n\r\nfunction PowerAction(props) {\r\n\tconst { device, stateKey, stateVal, onChange: parentOnChange } = props;\r\n\t\r\n\tconst onChange = (e) => {\r\n\t\tsetChecked(e.target.checked);\r\n\t\tdevice.setDeviceState(stateKey, e.target.checked).catch(err => console.error(err));\r\n\t}\r\n\t\r\n\tconst [checked, setChecked] = useState(stateVal);\r\n\tuseEffect(() => setChecked(stateVal), [stateVal]);\r\n\t\r\n\treturn (\r\n\r\n<Switch\r\n\tchecked={checked}\r\n\tonChange={parentOnChange || onChange}\r\n\tvalue={checked !== true}\r\n\tcolor=\"primary\"\r\n\t/>\r\n\r\n\t);\r\n}\r\n\r\nfunction TriggerAction(props) {\r\n\tconst { device, stateKey, stateVal } = props;\r\n\t\r\n\tconst onClick = () => {\r\n\t\tdevice.setDeviceState(stateKey, true).catch(err => console.error(err));\r\n\t}\r\n\t\r\n\t//\r\n\tif (stateVal === true || stateVal > 0) {\r\n\t\treturn <Action {...props} onChange={null} />;\r\n\t}\r\n\t\r\n\tconst icon = 'power';\r\n\treturn (\r\n\r\n<Button\r\n\tvariant=\"outlined\"\r\n\tcolor=\"primary\"\r\n\tsize=\"small\"\r\n\tstartIcon={<span className={'mdi mdi-' + icon}></span>}\r\n\tonClick={onClick}\r\n\t>\r\n\t\r\n\t{i18n.t('turn on')}\r\n</Button>\r\n\r\n\t);\r\n}\r\n\r\n\r\n/*\r\n * COMPONENTS\r\n *\r\n */\r\nfunction Label(props) {\r\n\tconst { label, br } = props;\r\n\tconst linebreak = br || false;\r\n\t\r\n\treturn (\r\n\t\r\n<React.Fragment>\r\n\t{label}\r\n\t{linebreak && <br />}\r\n</React.Fragment>\r\n\t\r\n\t);\r\n}\r\n\r\nfunction Component(props) {\r\n\tconst { title, children } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\treturn (\r\n\r\n<React.Fragment>\r\n\t<Label label={title} />\r\n\t<div className={classes.component}>\r\n\t\t{children}\r\n\t\r\n\t</div>\r\n</React.Fragment>\r\n\r\n\t);\r\n}\r\n\r\nfunction LevelComponent(props) {\r\n\tlet { device, stateKey, stateVal, title, min, max, step, markSteps } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst onChange = (e, val) => {\r\n\t\tsetLevel(val);\r\n\t\tdevice.setDeviceState(stateKey, val).catch(err => console.error(err));\r\n\t}\r\n\t\r\n\tconst [level, setLevel] = useState(stateVal);\r\n\tuseEffect(() => setLevel(stateVal), [stateVal]);\r\n\t\r\n\t// default settings\r\n\tmin = min || 0;\r\n\tmax = max || 100;\r\n\tstep = step || 1;\r\n\tmarkSteps = markSteps || 11; // 0 to 10\r\n\tlet markStep = ((max-min)/(markSteps-1)) || 10;\r\n\treturn (\r\n\r\n<Component title={title || stateKey }>\r\n\t<Slider\r\n\t\tclasses={{ markLabel: classes.sliderMarkLabel }}\r\n\t\t//onChange\r\n\t\tonChangeCommitted={onChange}\r\n\t\tdefaultValue={level}\r\n\t\tvalueLabelDisplay=\"auto\"\r\n\t\tmarks={[...Array(markSteps).keys()].map(number => ({ 'value': min+number*markStep, 'label': min+number*markStep }))}\r\n\t\tmin={min}\r\n\t\tmax={max}\r\n\t\tstep={step}\r\n\t/>\r\n\r\n</Component>\r\n\r\n\t);\r\n}\r\n\r\n\r\n\r\nexport default {\r\n\tconfigurations: {\r\n\t\t_any: {\r\n\t\t\tvalue: (val) => val.toString(),\r\n\t\t\t//unit\r\n\t\t\t//icon\r\n\t\t\t//state\r\n\t\t},\r\n\t\tbattery: {\r\n\t\t\tunit: ' %',\r\n\t\t\ticon: 'battery-medium'\r\n\t\t},\r\n\t\tdoor: {\r\n\t\t\ticon: {\r\n\t\t\t\t'true': 'door-open',\r\n\t\t\t\t'false': 'door-closed'\r\n\t\t\t},\r\n\t\t\tstate: {\r\n\t\t\t\t'true': 'open',\r\n\t\t\t\t'false': 'closed'\r\n\t\t\t},\r\n\t\t},\r\n\t\thumidity: {\r\n\t\t\tunit: ' %',\r\n\t\t\ticon: 'water-percent'\r\n\t\t},\r\n\t\tlevel: {\r\n\t\t\tunit: ' %'\r\n\t\t},\r\n\t\tposition: {\r\n\t\t\ticon: 'map-marker'\r\n\t\t},\r\n\t\tpower: {\r\n\t\t\tstate: {\r\n\t\t\t\t'true': 'on',\r\n\t\t\t\t'false': 'off'\r\n\t\t\t},\r\n\t\t\ticon: 'power'\r\n\t\t},\r\n\t\ttemperature: {\r\n\t\t\tunit: ' C',\r\n\t\t\ticon: 'thermometer'\r\n\t\t},\r\n\t\ttrigger: {\r\n\t\t\tstate: {\r\n\t\t\t\t'true': 'on',\r\n\t\t\t\t'false': 'off'\r\n\t\t\t},\r\n\t\t\ticon: 'power'\r\n\t\t},\r\n\t\twind: {\r\n\t\t\tunit: ' km/h',\r\n\t\t\ticon: 'weather-windy'\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t\tLabel,\r\n\t\tComponent,\r\n\t\tLevelComponent,\r\n\t\t\r\n\t\tlevel: LevelComponent\r\n\t},\r\n\tactions: {\r\n\t\tAction,\r\n\t\tPowerAction,\r\n\t\tTriggerAction,\r\n\t\t\r\n\t\tpower: PowerAction,\r\n\t\ttrigger: TriggerAction\r\n\t},\r\n\tstyles: {\r\n\t\t_any: {\r\n\t\t\t//icon: {},\r\n\t\t\tstate: {\r\n\t\t\t\t'true': {\r\n\t\t\t\t\t'color': '#090',\r\n\t\t\t\t\t'fontWeight': 'bold'\r\n\t\t\t\t},\r\n\t\t\t\t'false': {\r\n\t\t\t\t\t'color': '#999'\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}","\r\nexport default {\r\n\tconfigurations: {\r\n\t\tposition: {\r\n\t\t\ticon: 'home'\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t},\r\n\tactions: {\r\n\t},\r\n\tstyles: {\r\n\t}\r\n}","\r\nexport default {\r\n\tconfigurations: {\r\n\t\tposition: {\r\n\t\t\ticon: 'account'\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t},\r\n\tactions: {\r\n\t},\r\n\tstyles: {\r\n\t}\r\n}","\r\nexport default {\r\n\tconfigurations: {\r\n\t\topen: {\r\n\t\t\ticon: {\r\n\t\t\t\t'true': 'window-open-variant',\r\n\t\t\t\t'false': 'window-closed-variant'\r\n\t\t\t},\r\n\t\t\tstate: {\r\n\t\t\t\t'true': 'open',\r\n\t\t\t\t'false': 'closed'\r\n\t\t\t},\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t},\r\n\tactions: {\r\n\t},\r\n\tstyles: {\r\n\t}\r\n}","import React from 'react'\r\n\r\nimport Grid from '@material-ui/core/Grid'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tgridContainer: {\r\n\t\tpaddingLeft: theme.spacing(1),\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tpaddingLeft: theme.spacing(0.4)\r\n\t\t}\r\n\t}\r\n}));\r\n\r\n\r\nexport default function GridContainer(props) {\r\n\tconst { contents = {} } = props;\r\n\t\r\n\tconst classes = useStyles();\r\n\tconst columns = Object.keys(contents).length;\r\n\t\r\n\tlet grid = [];\r\n\tfor (let column = 1; column <= columns; column++) {\r\n\t\t\r\n\t\tif (!contents[column]) {\r\n\t\t\tconsole.warn('No content for column #' + column + '!');\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\t\r\n\t\tgrid.push(\r\n\t\t\t<Grid key={column} item\t\t\t\t// @see https://material-ui.com/customization/breakpoints/\r\n\t\t\t\txs={12}\t\t\t\t\t\t\t//    0 -  600px\r\n\t\t\t\tsm={6}\t\t\t\t\t\t\t//  600 -  960px\r\n\t\t\t\tmd={6}\t\t\t\t\t\t\t//  960 - 1280px\r\n\t\t\t\tlg={Math.round(12/columns)}\t\t// 1280 - 1920px\r\n\t\t\t\txl={Math.round(12/columns)}\t\t// \t\t> 1920px\r\n\t\t\t\t>\r\n\t\t\t\t\r\n\t\t\t\t{contents[column]}\r\n\t\t\t</Grid>\r\n\t\t);\r\n\t}\r\n\t\r\n\treturn (\r\n\r\n<Grid container spacing={0} className={classes.gridContainer}>\r\n\t{grid}\r\n</Grid>\r\n\r\n\t);\r\n}\r\n","import React from 'react';\r\nimport clsx from 'clsx';\r\n\r\nimport Snackbar from '@material-ui/core/Snackbar';\r\nimport SnackbarContent from '@material-ui/core/SnackbarContent';\r\nimport IconButton from '@material-ui/core/IconButton';\r\n\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport CheckCircleIcon from '@material-ui/icons/CheckCircle';\r\nimport WarningIcon from '@material-ui/icons/Warning';\r\nimport ErrorIcon from '@material-ui/icons/Error';\r\nimport InfoIcon from '@material-ui/icons/Info';\r\n\r\n\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { amber, green } from '@material-ui/core/colors';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tsuccess: {\r\n\t\tbackgroundColor: green[600],\r\n\t},\r\n\terror: {\r\n\t\tbackgroundColor: theme.palette.error.dark,\r\n\t},\r\n\tinfo: {\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t},\r\n\twarning: {\r\n\t\tbackgroundColor: amber[700],\r\n\t},\r\n\ticon: {\r\n\t\tfontSize: 20,\r\n\t},\r\n\ticonVariant: {\r\n\t\topacity: 0.9,\r\n\t\tmarginRight: theme.spacing(1),\r\n\t},\r\n\tmessage: {\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center',\r\n\t},\r\n}));\r\n\r\n\r\nconst variantIcon = {\r\n\tsuccess: CheckCircleIcon,\r\n\twarning: WarningIcon,\r\n\terror: ErrorIcon,\r\n\tinfo: InfoIcon,\r\n};\r\n\r\n\r\nexport default function StatusSnackbar(props) {\r\n\tconst classes = useStyles();\r\n\tlet { className, open, autoHideDuration, message, closeButton, onClose, variant, ...other } = props;\r\n\tconst Icon = variantIcon[variant];\r\n\t\r\n\topen = open || true;\r\n\tautoHideDuration = autoHideDuration || null;\r\n\treturn (\r\n\r\n<Snackbar\r\n\tanchorOrigin={{\r\n\t\tvertical: 'bottom',\r\n\t\thorizontal: 'center',\r\n\t}}\r\n\topen={open}\r\n\tautoHideDuration={autoHideDuration}\r\n\tonClose={onClose}\r\n\t>\r\n\t<SnackbarContent\r\n\t\tclassName={clsx(classes[variant], className)}\r\n\t\tmessage={\r\n\t\t\t<span id=\"client-snackbar\" className={classes.message}>\r\n\t\t\t\t<Icon className={clsx(classes.icon, classes.iconVariant)} />\r\n\t\t\t\t{message}\r\n\t\t\t</span>\r\n\t\t}\r\n\t\taction={closeButton && [\r\n\t\t\t<IconButton key=\"close\" aria-label=\"close\" color=\"inherit\" onClick={onClose}>\r\n\t\t\t\t<CloseIcon className={classes.icon} />\r\n\t\t\t</IconButton>,\r\n\t\t]}\r\n\t\t{...other}\r\n\t\t/>\r\n\t\t\r\n</Snackbar>\r\n\r\n\t);\r\n}","\r\nexport default {\r\n\tdefaults: require('./defaults').default,\r\n\t\r\n\tblind: require('./blind').default,\r\n\tdoor: require('./door').default,\r\n\theating: require('./heating').default,\r\n\tjalousie: require('./blind').default,\r\n\tlight: require('./light').default,\r\n\tlocation: require('./location').default,\r\n\tuser: require('./user').default,\r\n\twindow: require('./window').default\r\n}","import EventEmitter from 'events'\r\nimport functions from './functions'\r\n\r\n\r\n/**\r\n * Function\r\n *\r\n * @param\t{String}\t\tfunctionType\r\n * @return\t{Function}\r\n *\r\n */\r\nexport default class Function extends EventEmitter {\r\n\t\r\n\tconstructor(functionType) {\r\n\t\tsuper();\r\n\t\t\r\n\t\tthis.function = functionType;\r\n\t\t\r\n\t\tif (!this.function) {\t\r\n\t\t\tthrow new Error('No function given!');\r\n\t\t}\r\n\t\t\r\n\t\tthis.functionId = this.function.toLowerCase();\r\n\t\t\r\n\t\t// configuration\r\n\t\tthis.defaults = functions['defaults'].configurations;\r\n\t\tthis.configurations = (functions[this.functionId] && functions[this.functionId].configurations) || {};\r\n\t\t\r\n\t\t// styles\r\n\t\tthis.defaultStyles = functions['defaults'].styles;\r\n\t\tthis.styles = (functions[this.functionId] && functions[this.functionId].styles) || {};\r\n\t\t\r\n\t\t// components and actions\r\n\t\tthis.components = { ...functions['defaults'].components, ...(functions[this.functionId] && functions[this.functionId].components) || {} };\r\n\t\tthis.actions = { ...functions['defaults'].actions, ...(functions[this.functionId] && functions[this.functionId].actions) || {} };\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Mixed}\r\n\t * @private\r\n\t */\r\n\t_applyFunction(key, val) {\r\n\t\treturn this._isFunction(key) ? key(val) : val;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{String}\r\n\t * @private\r\n\t */\r\n\t_getValueFromSettings(settings, defaults = '') {\r\n\t\t\r\n\t\tfor (let key in settings) {\r\n\t\t\tif (settings[key] !== undefined) {\r\n\t\t\t\treturn settings[key];\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn defaults;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Boolean}\r\n\t * @private\r\n\t */\r\n\t_isFunction(key) {\r\n\t\treturn key && typeof key === 'function';\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Boolean}\r\n\t * @private\r\n\t */\r\n\t_isValue(val) {\r\n\t\treturn val !== undefined; // || val === null || val === false; // null is considered a value, so it can be used to actually null the output\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Object}\r\n\t * @private\r\n\t */\r\n\t_setObjectStructure(obj, defaultValue = undefined) {\r\n\t\t\r\n\t\tif (!obj || typeof obj != 'object') {\r\n\t\t\tobj = { 'default': obj || defaultValue };\r\n\t\t}\r\n\t\telse if (typeof obj == 'object' && !obj.default) {\r\n\t\t\tobj.default = defaultValue;\r\n\t\t}\r\n\t\t\r\n\t\treturn obj;\r\n\t}\r\n}\r\n","export default {\r\n\t\"hm-rpc\": \"HomeMatic\",\r\n}","import React from 'react'\r\nimport i18n from './i18n'\r\nimport Function from './Function'\r\nimport Adapters from './Adapters'\r\n\r\nimport { formatDistanceToNow } from 'date-fns'\r\nimport { de } from 'date-fns/locale'\r\n\r\n\r\n/**\r\n * Device\r\n *\r\n * @param\t{Object}\tdeviceProperties\r\n * @param\t{String}\tdeviceProperties.id\r\n * @param\t{String}\tdeviceProperties.name\r\n * @param\t{String}\t[deviceProperties.room=null]\r\n * @param\t{String}\tdeviceProperties.function\r\n * @param\t{Object}\tdeviceProperties.states\r\n * @param\t{Object}\t[deviceProperties.attributes={}]\r\n * @param\t{Object}\tdeviceProperties.options\r\n * @param\t{Object}\tsocket\r\n * @return\t{Device}\r\n *\r\n */\r\nexport default class Device extends Function {\r\n\t\r\n\tconstructor(deviceProperties, socket, language = window.sysLang || 'en') {\r\n\t\ttry {\r\n\t\t\tsuper(deviceProperties.function);\r\n\t\t}\r\n\t\tcatch(err) {\r\n\t\t\tthrow new Error('No function given for device ' + deviceProperties.name + '!');\r\n\t\t}\r\n\t\t\r\n\t\t// initialise class data\r\n\t\tthis.id = deviceProperties.id;\r\n\t\tthis.name = deviceProperties.name;\r\n\t\t\r\n\t\tthis.room = deviceProperties.room || null;\r\n\t\t\r\n\t\tthis.states = deviceProperties.states;\r\n\t\tthis.options = deviceProperties.options;\r\n\t\tthis.attributes = deviceProperties.attributes || {};\r\n\t\t\r\n\t\tthis.socket = socket;\r\n\t\t\r\n\t\t// verify data\r\n\t\tif (!this.options || typeof this.options !== 'object' || Object.keys(this.options).length === 0) {\r\n\t\t\tthrow new Error('Device' + (deviceProperties.id || deviceProperties.name ? ' ' + (deviceProperties.name || deviceProperties.id) : '') + ' not defined for jarvis!');\r\n\t\t}\r\n\t\telse if (!this.states || typeof this.states !== 'object' || Object.keys(this.states).length === 0) {\r\n\t\t\tthrow new Error('Insufficent properties provided' + (deviceProperties.id || deviceProperties.name ? ' for device ' + (deviceProperties.name || deviceProperties.id) : '') + ' (no states defined)!');\r\n\t\t}\r\n\t\telse if (!this.id || !this.name || !this.function) {\r\n\t\t\tthrow new Error('Insufficent properties provided' + (deviceProperties.id || deviceProperties.name ? ' for device ' + (deviceProperties.name || deviceProperties.id) : '') + ' (no id, name or function defined)!');\r\n\t\t}\r\n\t\telse if (!this.socket) {\t\r\n\t\t\tthrow new Error('No socket given!');\r\n\t\t}\r\n\t\t\r\n\t\t// hierarchy\r\n\t\tthis.children = deviceProperties.children || [];\r\n\t\tthis.parent = deviceProperties.parent || null;\r\n\t\t\r\n\t\t// do some stuff\r\n\t\tthis._setProperties();\r\n\t\tthis.stateSubscriptions = [];\r\n\t\t\r\n\t\t// listen for errors of the device\r\n\t\tthis.on('error', err => console.error('Device error occured!', err));\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Object|String}\r\n\t * @private\r\n\t */\r\n\t_getStateFromKey(stateKey = null, stateType = 'state') {\r\n\t\t\r\n\t\t// already a state object\r\n\t\tif (stateKey && typeof stateKey === 'object') {\r\n\t\t\treturn stateKey;\r\n\t\t}\r\n\t\t\r\n\t\t// get state object\r\n\t\tlet s = this.states[stateKey || this.primaryStateKey];\r\n\t\t\r\n\t\t// state not an object so far\r\n\t\tif (typeof s === 'string') {\r\n\t\t\tthis.states[stateKey || this.primaryStateKey] = { [stateType]: { 'node': s }};\r\n\t\t\ts = this.states[stateKey || this.primaryStateKey];\r\n\t\t}\r\n\t\telse if (typeof s[stateType] === 'string') {\r\n\t\t\tthis.states[stateKey || this.primaryStateKey][stateType] = { 'node': s[stateType] };\r\n\t\t\ts = this.states[stateKey || this.primaryStateKey];\r\n\t\t}\r\n\t\t\r\n\t\t// state not valid\r\n\t\tif (!s || !s[stateType]) {\r\n\t\t\treturn 'Incorrect or non-defined state key for device ' + this.name + '!';\r\n\t\t}\r\n\t\telse if (typeof s[stateType] == 'object' && !s[stateType].node) {\r\n\t\t\treturn 'No ' + stateType + ' specified for device ' + this.name + '!';\r\n\t\t}\r\n\t\t\r\n\t\treturn s;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @private\r\n\t */\r\n\t_getConfigurationSetting(config, stateKey, attribute, stateVal) {\r\n\t\t\r\n\t\tif (this[config][stateKey]) {\r\n\t\t\t\r\n\t\t\t// 1. if stateKey (e.g. level, power) is available, try to replace an attribute (e.g. icon, unit or for styles state, icon) based on current state (e.g. true, false)\r\n\t\t\tif (typeof this[config][stateKey][attribute] === 'object') {\r\n\t\t\t\treturn super._isValue(this[config][stateKey][attribute][stateVal]) ? this[config][stateKey][attribute][stateVal] : this[config][stateKey][attribute]['default'];\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// 2. if #1 is a function, apply it\r\n\t\t\telse if (super._isFunction(this[config][stateKey][attribute])) {\r\n\t\t\t\treturn this[config][stateKey][attribute](stateVal);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// 3. fallback to stateKey with attribute, if defined but neither an object (thus stateless) nor a function\r\n\t\t\telse if (typeof this[config][stateKey][attribute] === 'string') {\r\n\t\t\t\treturn this[config][stateKey][attribute];\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (this[config]['_any']) {\r\n\t\t\t\r\n\t\t\t// 4. fallback to _any if no stateKey (e.g. level, power) is given, but consider attribute to be stateful (e.g. true, false)\r\n\t\t\tif (typeof this[config]['_any'][attribute] === 'object') {\r\n\t\t\t\treturn super._isValue(this[config]['_any'][attribute][stateVal]) ? this[config]['_any'][attribute][stateVal] : this[config]['_any'][attribute]['default'];\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// 5. if #4 is a function, apply it\r\n\t\t\telse if (super._isFunction(this[config]['_any'][attribute])) {\r\n\t\t\t\treturn this[config]['_any'][attribute](stateVal);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// nothing, return undefined (not null, because this would mean take an empty value)\r\n\t\treturn undefined;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @private\r\n\t */\r\n\t_getUserSetting(stateKey, attribute, stateVal) {\r\n\t\t\r\n\t\tif (this.options[attribute][stateKey]) {\r\n\t\t\t\r\n\t\t\tif (typeof this.options[attribute][stateKey] === 'object') {\r\n\t\t\t\treturn super._isValue(this.options[attribute][stateKey][stateVal]) ? this.options[attribute][stateKey][stateVal] : this.options[attribute][stateKey]['default'];\r\n\t\t\t}\r\n\t\t\telse if (super._isFunction(this.options[attribute][stateKey])) {\r\n\t\t\t\treturn this.options[attribute][stateKey](stateVal);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\treturn this.options[attribute][stateKey];\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn undefined;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t *\r\n\t * @return void\r\n\t * @private\r\n\t *\r\n\t */\r\n\t_setProperties() {\r\n\t\t\r\n\t\tlet states = Object.keys(this.states);\r\n\t\t\r\n\t\t// delete ignored states\r\n\t\tif (this.options.ignoredStates) {\r\n\t\t\tthis.options.ignoredStates = Array.isArray(this.options.ignoredStates) ? this.options.ignoredStates : [this.options.ignoredStates];\r\n\t\t\t\r\n\t\t\tthis.options.ignoredStates.forEach(ignoredState => {\r\n\t\t\t\tif (this.states[ignoredState]) {\r\n\t\t\t\t\tdelete this.states[ignoredState];\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\t// get hidden states\r\n\t\tthis.options.hiddenStates = [];\r\n\t\tif (this.options.hideStates) {\r\n\t\t\tthis.options.hideStates = Array.isArray(this.options.hideStates) ? this.options.hideStates : [this.options.hideStates];\r\n\t\t\t\r\n\t\t\tthis.options.hideStates.forEach(hideState => {\r\n\t\t\t\tif (this.states[hideState]) {\r\n\t\t\t\t\tthis.options.hiddenStates.push(hideState);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\t// properties\r\n\t\tthis.primaryStateKey = this.options.primary || states[0];\r\n\t\tthis.secondaryStateKey = this.options.secondary || null;\r\n\t\t\r\n\t\t// bring user settings for value, state, unit, icon and styles in structure\r\n\t\t['value', 'state', 'unit', 'icon', 'styles'].forEach(key => {\r\n\t\t\t\r\n\t\t\tlet stateOrAttribute = this.options[key] && Object.keys(this.options[key])[0];\r\n\t\t\tthis.options[key] = !this.options[key] ? {} : super._setObjectStructure(stateOrAttribute && states.indexOf(stateOrAttribute) > -1 ? this.options[key] : { [this.primaryStateKey]: this.options[key] });\r\n\t\t});\r\n\t\t\r\n\t\t// manufacturer\r\n\t\tthis.states[this.primaryStateKey] = this._getStateFromKey(this.primaryStateKey);\r\n\t\tthis.options.manufacturer = (this.primaryStateKey && Adapters[this.states[this.primaryStateKey].state.node.substr(0, this.states[this.primaryStateKey].state.node.indexOf('.'))]) || 'unknown';\r\n\t\t\r\n\t\t// all options\r\n\t\tthis.options.groups = Array.isArray(this.options.group) ? this.options.group : [this.options.group];\r\n\t\tthis.options.sort = this.options.sort || 999;\r\n\t\t\r\n\t\tthis.options.label = (this.options.label && (typeof this.options.label === 'string' && this.options.label.replace(/%name%/g, this.name))) || this.options.label || this.name;\r\n\t\t//this.options.subtitle = this.options.subtitle;\r\n\t\tthis.options.divider = this.options.divider || false;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t *\r\n\t * @return\t{Object}\r\n\t * @private\r\n\t */\r\n\t_updateDeviceState(stateKey, state) {\r\n\t\t\r\n\t\t// add time changed\r\n\t\tstate.timeChanged = formatDistanceToNow(new Date(state.lc-5*1000), { locale: de, includeSeconds: true, addSuffix: true })\r\n\t\t\r\n\t\t// add unit\r\n\t\tstate.unit = '';\r\n\t\t\r\n\t\t// assign value\r\n\t\tstate.value = state.val;\r\n\t\t\r\n\t\t// mapping of value to state values\r\n\t\t[{ 'value': 'value' }, { 'state': 'value' }, { 'unit': 'unit' }].forEach(pair => {\r\n\t\t\tlet attribute = Object.keys(pair).toString();\r\n\t\t\tlet option = Object.values(pair).toString();\r\n\t\t\tlet settings = {};\r\n\t\t\t\r\n\t\t\t// get user setting\r\n\t\t\tsettings['options'] = this._getUserSetting(stateKey, attribute, state.value);\r\n\t\t\t\r\n\t\t\t// get function setting or fallback to defaults\r\n\t\t\t['configurations', 'defaults'].forEach(config => {\r\n\t\t\t\tsettings[config] = this._getConfigurationSetting(config, stateKey, attribute, state.value);\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tstate[option] = super._getValueFromSettings(settings, state[option]);\r\n\t\t\t\r\n\t\t});\r\n\t\t\r\n\t\tstate.value = i18n.t(state.value);\r\n\t\treturn state;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tget(property) {\r\n\t\treturn this[property] || null;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @return\t{React.Component}\r\n\t */\r\n\tgetAction(stateKey = null, forceDefault = false) {\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\t\r\n\t\tconst state = this.states[stateKey].state.value;\r\n\t\tconst stateVal = state.val;\r\n\t\t\r\n\t\tconst Action = (!forceDefault && this.actions[stateKey]) || this.actions.Action;\r\n\t\treturn <Action key={'action-' + this.id + '-' + stateKey} device={this} state={state} stateKey={stateKey} stateVal={stateVal} styles={this.getStyle('state', stateKey, stateVal)} />\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @return\t{React.Component}\r\n\t */\r\n\tgetComponent(stateKey) {\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\tconst stateVal = this.states[stateKey].state.value.val;\r\n\t\t\r\n\t\tconst Component = this.components[stateKey];\r\n\t\treturn (Component && <Component title={i18n.t(this.function + '#' + stateKey)} device={this} stateKey={stateKey} stateVal={stateVal} />) || i18n.t(this.function + '#' + stateKey);\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @param\t{String}\t[stateProperty=null]\r\n\t * @return\t{String}\r\n\t */\r\n\tgetDeviceState(stateKey = null, stateProperty = null) {\r\n\t\tconst s = this.states[stateKey || this.primaryStateKey];\r\n\t\t\r\n\t\tlet deviceState = null;\r\n\t\t\r\n\t\tif (s && s.state && stateProperty !== null && s.state.value !== undefined && s.state.value[stateProperty] !== undefined) {\r\n\t\t\tdeviceState = s.state.value[stateProperty];\r\n\t\t}\r\n\t\telse if (s && s.state && stateProperty === null && s.state.value !== undefined) {\r\n\t\t\tdeviceState = s.state.value;\r\n\t\t}\r\n\t\t\r\n\t\treturn deviceState;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get an icon based on the current device state (or falls back to a default).\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @param\t{String}\t[stateVal=default]\r\n\t * @param\t{String}\t[defaultIcon=null]\r\n\t * @return\t{String}\r\n\t */\r\n\tgetIcon(stateKey, stateVal = '', defaultIcon = '?') {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\t\r\n\t\tlet settings = {};\r\n\t\t\r\n\t\t// get user setting\r\n\t\tsettings['options'] = this._getUserSetting(stateKey, 'icon', stateVal);\r\n\t\t\r\n\t\t// get function setting or fallback to defaults\r\n\t\t['configurations', 'defaults'].forEach(config => {\r\n\t\t\tsettings[config] = this._getConfigurationSetting(config, stateKey, 'icon', stateVal);\r\n\t\t});\r\n\t\t\r\n\t\treturn super._getValueFromSettings(settings, defaultIcon);\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tgetOption(option, stateVal = 'default') {\r\n\t\treturn (this.options[option] && (this.options[option][stateVal] || this.options[option]['default'])) || this.options[option] || null;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tgetStyle(attribute, stateKey, stateVal = 'default') {\r\n\t\tlet settings = {};\r\n\t\t\r\n\t\t// get user setting\r\n\t\tsettings['options'] = this._getUserSetting(stateKey, 'styles', attribute, stateVal);\r\n\t\t\r\n\t\t// get function setting or fallback to defaults\r\n\t\t['styles', 'defaultStyles'].forEach(config => {\r\n\t\t\tsettings[config] = this._getConfigurationSetting(config, stateKey, attribute, stateVal);\r\n\t\t});\r\n\t\t\r\n\t\treturn super._getValueFromSettings(settings, {});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Requests all state values from the backend.\r\n\t *\r\n\t * @param\t{Boolean}\t[subscribe=false]\r\n\t * @return\t{Array<Promises>}\r\n\t *\r\n\t */\r\n\trequestDeviceStates(subscribe = false) {\r\n\t\t\r\n\t\tlet responses = [];\r\n\t\tfor (let stateKey in this.states) {\r\n\t\t\tresponses.push(this.requestDeviceState(stateKey, subscribe));\r\n\t\t}\r\n\t\t\r\n\t\treturn responses;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Requests a state value from the backend.\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @param\t{Boolean}\t[subscribe=false]\r\n\t * @return\t{Promise}\r\n\t *\r\n\t */\r\n\trequestDeviceState(stateKey = null, subscribe = false) {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\tlet s = this._getStateFromKey(stateKey);\r\n\t\tif (typeof s == 'string') {\r\n\t\t\treturn Promise.reject({ 'success': false, 'stateKey': stateKey, 'error': s });\r\n\t\t}\r\n\t\t\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\r\n\t\t\t// send cached value if present and subscrbe (means always updated)\r\n\t\t\tif (s.state.value !== undefined && this.stateSubscriptions.indexOf(stateKey) > -1) {\r\n\t\t\t\t\r\n\t\t\t\t// publish state\r\n\t\t\t\tthis.emit('stateChange', stateKey, s.state.value);\r\n\t\t\t\t\r\n\t\t\t\t// resolve\r\n\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey, 'cached': true });\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// request from backend\r\n\t\t\telse {\r\n\t\t\t\tthis.socket.getState(s.state.node)\r\n\t\t\t\t\t.then(state => {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// state does not exist\r\n\t\t\t\t\t\tif (state === null) {\r\n\t\t\t\t\t\t\treject({ 'success': false, 'stateKey': stateKey, 'error': 'State ' + s.state.node + ' not found!' });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// set result\r\n\t\t\t\t\t\ts.state.value = this._updateDeviceState(stateKey, state);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// publish state change\r\n\t\t\t\t\t\tthis.emit('stateChange', stateKey, s.state.value);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// subscribe to state\r\n\t\t\t\t\t\tif (subscribe) {\r\n\t\t\t\t\t\t\tthis.subscribeDeviceState(stateKey).catch(err => reject(err));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// resolve\r\n\t\t\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey, 'cached': false });\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(err => reject({ 'success': false, 'stateKey': stateKey, 'error': err }));\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Requests a state value from the backend.\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @param\t{Boolean}\t[subscribe=false]\r\n\t * @param\t{Object}\t[options={}]\r\n\t * @return\t{Promise}\r\n\t * @see https://github.com/ioBroker/ioBroker.history#access-values-from-javascript-adapter\r\n\t *\r\n\t */\r\n\trequestDeviceStateHistory(stateKey = null, subscribe = false, options = {}) {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\tlet s = this._getStateFromKey(stateKey);\r\n\t\tif (typeof s == 'string') {\r\n\t\t\treturn Promise.reject({ 'success': false, 'stateKey': stateKey, 'error': s });\r\n\t\t}\r\n\t\t\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\ts.state.historyCache = s.state.historyCache || {};\r\n\t\t\t\r\n\t\t\t// send cached value if present and subscrbe (means always updated)\r\n\t\t\tif (options.start && options.end && options.step && s.state.historyCache[options.start + '#' + options.end + '#' + options.step] !== undefined) {\r\n\t\t\t\t\r\n\t\t\t\t// publish state\r\n\t\t\t\tthis.emit('historyChange', stateKey, s.state.historyCache[options.start + '#' + options.end + '#' + options.step], s.state);\r\n\t\t\t\t\r\n\t\t\t\t// resolve\r\n\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey, 'cached': true });\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// request from backend\r\n\t\t\telse {\r\n\t\t\t\tthis.socket.getStateHistory(s.state.node, options)\r\n\t\t\t\t\t.then(history => {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// state does not exist\r\n\t\t\t\t\t\tif (history === null) {\r\n\t\t\t\t\t\t\treject({ 'success': false, 'stateKey': stateKey, 'error': 'State ' + s.state.node + ' not found!' });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// cache result\r\n\t\t\t\t\t\tif (options.start && options.end && options.step) {\r\n\t\t\t\t\t\t\ts.state.historyCache[options.start + '#' + options.end + '#' + options.step] = history;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// set result\r\n\t\t\t\t\t\ts.state.history = history;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// publish state change\r\n\t\t\t\t\t\tthis.emit('historyChange', stateKey, s.state.history, s.state);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// subscribe to state\r\n\t\t\t\t\t\tif (subscribe) {\r\n\t\t\t\t\t\t\tthis.subscribeDeviceState(stateKey).catch(err => reject(err));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// resolve\r\n\t\t\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey, 'cached': false });\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(err => reject({ 'success': false, 'stateKey': stateKey, 'error': err }));\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tsetAction(action) {\r\n\t\tthis.options.action = action;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tsetComponent(component) {\r\n\t\tthis.options.label = component;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @param\t{String}\tvalue\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @return\tvoid\r\n\t */\r\n\tsetDeviceState(stateKey = null, value) {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\tlet s = this._getStateFromKey(stateKey, 'action');\r\n\t\tif (typeof s == 'string') {\r\n\t\t\treturn Promise.reject({ 'success': false, 'stateKey': stateKey, 'error': s });\r\n\t\t}\r\n\t\t\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tthis.socket.setState(s.action.node, value)\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\r\n\t\t\t\t\t// get state value if not subscribed\r\n\t\t\t\t\tif (this.stateSubscriptions.indexOf(stateKey) === -1) {\r\n\t\t\t\t\t\tthis.requestDeviceState(stateKey);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t// resolve\r\n\t\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey });\r\n\t\t\t\t})\r\n\t\t\t\t.catch(err => reject({ 'success': false, 'stateKey': stateKey, 'error': err }));\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @return\tvoid\r\n\t */\r\n\tsubscribeDeviceState(stateKey = null) {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\tlet s = this._getStateFromKey(stateKey);\r\n\t\tif (typeof s == 'string') {\r\n\t\t\treturn Promise.reject({ 'success': false, 'stateKey': stateKey, 'error': s });\r\n\t\t}\r\n\t\t\r\n\t\t// add subscription\t\r\n\t\tthis.stateSubscriptions.push(stateKey);\r\n\t\t\r\n\t\t// subscribe\r\n\t\treturn new Promise(resolve => {\r\n\t\t\tthis.socket.subscribeState(s.state.node, (id, state, params) => {\r\n\t\t\t\t\r\n\t\t\t\tif (state && state.val !== this.getDeviceState(stateKey, 'val')) {\r\n\t\t\t\t\t\r\n\t\t\t\t\t// format value\r\n\t\t\t\t\ts.state.value = this._updateDeviceState(stateKey, state);\r\n\t\t\t\t\t\r\n\t\t\t\t\t// publish state change\r\n\t\t\t\t\tthis.emit('stateChange', stateKey, s.state.value);\r\n\t\t\t\t\t\r\n\t\t\t\t\t// publish to children as well\r\n\t\t\t\t\tthis.children.forEach(child => child.emit('stateChange', stateKey, s.state.value));\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tresolve({ 'success': true, 'stateKey': stateKey });\r\n\t\t});\r\n\t}\r\n}\r\n","import React from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport AppBar from '@material-ui/core/AppBar'\r\nimport Toolbar from '@material-ui/core/Toolbar'\r\nimport Typography from '@material-ui/core/Typography'\r\n//import IconButton from '@material-ui/core/IconButton'\r\n//import Badge from '@material-ui/core/Badge'\r\n//import NotificationsIcon from '@material-ui/icons/Notifications'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tappBar: {\r\n\t\tflexGrow: 1,\r\n\t\tboxShadow: 'none',\r\n\t\ttransform: 'none',\r\n\t},\r\n\ttoolbar: {\r\n\t\tbackgroundColor: theme.palette.primary.main\r\n\t},\r\n\tmenuButton: {\r\n\t\tmarginRight: theme.spacing(2),\r\n\t},\r\n\ttitle: {\r\n\t\tflexGrow: 1,\r\n\t},\r\n\ticon: {\r\n\t\t...theme.components.icon,\r\n\t\tcolor: '#fff',\r\n\t\tpaddingRight: '6px',\r\n\t\twidth: '1em',\r\n\t\theight: '1em',\r\n\t\tdisplay: 'inline-block',\r\n\t\tfontSize: '1.5rem',\r\n\t\ttransition: 'fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\r\n\t\tflexShrink: 0,\r\n\t\tuserSelect: 'none'\r\n\t}\r\n}));\r\n\r\n\r\nexport default function TopBar(props) {\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst { children, title } = props;\r\n\tconst [ icon, label ] = title.indexOf('|') > -1 ? title.split('|') : [ null, title ];\r\n\treturn (\r\n\r\n<AppBar id=\"appBar\" position=\"static\" className={classes.appBar}>\r\n\r\n\t<Toolbar className={classes.toolbar}>\r\n\t\t<Typography variant=\"h6\" className={classes.title}>\r\n\t\t\t{icon && <span className={clsx(classes.icon, 'mdi mdi-' + icon)}></span>}\r\n\t\t\t{label !== 'null' && label}\r\n\t\t</Typography>\r\n\t\t{/*\r\n\t\t<IconButton color=\"inherit\">\r\n\t\t\t<Badge badgeContent={17} color=\"secondary\">\r\n\t\t\t\t<NotificationsIcon />\r\n\t\t\t</Badge>\r\n\t\t</IconButton>\r\n\t\t*/}\r\n\t</Toolbar>\r\n\t\r\n\t{children}\r\n</AppBar>\r\n\r\n\t);\r\n}\r\n","/*\r\n * by QoP <https://stackoverflow.com/users/4484822/qop>\r\n * @see https://stackoverflow.com/questions/36862334/get-viewport-window-height-in-reactjs\r\n */\r\nimport { useState, useEffect } from 'react';\r\n\r\nfunction getWindowDimensions() {\r\n  const { innerWidth: width, innerHeight: height } = window;\r\n  return {\r\n    width,\r\n    height\r\n  };\r\n}\r\n\r\nexport default function useWindowDimensions() {\r\n  const [windowDimensions, setWindowDimensions] = useState(getWindowDimensions());\r\n\r\n  useEffect(() => {\r\n    function handleResize() {\r\n      setWindowDimensions(getWindowDimensions());\r\n    }\r\n\r\n    window.addEventListener('resize', handleResize);\r\n    return () => window.removeEventListener('resize', handleResize);\r\n  }, []);\r\n\r\n  return windowDimensions;\r\n}\r\n","import React, { useState, useEffect, useRef, useCallback } from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport useWindowDimensions from '../helpers/useWindowDimensions'\r\n\r\nimport Tabs from '@material-ui/core/Tabs'\r\nimport Tab from '@material-ui/core/Tab'\r\nimport Box from '@material-ui/core/Box'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\ticon: {\r\n\t\t...theme.components.icon,\r\n\t\tcolor: '#fff',\r\n\t\tpaddingBottom: '6px',\r\n\t\twidth: '1em',\r\n\t\theight: '1em',\r\n\t\tdisplay: 'inline-block',\r\n\t\tfontSize: '1.5rem',\r\n\t\ttransition: 'fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\r\n\t\tflexShrink: 0,\r\n\t\tuserSelect: 'none'\r\n\t},\r\n\ttabs: {\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t\tpaddingLeft: theme.spacing(),\r\n\t\tcolor: '#fff',\r\n\t\twidth: 'calc(100% - ' + theme.spacing() + 'px)',\r\n\t\tzIndex: 101,\r\n\t\tborderBottom: '5px solid #eee'\r\n\t},\r\n\tfixed: {\r\n\t\tposition: 'fixed',\r\n\t\ttop: 0\r\n\t},\r\n\tindicator: {\r\n\t\tbackgroundColor: '#fff',\r\n\t},\r\n\tfullscreen: {\r\n\t\tmarginLeft: -theme.spacing(),\r\n\t\tmarginTop: '-5px',\r\n\t},\r\n\tgrid: {\r\n\t\tpaddingBottom: '30px'\r\n\t}\r\n}));\r\n\r\n\r\nexport default function TabBar(props) {\r\n\tlet { tabs, selectTab } = props;\r\n\tconst classes = useStyles();\r\n\tlet tabBarProps = useRef({});\r\n\t\r\n\t// tab\r\n\tconst [tab, setTab] = useState(0);\r\n\tconst handleChange = (event, selectedTab) => {\r\n\t\tselectTab(selectedTab, tabs[selectedTab]);\r\n\t\tsetTab(selectedTab);\r\n\t}\r\n\t\r\n\t// scroll\r\n\tconst [fixed, setFixed] = useState(false);\r\n\tconst handleScroll = useCallback(() => {\r\n\t\tconst threshold = (tabBarProps.current.top + tabBarProps.current.height - 53);\r\n\t\tconst fixed = window.scrollY >= threshold;\r\n\t\t\r\n\t\tsetFixed(prevFixed => {\r\n\t\t\tif (prevFixed !== fixed) {\r\n\t\t\t\tdocument.getElementById('root').style.paddingTop = fixed ? (threshold-5-8) + 'px' : 0;\r\n\t\t\t\treturn fixed;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn prevFixed;\r\n\t\t});\r\n\t\t\r\n\t}, [tabBarProps]);\r\n\r\n\tuseEffect(() => {\r\n\t\ttabBarProps.current = {\r\n\t\t\ttop: document.getElementById('tabBar').offsetTop,\r\n\t\t\theight: document.getElementById('tabBar').offsetHeight\r\n\t\t}\r\n\t\t\r\n\t\twindow.addEventListener('scroll', handleScroll);\r\n\t\treturn () => window.removeEventListener('keydown', handleScroll, 0);\r\n\t\t\r\n\t}, [handleScroll]);\r\n\t\r\n\t// render tabs\r\n\tconst renderedTabs = tabs.map((tab, i) => {\r\n\t\tconst [ icon, label ] = tab.indexOf('|') > -1 ? tab.split('|') : [ null, tab ];\r\n\t\treturn <Tab key={'tab' + i} icon={<span className={clsx(classes.icon, 'mdi mdi-' + icon)}></span>} label={!fixed && label !== 'null' ? label : null} />\r\n\t});\r\n\t\r\n\treturn (\r\n\r\n<Tabs\r\n\tid=\"tabBar\"\r\n\tvalue={tab}\r\n\tonChange={handleChange}\r\n\tvariant=\"scrollable\"\r\n\tclasses={{\r\n\t\troot: clsx(classes.tabs, fixed && classes.fixed),\r\n\t\tindicator: classes.indicator\r\n\t}}>\r\n\t\r\n\t{renderedTabs}\r\n</Tabs>\r\n\r\n\t);\r\n}\r\n\r\n\r\nexport function TabPanel(props) {\r\n\tconst { children, selectedTab, renderedTab, fullscreen } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\t\r\n\t// get map height based on viewport\r\n\tconst { height } = useWindowDimensions();\r\n\tconst [mapHeight, setMapHeight] = useState(height);\r\n\tlet topBarHeight = useRef({});\r\n\t\r\n\tuseEffect(() => {\r\n\t\ttopBarHeight.current = document.getElementById('appBar').offsetHeight;\r\n\t\tsetMapHeight(height-topBarHeight.current+5);\r\n\t\t\r\n\t}, [height]);\r\n\t\r\n\t/*\r\n\t * Some components need to be visible upon loading, so proper initialise.\r\n\t * Due to the 'hidden' attribute though, they might be hidden.\r\n\t * This is a workaround to initially show everything for a short period of time and then hide according to tab settings.\r\n\t *\r\n\t */\r\n\tconst [hidden, setHidden] = useState(null);\r\n\tuseEffect(() => {\r\n\t\tsetTimeout(() => setHidden(selectedTab !== renderedTab), 10);\r\n\t\t\r\n\t}, [selectedTab, renderedTab]);\r\n\t\r\n\treturn (\r\n\r\n<Box\r\n\trole=\"tabpanel\"\r\n\thidden={hidden}\r\n\tid={'tabpanel-' + renderedTab}\r\n\tclassName={clsx(fullscreen ? classes.fullscreen : classes.grid)}\r\n\tstyle={{ height: mapHeight + 'px' }}\r\n\t>\r\n\t\r\n\t{children}\r\n</Box>\r\n\r\n\t);\r\n}\r\n","\r\nexport const ModuleSettings = {\r\n\tAdapterStatus: require('./AdapterStatus').Settings || {},\r\n\tChart: require('./Chart').Settings || {},\r\n\tDateTime: require('./DateTime').Settings || {},\r\n\tMap: require('./Map').Settings || {},\r\n\tMultimedia: require('./Multimedia').Settings || {},\r\n\tStateList: require('./StateList').Settings || {},\r\n\tStateListHorizontal: require('./StateListHorizontal').Settings || {},\r\n\tWeather: require('./Weather').Settings || {}\r\n}\r\n\r\nexport default {\r\n\tAdapterStatus: require('./AdapterStatus').default,\r\n\tChart: require('./Chart').default,\r\n\tDateTime: require('./DateTime').default,\r\n\tMap: require('./Map').default,\r\n\tMultimedia: require('./Multimedia').default,\r\n\tStateList: require('./StateList').default,\r\n\tStateListHorizontal: require('./StateListHorizontal').default,\r\n\tWeather: require('./Weather').default\r\n}","import React from 'react';\r\nimport Connection from '../Connection';\r\nimport Device from '../Device';\r\n\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport MuiDialogTitle from '@material-ui/core/DialogTitle';\r\nimport MuiDialogContent from '@material-ui/core/DialogContent';\r\nimport MuiDialogActions from '@material-ui/core/DialogActions';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\nimport Modules from '../modules';\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\troot: {\r\n\t\tmargin: 0,\r\n\t\tpadding: theme.spacing(2),\r\n\t},\r\n\tcloseButton: {\r\n\t\tposition: 'absolute',\r\n\t\tright: theme.spacing(1),\r\n\t\ttop: theme.spacing(1),\r\n\t\tcolor: theme.palette.grey[500],\r\n\t},\r\n});\r\n\r\n\r\nconst DialogTitle = withStyles(styles)(props => {\r\n\tconst { children, classes, onClose, ...other } = props;\r\n\treturn (\r\n\r\n<MuiDialogTitle disableTypography className={classes.root} {...other}>\r\n\t<Typography variant=\"h6\">{children}</Typography>\r\n\t{onClose ? (\r\n\t<IconButton aria-label=\"close\" className={classes.closeButton} onClick={onClose}>\r\n\t\t<CloseIcon />\r\n\t</IconButton>\r\n\t) : null}\r\n</MuiDialogTitle>\r\n\r\n\t);\r\n});\r\n\r\nconst DialogContent = withStyles(theme => ({\r\n\troot: {\r\n\t\tpadding: theme.spacing(2),\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tpaddingLeft: theme.spacing(1)\r\n\t\t}\r\n\t},\r\n}))(MuiDialogContent);\r\n\r\nconst DialogActions = withStyles(theme => ({\r\n\troot: {\r\n\t\tmargin: 0,\r\n\t\tpadding: theme.spacing(1),\r\n\t},\r\n}))(MuiDialogActions);\r\n\r\n\r\nexport default class Popup extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {\r\n\t\t\tchildren: []\r\n\t\t};\r\n\t}\r\n\t\r\n\tcomponentDidUpdate(prevProps, prevState) {\r\n\t\t\r\n\t\tlet device = this.props.contents && this.props.contents.device;\r\n\t\tif (device.id && this.props.contents.ts !== prevProps.contents.ts) {\r\n\t\t\t\r\n\t\t\t// get from cache\r\n\t\t\tif (device.children.length) {\r\n\t\t\t\tconsole.info('Got ' + Object.keys(device.children).length + ' states for device ' + device.name + ' from cache.');\r\n\t\t\t\tthis.setState({ 'children': device.children }, () => this.forceUpdate());\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// retrieve new\r\n\t\t\telse {\r\n\t\t\t\t// loop through states and request status\r\n\t\t\t\tlet responses = [];\r\n\t\t\t\tlet children = [];\r\n\t\t\t\t\r\n\t\t\t\tfor (let stateKey in device.states) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (device.states[stateKey].state === undefined || device.options.hiddenStates.indexOf(stateKey) > -1) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet child = new Device({\r\n\t\t\t\t\t\t\t'parent': device,\r\n\t\t\t\t\t\t\t'id': device.id + '#' + stateKey,\r\n\t\t\t\t\t\t\t'name': device.name,\r\n\t\t\t\t\t\t\t'function': device.function,\r\n\t\t\t\t\t\t\t'states': { [stateKey]: device.states[stateKey] },\r\n\t\t\t\t\t\t\t'options': {\r\n\t\t\t\t\t\t\t\t'primary': stateKey,\r\n\t\t\t\t\t\t\t\t'divider': children.length !== 0,\r\n\t\t\t\t\t\t\t\t'subgroup': null,\r\n\t\t\t\t\t\t\t\t'subtitle': null\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tConnection.getConnection,\r\n\t\t\t\t\t\twindow.language\r\n\t\t\t\t\t);\r\n\t\t\t\t\t\r\n\t\t\t\t\t// add child to parent\r\n\t\t\t\t\tdevice.children.push(child);\r\n\t\t\t\t\t\r\n\t\t\t\t\t// retrieve state\r\n\t\t\t\t\tresponses.push(child.requestDeviceState(null, true));\r\n\t\t\t\t\tchildren.push(child);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tPromise.allSettled(responses).then(() => {\r\n\t\t\t\t\tconsole.info('Retrieved ' + Object.keys(children).length + ' states for device ' + device.name + '.', responses);\r\n\t\t\t\t\tthis.setState({ 'children': children }, () => this.forceUpdate());\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (!device.id && this.props.contents.ts !== prevProps.contents.ts) {\r\n\t\t\tthis.setState({ 'children': [] }, () => this.forceUpdate());\r\n\t\t}\r\n\t}\r\n\t\r\n\tshouldComponentUpdate(nextProps, nextState) {\r\n\t\treturn !this.props.contents || this.props.contents.ts !== nextProps.contents.ts;\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { open, closeDialog, contents } = this.props;\r\n\t\tconst { device } = contents;\r\n\t\t\r\n\t\treturn (\r\n\r\n<Dialog onClose={closeDialog} open={open || false} maxWidth={'md'} fullWidth={true}>\r\n\t<DialogTitle onClose={closeDialog}>\r\n\t\t{device.name}\r\n\t</DialogTitle>\r\n\t<DialogContent dividers style={{ padding: 0 }}>\r\n\t\t\r\n\t\t<Modules.StateList openDialog={null} devices={this.state.children} component={true} action={true} />\t\r\n\t\t\r\n\t</DialogContent>\r\n\t<DialogActions>\r\n\t\t<Button autoFocus onClick={closeDialog} color=\"primary\">\r\n\t\t\tClose\r\n\t\t</Button>\r\n\t</DialogActions>\r\n</Dialog>\r\n\r\n\t\t);\r\n\t};\r\n}\r\n","import React from 'react'\r\n\r\nimport Card from '@material-ui/core/Card'\r\nimport CardHeader from '@material-ui/core/CardHeader'\r\nimport CardContent from '@material-ui/core/CardContent'\r\nimport Avatar from '@material-ui/core/Avatar'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tcard: {\r\n\t\tmargin: theme.spacing(1, 1, 0, 0),\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tmargin: theme.spacing(0.4, 0.4, 0, 0)\r\n\t\t}\r\n\t},\r\n\tcardHeaderNoContents: {\r\n\t\tpadding: theme.spacing(),\r\n\t},\r\n\tcardAvatar: props => ({\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t\tcolor: '#fff',\r\n\t\tfontSize: '24px',\r\n\t\t...props\r\n\t}),\r\n\tcardContent: {\r\n\t\tpadding: theme.spacing(0, 2),\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tpadding: theme.spacing(0)\r\n\t\t}\r\n\t}\r\n}));\r\n\r\n\r\nexport default function Widget(props) {\r\n\tconst { title, icon, iconStyle } = props;\r\n\tconst classes = useStyles(iconStyle);\r\n\t\r\n\treturn (\r\n\r\n<Card className={classes.card}>\r\n\t<CardHeader\r\n\t\tavatar={icon !== null &&\r\n\t\t\t<Avatar variant=\"rounded\" classes={{ root: classes.cardAvatar }}>\r\n\t\t\t\t{React.createElement('span', { 'className': 'mdi mdi-' + (icon || 'home') })}\r\n\t\t\t</Avatar>\r\n\t\t}\r\n\t\ttitle={title &&\r\n\t\t\t<Typography variant=\"h5\" component=\"h2\">\r\n\t\t\t\t{title}\r\n\t\t\t</Typography>\r\n\t\t}\r\n\t/>\r\n\t<CardContent className={classes.cardContent}>\r\n\t\t{props.children}\r\n\t</CardContent>\r\n</Card>\r\n\r\n\t);\r\n}\r\n","import { createMuiTheme } from '@material-ui/core/styles'\r\nimport { pink } from '@material-ui/core/colors'\r\nimport blue from '@material-ui/core/colors/blue'\r\n\r\nconst primary = blue[700]\r\nconst secondary = pink\r\n\r\nconst theme = createMuiTheme({\r\n\tpalette: {\r\n\t\tprimary: {\r\n\t\t\tmain: primary \r\n\t\t},\r\n\t\tsecondary: secondary,\r\n\t},\r\n\tcomponents: {\r\n\t\ticon: {\r\n\t\t\tfontSize: '24px',\r\n\t\t\tcolor: primary\r\n\t\t},\r\n\t\t'finger': {\r\n\t\t\tcursor: 'pointer'\r\n\t\t}\r\n\t}\r\n});\r\n\r\n//console.debug(theme);\r\nexport default theme;","import React from 'react'\n\n//import Drawer from '@material-ui/core/Drawer'\n\nimport TopBar from './components/TopBar'\nimport TabBar, { TabPanel } from './components/TabBar'\nimport GridContainer from './components/GridContainer'\nimport Popup from './components/Popup'\nimport Widget from './components/Widget'\nimport Modules, { ModuleSettings } from './modules'\n\n\n/*\n * STYLES\n */\nimport { ThemeProvider } from '@material-ui/core/styles';\nimport theme from './theme';\n\n\n/*\n *\n */\nconst getGroup = (groupId, group, props = {}) => {\n\t\n\t// group empty\n\tif (!group && ModuleSettings[group.settings.component.module].noDevicesAllowed !== true) {\n\t\tconsole.error('Group ' + groupId + ' defined in columns but not assigned to any devices!');\n\t\treturn null;\n\t}\n\t\n\t// get module for component\n\tgroup.settings.component = typeof group.settings.component === 'string' ? { 'module': group.settings.component } : (group.settings.component || {});\n\tconst Tag = Modules[group.settings.component.module || 'StateList'];\n\t\n\t// get tag\n\tif (Tag === undefined) {\n\t\tconsole.error('Undefined component \"' + group.settings.component.module + '\" used!');\n\t\treturn null;\n\t}\n\t\n\treturn <Tag key={'Tag' + groupId} devices={group.devices} openDialog={props.action ? props.action : null} settings={{ ...group.settings, ...props }} />\n}\n\n\n/*\n *\n */\nconst getGridContents = (contents, groups, props = {}) => {\n\t\n\tlet gridContents = {};\n\tconst columns = Object.keys(contents).length;\n\t\n\tfor (let column = 1; column <= columns; column++) {\n\t\t\n\t\tlet columnContents = contents[column];\n\t\tgridContents[column] = gridContents[column] || [];\n\t\t\n\t\t// no contents, thus add placeholder\n\t\tif (!columnContents || !Object.keys(columnContents).length) {\n\t\t\tgridContents[column].push(null);\n\t\t}\n\t\t\n\t\t// add contents\n\t\telse {\n\t\t\tfor (let groupId in columnContents) {\n\t\t\t\t\n\t\t\t\tlet group = groups[groupId] || {};\n\t\t\t\tgroup.settings = columnContents[groupId] || {};\n\t\t\t\tgroup.settings.component = typeof group.settings.component === 'string' ? { 'module': group.settings.component } : (group.settings.component || {});\n\t\t\t\t\n\t\t\t\tlet content = getGroup(groupId, group, props);\n\t\t\t\tif (content) {\n\t\t\t\t\tgridContents[column].push(\n\t\t\t\t\t\t<Widget key={'Box-' + groupId} title={group.settings.title === null ? null : (group.settings.title || group.name || (ModuleSettings[group.settings.component.module] && ModuleSettings[group.settings.component.module].title))} icon={group.settings.icon === null ? null : (group.settings.icon || (ModuleSettings[group.settings.component.module] && ModuleSettings[group.settings.component.module].icon))} iconStyle={group.settings.iconStyle}>\n\t\t\t\t\t\t\t{content}\n\t\t\t\t\t\t</Widget>\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\treturn gridContents;\n}\n\n\nexport default class Jarvis extends React.Component {\n\t\n    constructor(props) {\n\t\tsuper(props);\n\t\t\n\t\tthis.state = {\n\t\t\tselectedTab: 0,\n\t\t\ttabTitle: '',\n\t\t\t\n\t\t\tnotificationDrawer: false,\n\t\t\tdialog: false,\n\t\t\tdialogContents: {\n\t\t\t\t'ts': 0,\n\t\t\t\t'device': {}\n\t\t\t}\n\t\t}\n\t\t\n\t\t// bind methods\n\t\tthis.closeDialog = this.closeDialog.bind(this);\n\t\tthis.openDialog = this.openDialog.bind(this);\n\t\tthis.selectTab = this.selectTab.bind(this);\n\t\t//this.toggleDrawer = this.toggleDrawer.bind(this);\n\t\t\n\t\t// initialise\n\t\tthis.gridContents = {};\n\t\tthis.layout = this.props.settings.layout;\n\t\tthis.tabs = Object.keys(this.layout);\n\t\tthis.tabsEnabled = this.tabs[0] !== 1;\n\t\tthis.state.tabTitle = this.tabs[this.state.selectedTab];\n\t\t\n\t\t// no tabs defined, so layout wrap into default tab\n\t\tif (!this.tabsEnabled) {\n\t\t\tthis.layout = { 'Home': this.layout };\n\t\t\tthis.tabs.push('1');\n\t\t}\n\t\t\n\t\t// widget props\n\t\tthis.widgetProps = {}\n\t}\n\t\n\tgetTabPanels() {\n\t\t\n\t\tlet tab = 0;\n\t\tlet tabPanels = [];\n\t\tfor (let tabLabel in this.layout) {\n\t\t\tconst contents = this.layout[tabLabel];\n\t\t\t\n\t\t\t// fullscreen in component\n\t\t\tlet groupId = Object.keys(contents)[0];\n\t\t\tlet fullscreen = Number.isNaN(parseInt(groupId));\n\t\t\t\n\t\t\tif (!this.gridContents[tabLabel] && fullscreen) {\n\t\t\t\tthis.gridContents[tabLabel] = getGroup(contents, { ...this.props.groups[groupId], settings: contents[groupId] }, { action: this.openDialog, ...this.widgetProps });\n\t\t\t}\n\t\t\t\n\t\t\t// grid layout\n\t\t\telse if (!this.gridContents[tabLabel]) {\n\t\t\t\tthis.gridContents[tabLabel] = <GridContainer contents={getGridContents(contents, this.props.groups, { action: this.openDialog, ...this.widgetProps })} />\n\t\t\t}\n\t\t\t\n\t\t\tlet tabPanel = (\n\t\t\t\t<TabPanel key={'tabPanel-' + tab} renderedTab={tab} selectedTab={this.state.selectedTab} fullscreen={fullscreen}>\n\t\t\t\t\t{this.gridContents[tabLabel]}\n\t\t\t\t</TabPanel>\n\t\t\t);\n\t\t\t\n\t\t\ttabPanels.push(tabPanel);\n\t\t\ttab++;\n\t\t}\n\t\t\n\t\treturn tabPanels;\n\t}\n\t\n\tcloseDialog() {\n\t\tthis.setState({ 'dialog': false, 'dialogContents': { 'ts': Date.now(), 'device': {} } });\n\t}\n\t\n\topenDialog(device) {\n\t\tthis.setState({ 'dialog': true, 'dialogContents': { 'ts': Date.now(), 'device': device } });\n\t}\n\t\n\tselectTab(tab, title) {\n\t\tthis.setState({ selectedTab: tab, tabTitle: title });\n\t}\n\t\n\t/*\n\ttoggleDrawer(drawer, open) {\n\t\tthis.setState({ [drawer]: open });\n\t};\n\t*/\n\t\n    render() {\n        return (\n\n<ThemeProvider theme={theme}>\n\t<TopBar title={this.props.settings.topBarTitle || (this.tabsEnabled && this.state.tabTitle) || 'jarvis'}>\n\t\t{this.tabsEnabled && <TabBar tabs={this.tabs} selectTab={this.selectTab} />}\n\t</TopBar>\n\t\n\t{/*\n\t<Drawer anchor=\"right\" open={this.state.notificationDrawer} onClose={this.toggleDrawer('notificationDrawer', false)}>\n\t\t\n\t</Drawer>\n\t*/}\n\n\t<Popup open={this.state.dialog} contents={this.state.dialogContents} closeDialog={this.closeDialog} />\n\t{this.getTabPanels()}\n\t\n</ThemeProvider>\n\n\t\t)\n\t}\n}\n","import React from 'react'\nimport LogRocket from 'logrocket'\nimport uuid from 'uuid/v3'\n\nimport Grid from '@material-ui/core/Grid'\nimport CircularProgress from '@material-ui/core/CircularProgress'\nimport Typography from '@material-ui/core/Typography'\nimport Skeleton from '@material-ui/lab/Skeleton'\n\nimport GridContainer from './components/GridContainer'\nimport StatusSnackbar from './components/StatusSnackbar'\n\nimport i18n from './i18n'\nimport Connection from './Connection'\nimport Device from './Device'\nimport Jarvis from './Jarvis'\n\n\n/*\n * STYLES\n */\nimport { withStyles } from '@material-ui/core/styles';\nconst styles = theme => ({\n\tloading: {\n\t\tmargin: '10px 0 0 0',\n\t\tcolor: '#999'\n\t},\n\tgridItem: {\n\t\tmargin: theme.spacing(1, 1, 0, 0),\n\t\t[theme.breakpoints.down('md')]: {\n\t\t\tmarginRight: theme.spacing(0.4, 0.4, 0, 0)\n\t\t}\n\t}\n});\n\n\n/*\n * CONSTANTS\n *\n */\nconst NODE_SETTINGS = 'jarvis.0.settings';\nconst NODE_DEVICES = 'jarvis.0.devices';\n\n\nclass App extends React.Component {\n\t\n    constructor(props) {\n\t\tsuper(props);\n\t\t\n\t\tthis.state = {\n\t\t\tloaded: [],\n\t\t\terror: false,\n\t\t\terrorMessage: ''\n\t\t}\n\t};\n\t\n\tcomponentDidMount() {\n\t\t\n\t\t// connect and get connection\n\t\tconst noErrorFunction = () => this.setState({ error: false, errorMessage: '' });\n\t\tconst url = window.location.hostname === 'localhost' ? 'https://192.168.178.29:8082' : (window.location.protocol + '//' + window.location.hostname + (window.location.port ? ':' + window.location.port : ''));\n\t\tconst listeners = [\n\t\t\t{ 'event': 'connect', 'callback': noErrorFunction },\n\t\t\t{ 'event': 'reconnect', 'callback': noErrorFunction },\n\t\t\t{ 'event': 'disconnect', 'callback': noErrorFunction },\n\t\t\t{ 'event': 'error', 'callback': err => this.setState({ error: true, errorMessage: i18n.t('Connection lost! Trying to reconnect') + '..' }) }\n\t\t];\n\t\t\n\t\tthis.socket = Connection.connect(url, listeners);\n\t\t\n\t\t// retrieve settings\n\t\tthis.settings = {};\n\t\tthis.socket.getState(NODE_SETTINGS)\n\t\t\t.then(state => {\n\t\t\t\t\n\t\t\t\ttry {\n\t\t\t\t\tthis.settings = state && JSON.parse(state.val);\n\t\t\t\t\tthis.useSettings();\n\t\t\t\t\tthis.setState({ loaded: [...this.state.loaded, 'settings'] });\n\t\t\t\t}\n\t\t\t\tcatch(err) {\n\t\t\t\t\tconsole.error('GET_SETTINGS: ' + err.message);\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\terror: true,\n\t\t\t\t\t\terrorMessage: 'Error parsing settings!'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t\n\t\t\t})\n\t\t\t.catch(err => {\n\t\t\t\tconsole.error('GET_SETTINGS: ' + err.message);\n\t\t\t\tthis.setState({\n\t\t\t\t\terror: true,\n\t\t\t\t\terrorMessage: err\n\t\t\t\t});\n\t\t\t});\n\t\t\n\t\t\n\t\t// retrieve devices\n\t\tthis.devices = {};\n\t\tthis.groups = {};\n\t\t\n\t\tthis.socket.getState(NODE_DEVICES)\n\t\t\t.then(state => {\n\t\t\t\t\n\t\t\t\ttry {\n\t\t\t\t\tthis.devices = JSON.parse(state.val);\n\t\t\t\t\tthis.processDevices(this.devices).then(groups => {\n\t\t\t\t\t\tthis.groups = groups;\n\t\t\t\t\t\tthis.setState({ loaded: [...this.state.loaded, 'groups'] });\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tcatch(err) {\n\t\t\t\t\tconsole.error('GET_DEVICES: ' + err.message);\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\terror: true,\n\t\t\t\t\t\terrorMessage: 'Error parsing devices!'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(err => {\n\t\t\t\tconsole.error('GET_DEVICES: ' + err.message);\n\t\t\t\tthis.setState({\n\t\t\t\t\terror: true,\n\t\t\t\t\terrorMessage: 'Socket failed while getting devices!'\n\t\t\t\t});\n\t\t\t});\n    }\n\n\t/**\n\t *\n\t *\n\t */\n\tuseSettings() {\n\t\t\n\t\t// LogRocket\n\t\tif (this.settings.debug && this.settings.debug.name && this.settings.debug.email && this.settings.debug.email.indexOf('@') > -1) {\n\t\t\tLogRocket.init('36n1xl/jarvis');\n\t\t\t\n\t\t\tlet id = uuid(this.settings.debug.name + '#' + this.settings.debug.email, 'e63359dc-bc1c-476e-81cd-8f580d09a557');\n\t\t\tLogRocket.identify(id, {\n\t\t\t\tname: this.settings.debug.name,\n\t\t\t\temail: this.settings.debug.email\n\t\t\t});\n\t\t\t\n\t\t\tconsole.info('Opt-In for providing debugging details to the developer. Your ID is: ' + id);\n\t\t}\n\t\t\n\t\t// language\n\t\twindow.language = (this.settings.language || navigator.language || navigator.userLanguage || 'en').substr(0, 2);\n\t\ti18n.setLanguage(window.language);\n\t\ti18n.loadTranslations(['en', 'de']);\n\t\t\n\t\t// page title\n\t\tif (this.settings.pageTitle) {\n\t\t\tdocument.title = this.settings.pageTitle;\n\t\t}\n\t\t\n\t\t// favicon\n\t\tif (this.settings.pageFavicon && this.settings.pageFavicon.substr(0, 5) === 'data:') {\n\t\t\tdocument.getElementById('favicon').href = this.settings.pageFavicon;\n\t\t}\n\t\t\n\t\t// translations\n\t\tif (this.settings.translations) {\n\t\t\t\n\t\t\tlet translations = this.settings.translations;\n\t\t\tfor (let language in translations) {\n\t\t\t\ti18n.setTranslation(language, translations[language]);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t/**\n\t *\n\t *\n\t */\n\tgroupDevice(groups, device) {\n\t\t\n\t\t// add device to group(s)\n\t\tlet options = device.get('options');\n\t\toptions.groups.forEach(group => {\n\t\t\t\n\t\t\tlet groupId = group.toLowerCase().replace(/ /g, '');\n\t\t\tif (!groups[groupId]) {\n\t\t\t\tgroups[groupId] = { 'id': groupId, 'name': group, 'devices': [device] };\n\t\t\t}\n\t\t\telse {\n\t\t\t\tgroups[groupId].devices.push(device);\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn groups;\n\t}\n\t\n\t/**\n\t *\n\t *\n\t */\n\tprocessDevice(deviceProperties) {\n\t\t\n\t\tlet promises = [];\n\t\tlet device = null;\n\t\ttry {\n\t\t\tdevice = new Device(deviceProperties, this.socket, window.language);\n\t\t\t\n\t\t\t// request primary state value\n\t\t\tpromises.push(device.requestDeviceState(null, true));\n\t\t\t\n\t\t\t// request secondary state value\n\t\t\tif (device.secondaryStateKey) {\n\t\t\t\tpromises.push(device.requestDeviceState(device.secondaryStateKey, true));\n\t\t\t}\n\t\t\t\n\t\t}\n\t\tcatch(err) {\n\t\t\tconsole.warn(err.message);\n\t\t}\n\t\t\n\t\treturn new Promise(resolve => {\n\t\t\tPromise.allSettled(promises).then(results => {\n\t\t\t\t\n\t\t\t\tresults.forEach(result => {\n\t\t\t\t\tif (result.status === 'rejected') {\n\t\t\t\t\t\tconsole.error(result);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tresolve(device);\n\t\t\t});\n\t\t});\n\t}\n\t\n\t/**\n\t *\n\t *\n\t */\n\tprocessDevices(deviceList) {\n\t\t\n\t\t// loop through all devices of in the device list\n\t\tlet promises = [];\n\t\tlet groups = {};\n\t\t\n\t\tlet devices = 0, groupedDevices = 0;\n\t\tfor (let deviceId in deviceList) {\n\t\t\tdevices++;\n\t\t\t\n\t\t\tdeviceList[deviceId].options = deviceList[deviceId].jarvis;\n\t\t\tdelete deviceList[deviceId].jarvis;\n\t\t\t\n\t\t\tlet deviceProperties = { ...deviceList[deviceId], 'id': deviceId };\n\t\t\tpromises.push(new Promise((resolve, reject) => {\n\t\t\t\t\n\t\t\t\tthis.processDevice(deviceProperties).then(device => {\n\t\t\t\n\t\t\t\t\tif (device !== null) {\n\t\t\t\t\t\tgroupedDevices++;\n\t\t\t\t\t\tgroups = this.groupDevice(groups, device);\n\t\t\t\t\t\tresolve(deviceId);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\treject(deviceId);\n\t\t\t\t});\n\t\t\t}));\n\t\t\t\n\t\t\t// check states for own device settings\n\t\t\tfor (let stateKey in deviceProperties.states) {\n\t\t\t\t\n\t\t\t\tlet state = deviceProperties.states[stateKey];\n\t\t\t\tif (state && state.jarvis !== undefined) {\n\t\t\t\t\t\n\t\t\t\t\tpromises.push(new Promise((resolve, reject) => {\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.processDevice({ ...deviceProperties, 'id': deviceId + '#' + stateKey, 'states': { [stateKey]: state }, 'options': state.jarvis }).then(device => {\n\t\t\t\t\t\n\t\t\t\t\t\t\tif (device !== null) {\n\t\t\t\t\t\t\t\tgroupedDevices++;\n\t\t\t\t\t\t\t\tgroups = this.groupDevice(groups, device);\n\t\t\t\t\t\t\t\tresolve(deviceId);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\treject(deviceId);\n\t\t\t\t\t\t});\n\t\t\t\t\t}));\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn new Promise(resolve => Promise.allSettled(promises).then(res => {\n\t\t\t\n\t\t\t// sort groups\n\t\t\tfor (let groupId in groups) {\n\t\t\t\tgroups[groupId].devices.sort((item1, item2) => {\n\t\t\t\t\tif (item1.options.sort > item2.options.sort) return 1;\n\t\t\t\t\telse if (item2.options.sort > item1.options.sort) return -1;\n\t\t\t\t\telse return 0;\n\t\t\t\t});\n\t\t\t}\n\t\t\n\t\t\t// return\n\t\t\tconsole.info('Processed ' + devices + ' devices. Added ' + groupedDevices + ' devices in ' + Object.keys(groups).length + ' groups.', res, groups);\n\t\t\tresolve(groups);\n\t\t}));\n\t};\n\t\n\trenderError() {\n\t\tconsole.error(JSON.stringify(this.state.errorMessage));\n\t\treturn (\n\n<StatusSnackbar\n\tkey={'StatusSnackbar'}\n\tvariant=\"error\"\n\tcloseButton={false}\n\tmessage={this.state.errorMessage.toString()}\n\t/>\n\n\t\t);\n\t}\n\t\n\trenderLoadingProgress() {\n\t\tconst { classes } = this.props;\n\t\treturn (\n\n<Grid\n\tkey=\"loadingProcess\" \n\tcontainer\n\tspacing={0}\n\tdirection=\"column\"\n\tjustify=\"center\"\n\talignItems=\"center\"\n\tstyle={{ minHeight: \"100vh\" }}\n\t>\n\n\t<CircularProgress />\n\t<Typography className={classes.loading}>{i18n.t('Retrieving settings')}...</Typography>\n\n</Grid>\n\n\t\t);\n\t};\n\t\n\trenderLoadingSkeleton(props) {\n\t\tconst { classes } = this.props;\n\t\tconst { topBar, tabBar, gridColumns } = props;\n\t\t\n\t\tconst SkeletonLoader = (props) => <Skeleton animation=\"wave\" variant=\"rect\" className={classes.gridItem} height={props.height} />;\n\t\t\n\t\tlet gridContents = {}\n\t\tfor (let column = 1; column <= gridColumns; column++) {\n\t\t\tgridContents[column] = gridContents[column] || [];\n\t\t\t\n\t\t\tlet loaders = Math.random() * (5 - 2) + 2;\n\t\t\tfor (let loader = 1; loader <= loaders; loader++) {\n\t\t\t\tgridContents[column].push(<SkeletonLoader key={column + '#' + loader} height={(Math.random() * (400 - 100) + 100)} />);\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn (\n\n<React.Fragment>\n\t{topBar && <Skeleton animation=\"wave\" variant=\"rect\" height={64} />}\n\t{tabBar && <Skeleton animation=\"wave\" variant=\"rect\" height={48} />}\n\t<GridContainer key=\"loadingSkeleton\" contents={gridContents} />\n</React.Fragment>\n\n\t\t);\n\t}\n\t\n    render() {\n\t\t\n\t\t// error message\n\t\tconst error = this.state.error ? this.renderError() : null;\n\t\t\n\t\t// loading screens\n\t\tif (this.state.error && this.state.loaded.length < 2) {\n\t\t\treturn error;\n\t\t}\n\t\telse if (this.state.loaded.indexOf('settings') === -1) {\n\t\t\treturn this.renderLoadingProgress();\n\t\t}\n\t\telse if (this.state.loaded.indexOf('groups') === -1) {\n\t\t\tconst tab = Object.keys(this.settings.layout)[0];\n\t\t\treturn this.renderLoadingSkeleton({ topBar: true, tabBar: tab !== 1, gridColumns: (tab !== 1 ? Object.keys(this.settings.layout[tab]).length : tab.length) });\n\t\t}\n\t\t\n\t\t// App\n\t\treturn [ error, <Jarvis key=\"jarvis\" settings={this.settings} groups={this.groups} /> ];\n\t};\n}\n\nexport default withStyles(styles)(App);\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react'\r\nimport ReactDOM from 'react-dom'\r\n\r\nimport './index.css'\r\nimport App from './App'\r\nimport * as serviceWorker from './serviceWorker'\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n","/**\r\n *\r\n *\r\n */\r\nfunction HsvToRgb(h, s = 1, v = 1) {\r\n\tif (Array.isArray(h)) {\r\n\t\tv = h[2];\r\n\t\ts = h[1];\r\n\t\th = h[0];\r\n\t}\r\n\telse if (typeof h === 'string' && h.indexOf(',')) {\r\n\t\t[h, s, v] = h.split(',');\r\n\t}\r\n\t\r\n\tif (h > 1) {\r\n\t\th = h/360;\r\n\t}\r\n\t\r\n\tlet r, g, b, i, f, p, q, t;\r\n\t\r\n\ti = Math.floor(h * 6);\r\n\tf = h * 6 - i;\r\n\tp = v * (1 - s);\r\n\tq = v * (1 - f * s);\r\n\tt = v * (1 - (1 - f) * s);\r\n\t\r\n\tswitch (i % 6) {\r\n\t\tcase 0:\r\n\t\t\tr = v;\r\n\t\t\tg = t;\r\n\t\t\tb = p;\r\n\t\t\tbreak;\r\n\t\t\t\r\n\t\tcase 1:\r\n\t\t\tr = q;\r\n\t\t\tg = v;\r\n\t\t\tb = p;\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tcase 2:\r\n\t\t\tr = p;\r\n\t\t\tg = v;\r\n\t\t\tb = t;\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tcase 3:\r\n\t\t\tr = p;\r\n\t\t\tg = q;\r\n\t\t\tb = v;\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tcase 4:\r\n\t\t\tr = t;\r\n\t\t\tg = p;\r\n\t\t\tb = v;\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tcase 5:\r\n\t\t\tr = v;\r\n\t\t\tg = p;\r\n\t\t\tb = q;\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tdefault: // for webpack\r\n\t\t\tbreak;\r\n\t}\r\n\t\r\n\treturn [\r\n\t\tMath.round(r * 255),\r\n\t\tMath.round(g * 255),\r\n\t\tMath.round(b * 255)\r\n\t];\r\n}\r\n\r\n\r\n/**\r\n *\r\n *\r\n */\r\nfunction RgbToHex(r, g, b) {\r\n\tif (Array.isArray(r)) {\r\n\t\tb = r[2];\r\n\t\tg = r[1];\r\n\t\tr = r[0];\r\n\t}\r\n\telse if (typeof r === 'string' && r.indexOf(',')) {\r\n\t\t[r, g, b] = r.split(',');\r\n\t}\r\n\t\r\n\tr = parseInt(r).toString(16);\r\n\tg = parseInt(g).toString(16);\r\n\tb = parseInt(b).toString(16);\r\n\t\r\n\tif (r.length === 1) r = '0' + r;\r\n\tif (g.length === 1) g = '0' + g;\r\n\tif (b.length === 1) b = '0' + b;\r\n\t\r\n\treturn \"#\" + r + g + b;\r\n}\r\n\r\n\r\nexport default {\r\n\tHsvToRgb,\r\n\tRgbToHex\r\n}","import React, { useState, useEffect } from 'react'\r\nimport { HuePicker, SketchPicker as ColorPicker } from 'react-color'\r\n\r\nimport helpers from '../helpers/colorConverter'\r\nimport defaults from './defaults'\r\n\r\n\r\n/*\r\n * ACTIONS\r\n *\r\n */\r\nfunction LightLevelAction(props) {\r\n\tconst { device, stateKey, stateVal } = props;\r\n\t\r\n\tconst onChange = (e) => {\r\n\t\tsetChecked(e.target.checked);\r\n\t\tdevice.setDeviceState(stateKey, e.target.checked ? 100 : 0).catch(err => console.error(err));\r\n\t}\r\n\t\r\n\tconst [checked, setChecked] = useState(stateVal > 0);\r\n\tuseEffect(() => setChecked(stateVal > 0), [stateVal]);\r\n\t\r\n\t// only show percentage if device has a switch itself\r\n\tif (device.parent && device.parent.states.power) {\r\n\t\treturn <defaults.actions.Action {...props} stateVal={checked} onChange={onChange} />;\r\n\t}\r\n\t\r\n\treturn <defaults.actions.PowerAction {...props} stateVal={checked} onChange={onChange} />\r\n}\r\n\r\nfunction LightColorAction(props) {\r\n\tconst { stateKey, stateVal } = props;\r\n\t\r\n\tconst [colorSpace, setColorSpace] = useState(stateVal);\r\n\tuseEffect(() => setColorSpace(stateVal), [stateVal]);\r\n\t\r\n\tlet colors, labels = {};\r\n\tif (stateKey === 'rgb' && colorSpace) {\r\n\t\tcolors = colorSpace.split(',');\r\n\t\tlabels = { Red: colors[0], Green: colors[1], Blue: colors[2] };\r\n\t\t\r\n\t}\r\n\telse if (stateKey === 'hsv' && colorSpace) {\r\n\t\tcolors = colorSpace.split(',');\r\n\t\tlabels = { Hue: colors[0], Saturation: colors[1], Brightness: colors[2] };\r\n\t}\r\n\t\r\n\tconst Label = defaults.components.Label;\r\n\tlet label = [];\r\n\tfor (let key in labels) {\r\n\t\tlabel.push(<Label key={key} label={key + ' ' + labels[key]} br={true} />);\r\n\t}\r\n\t\r\n\treturn label;\r\n}\r\n\r\n\r\n/*\r\n * COMPONENTS\r\n *\r\n */\r\nfunction LightColorTemperatureComponent(props) {\r\n\tconst Level = defaults.components.LevelComponent;\r\n\treturn (\r\n\t\t<Level min={2000} max={6500} step={10} {...props} />\r\n\t);\r\n}\r\n\r\nfunction LightHueComponent(props) {\r\n\tconst { device, stateKey, stateVal, title } = props;\r\n\t\r\n\tconst onChangeComplete = (color, e) => {\r\n\t\tsetHue(Math.round(color.hsl.h));\r\n\t\tdevice.setDeviceState(stateKey, Math.round(color.hsl.h)).catch(err => console.error(err));\r\n\t}\r\n\t\r\n\tconst [hue, setHue] = useState(stateVal);\r\n\tuseEffect(() => setHue(stateVal), [stateVal]);\r\n\t\r\n\tconst Component = defaults.components.Component;\r\n\tconst color = helpers.RgbToHex(helpers.HsvToRgb(hue));\r\n\treturn (\r\n\r\n<Component title={title || stateKey }>\r\n\t<HuePicker\r\n\t\tcolor={color}\r\n\t\twidth={'100%'}\r\n\t\tonChangeComplete={onChangeComplete}\r\n\t\t/>\r\n\t\t\r\n</Component>\r\n\r\n\t);\r\n}\r\n\r\nfunction LightColorComponent(props) {\r\n\tconst { device, stateKey, stateVal, title } = props;\r\n\t\r\n\tconst onChangeComplete = (color, e) => {\r\n\t\tcolor = color[stateKey];\r\n\t\t\r\n\t\t// RGB\r\n\t\tif (stateKey === 'rgb') {\r\n\t\t\tcolor = [color.r, color.g, color.b].join(',');\r\n\t\t}\r\n\t\t// HSV\r\n\t\telse if (stateKey === 'hsv') {\r\n\t\t\tcolor = [color.h, color.s, color.v].join(',');\r\n\t\t}\r\n\t\t\r\n\t\tdevice.setDeviceState(stateKey, color).catch(err => console.error(err));\r\n\t};\r\n\t\r\n\tlet initialColor = stateVal || '#ffffff';\r\n\t\r\n\t// RGB\r\n\tif (stateKey === 'rgb') {\r\n\t\tinitialColor = helpers.RgbToHex(initialColor);\r\n\t}\r\n\t// HSV\r\n\telse if (stateKey === 'hsv') {\r\n\t\tinitialColor = helpers.RgbToHex(helpers.HsvToRgb(initialColor));\r\n\t}\r\n\t\r\n\tconst [colorSpace, setColorSpace] = useState(initialColor);\r\n\tuseEffect(() => {\r\n\t\t// RGB\r\n\t\tif (stateKey === 'rgb') {\r\n\t\t\tsetColorSpace(helpers.RgbToHex(stateVal));\r\n\t\t}\r\n\t\t// HSV\r\n\t\telse if (stateKey === 'hsv') {\r\n\t\t\tsetColorSpace(helpers.RgbToHex(helpers.HsvToRgb(stateVal)));\r\n\t\t}\r\n\t\t// HEX\r\n\t\telse if (stateKey === 'hex') {\r\n\t\t\tsetColorSpace(stateVal);\r\n\t\t}\r\n\t}, [stateKey, stateVal]);\r\n\t\r\n\tconst Component = defaults.components.Component;\r\n\treturn (\r\n\r\n<Component title={title || stateKey }>\r\n\t<ColorPicker\r\n\t\tcolor={colorSpace}\r\n\t\twidth={'100%'}\r\n\t\tonChangeComplete={onChangeComplete}\r\n\t\t/>\r\n\t\t\r\n</Component>\r\n\r\n\t);\r\n}\r\n\r\n\r\nconst color = {\r\n\ticon: {\r\n\t\t'default': 'palette',\r\n\t},\r\n\tunit: ' '\r\n}\r\n\r\nexport default {\r\n\tconfigurations: {\r\n\t\tpower: {\r\n\t\t\ticon: {\r\n\t\t\t\t'true': 'lightbulb-on',\r\n\t\t\t\t'false': 'lightbulb-off-outline'\r\n\t\t\t},\r\n\t\t},\r\n\t\tlevel: {\r\n\t\t\tvalue: (val) => val > 0 && val <= 1 ? val * 100 : val,\r\n\t\t\tunit: (value) => value !== 'off' ? ' %' : null,\r\n\t\t\ticon: {\r\n\t\t\t\t'default': 'lightbulb-on',\r\n\t\t\t\t'0': 'lightbulb-off-outline'\r\n\t\t\t},\r\n\t\t\tstate: {\r\n\t\t\t\t'0': 'off'\r\n\t\t\t},\r\n\t\t},\r\n\t\tcolorTemperature: {\r\n\t\t\ticon: {\r\n\t\t\t\t'default': 'thermometer',\r\n\t\t\t},\r\n\t\t\tunit: ' K'\r\n\t\t},\r\n\t\thue: color,\r\n\t\trgb: color,\r\n\t\thsv: color,\r\n\t\thex: color\r\n\t},\r\n\tcomponents: {\r\n\t\tlevel: defaults.components.LevelComponent,\r\n\t\tcolorTemperature: LightColorTemperatureComponent,\r\n\t\trgb: LightColorComponent,\r\n\t\thsv: LightColorComponent,\r\n\t\thex: LightColorComponent,\r\n\t\thue: LightHueComponent\r\n\t},\r\n\tactions: {\r\n\t\tpower: defaults.actions.PowerAction,\r\n\t\tlevel: LightLevelAction,\r\n\t\trgb: LightColorAction,\r\n\t\thsv: LightColorAction,\r\n\t\thex: LightColorAction\r\n\t},\r\n\tstyles: {\r\n\t\t_any: {\r\n\t\t\t//icon: {},\r\n\t\t\tstate: {\r\n\t\t\t\t'0': {\r\n\t\t\t\t\t'color': '#999'\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}","import EventEmitter from 'events'\r\nimport io from 'socket.io-client'\r\n\r\n\r\n/**\r\n * Class for Socket.io conncetion handling.\r\n *\r\n * @description This is based on an implementation @GermanBluefox (https://github.com/GermanBluefox), see https://github.com/ioBroker/adapter-react/blob/master/src/Connection.js\r\n *\t\t\t\tOnly required functions are taken from source class. Major change is that all events are emitted, so proper error handling is possible in the App.\r\n *\r\n *\r\n * @param\t{String}\t\turl\r\n * @param\t{Object}\t\toptions\r\n * @return\t{Socket}\r\n * @see https://github.com/ioBroker/ioBroker.socketio/blob/master/lib/socket.js https://github.com/ioBroker/ioBroker.js-controller/blob/master/lib/adapter.js#L635\r\n *\r\n */\r\nexport default class Socket extends EventEmitter {\r\n\t\r\n\tconstructor(url = null, options = {}) {\r\n\t\tsuper();\r\n\t\t\r\n\t\t// socket connection\r\n\t\tthis.socket = io(url, { timeout: 10000, ...options, query: 'ws=true' });\r\n\t\tthis.statesSubscribes = {}; // subscribed states\r\n\t\t\r\n\t\t/*\r\n\t\t * API events\r\n\t\t * @see https://github.com/socketio/socket.io-client/blob/HEAD/docs/API.md#socket\r\n\t\t *\r\n\t\t */\r\n\t\t// connect\r\n\t\tthis.socket.on('connect', () => this.emit('connect'));\r\n\t\t\r\n\t\t// reconnect: Fired upon a successful reconnection.\r\n\t\tthis.socket.on('reconnect', attempts => this.emit('reconnect', attempts));\r\n\t\t\r\n\t\t// reconnect_error: Fired upon a reconnection attempt error.\r\n\t\tthis.socket.on('reconnect_error', error => this.emit('error', { 'type': 'reconnect', 'event': 'reconnect_error', 'message': error.message }));\r\n\t\t\r\n\t\t// reconnect_failed: Fired upon a reconnection attempt error.\r\n\t\tthis.socket.on('reconnect_failed', () => this.emit('error', { 'type': 'reconnect', 'event': 'reconnect_failed', 'message': 'Reconnection failed!' }));\r\n\t\t\r\n\t\t// discconect\r\n\t\tthis.socket.on('disconnect', reason => this.emit('disconnect', reason));\r\n\t\t\r\n\t\t// connect_error\r\n\t\tthis.socket.on('connect_error', error => this.emit('error', { 'type': 'connect', 'event': 'connect_error', 'message': error.message }));\r\n\t\t\r\n\t\t// connect_timeout\r\n\t\tthis.socket.on('connect_timeout', () => this.emit('error', { 'type': 'connect', 'event': 'connect_timeout', 'message': 'Connect ran into timeout!' }));\r\n\t\t\r\n\t\t// error\r\n\t\tthis.socket.on('error', error => this.emit('error', { 'type': 'error', 'event': 'error', 'message': error.message }));\r\n\t\t\r\n\t\t/*\r\n\t\t * ioBroker events\r\n\t\t *\r\n\t\t */\r\n\t\tthis.socket.on('stateChange', (id, state) => setTimeout(() => this.stateChange(id, state), 0));\r\n\t}\r\n\t\r\n\t/**\r\n\t * Subscribes to multiple states by setting a callback.\r\n\t *\r\n\t */\r\n\tsubscribeStates(ids, cb) {\r\n\t\tids = Array.isArray(ids) ? ids : [ids];\r\n\t\tids.forEach(id => this.subscribeState(id, cb));\r\n\t}\r\n\t\r\n\t/**\r\n\t * Subscribes to a state by setting a callback.\r\n\t *\r\n\t */\r\n\tsubscribeState(id, cb) {\r\n\t\t\r\n\t\tif (!this.statesSubscribes[id]) {\r\n\t\t\tlet reg = id\r\n\t\t\t\t.replace(/\\./g, '\\\\.')\r\n\t\t\t\t.replace(/\\*/g, '.*')\r\n\t\t\t\t.replace(/\\(/g, '\\\\(')\r\n\t\t\t\t.replace(/\\)/g, '\\\\)')\r\n\t\t\t\t.replace(/\\+/g, '\\\\+')\r\n\t\t\t\t.replace(/\\[/g, '\\\\[');\r\n\r\n\t\t\tif (reg.indexOf('*') === -1) {\r\n\t\t\t\treg += '$';\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis.statesSubscribes[id] = { reg: new RegExp(reg), cbs: [cb] };\r\n\t\t\t\r\n\t\t\tif (this.socket.connected) {\r\n\t\t\t\tthis.socket.emit('subscribe', id);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.statesSubscribes[id].cbs.indexOf(cb) === -1 && this.statesSubscribes[id].cbs.push(cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Fires pre-registered callbacks (via subscribeState) upon state change.\r\n\t *\r\n\t */\r\n\tstateChange(id, state) {\r\n\t\t\r\n\t\tid = id ? id.replace(/[\\s'\"]/g, '_') : '';\r\n\t\tfor (const task in this.statesSubscribes) {\r\n\t\t\tif (this.statesSubscribes.hasOwnProperty(task) && this.statesSubscribes[task].reg.test(id)) {\r\n\t\t\t\tthis.statesSubscribes[task].cbs.forEach(cb => cb(id, state));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets an object view.\r\n\t *\r\n\t */\r\n\tgetAdapterInstances(adapter, cb) {\r\n\t\t\r\n\t\tif (typeof adapter === 'function') {\r\n\t\t\tcb = adapter;\r\n\t\t\tadapter = null;\r\n\t\t}\r\n\t\t\r\n\t\treturn this.getObjectView('system', 'instance', { 'startkey': 'system.adapter.' + (adapter ? adapter + '.' : ''), 'endkey': 'system.adapter.' + (adapter ? adapter + '.999' : 'zzz') }, cb);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets an object view.\r\n\t *\r\n\t */\r\n\tgetObjectView(design, search, params, cb) {\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.getObjectView(design, search, params, err => err ? reject(err) : resolve()));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('getObjectView', design, search, params, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets a remote ressource.\r\n\t *\r\n\t */\r\n\tgetRemoteResource(url, cb) {\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.getRemoteResource(url, (err, state) => err ? reject(err) : resolve(state)));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('httpGet', url, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets a state.\r\n\t *\r\n\t */\r\n\tgetState(id, cb) {\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.getState(id, (err, state) => err ? reject(err) : resolve(state)));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('getState', id, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets multiple states at once.\r\n\t *\r\n\t */\r\n\tgetStates(pattern, cb) {\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.getStates(pattern, (err, state) => err ? reject(err) : resolve(state)));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('getStates', pattern, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets the state history.\r\n\t *\r\n\t */\r\n\tgetStateHistory(id, options, cb) {\r\n\t\t\r\n\t\tif (typeof options === 'function') {\r\n\t\t\tcb = options;\r\n\t\t\toptions = {};\r\n\t\t}\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.getStateHistory(id, options, (err, state) => err ? reject(err) : resolve(state)));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('getHistory', id, options, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Sets a state.\r\n\t *\r\n\t */\r\n\tsetState(id, val, cb) {\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.setState(id, val, err => err ? reject(err) : resolve()));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('setState', id, val, cb);\r\n\t\t}\r\n\t}\r\n}\r\n","import Socket from './Socket'\r\n\r\n/**\r\n * Connection\r\n +\r\n *\r\n */\r\nexport default class Connection {\r\n\r\n\t/*\r\n\t * URL\r\n\t */\r\n\tstatic url = window.location.hostname;\r\n\t\r\n\t/*\r\n\t * Connection\r\n\t */\r\n\tstatic connection = null;\r\n\t\r\n\t/**\r\n\t * Connects to the Socket.\r\n\t *\r\n\t * @param\t{String}\turl\r\n\t * @param\t{Array}\t\tlisteners\r\n\t * @return\t{Connection}\r\n\t */\r\n\tstatic connect(url = null, listeners = null) {\r\n\t\t\r\n\t\t// set URL\r\n\t\tif (url) {\r\n\t\t\tConnection.setUrl = url;\r\n\t\t}\r\n\t\t\r\n\t\t// connect\r\n\t\tConnection.connection = new Socket(Connection.url);\r\n\t\t\r\n\t\t// set listeners\r\n\t\tif (listeners) {\r\n\t\t\tConnection.setListeners = listeners;\r\n\t\t}\r\n\t\t\r\n\t\t// return connection\r\n\t\treturn Connection.connection;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets the current Connection.\r\n\t *\r\n\t * @param\tvoid\r\n\t * @return\t{Connection}\tCurrent Connection\r\n\t */\r\n\tstatic get getConnection() {\r\n\t\treturn Connection.connection || null;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get the current URL.\r\n\t *\r\n\t * @param\tvoid\r\n\t * @return\t{String}\tURL\r\n\t */\r\n\tstatic get getUrl() {\r\n\t\treturn Connection.url;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Sets an event listener.\r\n\t *\r\n\t * @param\t{Object}\t\t\tlistener\r\n\t * @param\t{String}\t\t\tlistener.event\r\n\t * @param\t{Function}\t\t\tlistener.callback\r\n\t * @return\tvoid\r\n\t */\r\n\tstatic set setListener(listener) {\r\n\t\tConnection.connection.on(listener.event, listener.callback);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Set event listeners.\r\n\t *\r\n\t * @param\t{Array<Object>}\t\tlisteners\r\n\t * @return \t{Boolean}\r\n\t */\r\n\tstatic set setListeners(listeners = []) {\r\n\t\t\r\n\t\tif (!listeners || !Array.isArray(listeners)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t\tlisteners.forEach(listener => Connection.setListener = listener);\r\n\t\treturn true;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Set a new URL (has to be set before calling connect()).\r\n\t *\r\n\t * @param\t{String}\tURL\r\n\t * @return\tvoid\r\n\t */\r\n\tstatic set setUrl(url) {\r\n\t\tConnection.url = url;\r\n\t}\r\n}\r\n","import { format } from 'date-fns'\r\nimport { de } from 'date-fns/locale'\r\n\r\n/**\r\n *\r\n *\r\n */\r\nfunction timeToSeconds(time) {\r\n\t\r\n\tif (time.toString().indexOf(':') > -1) {\r\n\t\ttime = time.toString();\r\n\t\tlet format = time.split(':').length-1;\r\n\t\tlet [ hours, minutes, seconds ] = format > 1 ? time.split(':') : ('0:' + time).split(':');\r\n\t\ttime = parseInt(hours) * 3600 + parseInt(minutes) * 60 + parseInt(seconds);\r\n\t}\r\n\t\r\n\treturn parseInt(time);\r\n}\r\n\r\n/**\r\n *\r\n *\r\n */\r\nfunction timeToHoursMinutesSeconds(time, withHours = false) {\r\n\t\r\n\tif (time.toString().indexOf(':') > -1) {\r\n\t\treturn time;\r\n\t}\r\n\t\r\n\ttime = parseInt(time);\r\n\twithHours = withHours || (time > 3600);\r\n\t\r\n\tif (Number.isNaN(time)) {\r\n\t\treturn withHours ? '00:00:00' : '00:00';\r\n\t}\r\n\t\r\n\tlet hours = '0' + Math.floor(time/3600);\r\n\tlet minutes = '0' + Math.floor(time/60);\r\n\tlet seconds = '0' + (time % 60);\r\n\t\r\n\treturn withHours ? [ hours.substr(-2), minutes.substr(-2), seconds.substr(-2) ].join(':') : [ minutes.substr(-2), seconds.substr(-2) ].join(':');\r\n}\r\n\r\n/**\r\n *\r\n *\r\n */\r\nfunction secondsToDateTime(seconds, dateTimeFormat = 'dd. MMM yyyy, HH:mm') {\r\n\treturn format(new Date(seconds*1000), dateTimeFormat, { locale: de });\r\n}\r\n\r\n\r\nexport default {\r\n\ttimeToSeconds,\r\n\ttimeToHoursMinutesSeconds,\r\n\tsecondsToDateTime\r\n}"],"sourceRoot":""}