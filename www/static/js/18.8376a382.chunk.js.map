{"version":3,"sources":["pages/ConfigurationPage/DevicesPage/ComponentConfigPage.js","components/Collapsible.js","../../../../AppData/Roaming/npm/node_modules/react-scripts/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toArray.js","pages/ConfigurationPage/DevicesPage/JsonEditor.js","pages/ConfigurationPage/DevicesPage/Devices.config.js","pages/ConfigurationPage/DevicesPage/StateExplorer.js","pages/ConfigurationPage/DevicesPage/DevicesPage.js","../node_modules/@material-ui/icons/Edit.js","../node_modules/@material-ui/icons/Add.js","../node_modules/@material-ui/icons/KeyboardArrowRight.js"],"names":["ComponentConfig","React","memo","props","Log","_","_onClose","_onChange","id","config","attributes","useState","open","setOpen","useEffect","undefined","componentConfiguration","Object","keys","map","configKey","configOption","val","_translate","info","otherConfigOption","label","i18n","t","selection","Tag","Inputs","type","key","divider","disableTypography","container","spacing","item","width","inputProps","style","textAlign","onChange","header","actions","Button","variant","onClick","color","dense","maxWidth","fullWidth","disablePadding","useStyles","makeStyles","theme","transition","duration","transitions","shortest","expanded","Collapsible","position","create","left","top","right","height","content","opacity","backgroundColor","palette","display","margin","marginTop","marginBottom","CollapsibleSummary","minHeight","padding","CollapsibleSummaryContent","flexGrow","CollapsibleSummaryExpandIcon","transform","CollapsibleDetails","CollapsibleContext","createContext","forwardRef","ref","arr","defaultExpanded","childrenProp","children","className","other","classes","setExpanded","handleChange","useCallback","event","Children","toArray","arrayWithHoles","iterableToArray","unsupportedIterableToArray","nonIterableRest","summary","contextValue","useMemo","toggle","Paper","elevation","root","clsx","Provider","value","Collapse","in","timeout","aria-labelledby","role","expandIcon","onBlur","onFocusVisible","useContext","ButtonBase","focusRipple","disableRipple","component","aria-expanded","stopPropagation","IconButton","size","tabIndex","aria-hidden","JsonEditor","mode","allowedModes","htmlElementProps","JsonEditorPopup","indexOf","Error","TreeView","TreeItem","text","secondary","action","hover","TreeItemContent","paddingRight","TreeItemError","error","light","textDecoration","cursor","fontWeight","TreeItemExpanded","TreeItemSelected","TreeItemGroup","paddingLeft","TreeItemLabel","Entry","alignItems","Group","EntryIcon","marginRight","EntryText","indexObjects","list","index","objectsTree","objectId","substr","lastIndexOf","namespace","push","StateExplorer","Cache","get","objectList","setObjectList","selectedItem","useRef","searchTimeout","Connection","connection","getObjects","then","res","forEach","promise","i","status","Array","isArray","rows","obj","sort","tree","_objectList","Date","now","set","catch","message","stack","renderTree","states","channelKey","length","concat","stateKey","Item","nodeId","channel","details","group","Fieldset","Text","clearTimeout","current","setTimeout","data","filter","toLowerCase","prevObjectList","timeConverter","parseDate","updated","startIcon","defaultCollapseIcon","defaultExpandIcon","onNodeSelect","e","otherProps","selected","common","name","GroupIcon","StateIcon","caption","title","arrow","getLanguage","StateExplorerPopup","state","onClose","s","iconContainer","flexDirection","alignRight","justifyContent","marginLeft","ModifyIcon","verticalAlign","heading","ListItem","drag","userSelect","isDragging","_merge","require","_copy","DevicesPage","device","setDevice","errors","setErrors","EDITOR","prevErrors","nextErrors","_addState","newStateKey","replace","prevDevice","_addDefaultStates","func","FUNCTIONS","stateKeys","reverse","substitute","xs","onDelete","savedDevice","options","split","base","characteristic","param","_updated","onSave","_onSave","disabled","FieldsetItem","columns","autoFocus","required","Select","function","funcKey","FUNCTION_ICONS","sortOptionsByKey","icon","Switch","suppressPopup","DeviceStates","_renameState","nextDevice","splice","sKey","_moveState","source","destination","_deleteState","AddDeviceState","StateAddRef","setError","onAddState","_setNewStateKey","shrink","onEnter","renderedStates","DragDeviceState","onDragEnd","droppableId","provided","snapshot","innerRef","droppableProps","placeholder","draggableId","draggableProps","dragHandleProps","DeviceState","fields","DevicesStates","field","DeviceStateField","prompt","fontSize","noPadding","fieldProps","deviceDefaults","json","DeviceStateFieldJsonEditor","DeviceStateFieldAutoComplete","DeviceStateFieldStateExplorer","DeviceStateFieldOther","node","setValue","showJsonEditor","setShowJsonEditor","additionalProps","Fragment","DeviceStateFieldInput","setVal","showStateExplorer","setShowStateExplorer","components","option","getComponents","componentConfig","setComponentConfig","property","componentsOptions","userConfig","c","renderOption","Input","ucFirst","_interopRequireDefault","_interopRequireWildcard","defineProperty","exports","default","_default","createElement","d"],"mappings":"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","file":"static/js/18.8376a382.chunk.js","sourcesContent":["import React, { useState, useEffect } from 'react'\r\n//import clsx from 'clsx'\r\n\r\nimport i18n from '../../../controller/i18n'\r\nimport Log from '../../../controller/Log'\r\n\r\nimport Grid from '@material-ui/core/Grid'\r\nimport List from '@material-ui/core/List'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport Dialog from '../../../components/Dialog'\r\nimport Info from '../../../components/Info'\r\nimport Inputs from '../../../components/Inputs'\r\n\r\n\r\n/*\r\n * STYLES\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nconst useStyles = makeStyles(theme => ({\r\n}));\r\n */\r\n\r\n\r\n/*\r\n *\r\n */\r\nconst ComponentConfig = React.memo(props => {\r\n\tLog._('WidgetPage', 'RENDER ComponentConfig', 'development');\r\n\t//const classes = useStyles();\r\n\tconst { _onClose, _onChange, id, config, attributes } = props;\r\n\t\r\n\tconst [open,setOpen] = useState(false);\r\n\tconst onClose = () => {\r\n\t\tsetOpen(false)\r\n\t\t_onClose();\r\n\t}\r\n\t\r\n\tuseEffect(() => {\r\n\t\tsetOpen(config !== null);\r\n\t}, [config]);\r\n\t\r\n\tif (id === null || config === null || config === undefined) {\r\n\t\treturn null;\r\n\t}\r\n\t\r\n\t// component configuration\r\n\tconst componentConfiguration = Object.keys(config).map(configKey => {\r\n\t\tlet configOption = config[configKey];\r\n\t\tconfigOption = typeof configOption === 'object' ? configOption : { 'label': configKey, 'val': configOption.val !== undefined ? configOption.val : configOption }\r\n\t\tlet { _translate, info, ...otherConfigOption } = configOption;\r\n\t\t\r\n\t\totherConfigOption.label = configOption.label || configKey;\r\n\t\totherConfigOption.label = _translate ? i18n.t(configOption.label) : configOption.label;\r\n\t\totherConfigOption.val = _translate ? i18n.t(configOption.val) : configOption.val;\r\n\t\totherConfigOption.selection = typeof otherConfigOption.selection === 'function' ? otherConfigOption.selection(props) : otherConfigOption.selection;\r\n\t\t\r\n\t\tconst Tag = Inputs[configOption.type || 'Text'];\r\n\t\treturn (\r\n\t\t\t<ListItem key={'Config-' + configKey} divider>\r\n\t\t\t\t<ListItemText disableTypography>\r\n\t\t\t\t\t<Grid container spacing={1}>\r\n\t\t\t\t\t\t<Grid item><Info info={info} /></Grid>\r\n\t\t\t\t\t\t<Grid item><Typography>{i18n.t(otherConfigOption.label)}</Typography></Grid>\r\n\t\t\t\t\t</Grid>\r\n\t\t\t\t</ListItemText>\r\n\t\t\t\t\r\n\t\t\t\t<ListItemSecondaryAction>\r\n\t\t\t\t\t<Tag\r\n\t\t\t\t\t\tkey={'componentConfig.' + id + '.' + configKey}\r\n\t\t\t\t\t\tid={'componentConfig.' + id + '.' + configKey}\r\n\t\t\t\t\t\t{...otherConfigOption}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlabel=''\r\n\t\t\t\t\t\twidth={180}\r\n\t\t\t\t\t\tinputProps={{\r\n\t\t\t\t\t\t\tstyle: { textAlign: 'right' }\r\n\t\t\t\t\t\t}} \r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tonChange={(props, val) => _onChange(props, val, attributes)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t\t</ListItemSecondaryAction>\r\n\t\t\t</ListItem>\r\n\t\t);\r\n\t});\r\n\t\r\n\treturn (\r\n\t\t<Dialog\r\n\t\t\theader={i18n.t('Component configuration')}\r\n\t\t\tactions={\r\n\t\t\t\t<Inputs.Button key=\"action-save\" variant=\"text\" onClick={onClose} color=\"primary\" label=\"Apply\" />\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tdense\r\n\t\t\tmaxWidth='xs'\r\n\t\t\tfullWidth={true}\r\n\t\t\topen={open}\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t<List dense disablePadding>\r\n\t\t\t\t{componentConfiguration}\r\n\t\t\t</List>\r\n\t\t</Dialog>\r\n\t);\r\n});\r\n\r\nexport default ComponentConfig;\r\n","import React, { useState, useCallback, useMemo } from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport ButtonBase from '@material-ui/core/ButtonBase'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport Collapse from '@material-ui/core/Collapse'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport ExpandIcon from '@material-ui/icons/KeyboardArrowRight'\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => {\r\n\tconst transition = {\r\n\t\tduration: theme.transitions.duration.shortest,\r\n\t};\r\n\t\r\n\treturn {\r\n\t\texpanded: {\r\n\t\t},\r\n\t\tCollapsible: {\r\n\t\t\tposition: 'relative',\r\n\t\t\ttransition: theme.transitions.create(['margin'], transition),\r\n\t\t\t'&:before': {\r\n\t\t\t\tposition: 'absolute',\r\n\t\t\t\tleft: 0,\r\n\t\t\t\ttop: -1,\r\n\t\t\t\tright: 0,\r\n\t\t\t\theight: 1,\r\n\t\t\t\tcontent: '\"\"',\r\n\t\t\t\topacity: 1,\r\n\t\t\t\tbackgroundColor: theme.palette.divider,\r\n\t\t\t\ttransition: theme.transitions.create(['opacity', 'background-color'], transition),\r\n\t\t\t},\r\n\t\t\t'&:first-child': {\r\n\t\t\t\t'&:before': {\r\n\t\t\t\t\tdisplay: 'none',\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t'&$expanded': {\r\n\t\t\t\tmargin: '16px 0',\r\n\t\t\t\t'&:first-child': {\r\n\t\t\t\t\tmarginTop: 0,\r\n\t\t\t\t},\r\n\t\t\t\t'&:last-child': {\r\n\t\t\t\t\tmarginBottom: 0,\r\n\t\t\t\t},\r\n\t\t\t\t'&:before': {\r\n\t\t\t\t\topacity: 0,\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t'&$expanded + &': {\r\n\t\t\t\t'&:before': {\r\n\t\t\t\t\tdisplay: 'none',\r\n\t\t\t\t},\r\n\t\t\t}\r\n\t\t},\r\n\t\tCollapsibleSummary: {\r\n\t\t\tdisplay: 'flex',\r\n\t\t\tminHeight: 8 * 6,\r\n\t\t\ttransition: theme.transitions.create(['min-height', 'background-color'], transition),\r\n\t\t\tpadding: theme.spacing(0, 2),\r\n\t\t\t'&$expanded': {\r\n\t\t\t\tminHeight: 64,\r\n\t\t\t}\r\n\t\t},\r\n\t\tCollapsibleSummaryContent: {\r\n\t\t\tdisplay: 'flex',\r\n\t\t\tflexGrow: 1,\r\n\t\t\ttransition: theme.transitions.create(['margin'], transition),\r\n\t\t\tmargin: '12px 0',\r\n\t\t\t\r\n\t\t\t'&$expanded': {\r\n\t\t\t\tmargin: '20px 0',\r\n\t\t\t},\r\n\t\t},\r\n\t\tCollapsibleSummaryExpandIcon: {\r\n\t\t\ttransform: 'rotate(0deg)',\r\n\t\t\ttransition: theme.transitions.create('transform', transition),\r\n\t\t\t'&:hover': {\r\n\t\t\t\t// Disable the hover effect for the IconButton,\r\n\t\t\t\t// because a hover effect should apply to the entire Expand button and\r\n\t\t\t\t// not only to the IconButton.\r\n\t\t\t\tbackgroundColor: 'transparent',\r\n\t\t\t},\r\n\t\t\t'&$expanded': {\r\n\t\t\t\ttransform: 'rotate(90deg)',\r\n\t\t\t},\r\n\t\t},\r\n\t\tCollapsibleDetails: {\r\n\t\t\t//display: 'flex',\r\n\t\t\tpadding: theme.spacing(0, 2, 2, 4),\r\n\t\t}\r\n\t}\r\n});\r\n\r\n\r\n/*\r\n *\r\n */\r\nconst CollapsibleContext = React.createContext({});\r\n\r\nexport default React.forwardRef(function Collapsible(props, ref) {\r\n\tconst { expanded: defaultExpanded, children: childrenProp, className, ...other } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst [expanded, setExpanded] = useState(defaultExpanded !== undefined ? defaultExpanded : false);\r\n\tconst handleChange = useCallback(\r\n\t\t(event) => {\r\n\t\t\tsetExpanded(!expanded);\r\n\t\t},\r\n\t\t[expanded, setExpanded]\r\n\t);\r\n\t\r\n\tconst [summary, ...children] = React.Children.toArray(childrenProp);\r\n\tconst contextValue = useMemo(() => ({ expanded, toggle: handleChange }), [ expanded, handleChange ]);\r\n\t\r\n\treturn (\r\n\t\t<Paper\r\n\t\t\televation={0} \r\n\t\t\tclasses={{ root: clsx(classes.Collapsible, { [classes.expanded]: expanded }, className) }}\r\n\t\t\tref={ref}\r\n\t\t\t{...other}\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t<CollapsibleContext.Provider value={contextValue}>{summary}</CollapsibleContext.Provider>\r\n\t\t\t<Collapse in={expanded} timeout=\"auto\">\r\n\t\t\t\t<div aria-labelledby={summary.props.id} id={summary.props['aria-controls']} role=\"region\">\r\n\t\t\t\t\t{children}\r\n\t\t\t\t</div>\r\n\t\t\t</Collapse>\r\n\t\t</Paper>\r\n\t);\r\n});\r\n\r\n/*\r\n *\r\n */\r\nexport const CollapsibleSummary = React.forwardRef(function CollapsibleSummary(props, ref) {\r\n\tconst { children, className, expandIcon, onBlur, onClick, onFocusVisible, ...other } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst { expanded, toggle } = React.useContext(CollapsibleContext);\r\n\tconst handleChange = (event) => {\r\n\t\tevent.stopPropagation();\r\n\t\t\r\n\t\tif (toggle) {\r\n\t\t\ttoggle(event);\r\n\t\t}\r\n\t\tif (onClick) {\r\n\t\t\tonClick(event);\r\n\t\t}\r\n\t};\r\n\t\r\n\treturn (\r\n\t\t<ButtonBase\r\n\t\t\tfocusRipple={false}\r\n\t\t\tdisableRipple\r\n\t\t\tcomponent=\"div\"\r\n\t\t\taria-expanded={expanded}\r\n\t\t\tclassName={clsx(classes.CollapsibleSummary, { [classes.expanded]: expanded }, className)}\r\n\t\t\tonClick={handleChange}\r\n\t\t\tref={ref}\r\n\t\t\t{...other}\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t<IconButton\r\n\t\t\t\tclassName={clsx(classes.CollapsibleSummaryExpandIcon, { [classes.expanded]: expanded })}\r\n\t\t\t\tcomponent=\"div\"\r\n\t\t\t\tsize=\"small\"\r\n\t\t\t\ttabIndex={null}\r\n\t\t\t\trole={null}\r\n\t\t\t\taria-hidden\r\n\t\t\t\t>\r\n\t\t\t\t\r\n\t\t\t\t{expandIcon ? expandIcon : <ExpandIcon />}\r\n\t\t\t</IconButton>\r\n\t\t\t<div className={clsx(classes.CollapsibleSummaryContent, { [classes.expanded]: expanded })}>\r\n\t\t\t\t{children}\r\n\t\t\t</div>\r\n\t\t</ButtonBase>\r\n\t);\r\n});\r\n\r\n/*\r\n *\r\n */\r\nexport const CollapsibleDetails = React.forwardRef(function CollapsibleDetails(props, ref) {\r\n\tconst { className, ...other } = props;\r\n\tconst classes = useStyles();\r\n\r\n\treturn <div className={clsx(classes.CollapsibleDetails, className)} ref={ref} {...other} />;\r\n});\r\n","import arrayWithHoles from \"@babel/runtime/helpers/esm/arrayWithHoles\";\nimport iterableToArray from \"@babel/runtime/helpers/esm/iterableToArray\";\nimport unsupportedIterableToArray from \"@babel/runtime/helpers/esm/unsupportedIterableToArray\";\nimport nonIterableRest from \"@babel/runtime/helpers/esm/nonIterableRest\";\nexport default function _toArray(arr) {\n  return arrayWithHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableRest();\n}","import React from 'react'\r\n//import clsx from 'clsx'\r\n\r\nimport i18n from '../../../controller/i18n'\r\n\r\nimport Dialog from '../../../components/Dialog'\r\nimport Inputs from '../../../components/Inputs'\r\n\r\nimport { JsonEditor as Editor } from 'jsoneditor-react'\r\nimport 'jsoneditor-react/es/editor.min.css'\r\n\r\n\r\n/*\r\n *\r\n */\r\nconst JsonEditor = React.forwardRef((props, ref) => {\r\n\tconst { val, height, _onChange } = props;\r\n\t\r\n\treturn (\r\n\t\t<Editor\r\n\t\t\tref={ref}\r\n\t\t\tvalue={val || {}}\r\n\t\t\tmode='text'\r\n\t\t\tallowedModes={['tree', 'view', 'form', 'text']}\r\n\t\t\thtmlElementProps={{ style: { 'height': height || 0, 'display': !height ? 'none' : 'block' } }}\r\n\t\t\tonChange={_onChange}\r\n\t\t\t/>\r\n\t);\r\n});\r\n\r\n/*\r\n *\r\n */\r\nexport const JsonEditorPopup = React.memo(props => {\r\n\tconst { open, _onClose } = props;\r\n\t\r\n\treturn (\r\n\t\t<Dialog\r\n\t\t\theader={i18n.t('JSON Editor')}\r\n\t\t\tactions={\r\n\t\t\t\t<Inputs.Button key=\"action-save\" variant=\"text\" onClick={_onClose} color=\"primary\" label=\"Apply\" />\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tdense\r\n\t\t\tmaxWidth='sm'\r\n\t\t\tfullWidth={true}\r\n\t\t\topen={open}\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t<JsonEditor {...props} />\r\n\t\t</Dialog>\r\n\t);\r\n});\r\n\r\nexport default JsonEditor;\r\n","\r\n\r\nexport default {\r\n\t\"state\": {\r\n\t\t\"label\": \"config#Devices#state#label\",\r\n\t\t\"info\": \"config#Devices#state#info\",\r\n\t\t\r\n\t\t//<IGNORE>\r\n\t\t// white space not allowed\r\n\t\t\"onValidate\": val => {\r\n\t\t\tif (val.indexOf(' ') > -1) {\r\n\t\t\t\tthrow new Error('No whitespaces allowed in the state');\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn val;\r\n\t\t}//</IGNORE>\r\n\t},\r\n\t\"stateStyle\": {\r\n\t\t\"label\": \"config#Devices#stateStyle#label\",\r\n\t\t\"info\": \"config#Devices#stateStyle#info\",\r\n\t\t\"json\": true\r\n\t},\r\n\t\"properties\": {\r\n\t\t\"label\": \"config#Devices#properties#label\",\r\n\t\t\"info\": \"config#Devices#properties#info\",\r\n\t\t\"json\": true\r\n\t},\r\n\t\"display\": {\r\n\t\t\"label\": \"config#Devices#display#label\",\r\n\t\t\"info\": \"config#Devices#display#info\",\r\n\t\t\"json\": true\r\n\t},\r\n\t\"label\": {\r\n\t\t\"label\": \"config#Devices#label#label\",\r\n\t\t\"info\": \"config#Devices#label#info\"\r\n\t},\r\n\t\"unit\": {\r\n\t\t\"label\": \"config#Devices#unit#label\",\r\n\t\t\"info\": \"config#Devices#unit#info\",\r\n\t\t\"json\": true,\r\n\t\t\r\n\t\t// if only a single string is given for a unit, convert it to a json compatible format to it will pass validation later\r\n\t\t\"onValidate\": val => val.indexOf(\" \") === -1 && val.indexOf('\"') === -1 && val.indexOf(\"}\") === -1 && val.indexOf(\"{\") === -1 ? '\"' + val + '\"' : val\r\n\t},\r\n\t\"icon\": {\r\n\t\t\"label\": \"config#Devices#icon#label\",\r\n\t\t\"info\": \"config#Devices#icon#info\",\r\n\t\t\"link\": \"https://materialdesignicons.com/\",\r\n\t\t\"json\": true,\r\n\t\t\r\n\t\t// if only a single string is given for an icon, convert it to a json compatible format to it will pass validation later\r\n\t\t\"onValidate\": val => val.indexOf(\" \") === -1 && val.indexOf('\"') === -1 && val.indexOf(\"}\") === -1 && val.indexOf(\"{\") === -1 ? '\"' + val + '\"' : val\r\n\t},\r\n\t\"iconStyle\": {\r\n\t\t\"label\": \"config#Devices#iconStyle#label\",\r\n\t\t\"info\": \"config#Devices#iconStyle#info\",\r\n\t\t\"json\": true\r\n\t},\r\n\t\"placeholder_1\": {\r\n\t\t\"type\": \"Placeholder\"\r\n\t},\r\n\t\"action\": {\r\n\t\t\"label\": \"config#Devices#action#label\",\r\n\t\t\"info\": \"config#Devices#action#info\",\r\n\t\t\r\n\t\t//<IGNORE>\r\n\t\t// white space not allowed\r\n\t\t\"onValidate\": val => {\r\n\t\t\tif (val.indexOf(' ') > -1) {\r\n\t\t\t\tthrow new Error('No whitespaces allowed in the state');\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn val;\r\n\t\t}//</IGNORE>\r\n\t},\r\n\t\"bodyElement\": {\r\n\t\t\"label\": \"config#Devices#bodyElement#label\",\r\n\t\t\"autoComplete\": true,\r\n\t\t\"autoHighlight\": true,\r\n\t\t\"options\": null,\r\n\t\t\"renderOption\": null\r\n\t},\r\n\t\"actionElement\": {\r\n\t\t\"label\": \"config#Devices#actionElement#label\",\r\n\t\t\"autoComplete\": true,\r\n\t\t\"autoHighlight\": true,\r\n\t\t\"options\": null,\r\n\t\t\"renderOption\": null\r\n\t},\r\n\t\"hide\": {\r\n\t\t\"label\": \"config#Devices#hide#label\",\r\n\t\t\"info\": \"config#Devices#hide#info\",\r\n\t\t\"type\": \"Switch\"\r\n\t}\r\n}\r\n","import React, { useState, useEffect, useRef } from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport Cache from '../../../controller/Cache'\r\nimport Connection from '../../../controller/Connection'\r\nimport i18n from '../../../controller/i18n'\r\nimport Log from '../../../controller/Log'\r\nimport timeConverter from '../../../helpers/timeConverter'\r\n\r\nimport LinearProgress from '@material-ui/core/LinearProgress'\r\nimport Divider from '@material-ui/core/Divider'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport TreeItem from '@material-ui/lab/TreeItem'\r\nimport TreeView from '@material-ui/lab/TreeView'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport CollapseIcon from '@material-ui/icons/ArrowDropDown'\r\nimport ExpandIcon from '@material-ui/icons/ArrowRight'\r\nimport GroupIcon from '@material-ui/icons/Folder'\r\nimport RefreshIcon from '@material-ui/icons/Refresh'\r\nimport StateIcon from '@material-ui/icons/BookmarkBorder'\r\n\r\nimport Dialog from '../../../components/Dialog'\r\nimport Inputs from '../../../components/Inputs'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tdivider: {\r\n\t\tflexGrow: 1\r\n\t},\r\n\tTreeView: {\r\n\t\tpadding: theme.spacing(2),\r\n\t\t'&:focus > $TreeItemContent $TreeItemLabel, &:hover > $TreeItemContent $TreeItemLabel, &$TreeItemSelected > $TreeItemContent $TreeItemLabel': {\r\n\t\t\tbackgroundColor: 'transparent',\r\n\t\t},\r\n\t},\r\n\tTreeItem: {\r\n\t\tcolor: theme.palette.text.secondary,\r\n\t\t'&:hover > $TreeItemContent': {\r\n\t\t\tbackgroundColor: theme.palette.action.hover,\r\n\t\t},\r\n\t},\r\n\tTreeItemContent: {\r\n\t\tcolor: theme.palette.text.secondary,\r\n\t\tpaddingRight: theme.spacing(1),\r\n\t\t//fontWeight: theme.typography.fontWeightMedium,\r\n\t\t'$TreeItemExpanded > &': {\r\n\t\t\t//fontWeight: theme.typography.fontWeightRegular,\r\n\t\t},\r\n\t},\r\n\tTreeItemError: {\r\n\t\tbackgroundColor: theme.palette.error.light,\r\n\t\ttextDecoration: 'line-through',\r\n\t\tcursor: 'not-allowed !important',\r\n\t\tfontWeight: 'normal',\r\n\t},\r\n\tTreeItemExpanded: {\r\n\t},\r\n\tTreeItemSelected: {\r\n\t\tfontWeight: 'bold !important',\r\n\t},\r\n\tTreeItemGroup: {\r\n\t\tfontWeight: 'initial',\r\n\t\t'& $TreeItemContent': {\r\n\t\t\tpaddingLeft: theme.spacing(2),\r\n\t\t},\r\n\t},\r\n\tTreeItemLabel: {\r\n\t\tfontWeight: 'inherit',\r\n\t\tcolor: 'inherit',\r\n\t},\r\n\tEntry: {\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center',\r\n\t\tpadding: theme.spacing(0.5, 0),\r\n\t},\r\n\tGroup: {\r\n\t\t//fontWeight: 'bold'\r\n\t},\r\n\tEntryIcon: {\r\n\t\tmarginRight: theme.spacing(1),\r\n\t},\r\n\tEntryText: {\r\n\t\tfontWeight: 'inherit',\r\n\t\tflexGrow: 1,\r\n\t}\r\n}));\r\n\r\n\r\n/*\r\n *\r\n */\r\nconst indexObjects = (list, index) => {\r\n\tlet objectsTree = {}\r\n\tlet root = [];\r\n\t\r\n\tfor (let objectId of list) {\r\n\t\t\r\n\t\t// index state\r\n\t\tobjectsTree[objectId.substr(0, objectId.lastIndexOf('.'))] = objectsTree[objectId.substr(0, objectId.lastIndexOf('.'))] || {}\r\n\t\tobjectsTree[objectId.substr(0, objectId.lastIndexOf('.'))][objectId] = index[objectId];\r\n\t\t\r\n\t\t// make sure state is added to all its parents\r\n\t\tlet namespace = objectId;\r\n\t\twhile (namespace.indexOf('.') > -1) {\r\n\t\t\tconst id = namespace;\r\n\t\t\tnamespace = namespace.substr(0, namespace.lastIndexOf('.'));\r\n\t\t\t\r\n\t\t\tif (objectsTree[namespace] === undefined || objectsTree[namespace][id] === undefined) {\r\n\t\t\t\tobjectsTree[namespace] = objectsTree[namespace] || {}\r\n\t\t\t\tobjectsTree[namespace][id] = {}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (namespace && namespace.indexOf('.') === -1 && root.indexOf(namespace) === -1) {\r\n\t\t\t\troot.push(namespace);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn [ root, objectsTree ];\r\n}\r\n\r\n/*\r\n *\r\n */\r\nconst StateExplorer = React.memo(props => {\r\n\tconst { val, _onChange } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\t\r\n\tconst [objectList,setObjectList] = useState(Cache.get('objectList') || null);\r\n\tconst selectedItem = useRef(val);\r\n\tconst searchTimeout = useRef();\r\n\t\r\n\tuseEffect(() => {\r\n\t\t\r\n\t\tif (objectList === null || !objectList.root) {\r\n\t\t\tconst socket = Connection.connection;\r\n\t\t\tsocket.getObjects()\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tlet list = [];\r\n\t\t\t\t\tlet index = {}\r\n\t\t\t\t\t\r\n\t\t\t\t\tres.forEach((promise, i) => {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (promise.status === 'fulfilled' && promise.value && Array.isArray(promise.value.rows)) {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t// read results and sort\r\n\t\t\t\t\t\t\tfor (let obj of promise.value.rows) {\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t// skip system\r\n\t\t\t\t\t\t\t\tif (obj.id.substr(0,6) === 'system') {\r\n\t\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t// index result\r\n\t\t\t\t\t\t\t\tindex[obj.id] = obj.value;\r\n\t\t\t\t\t\t\t\tlist.push(obj.id);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t\t// index sorted results\r\n\t\t\t\t\tlist.sort();\r\n\t\t\t\t\tconst [ root, tree ] = indexObjects(list, index);\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst _objectList = {\r\n\t\t\t\t\t\t'updated': Date.now(),\r\n\t\t\t\t\t\t'root': root.sort(),\r\n\t\t\t\t\t\t'list': list,\r\n\t\t\t\t\t\t'tree': tree\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tCache.set('objectList', _objectList);\r\n\t\t\t\t\tsetObjectList(_objectList);\r\n\t\t\t\t})\r\n\t\t\t\t.catch(error => {\r\n\t\t\t\t\tLog._('StateExplorer', error.message, 'error', true, error.stack);\r\n\t\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t}, [objectList]);\r\n\t\r\n\t//\r\n\tconst search = (props, val) => {\r\n\t\tclearTimeout(searchTimeout.current);\r\n\t\tsearchTimeout.current = setTimeout(() => {\r\n\t\t\tconst data = Cache.get('objectList');\r\n\t\t\t\r\n\t\t\tconst [ root, tree ] = indexObjects(data.list.filter(obj => obj.toLowerCase().indexOf(val.toLowerCase()) > -1), data.tree);\r\n\t\t\tsetObjectList(prevObjectList => ({\r\n\t\t\t\t...prevObjectList,\r\n\t\t\t\t'root': root.sort(),\r\n\t\t\t\t'tree': tree\r\n\t\t\t}));\r\n\t\t\t\r\n\t\t}, 750);\r\n\t}\r\n\t\r\n\t//\r\n\tconst selectObject = (e, val) => {\r\n\t\tconst selected = objectList.tree[val] || null; // tree only holds channels, thus null will be a state\r\n\t\t\r\n\t\tif (selected === null) {\r\n\t\t\tval = val.indexOf(' ') === -1 ? val : '';\r\n\t\t\tselectedItem.current = val;\r\n\t\t\t_onChange(val);\r\n\t\t}\r\n\t}\r\n\t\r\n\t//\r\n\tconst renderTree = key => {\r\n\t\tlet states = [];\r\n\t\tlet children = [];\r\n\t\t\r\n\t\t// channels\r\n\t\tif (objectList.tree[key]) {\r\n\t\t\tObject.keys(objectList.tree[key]).forEach(channelKey => {\r\n\t\t\t\tconst child = objectList.tree[key][channelKey];\r\n\t\t\t\t\r\n\t\t\t\tif (child.type === 'state') {\r\n\t\t\t\t\tstates.push(channelKey);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tchildren.push(renderTree(channelKey));\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t\t\r\n\t\t// states\r\n\t\tif (states.length > 0) {\r\n\t\t\tchildren = children.concat(\r\n\t\t\t\tstates.map(stateKey => <Item key={stateKey} error={(stateKey.indexOf(' ') > -1)} nodeId={stateKey} label={<Entry key={stateKey} error={(stateKey.indexOf(' ') > -1)} id={stateKey.substr(stateKey.lastIndexOf('.')+1)} {...objectList.tree[stateKey.substr(0, stateKey.lastIndexOf('.'))][stateKey]} />} />)\r\n\t\t\t);\r\n\t\t}\r\n\t\t\r\n\t\tconst channel = key.substr(key.lastIndexOf('.')+1);\r\n\t\tconst details = key.indexOf('.') > -1 ? objectList.tree[key.substr(0, key.lastIndexOf('.'))][key] : {}\r\n\t\treturn (\r\n\t\t\t<Item key={key} nodeId={key} children={children} label={<Entry key={key} group id={channel} {...details} />} />\r\n\t\t);\r\n\t}\r\n\t\r\n\treturn (\r\n\t\t<Paper>\r\n\t\t\t<Inputs.Fieldset>\r\n\t\t\t\t<Inputs.Text\r\n\t\t\t\t\tid='search'\r\n\t\t\t\t\tlabel='Search'\r\n\t\t\t\t\tonChange={search}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\r\n\t\t\t\t<div className={classes.divider} />\r\n\t\t\t\t<div style={{ margin: 'auto 0' }}>\r\n\t\t\t\t\t{objectList !== null && <span style={{ margin: 'auto 0' }}>{i18n.t('Last refresh') + ': ' + timeConverter.parseDate(objectList.updated, 'dd.MM.yyyy, HH:mm:ss')}</span>}\r\n\t\t\t\t\t<Inputs.Button\r\n\t\t\t\t\t\tlabel='refresh'\r\n\t\t\t\t\t\tstartIcon={<RefreshIcon />}\r\n\t\t\t\t\t\tonClick={() => setObjectList(null)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t</Inputs.Fieldset>\r\n\t\t\t<Divider />\r\n\t\t\t\r\n\t\t\t{(objectList === null || !objectList.root) ?\r\n\t\t\t<LinearProgress />\r\n\t\t\t:\r\n\t\t\t<TreeView\r\n\t\t\t\tclassName={classes.TreeView}\r\n\t\t\t\tdefaultCollapseIcon={<CollapseIcon />}\r\n\t\t\t\tdefaultExpandIcon={<ExpandIcon />}\r\n\t\t\t\tonNodeSelect={selectObject}\r\n\t\t\t\t>\r\n\t\t\t\t\r\n\t\t\t\t{objectList.root.map(key => renderTree(key))}\r\n\t\t\t</TreeView>}\r\n\t\t</Paper>\r\n\t);\r\n});\r\n\r\n/*\r\n *\r\n */\r\nconst Item = props => {\r\n\tconst { children, error, ...otherProps } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\treturn (\r\n\t\t<TreeItem\r\n\t\t\tclasses={{\r\n\t\t\t\troot: clsx(error && classes.TreeItemError, classes.TreeItem),\r\n\t\t\t\tcontent: classes.TreeItemContent,\r\n\t\t\t\texpanded: classes.TreeItemExpanded,\r\n\t\t\t\tselected: classes.TreeItemSelected,\r\n\t\t\t\tgroup: classes.TreeItemGroup,\r\n\t\t\t\tlabel: classes.TreeItemLabel\r\n\t\t\t}}\r\n\t\t\t\r\n\t\t\t{...otherProps}\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t{children || null}\r\n\t\t</TreeItem>\r\n\t);\r\n}\r\n\r\n/*\r\n *\r\n */\r\nconst Entry = props => {\r\n\tconst { id, error, type, group, common } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst name = common && common.name ? common.name : '';\t\r\n\tconst EntryIcon = group ? GroupIcon : StateIcon;\r\n\treturn (\r\n\t\t<div className={clsx(error && classes.TreeItemError, classes.Entry, group && classes.Group)}>\r\n\t\t\t<EntryIcon color=\"inherit\" className={classes.EntryIcon} />\r\n\t\t\t<EntryText width=\"40%\" caption label={id} />\r\n\t\t\t{name.length > 60 ? \r\n\t\t\t\t<Tooltip title={name} arrow>\r\n\t\t\t\t\t<div style={{ width: '40%' }}>\r\n\t\t\t\t\t\t<EntryText label={name.substr(0, 60) + '...'} />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Tooltip>\r\n\t\t\t:\r\n\t\t\t\t<EntryText width=\"40%\" label={name} />\r\n\t\t\t}\r\n\t\t\t<EntryText width=\"10%\" label={type} />\r\n\t\t\t<EntryText width=\"10%\" label={common && common.role} />\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\n/*\r\n *\r\n */\r\nconst EntryText = props => {\r\n\tconst { label, width, caption } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\treturn (\r\n\t\t<div style={{ width: width || '100%' }}>\r\n\t\t\t<Typography variant={caption ? 'caption' : 'body2'} className={classes.EntryText}>\r\n\t\t\t\t{(label && label[i18n.getLanguage()]) || label || ''}\r\n\t\t\t</Typography>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\n/*\r\n *\r\n */\r\nexport const StateExplorerPopup = React.memo(props => {\r\n\tconst { open, _onClose, _onChange } = props;\r\n\t\r\n\tconst state = useRef(props.val);\r\n\treturn (\r\n\t\t<Dialog\r\n\t\t\theader={i18n.t('State Explorer')}\r\n\t\t\tactions={[\r\n\t\t\t\t<Inputs.Button key='action-cancel' variant=\"text\" onClick={_onClose} color=\"secondary\" label=\"Cancel\" />,\r\n\t\t\t\t<Inputs.Button key=\"action-save\" variant=\"text\" onClick={() => _onChange(state.current)} color=\"primary\" label=\"Apply\" />\r\n\t\t\t]}\r\n\t\t\t\r\n\t\t\tdense\r\n\t\t\tmaxWidth='lg'\r\n\t\t\tfullWidth={true}\r\n\t\t\t\r\n\t\t\topen={open}\r\n\t\t\tonClose={_onClose}\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t<StateExplorer {...props} _onChange={s => state.current = s} />\r\n\t\t</Dialog>\r\n\t);\r\n});\r\n\r\nexport default StateExplorer;\r\n","import React, { useState, useEffect, useRef, useCallback } from 'react'\r\nimport clsx from 'clsx'\r\nimport { DragDropContext, Droppable, Draggable } from 'react-beautiful-dnd'\r\n\r\nimport DevicesStates from './Devices.config'\r\nimport i18n from '../../../controller/i18n'\r\nimport Log from '../../../controller/Log'\r\nimport FUNCTIONS, { icons as FUNCTION_ICONS, componentsOptions } from '../../../functions'\r\nimport ucFirst from '../../../helpers/utils'\r\n\r\nimport Grid from '@material-ui/core/Grid'\r\nimport List from '@material-ui/core/List'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport IconButton from '@material-ui/core/IconButton'\r\n\r\nimport AddIcon from '@material-ui/icons/Add'\r\nimport EditIcon from '@material-ui/icons/Edit'\r\nimport DeleteIcon from '@material-ui/icons/Delete'\r\n\r\nimport ComponentConfig from '../DevicesPage/ComponentConfigPage'\r\nimport { JsonEditorPopup } from '../DevicesPage/JsonEditor'\r\nimport { StateExplorerPopup } from '../DevicesPage/StateExplorer'\r\nimport { Screenshot, getComponents } from '../../../modules/StateList/StateList.settings'\r\n\r\nimport Collapsible, { CollapsibleSummary, CollapsibleDetails } from '../../../components/Collapsible'\r\nimport Dialog from '../../../components/Dialog'\r\nimport Icon from '../../../components/Icon'\r\nimport Inputs from '../../../components/Inputs'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nconst useStyles = makeStyles(theme => ({\r\n\tfullWidth: {\r\n\t\twidth: '100%',\r\n\t},\r\n\ticonContainer: {\r\n\t\tflexDirection: 'column',\r\n\t\talignItems: 'center'\r\n\t},\r\n\talignRight: {\r\n\t\tdisplay: 'flex',\r\n\t\tjustifyContent: 'flex-end',\r\n\t\t\r\n\t\t'& > :not(:first-child)': {\r\n\t\t\tmarginLeft: 8,\r\n\t\t}\r\n\t},\r\n\tModifyIcon: {\r\n\t\tverticalAlign: 'bottom'\r\n\t},\r\n\theading: {\r\n\t\tmargin: 'auto auto auto 0'\r\n\t},\r\n\tListItem: {\r\n\t\tpadding: 0\r\n\t},\r\n\tdrag: {\r\n\t\tcursor: 'grab !important',\r\n\t\tuserSelect: 'none',\r\n\t\t\r\n\t\t'&:hover': {\r\n\t\t\tbackgroundColor: theme.palette.action.hover,\r\n\t\t}\r\n\t},\r\n\tisDragging: {\r\n\t\tbackgroundColor: theme.palette.action.selected,\r\n\t}\r\n}));\r\n\r\n\r\nconst _merge = require('deepmerge');\r\nconst _copy = require('rfdc')();\r\n\r\nconst DevicesPage = React.memo(props => {\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst [device,setDevice] = useState(_copy(props.device));\r\n\tconst [errors,setErrors] = useState({});\r\n\tconst EDITOR = useRef({});\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _onChange = useCallback((props, val) => {\r\n\t\t\r\n\t\t// error handler\r\n\t\tsetErrors(prevErrors => {\r\n\t\t\tlet nextErrors = { ...prevErrors }\r\n\t\t\t\r\n\t\t\t// error occured\r\n\t\t\tif (props.error && props.error !== prevErrors[props.id]) {\r\n\t\t\t\tnextErrors[props.id] = props.error;\r\n\t\t\t\treturn nextErrors;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// no error -> remove old error\r\n\t\t\telse if (!props.error && prevErrors[props.id]) {\r\n\t\t\t\tdelete nextErrors[props.id];\r\n\t\t\t\treturn nextErrors;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn prevErrors;\r\n\t\t});\r\n\t\t\r\n\t\t// set value\r\n\t\tEDITOR.current[props.id] = val;\r\n\t\t\r\n\t}, []);\r\n\t\r\n\t/*\r\n\t * trigger initial validation\r\n\t */\r\n\tuseEffect(() => {\r\n\t\tif (!props.device.name) {\r\n\t\t\tsetErrors(prevErrors => ({\r\n\t\t\t\t...prevErrors,\r\n\t\t\t\t'device->name': true\r\n\t\t\t}));\r\n\t\t}\r\n\t\t\r\n\t}, [props.device.name]);\r\n\t\r\n\tif (device === null) {\r\n\t\treturn null;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _onSave = () => {\r\n\t\tlet savedDevice = { ...device }\r\n\t\tsavedDevice.options = savedDevice.options || {}\r\n\t\tsavedDevice.attributes = savedDevice.attributes || {}\r\n\t\t\r\n\t\tfor (const key in EDITOR.current) {\r\n\t\t\tconst val = EDITOR.current[key];\r\n\t\t\tconst [ type, base, characteristic, param ] = key.split('->');\r\n\t\t\t\r\n\t\t\t// states\r\n\t\t\tif (type === 'states') {\r\n\t\t\t\tif (typeof savedDevice[type][base] === 'object' && characteristic.toLowerCase().indexOf('config') > -1) {\r\n\t\t\t\t\tsavedDevice[type][base][characteristic] = savedDevice[type][base][characteristic] || {}\r\n\t\t\t\t\tsavedDevice[type][base][characteristic][param] = val;\r\n\t\t\t\t}\r\n\t\t\t\telse if (typeof savedDevice[type][base] === 'object') {\r\n\t\t\t\t\tsavedDevice[type][base][characteristic] = val;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tsavedDevice[type][base] = {\r\n\t\t\t\t\t\t'state': savedDevice[type][base],\r\n\t\t\t\t\t\t[characteristic]: val\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// options or attributes\r\n\t\t\telse if (type === 'options' || type === 'attributes') {\r\n\t\t\t\tsavedDevice[type][base] = val;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// device\r\n\t\t\telse {\r\n\t\t\t\tsavedDevice[base] = val;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// save\r\n\t\tsavedDevice.attributes._updated = Date.now();\r\n\t\tprops.onSave(savedDevice);\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _deleteDevice = () => props.onDelete && props.onDelete(device.id);\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _addState = newStateKey => {\r\n\t\t\r\n\t\tconst stateKey = newStateKey.replace(/ /g, '');\r\n\t\tsetDevice(prevDevice => ({\r\n\t\t\t...prevDevice,\r\n\t\t\tstates: {\r\n\t\t\t\t[stateKey]: {},\r\n\t\t\t\t...prevDevice.states || {}\r\n\t\t\t}\r\n\t\t}));\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _renameState = (stateKey, newStateKey) => {\r\n\t\tnewStateKey = newStateKey.replace(/ /g, '');\r\n\t\t\r\n\t\t// verify state key does not exist\r\n\t\tif (device.states[newStateKey] !== undefined) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t\t// replace state key in layout\r\n\t\t//props.onReplaceStateKey(device.id, stateKey, newStateKey); // this is wrong here because Device has to be saved first\r\n\t\tEDITOR.current['states->' + newStateKey + '->_renamed'] = stateKey;\r\n\t\t\r\n\t\t// change state key in EDITOR\r\n\t\tlet state = {}\r\n\t\tfor (let key in EDITOR.current) {\r\n\t\t\tconst [ type, base, characteristic ] = key.split('->');\r\n\t\t\t\r\n\t\t\tif (type === 'states' && base === stateKey) {\r\n\t\t\t\tstate[characteristic] = EDITOR.current[key];\r\n\t\t\t\tEDITOR.current[type + '->' + newStateKey + '->' + characteristic] = EDITOR.current[key];\r\n\t\t\t\tdelete EDITOR.current[key];\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// change state key in device\r\n\t\tsetDevice(prevDevice => {\r\n\t\t\tconst nextDevice = { ...prevDevice, 'states': {} }\r\n\t\t\t\r\n\t\t\tconst states = Object.keys(prevDevice.states);\r\n\t\t\tconst position = states.indexOf(stateKey);\r\n\t\t\tstates.splice(position, 1, newStateKey);\r\n\t\t\t\r\n\t\t\tfor (let sKey of states) {\r\n\t\t\t\tnextDevice.states[sKey] = {\r\n\t\t\t\t\t...prevDevice.states[sKey === newStateKey ? stateKey : sKey],\r\n\t\t\t\t\t...state\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn nextDevice;\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _addDefaultStates = func => {\r\n\t\t\r\n\t\tif (FUNCTIONS[func] !== undefined) {\r\n\t\t\tconst stateKeys = Object.keys(device.states || {});\r\n\t\t\tObject.keys(FUNCTIONS[func]).reverse().forEach(stateKey => {\r\n\t\t\t\tconst state = FUNCTIONS[func][stateKey];\r\n\t\t\t\t\r\n\t\t\t\tif (state.substitute !== true && stateKeys.indexOf(stateKey) === -1 && stateKey.substr(0,1) !== '_') {\r\n\t\t\t\t\t_addState(stateKey);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _moveState = res => {\r\n\t\t\r\n\t\tif (res.source && res.destination && res.source.index !== res.destination.index) {\r\n\t\t\t\r\n\t\t\tsetDevice(prevDevice => {\r\n\t\t\t\tlet nextDevice = { ...prevDevice, 'states': {} }\r\n\t\t\t\t\r\n\t\t\t\tlet states = Object.keys(prevDevice.states);\r\n\t\t\t\tstates.splice(res.destination.index, 0, states.splice(res.source.index, 1)[0]);\r\n\t\t\t\tstates.forEach(stateKey => {\r\n\t\t\t\t\tnextDevice.states[stateKey] = prevDevice.states[stateKey];\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\treturn nextDevice;\r\n\t\t\t});\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _deleteState = stateKey => {\r\n\t\t\r\n\t\t//props.onStateDelete(device.id, stateKey); // this is wrong here because Device has to be saved first\r\n\t\tsetDevice(prevDevice => {\r\n\t\t\tlet nextDevice = { ...prevDevice }\r\n\t\t\tdelete nextDevice.states[stateKey];\r\n\t\t\treturn nextDevice;\r\n\t\t});\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\tLog._('DevicesPages', 'RENDER DevicesPage', 'development');\r\n\treturn (\r\n\t\t<Dialog\r\n\t\t\tid='DeviceConfiguration'\r\n\t\t\theader={i18n.t('Device Configuration') + ' (' + i18n.t('Device ID') + ': ' + device.id + ')'}\r\n\t\t\tactions={[\r\n\t\t\t\t<Grid key='actions' container>\r\n\t\t\t\t\t<Grid item xs={6}>\r\n\t\t\t\t\t\t{device.name && <Inputs.Button key='action->delete' variant=\"text\" onClick={() => _deleteDevice()} color=\"secondary\" startIcon={<DeleteIcon />} label=\"Delete Device\" />}\r\n\t\t\t\t\t</Grid>\r\n\t\t\t\t\t<Grid item xs={6} className={classes.alignRight}>\r\n\t\t\t\t\t\t<Inputs.Button key='action->cancel' className=\"cancel\" variant=\"text\" onClick={() => props.onClose()} color=\"secondary\" label=\"Cancel\" />\r\n\t\t\t\t\t\t<Inputs.Button key='action->save' className=\"apply\" variant=\"text\" onClick={() => _onSave()} color=\"primary\" disabled={Object.keys(errors).length > 0} label=\"Apply\" />\r\n\t\t\t\t\t</Grid>\r\n\t\t\t\t</Grid>\r\n\t\t\t]}\r\n\t\t\t\r\n\t\t\tdense\r\n\t\t\tmaxWidth='lg'\r\n\t\t\tfullWidth={true}\r\n\t\t\t\r\n\t\t\topen={true}\r\n\t\t\tonClose={() => props.onClose()}\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t<Inputs.Fieldset label='General'>\r\n\t\t\t\t<Inputs.FieldsetItem columns={3}>\r\n\t\t\t\t\t<Inputs.Text\r\n\t\t\t\t\t\tkey=\"device->name\"\r\n\t\t\t\t\t\tid=\"device->name\"\r\n\t\t\t\t\t\twidth={200}\r\n\t\t\t\t\t\tautoFocus\r\n\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlabel='Device'\r\n\t\t\t\t\t\tval={device.name}\r\n\t\t\t\t\t\tonChange={_onChange}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t\t</Inputs.FieldsetItem>\r\n\t\t\t\t<Inputs.FieldsetItem columns={3}>\r\n\t\t\t\t\t<Inputs.Text\r\n\t\t\t\t\t\tkey=\"device->label\"\r\n\t\t\t\t\t\tid=\"device->label\"\r\n\t\t\t\t\t\twidth={200}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlabel='Label'\r\n\t\t\t\t\t\tval={device.label || ''}\r\n\t\t\t\t\t\tonChange={_onChange}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t\t</Inputs.FieldsetItem>\r\n\t\t\t\t<Inputs.FieldsetItem columns={3}>\r\n\t\t\t\t\t<Inputs.Select\r\n\t\t\t\t\t\tkey=\"device->function\"\r\n\t\t\t\t\t\tid=\"device->function\"\r\n\t\t\t\t\t\twidth={200}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlabel='Function'\r\n\t\t\t\t\t\tval={device.function || 'other'}\r\n\t\t\t\t\t\tselection={\r\n\t\t\t\t\t\t\tObject.keys(FUNCTIONS).map(funcKey => {\r\n\t\t\t\t\t\t\t\tconst func = funcKey !== '_defaults' ? funcKey : 'other';\r\n\t\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\t\t[func]: i18n.t(func),\r\n\t\t\t\t\t\t\t\t\t'icon': FUNCTION_ICONS[funcKey] || null,\r\n\t\t\t\t\t\t\t\t\t'_key': func,\r\n\t\t\t\t\t\t\t\t\t'_translated': true,\r\n\t\t\t\t\t\t\t\t\t'_sort': i18n.t(func)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tsortOptionsByKey\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tonChange={(props, val) => {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t// add default state keys of function (if not added already)\r\n\t\t\t\t\t\t\tif (Object.keys(device.states).length === 0) {\r\n\t\t\t\t\t\t\t\t_addDefaultStates(val);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t_onChange(props, val);\r\n\t\t\t\t\t\t\tsetDevice(prevDevice => ({\r\n\t\t\t\t\t\t\t\t...prevDevice,\r\n\t\t\t\t\t\t\t\t'function': val\r\n\t\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t\t</Inputs.FieldsetItem>\r\n\t\t\t\t<Inputs.FieldsetItem columns={3}>\r\n\t\t\t\t\t<Inputs.Text\r\n\t\t\t\t\t\tkey=\"device->icon\"\r\n\t\t\t\t\t\tid=\"device->icon\"\r\n\t\t\t\t\t\twidth={200}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlabel='Icon'\r\n\t\t\t\t\t\tval={device.icon || ''}\r\n\t\t\t\t\t\tonChange={_onChange}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t\t</Inputs.FieldsetItem>\r\n\t\t\t\t\r\n\t\t\t\t<Inputs.FieldsetItem columns={3}>\r\n\t\t\t\t\t<Inputs.Switch\r\n\t\t\t\t\t\tkey=\"device->suppressPopup\"\r\n\t\t\t\t\t\tid=\"device->suppressPopup\"\r\n\t\t\t\t\t\twidth={200}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlabel='Suppress Popup'\r\n\t\t\t\t\t\tinfo='Do not open the device details in the popup when the device is clicked'\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tval={device.suppressPopup !== undefined ? device.suppressPopup : false}\r\n\t\t\t\t\t\tonChange={_onChange}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t\t</Inputs.FieldsetItem>\r\n\t\t\t</Inputs.Fieldset>\r\n\t\t\t\r\n\t\t\t<Inputs.Fieldset label='States'>\r\n\t\t\t\t<DeviceStates\r\n\t\t\t\t\t_onChange={_onChange}\r\n\t\t\t\t\t_addState={_addState}\r\n\t\t\t\t\t_addDefaultStates={_addDefaultStates}\r\n\t\t\t\t\t_renameState={_renameState}\r\n\t\t\t\t\t_moveState={_moveState}\r\n\t\t\t\t\t_deleteState={_deleteState}\r\n\t\t\t\t\terrors={errors}\r\n\t\t\t\t\tdevice={device}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t</Inputs.Fieldset>\r\n\t\t</Dialog>\r\n\t)\r\n});\r\n\r\nexport default DevicesPage;\r\n\r\n\r\n/*\r\n *\r\n */\r\nconst AddDeviceState = React.memo(props => {\r\n\tLog._('DevicesPages', 'RENDER AddDeviceState', 'development');\r\n\tconst { device } = props;\r\n\t\r\n\tconst StateAddRef = useRef();\r\n\tconst [error,setError] = useState('');\r\n\t\r\n\tconst onAddState = () => {\r\n\t\tconst newStateKey = StateAddRef.current.value || '';\r\n\t\t\r\n\t\t// empty state key\r\n\t\tif (!newStateKey) {\r\n\t\t\tsetError(i18n.t('Type in a state key / identifier'));\r\n\t\t}\r\n\r\n\t\t// state key exists already\r\n\t\telse if (Object.keys(device.states || {}).indexOf(newStateKey) > -1) {\r\n\t\t\tsetError(i18n.t('State key already used'));\r\n\t\t}\r\n\t\t\r\n\t\t// add state\r\n\t\telse {\r\n\t\t\tsetError('');\r\n\t\t\tprops._setNewStateKey(newStateKey)\r\n\t\t\tprops._addState(newStateKey);\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn (\r\n\t\t<ListItem key='StatesListItemLabel->add' dense divider className=\"DeviceStateAdd\">\r\n\t\t\t<ListItemIcon>\r\n\t\t\t\t<IconButton size=\"small\" disabled>\r\n\t\t\t\t\t<AddIcon />\r\n\t\t\t\t</IconButton>\r\n\t\t\t</ListItemIcon>\r\n\t\t\t\r\n\t\t\t<ListItemText disableTypography style={{ display: 'flex' }}>\r\n\t\t\t\t<Inputs.Text\r\n\t\t\t\t\tid='states->add'\r\n\t\t\t\t\tref={StateAddRef}\r\n\t\t\t\t\tshrink={true}\r\n\t\t\t\t\tlabel='new state key'\r\n\t\t\t\t\tval={props.newStateKey}\r\n\t\t\t\t\tonEnter={onAddState}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\r\n\t\t\t\t<div style={{ display: 'flex', margin: 'auto 0' }}>\r\n\t\t\t\t\t<Inputs.Button\r\n\t\t\t\t\t\tclassName=\"DeviceStateAddButton\"\r\n\t\t\t\t\t\tlabel='add state'\r\n\t\t\t\t\t\tonClick={onAddState}\r\n\t\t\t\t\t\twidth={275}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<Inputs.Button\r\n\t\t\t\t\t\tlabel='add default states'\r\n\t\t\t\t\t\tonClick={() => props._addDefaultStates(device.function)}\r\n\t\t\t\t\t\twidth={275}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t\t</div>\r\n\t\t\t\t<span style={{ color: '#900' }}>{error}</span>\r\n\t\t\t</ListItemText>\r\n\t\t</ListItem>\r\n\t);\r\n});\r\n\r\n/*\r\n *\r\n */\r\nconst DeviceStates = React.memo(props => {\r\n\tLog._('DevicesPages', 'RENDER DeviceStates', 'development');\r\n\tconst { device, _moveState } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst newStateKey = useRef('');\r\n\tconst setNewStateKey = val => newStateKey.current = val;\r\n\t\r\n\tconst renderedStates = Object.keys(device.states || {}).map((stateKey, i) => {\r\n\t\tlet state = device.states[stateKey];\r\n\t\tstate = typeof state === 'string' ? { 'state': state } : state;\r\n\t\t\r\n\t\treturn (\r\n\t\t\t<DragDeviceState\r\n\t\t\t\t{...props}\r\n\t\t\t\tkey={'DeviceState->' + stateKey}\r\n\t\t\t\tindex={i}\r\n\t\t\t\tstate={{ ...state, 'key': stateKey }}\r\n\t\t\t\texpanded={stateKey === newStateKey.current}\r\n\t\t\t\t/>\r\n\t\t\t\r\n\t\t);\r\n\t});\r\n\t\r\n\treturn (\r\n\t\t<List classes={{ root: classes.fullWidth }} dense>\r\n\t\t\t<AddDeviceState newStateKey={newStateKey.current} _setNewStateKey={setNewStateKey} {...props} />\r\n\t\t\t<DragDropContext onDragEnd={_moveState}>\r\n\t\t\t\t<Droppable\r\n\t\t\t\t\tkey='DeviceStates'\r\n\t\t\t\t\tdroppableId='states'\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\r\n\t\t\t\t\t{(provided, snapshot) => (\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tref={provided.innerRef}\r\n\t\t\t\t\t\t{...provided.droppableProps}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t{renderedStates}\r\n\t\t\t\t\t\t{provided.placeholder}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</Droppable>\r\n\t\t\t</DragDropContext>\r\n\t\t</List>\r\n\t);\r\n});\r\n\r\n/*\r\n *\r\n */\r\nconst DragDeviceState = props => {\r\n\tconst classes = useStyles();\r\n\t\r\n\treturn (\r\n\t\t<Draggable\r\n\t\t\tkey={props.state.key}\r\n\t\t\tdraggableId={'state->' + props.state.key}\r\n\t\t\tindex={props.index}\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t{(provided, snapshot) => (\r\n\t\t\t<div\r\n\t\t\t\tclassName={clsx(classes.drag, snapshot.isDragging && classes.isDragging)}\r\n\t\t\t\tref={provided.innerRef}\r\n\t\t\t\t{...provided.draggableProps}\r\n\t\t\t\t{...provided.dragHandleProps}\r\n\t\t\t\t>\r\n\t\t\t\t\r\n\t\t\t\t<DeviceState {...props} />\r\n\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</Draggable>\r\n\t);\r\n}\r\n\r\n/*\r\n *\r\n */\r\nconst DeviceState = React.memo(props => {\r\n\tLog._('DevicesPages', 'RENDER DeviceState', 'development');\r\n\tconst { state, expanded, _renameState, _deleteState } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst fields = Object.keys(DevicesStates).map(field => <DeviceStateField key={'DeviceStateField->' + state.key + '->' + field} {...props} field={field} />);\r\n\tconst renameState = () => {\r\n\t\tconst stateKey = prompt(i18n.t('Rename State Key'), state.key);\r\n\t\t\r\n\t\tif (stateKey && stateKey !== state.key) {\r\n\t\t\t_renameState(state.key, stateKey);\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn (\r\n\t\t<ListItem\r\n\t\t\tkey={'StatesListItem->' + state.key}\r\n\t\t\tclasses={{ root: clsx(classes.ListItem, 'DeviceState') }}\r\n\t\t\tdense\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t<ListItemText disableTypography>\r\n\t\t\t\t<Collapsible key={'DeviceState->' + state.key} expanded={expanded} className={'DeviceState DeviceState->' + state.key}>\r\n\t\t\t\t\t<CollapsibleSummary>\r\n\t\t\t\t\t\t<Typography classes={{ root: classes.heading }} display=\"inline\">{state.key}</Typography>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<IconButton size=\"small\" onClick={renameState}>\r\n\t\t\t\t\t\t\t<EditIcon />\r\n\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t<IconButton size=\"small\" onClick={e => {e.stopPropagation();_deleteState(state.key)}}>\r\n\t\t\t\t\t\t\t<DeleteIcon />\r\n\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t<Icon style={{ fontSize: '1.5em', margin: 'auto 8px' }} icon=\"mdi:drag\" />\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t</CollapsibleSummary>\r\n\t\t\t\t\t<CollapsibleDetails>\r\n\t\t\t\t\t\t<Inputs.Fieldset noPadding>\r\n\t\t\t\t\t\t\t{fields}\r\n\t\t\t\t\t\t</Inputs.Fieldset>\r\n\t\t\t\t\t</CollapsibleDetails>\r\n\t\t\t\t</Collapsible>\r\n\t\t\t</ListItemText>\r\n\t\t</ListItem>\r\n\t);\r\n});\r\n\r\n/*\r\n *\r\n */\r\nconst DeviceStateField = React.memo(props => {\r\n\tconst { device, field } = props;\r\n\tconst fieldProps = DevicesStates[field];\r\n\tconst deviceDefaults = _merge(FUNCTIONS['_defaults'], FUNCTIONS[device.function] || {});\r\n\t\r\n\t// JSON\r\n\tif (fieldProps.json === true) {\r\n\t\treturn <DeviceStateFieldJsonEditor {...props} fieldProps={fieldProps} deviceDefaults={deviceDefaults} />\r\n\t}\r\n\t\r\n\t// AutoComplete\r\n\telse if (fieldProps.options !== undefined) {\r\n\t\treturn <DeviceStateFieldAutoComplete {...props} fieldProps={fieldProps} deviceDefaults={deviceDefaults} />\r\n\t}\r\n\t\r\n\t// State Explorer\r\n\telse if (field === 'state' || field === 'action') {\r\n\t\treturn <DeviceStateFieldStateExplorer {...props} fieldProps={fieldProps} deviceDefaults={deviceDefaults} />\r\n\t}\r\n\t\r\n\t// Other\r\n\telse {\r\n\t\treturn <DeviceStateFieldOther {...props} fieldProps={fieldProps} deviceDefaults={deviceDefaults} />\r\n\t}\r\n});\r\n\r\nconst DeviceStateFieldJsonEditor = React.memo(props => {\r\n\tconst { state, field, _onChange } = props;\r\n\t\r\n\t\r\n\tconst value = useRef(state[field] && state[field].node ? state[field].node : (state[field] || ''));\r\n\tconst setValue = val => value.current = val;\r\n\tconst [showJsonEditor,setShowJsonEditor] = useState(false);\r\n\tconst onChange = (props, val) => !props.error && _onChange(props, val);\r\n\t\r\n\t// additional props\r\n\tlet additionalProps = {}\r\n\tadditionalProps.action = () => setShowJsonEditor(true);\r\n\t\r\n\treturn (\r\n\t\t<React.Fragment key={'StatesListItemField->' + state.key + '->' + field}>\r\n\t\t\t<JsonEditorPopup\r\n\t\t\t\topen={showJsonEditor}\r\n\t\t\t\t_onClose={() => setShowJsonEditor(false)}\r\n\t\t\t\tval={value.current}\r\n\t\t\t\theight={500}\r\n\t\t\t\t_onChange={val => {\r\n\t\t\t\t\tonChange({ 'id': 'states->' + state.key + '->' + field }, val);\r\n\t\t\t\t\tsetValue(val);\r\n\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t\r\n\t\t\t<DeviceStateFieldInput {...props} additionalProps={additionalProps} val={value.current} setVal={setValue} _onChange={onChange} />\r\n\t\t</React.Fragment>\r\n\t);\r\n});\r\n\r\nconst DeviceStateFieldStateExplorer = React.memo(props => {\r\n\tconst { state, field, _onChange } = props;\r\n\t\r\n\t\r\n\tconst [value,setValue] = useState(state[field] && state[field].node ? state[field].node : (state[field] || ''));\r\n\tconst setVal = val => setValue(val);\r\n\tconst [showStateExplorer,setShowStateExplorer] = useState(false);\r\n\t\r\n\t// additional props\r\n\tlet additionalProps = {}\r\n\tadditionalProps.action = () => setShowStateExplorer(true);\r\n\t\r\n\treturn (\r\n\t\t<React.Fragment key={'StatesListItemField->' + state.key + '->' + field}>\r\n\t\t\t\r\n\t\t\t<StateExplorerPopup\r\n\t\t\t\topen={showStateExplorer}\r\n\t\t\t\t_onClose={() => setShowStateExplorer(false)}\r\n\t\t\t\tval={value}\r\n\t\t\t\t_onChange={val => {\r\n\t\t\t\t\t_onChange({ 'id': 'states->' + state.key + '->' + field }, val);\r\n\t\t\t\t\tsetValue(val);\r\n\t\t\t\t\tsetShowStateExplorer(false);\r\n\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t\r\n\t\t\t<DeviceStateFieldInput {...props} additionalProps={additionalProps} val={value} setVal={setVal} />\r\n\t\t</React.Fragment>\r\n\t);\r\n});\r\n\r\nconst DeviceStateFieldAutoComplete = React.memo(props => {\r\n\tconst { device, deviceDefaults, state, field, fieldProps, _onChange } = props;\r\n\t\r\n\t\r\n\t// components\r\n\tconst components = {\r\n\t\t'screenshot': (option, state) => <Screenshot func={device.function} option={option} selected={state.selected} />,\r\n\t\t'bodyElement': getComponents(device.function, 'body'),\r\n\t\t'actionElement': getComponents(device.function, 'action')\r\n\t}\r\n\t\r\n\tconst [value,setValue] = useState(\r\n\t\t(state[field] && state[field].node !== undefined) || state[field] !== undefined ? // prefer if given but empty (which means user has unselected it)\r\n\t\t\t((state[field] && state[field].node) || state[field] || '') : (\r\n\t\t\t\t(field.indexOf('Element') > -1 && deviceDefaults[state.key.toLowerCase()] && deviceDefaults[state.key.toLowerCase()][field]) ||\r\n\t\t\t\t(field.indexOf('Element') > -1 && deviceDefaults['_any'] && deviceDefaults['_any'][field]) ||\r\n\t\t\t\t''\r\n\t\t\t)\r\n\t);\r\n\t\r\n\tconst setVal = val => setValue(val);\r\n\tconst [componentConfig,setComponentConfig] = useState(null);\r\n\t\r\n\t//\r\n\tconst property = useRef({});\r\n\tuseEffect(() => {\r\n\t\t\r\n\t\tif (value && property.current[value] === undefined) {\r\n\t\t\tlet config = _merge(\r\n\t\t\t\tcomponentsOptions['_defaults'][value] || {},\r\n\t\t\t\t(componentsOptions[props.device.function] && componentsOptions[props.device.function][value]) || {}\r\n\t\t\t);\r\n\t\t\t\r\n\t\t\t// apply user specific values\r\n\t\t\tconst userConfig = props.state[value + 'Config'] || {}\r\n\t\t\tObject.keys(userConfig).forEach(c => {\r\n\t\t\t\tconfig[c] = typeof config[c] !== 'object' ? { 'val': config[c] } : config[c];\r\n\t\t\t\tconfig[c].val = userConfig[c];\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tproperty.current[value] = config;\r\n\t\t}\r\n\t\t\r\n\t}, [value, props.device, props.state]);\r\n\t\r\n\t// additional props\r\n\tlet additionalProps = {}\r\n\tif (fieldProps.options !== undefined) {\r\n\t\tadditionalProps.options = typeof fieldProps.options === 'function' ? fieldProps.options(props.device) : components[field];\r\n\t}\r\n\t\r\n\tif (fieldProps.renderOption !== undefined) {\r\n\t\tadditionalProps.renderOption = typeof fieldProps.renderOption === 'function' ? ((option, state) => fieldProps.renderOption(option, state, props.device)) : components['screenshot'];\r\n\t}\r\n\t\r\n\tadditionalProps.action = ((componentsOptions['_defaults'] && componentsOptions['_defaults'][value]) || (componentsOptions[device.function] && componentsOptions[device.function][value])) && (() => setComponentConfig({ 'id': field + 'Config', 'config': property.current[value] }));\r\n\t\r\n\treturn (\r\n\t\t<React.Fragment key={'StatesListItemField->' + state.key + '->' + field}>\r\n\t\t\t\r\n\t\t\t<ComponentConfig\r\n\t\t\t\t_onClose={() => setComponentConfig(null)}\r\n\t\t\t\t_onChange={(props, val) => {\r\n\t\t\t\t\tconst key = props.id.substr(props.id.lastIndexOf('.')+1);\r\n\t\t\t\t\tproperty.current[value][key].val = val;\r\n\t\t\t\t\t_onChange({ ...props, 'id': 'states->' + state.key + '->' + value + 'Config->' + key }, val);\r\n\t\t\t\t}}\r\n\t\t\t\tid={(componentConfig && componentConfig.id) || null}\r\n\t\t\t\tconfig={(componentConfig && componentConfig.config) || {}}\r\n\t\t\t\tdevice={device}\r\n\t\t\t\t/>\r\n\t\t\t\r\n\t\t\t<DeviceStateFieldInput {...props} additionalProps={additionalProps} val={value} setVal={setVal} />\r\n\t\t</React.Fragment>\r\n\t);\r\n});\r\n\r\nconst DeviceStateFieldOther = React.memo(props => {\r\n\tconst { state, field } = props;\r\n\t\r\n\t\r\n\tconst [value,setValue] = useState(state[field] && state[field].node ? state[field].node : (state[field] || ''));\r\n\tconst setVal = val => setValue(val);\r\n\t\r\n\treturn (\r\n\t\t<React.Fragment key={'StatesListItemField->' + state.key + '->' + field}>\r\n\t\t\t<DeviceStateFieldInput {...props} val={value} setVal={setVal} />\r\n\t\t</React.Fragment>\r\n\t);\r\n});\r\n\r\nconst DeviceStateFieldInput = React.memo(props => {\r\n\tconst { deviceDefaults, state, field, fieldProps, additionalProps, setVal, _onChange } = props;\r\n\t\r\n\t\r\n\tconst Input = Inputs[fieldProps.type || 'Text'];\r\n\t\r\n\treturn (\r\n\t\t<Inputs.FieldsetItem className={'field->' + field} columns={4}>\r\n\t\t\t<Input\r\n\t\t\t\t{...fieldProps}\r\n\t\t\t\t{...additionalProps}\r\n\t\t\t\t\r\n\t\t\t\tid={'states->' + state.key + '->' + field}\r\n\t\t\t\tshrink={true}\r\n\t\t\t\tlabel={fieldProps.label || ucFirst(field)}\r\n\t\t\t\tplaceholder={(deviceDefaults[state.key.toLowerCase()] && deviceDefaults[state.key.toLowerCase()][field.replace('Element', '')]) || fieldProps.val || ''}\r\n\t\t\t\twidth={370}\r\n\t\t\t\tval={props.val}\r\n\t\t\t\t\r\n\t\t\t\tonChange={(props, val) => {\r\n\t\t\t\t\tsetVal(val);\r\n\t\t\t\t\ttypeof fieldProps.onChange === 'function' ? fieldProps.onChange(props, val, _onChange) : _onChange(props, val);\r\n\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t\t\r\n\t\t</Inputs.FieldsetItem>\r\n\t);\r\n});\r\n","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 00-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z\"\n}), 'Edit');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z\"\n}), 'Add');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z\"\n}), 'KeyboardArrowRight');\n\nexports.default = _default;"],"sourceRoot":""}