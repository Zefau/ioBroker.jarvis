(this.webpackJsonpjarvis=this.webpackJsonpjarvis||[]).push([[42],{1366:function(e,t,a){"use strict";a.r(t),a.d(t,"StateExplorerPopup",(function(){return J}));var r=a(55),n=a(5),l=a(9),o=a(45),c=a(0),i=a.n(c),u=a(2),s=a(23),d=a(22),f=a(6),m=a(12),b=a(83),p=a(1335),h=a(125),E=a(140),g=a(1614),v=a(1613),I=a(61),O=a(32),y=a(1483),x=a.n(y),T=a(1484),j=a.n(T),C=a(1485),w=a.n(C),k=a(1482),L=a.n(k),$=a(1486),S=a.n($),W=a(162),G=a(27),N=a(41),R=Object(N.a)((function(e){return{divider:{flexGrow:1},TreeView:{padding:e.spacing(2),"&:focus > $TreeItemContent $TreeItemLabel, &:hover > $TreeItemContent $TreeItemLabel, &$TreeItemSelected > $TreeItemContent $TreeItemLabel":{backgroundColor:"transparent"}},TreeItem:{color:e.palette.text.secondary,"&:hover > $TreeItemContent":{backgroundColor:e.palette.action.hover}},TreeItemContent:{color:e.palette.text.secondary,paddingRight:e.spacing(1),"$TreeItemExpanded > &":{}},TreeItemError:{backgroundColor:e.palette.error.light,textDecoration:"line-through",cursor:"not-allowed !important",fontWeight:"normal"},TreeItemExpanded:{},TreeItemSelected:{fontWeight:"bold !important"},TreeItemGroup:{fontWeight:"initial","& $TreeItemContent":{paddingLeft:e.spacing(2)}},TreeItemLabel:{fontWeight:"inherit",color:"inherit"},Entry:{display:"flex",alignItems:"center",padding:e.spacing(.5,0)},Group:{},EntryIcon:{marginRight:e.spacing(1)},EntryText:{fontWeight:"inherit",flexGrow:1}}})),_=function(e,t){var a,r={},n=[],l=Object(o.a)(e);try{for(l.s();!(a=l.n()).done;){var c=a.value;r[c.substr(0,c.lastIndexOf("."))]=r[c.substr(0,c.lastIndexOf("."))]||{},r[c.substr(0,c.lastIndexOf("."))][c]=t[c];for(var i=c;i.indexOf(".")>-1;){var u=i;void 0!==r[i=i.substr(0,i.lastIndexOf("."))]&&void 0!==r[i][u]||(r[i]=r[i]||{},r[i][u]={}),i&&-1===i.indexOf(".")&&-1===n.indexOf(i)&&n.push(i)}}}catch(s){l.e(s)}finally{l.f()}return[n,r]},A=i.a.memo((function(e){var t=e.val,a=e._onChange,r=R(),u=Object(c.useState)(s.default.get("objectList")||null),g=Object(l.a)(u,2),I=g[0],O=g[1],y=Object(c.useRef)(t),T=Object(c.useRef)();Object(c.useEffect)((function(){null!==I&&I.root||d.default.connection.getObjects().then((function(e){var t=[],a={};e.forEach((function(e,r){if("fulfilled"===e.status&&e.value&&Array.isArray(e.value.rows)){var n,l=Object(o.a)(e.value.rows);try{for(l.s();!(n=l.n()).done;){var c=n.value;"system"!==c.id.substr(0,6)&&(a[c.id]=c.value,t.push(c.id))}}catch(i){l.e(i)}finally{l.f()}}})),t.sort();var r=_(t,a),n=Object(l.a)(r,2),c=n[0],i=n[1],u={updated:Date.now(),root:c.sort(),list:t,tree:i};s.default.set("objectList",u),O(u)})).catch((function(e){m.default._("StateExplorer",e.message,"error",!0,e.stack)}))}),[I]);var C=function e(t){var a=[],r=[];I.tree[t]&&Object.keys(I.tree[t]).forEach((function(n){"state"===I.tree[t][n].type?a.push(n):r.push(e(n))})),a.length>0&&(r=r.concat(a.map((function(e){return i.a.createElement(B,{key:e,error:e.indexOf(" ")>-1,nodeId:e,label:i.a.createElement(D,Object.assign({key:e,error:e.indexOf(" ")>-1,id:e.substr(e.lastIndexOf(".")+1)},I.tree[e.substr(0,e.lastIndexOf("."))][e]))})}))));var n=t.substr(t.lastIndexOf(".")+1),l=t.indexOf(".")>-1?I.tree[t.substr(0,t.lastIndexOf("."))][t]:{};return i.a.createElement(B,{key:t,nodeId:t,children:r,label:i.a.createElement(D,Object.assign({key:t,group:!0,id:n},l))})};return i.a.createElement(E.a,null,i.a.createElement(G.default.Fieldset,null,i.a.createElement(G.default.Text,{id:"search",label:"Search",onChange:function(e,t){clearTimeout(T.current),T.current=setTimeout((function(){var e=s.default.get("objectList"),a=_(e.list.filter((function(e){return e.toLowerCase().indexOf(t.toLowerCase())>-1})),e.tree),r=Object(l.a)(a,2),o=r[0],c=r[1];O((function(e){return Object(n.a)(Object(n.a)({},e),{},{root:o.sort(),tree:c})}))}),750)}}),i.a.createElement("div",{className:r.divider}),i.a.createElement("div",{style:{margin:"auto 0"}},null!==I&&i.a.createElement("span",{style:{margin:"auto 0"}},f.default.t("Last refresh")+": "+b.default.parseDate(I.updated,"dd.MM.yyyy, HH:mm:ss")),i.a.createElement(G.default.Button,{label:"refresh",startIcon:i.a.createElement(L.a,null),onClick:function(){return O(null)}}))),i.a.createElement(h.a,null),null!==I&&I.root?i.a.createElement(v.a,{className:r.TreeView,defaultCollapseIcon:i.a.createElement(x.a,null),defaultExpandIcon:i.a.createElement(j.a,null),onNodeSelect:function(e,t){null===(I.tree[t]||null)&&(t=-1===t.indexOf(" ")?t:"",y.current=t,a(t))}},I.root.map((function(e){return C(e)}))):i.a.createElement(p.a,null))})),B=function(e){var t=e.children,a=e.error,n=Object(r.a)(e,["children","error"]),l=R();return i.a.createElement(g.a,Object.assign({classes:{root:Object(u.a)(a&&l.TreeItemError,l.TreeItem),content:l.TreeItemContent,expanded:l.TreeItemExpanded,selected:l.TreeItemSelected,group:l.TreeItemGroup,label:l.TreeItemLabel}},n),t||null)},D=function(e){var t=e.id,a=e.error,r=e.type,n=e.group,l=e.common,o=R(),c=l&&l.name?l.name:"",s=n?w.a:S.a;return i.a.createElement("div",{className:Object(u.a)(a&&o.TreeItemError,o.Entry,n&&o.Group)},i.a.createElement(s,{color:"inherit",className:o.EntryIcon}),i.a.createElement(H,{width:"40%",caption:!0,label:t}),c.length>60?i.a.createElement(I.a,{title:c,arrow:!0},i.a.createElement("div",{style:{width:"40%"}},i.a.createElement(H,{label:c.substr(0,60)+"..."}))):i.a.createElement(H,{width:"40%",label:c}),i.a.createElement(H,{width:"10%",label:r}),i.a.createElement(H,{width:"10%",label:l&&l.role}))},H=function(e){var t=e.label,a=e.width,r=e.caption,n=R();return i.a.createElement("div",{style:{width:a||"100%"}},i.a.createElement(O.a,{variant:r?"caption":"body2",className:n.EntryText},t&&t[f.default.getLanguage()]||t||""))},J=i.a.memo((function(e){var t=e.open,a=e._onClose,r=e._onChange,n=Object(c.useRef)(e.val);return i.a.createElement(W.default,{header:f.default.t("State Explorer"),actions:[i.a.createElement(G.default.Button,{key:"action-cancel",variant:"text",onClick:a,color:"secondary",label:"Cancel"}),i.a.createElement(G.default.Button,{key:"action-save",variant:"text",onClick:function(){return r(n.current)},color:"primary",label:"Apply"})],dense:!0,maxWidth:"lg",fullWidth:!0,open:t,onClose:a},i.a.createElement(A,Object.assign({},e,{_onChange:function(e){return n.current=e}})))}));t.default=A}}]);
//# sourceMappingURL=42.17ba5c0c.chunk.js.map